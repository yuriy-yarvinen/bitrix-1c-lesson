{"version":3,"file":"public.bundle.js","sources":["../src/legacy.js","../src/desktop.js","../src/functions/settings.js","../src/public.js"],"sourcesContent":["import { Reflection, Type } from 'main.core';\nimport { Messenger } from './public';\n\n/* eslint-disable no-console */\nconst legacyMessenger = {};\nlegacyMessenger.openMessenger = function(...args): Promise {\n\tconsole.warn(\"Developer: method BXIM.openMessenger is deprecated. Use method 'Messenger.openChat' from 'im.public' or 'im.public.iframe' extension.\");\n\n\treturn Messenger.openChat(...args);\n};\n\nlegacyMessenger.openMessengerSlider = function(dialogId: string): Promise {\n\tconsole.warn(\"Developer: method BXIM.openMessengerSlider is deprecated. Use method 'Messenger.openChat' from 'im.public' or 'im.public.iframe' extension.\");\n\n\treturn Messenger.openChat(dialogId);\n};\n\nlegacyMessenger.openHistory = function(...args): Promise {\n\tconsole.warn(\"Developer: method BXIM.openHistory is deprecated. Use method 'Messenger.openChat' from 'im.public' or 'im.public.iframe' extension.\");\n\n\tconst Opener = Reflection.getClass('BX.Messenger.v2.Lib.Opener');\n\n\treturn Opener?.openHistory(...args);\n};\n\nlegacyMessenger.openNotify = function(...args): Promise {\n\tconsole.warn(\"Developer: method BXIM.openNotify is deprecated. Use method 'Messenger.openNotifications' from 'im.public' or 'im.public.iframe' extension.\");\n\n\treturn Messenger.openNotifications(...args);\n};\n\nlegacyMessenger.openSettings = function(...args): Promise {\n\tconsole.warn(\"Developer: method BXIM.openSettings is deprecated. Use method 'Messenger.openSettings' from 'im.public' or 'im.public.iframe' extension.\");\n\n\treturn Messenger.openSettings(...args);\n};\n\nlegacyMessenger.openVideoconf = function(code): Promise {\n\tconsole.warn(\"Developer: method BXIM.openVideoconf is deprecated. Use method 'Messenger.openConference' from 'im.public' or 'im.public.iframe' extension.\");\n\n\treturn Messenger.openConference({ code });\n};\n\nlegacyMessenger.openVideoconfByUrl = function(link): boolean {\n\tconsole.warn(\"Developer: method BXIM.openVideoconfByUrl is deprecated. Use method 'Messenger.openConference' from 'im.public' or 'im.public.iframe' extension.\");\n\n\tconst Utils = Reflection.getClass('BX.Messenger.v2.Lib.Utils');\n\tif (Utils && Type.isStringFilled(url) && !Utils.conference.isCurrentPortal(url))\n\t{\n\t\treturn false;\n\t}\n\n\tMessenger.openConference({ link });\n\n\treturn true;\n};\n\nlegacyMessenger.callTo = function(...args): Promise {\n\tconsole.warn(\"Developer: method BXIM.callTo is deprecated. Use method 'Messenger.startVideoCall' from 'im.public' or 'im.public.iframe' extension.\");\n\n\treturn Messenger.startVideoCall(...args);\n};\n\nlegacyMessenger.phoneTo = function(...args): Promise {\n\tconsole.warn(\"Developer: method BXIM.phoneTo is deprecated. Use method 'Messenger.startPhoneCall' from 'im.public' or 'im.public.iframe' extension.\");\n\n\treturn Messenger.startPhoneCall(...args);\n};\n\nlegacyMessenger.startCallList = function(...args): Promise {\n\tconsole.warn(\"Developer: method BXIM.startCallList is deprecated. Use method 'Messenger.startCallList' from 'im.public' or 'im.public.iframe' extension.\");\n\n\treturn Messenger.startCallList(...args);\n};\n\nlegacyMessenger.disk = {\n\tsaveToDiskAction(...args): Promise {\n\t\tconsole.warn(\"Developer: method BXIM.disk.saveToDiskAction is deprecated. Use method 'Messenger.saveFileToDisk' from 'im.public' or 'im.public.iframe' extension.\");\n\n\t\tconst [, params] = args;\n\t\tif (!params || !params.fileId)\n\t\t{\n\t\t\treturn Promise.reject();\n\t\t}\n\n\t\treturn Messenger.saveFileToDisk(params.fileId);\n\t},\n};\n\nlegacyMessenger.messenger = {};\nlegacyMessenger.messenger.popupPopupMenu = false;\nlegacyMessenger.settings = {};\n\nconst legacyDesktop = {\n\tinit: () => {},\n\tenableInVersion: () => false,\n\tgetApiVersion: () => 0,\n\taddCustomEvent: () => {},\n\tonCustomEvent: () => {},\n\tready: () => true,\n\tlog: () => {},\n};\n\nexport { legacyMessenger, legacyDesktop };\n","import { Extension, Reflection } from 'main.core';\n\nclass Desktop\n{\n\tconstructor()\n\t{\n\t\tconst settings = Extension.getSettings('im.public');\n\t\tthis.v2enabled = settings.get('v2enabled', false);\n\t}\n\n\tasync openPage(url: string, options: { skipNativeBrowser?: boolean } = {}): Promise\n\t{\n\t\tif (!this.v2enabled)\n\t\t{\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\n\t\tif (DesktopManager.isDesktop())\n\t\t{\n\t\t\treturn Promise.resolve(true);\n\t\t}\n\n\t\tconst targetUrl = new URL(url);\n\t\tif (targetUrl.host !== location.host)\n\t\t{\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\n\t\tconst skipNativeBrowser = Boolean(options.skipNativeBrowser);\n\n\t\tconst isRedirectAllowed = await DesktopManager?.getInstance().checkForOpenBrowserPage();\n\t\tif (isRedirectAllowed)\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().openPage(targetUrl.href, { skipNativeBrowser });\n\t\t}\n\n\t\tif (skipNativeBrowser === true)\n\t\t{\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\n\t\twindow.open(targetUrl.href, '_blank');\n\n\t\treturn Promise.resolve(true);\n\t}\n}\n\nexport const desktop = new Desktop();\n","const SectionNameMap = {\n\tnotify: 'notification',\n};\n\nexport const prepareSettingsSection = (legacySectionName: string): string => {\n\treturn SectionNameMap[legacySectionName] ?? '';\n};\n","import { Type, Extension, Reflection, type JsonObject } from 'main.core';\n\nimport { DesktopApi } from 'im.v2.lib.desktop-api';\n\nimport { legacyMessenger, legacyDesktop } from './legacy';\nimport { desktop } from './desktop';\nimport { prepareSettingsSection } from './functions/settings';\n\nimport type { ForwardedEntityConfig } from 'im.v2.provider.service.sending';\nimport type { NavigationMenuItemParams } from 'im.v2.lib.navigation';\nimport type { CreatableChatType, OpenChatCreationParams } from 'im.v2.component.content.chat-forms.forms';\nimport type { ChatEmbeddedApplicationType, ChatEmbeddedApplicationInstance } from 'im.v2.application.launch';\n\ntype Opener = {\n\topenChat: (dialogId?: string, text?: string) => Promise,\n\topenNavigationItem: (menuItem: NavigationMenuItemParams) => Promise,\n\topenChatWithBotContext: (dialogId: string, context: JsonObject) => Promise,\n\tforwardEntityToChat: (dialogId: string, entityConfig: ForwardedEntityConfig) => Promise,\n\topenLines: (dialogId?: string) => Promise,\n\topenCopilot: (dialogId?: string) => Promise,\n\topenCollab: (dialogId?: string) => Promise,\n\topenChannel: (dialogId?: string) => Promise,\n\topenTaskComments: (dialogId?: string) => Promise,\n\topenLinesHistory: (dialogId?: string) => Promise,\n\topenNotifications: () => Promise,\n\topenRecentSearch: () => Promise,\n\topenSettings: ({ onlyPanel?: string }) => Promise,\n\topenConference: ({ code?: string, link?: string }) => Promise,\n\topenChatCreation: (chatType: CreatableChatType) => Promise,\n\tstartVideoCall: (dialogId?: string, withVideo?: boolean) => Promise,\n\tstartPhoneCall: (number: string, params: JsonObject) => Promise,\n\tstartCallList: (callListId: number, params: JsonObject) => Promise,\n\tenableDesktopRedirect: () => void,\n\tdisableDesktopRedirect: () => void,\n\tisChatOpened: (dialogId: string) => boolean,\n};\n\nclass Messenger\n{\n\tv2enabled: boolean = false;\n\n\tconstructor()\n\t{\n\t\tconst settings = Extension.getSettings('im.public');\n\t\tthis.v2enabled = settings.get('v2enabled', false);\n\t\tthis.desktop = desktop;\n\t}\n\n\tasync openChat(dialogId: string = '', messageId: number = 0): Promise\n\t{\n\t\tif (!this.v2enabled)\n\t\t{\n\t\t\twindow.BXIM.openMessenger(dialogId);\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tconst isRedirectAllowed = await DesktopManager?.getInstance().checkForRedirect();\n\t\tif (isRedirectAllowed)\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().redirectToChat(dialogId, messageId);\n\t\t}\n\n\t\treturn getOpener()?.openChat(dialogId, messageId);\n\t}\n\n\tasync openChatWithBotContext(dialogId: string = '', context: JsonObject = {}): Promise\n\t{\n\t\tif (!this.v2enabled)\n\t\t{\n\t\t\twindow.BXIM.openMessenger(dialogId);\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tconst isRedirectAllowed = await DesktopManager?.getInstance().checkForRedirect();\n\t\tif (isRedirectAllowed)\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().redirectToChatWithBotContext(dialogId, context);\n\t\t}\n\n\t\treturn getOpener()?.openChatWithBotContext(dialogId, context);\n\t}\n\n\tasync forwardEntityToChat(dialogId: string, entityConfig: ForwardedEntityConfig): Promise\n\t{\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tconst isRedirectAllowed = await DesktopManager?.getInstance().checkForRedirect();\n\t\tif (isRedirectAllowed)\n\t\t{\n\t\t\t// return DesktopManager?.getInstance().redirectToEntityForward(dialogId, messageId);\n\t\t}\n\n\t\treturn getOpener()?.forwardEntityToChat(dialogId, entityConfig);\n\t}\n\n\tasync openLines(dialogId: string = ''): Promise\n\t{\n\t\tif (!this.v2enabled)\n\t\t{\n\t\t\tconst preparedDialogId = dialogId === '' ? 0 : dialogId;\n\t\t\twindow.BXIM.openMessenger(preparedDialogId, 'im-ol');\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tconst isRedirectAllowed = await DesktopManager?.getInstance().checkForRedirect();\n\t\tif (isRedirectAllowed)\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().redirectToLines(dialogId);\n\t\t}\n\n\t\treturn getOpener()?.openLines(dialogId);\n\t}\n\n\tasync openCopilot(dialogId: string = '', contextId: number = 0): Promise\n\t{\n\t\tif (!this.v2enabled)\n\t\t{\n\t\t\twindow.BXIM.openMessenger(dialogId);\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tconst isRedirectAllowed = await DesktopManager?.getInstance().checkForRedirect();\n\t\tif (isRedirectAllowed)\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().redirectToCopilot(dialogId);\n\t\t}\n\n\t\treturn getOpener()?.openCopilot(dialogId, contextId);\n\t}\n\n\tasync openCollab(dialogId: string = ''): Promise\n\t{\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tconst isRedirectAllowed = await DesktopManager?.getInstance().checkForRedirect();\n\t\tif (isRedirectAllowed)\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().redirectToCollab(dialogId);\n\t\t}\n\n\t\treturn getOpener()?.openCollab(dialogId);\n\t}\n\n\tasync openChannel(dialogId: string = ''): Promise\n\t{\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tconst isRedirectAllowed = await DesktopManager?.getInstance().checkForRedirect();\n\t\tif (isRedirectAllowed)\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().redirectToChannel(dialogId);\n\t\t}\n\n\t\treturn getOpener()?.openChannel(dialogId);\n\t}\n\n\tasync openTaskComments(dialogId: string = '', messageId: number = 0): Promise\n\t{\n\t\tconst FeatureManager = Reflection.getClass('BX.Messenger.v2.Lib.FeatureManager');\n\t\tconst Feature = Reflection.getClass('BX.Messenger.v2.Lib.Feature');\n\t\tif (!FeatureManager?.isFeatureAvailable(Feature.isTasksRecentListAvailable))\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tconst isRedirectAllowed = await DesktopManager?.getInstance().checkForRedirect();\n\t\tif (isRedirectAllowed)\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().redirectToTaskComments(dialogId, messageId);\n\t\t}\n\n\t\treturn getOpener()?.openTaskComments(dialogId, messageId);\n\t}\n\n\tasync openLinesHistory(dialogId: string = ''): Promise\n\t{\n\t\tif (!this.v2enabled)\n\t\t{\n\t\t\twindow.BXIM.openHistory(dialogId);\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn getOpener()?.openHistory(dialogId);\n\t}\n\n\tasync openNotifications(): Promise\n\t{\n\t\tif (!this.v2enabled)\n\t\t{\n\t\t\twindow.BXIM.openNotify();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tconst isRedirectAllowed = await DesktopManager?.getInstance().checkForRedirect();\n\t\tif (isRedirectAllowed)\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().redirectToNotifications();\n\t\t}\n\n\t\treturn getOpener()?.openNotifications();\n\t}\n\n\tasync openRecentSearch(): Promise\n\t{\n\t\tif (!this.v2enabled)\n\t\t{\n\t\t\twindow.BXIM.openMessenger();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tconst isRedirectAllowed = await DesktopManager?.getInstance().checkForRedirect();\n\t\tif (isRedirectAllowed)\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().redirectToRecentSearch();\n\t\t}\n\n\t\treturn getOpener()?.openRecentSearch();\n\t}\n\n\tasync openSettings(options: { onlyPanel?: string } = {}): Promise\n\t{\n\t\tif (!this.v2enabled)\n\t\t{\n\t\t\tconst params = {};\n\t\t\tif (Type.isPlainObject(options))\n\t\t\t{\n\t\t\t\tif (Type.isStringFilled(options.selected))\n\t\t\t\t{\n\t\t\t\t\tparams.active = options.selected;\n\t\t\t\t}\n\n\t\t\t\tif (Type.isStringFilled(options.section))\n\t\t\t\t{\n\t\t\t\t\tparams.onlyPanel = options.section;\n\t\t\t\t}\n\t\t\t}\n\t\t\twindow.BXIM.openSettings(params);\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tconst isRedirectAllowed = await DesktopManager?.getInstance().checkForRedirect();\n\t\tif (isRedirectAllowed)\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().redirectToSettings(options.onlyPanel ?? '');\n\t\t}\n\n\t\tconst settingsSection = prepareSettingsSection(options.onlyPanel ?? '');\n\n\t\treturn getOpener()?.openSettings(settingsSection);\n\t}\n\n\tasync openConference(options: { code?: string, link?: string } = {}): Promise\n\t{\n\t\tif (!this.v2enabled)\n\t\t{\n\t\t\tif (Type.isPlainObject(options))\n\t\t\t{\n\t\t\t\tif (Type.isStringFilled(options.code))\n\t\t\t\t{\n\t\t\t\t\twindow.BXIM.openVideoconf(options.code);\n\t\t\t\t}\n\n\t\t\t\tif (Type.isStringFilled(options.link))\n\t\t\t\t{\n\t\t\t\t\twindow.BXIM.openVideoconfByUrl(options.link);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst Utils = Reflection.getClass('BX.Messenger.v2.Lib.Utils');\n\t\tif (Type.isStringFilled(options.url) && !Utils.conference.isCurrentPortal(options.url))\n\t\t{\n\t\t\tUtils.browser.openLink(options.url);\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst code = Utils.conference.getCodeByOptions(options);\n\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tif (DesktopManager?.isDesktop())\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().openConference(code);\n\t\t}\n\t\tconst isRedirectAllowed = await DesktopManager?.getInstance().checkForRedirect();\n\t\tif (isRedirectAllowed)\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().redirectToConference(code);\n\t\t}\n\n\t\treturn getOpener()?.openConference(code);\n\t}\n\n\tasync openChatCreation(\n\t\tchatType: CreatableChatType,\n\t\tparams: OpenChatCreationParams = {},\n\t): Promise\n\t{\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tconst isRedirectAllowed = await DesktopManager?.getInstance().checkForRedirect();\n\t\tif (isRedirectAllowed)\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().redirectToChatCreation(chatType);\n\t\t}\n\n\t\treturn getOpener()?.openChatCreation(chatType, params);\n\t}\n\n\tasync startVideoCall(dialogId: string = '', withVideo: boolean = true): Promise\n\t{\n\t\tif (!this.v2enabled)\n\t\t{\n\t\t\twindow.BXIM.callTo(dialogId, withVideo);\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tconst isRedirectAllowed = await DesktopManager?.getInstance().checkForRedirect();\n\t\tif (isRedirectAllowed)\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().redirectToVideoCall(dialogId, withVideo);\n\t\t}\n\n\t\treturn getOpener()?.startVideoCall(dialogId, withVideo);\n\t}\n\n\tasync startPhoneCall(number: string, params: JsonObject): Promise\n\t{\n\t\tif (!this.v2enabled)\n\t\t{\n\t\t\twindow.BXIM.phoneTo(number, params);\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tconst desktopIsActive = await DesktopManager?.getInstance().checkStatusInDifferentContext();\n\t\tif (desktopIsActive && !DesktopApi.isAirDesignEnabledInDesktop())\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().redirectToPhoneCall(number, params);\n\t\t}\n\n\t\treturn getOpener()?.startPhoneCall(number, params);\n\t}\n\n\tasync startCallList(callListId: number, params: JsonObject): Promise\n\t{\n\t\tif (!this.v2enabled)\n\t\t{\n\t\t\twindow.BXIM.startCallList(callListId, params);\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tconst desktopIsActive = await DesktopManager?.getInstance().checkStatusInDifferentContext();\n\t\tif (desktopIsActive && !DesktopApi.isAirDesignEnabledInDesktop())\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().redirectToCallList(callListId, params);\n\t\t}\n\n\t\treturn getOpener()?.startCallList(callListId, params);\n\t}\n\n\tenableDesktopRedirect()\n\t{\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tDesktopManager?.getInstance().enableRedirect();\n\t}\n\n\tdisableDesktopRedirect()\n\t{\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tDesktopManager?.getInstance().disableRedirect();\n\t}\n\n\tsetWebRTCDebug(debug: boolean = false)\n\t{\n\t\tif (!this.v2enabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst PhoneManager = Reflection.getClass('BX.Messenger.v2.Lib.PhoneManager');\n\t\tPhoneManager?.getInstance().toggleDebugFlag(debug);\n\n\t\tconst CallManager = Reflection.getClass('BX.Messenger.v2.Lib.CallManager');\n\t\tCallManager?.getInstance().toggleDebugFlag(debug);\n\t}\n\n\tasync saveFileToDisk(fileId: number | string): Promise<void>\n\t{\n\t\tconst { DiskService } = Reflection.getClass('BX.Messenger.v2.Service');\n\t\tif (!DiskService)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tawait (new DiskService()).save([fileId]).catch((error) => {\n\t\t\tconsole.error('Messenger.saveFileToDisk error:', error);\n\t\t});\n\n\t\tconst Notifier = Reflection.getClass('BX.Messenger.v2.Lib.Notifier');\n\t\tNotifier?.file.onDiskSaveComplete();\n\t}\n\n\tasync openNavigationItem({ id, entityId, target }: NavigationMenuItemParams): Promise<void>\n\t{\n\t\tconst DesktopManager = Reflection.getClass('BX.Messenger.v2.Lib.DesktopManager');\n\t\tconst LayoutManager = Reflection.getClass('BX.Messenger.v2.Lib.LayoutManager');\n\n\t\tconst isRedirectAllowed = await DesktopManager?.getInstance().checkForRedirect();\n\t\tconst isLayout = LayoutManager?.getInstance().isValidLayout(id);\n\t\tif (isRedirectAllowed && isLayout)\n\t\t{\n\t\t\treturn DesktopManager?.getInstance().redirectToLayout({ id, entityId });\n\t\t}\n\n\t\treturn getOpener()?.openNavigationItem({ id, entityId, target });\n\t}\n\n\tisEmbeddedMode(): boolean\n\t{\n\t\tconst LayoutManager = Reflection.getClass('BX.Messenger.v2.Lib.LayoutManager');\n\t\tif (!LayoutManager)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn LayoutManager.getInstance().isEmbeddedMode();\n\t}\n\n\tisMessengerSliderOpened(): boolean\n\t{\n\t\tconst MessengerSlider = Reflection.getClass('BX.Messenger.v2.Lib.MessengerSlider');\n\t\tif (!MessengerSlider)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn MessengerSlider.getInstance().isOpened();\n\t}\n\n\tisChatOpened(dialogId: string): boolean\n\t{\n\t\treturn getOpener()?.isChatOpened(dialogId);\n\t}\n\n\tasync initApplication(\n\t\tapplicationName: ChatEmbeddedApplicationType,\n\t\tconfig: JsonObject = {},\n\t): Promise<ChatEmbeddedApplicationInstance>\n\t{\n\t\tconst launch = Reflection.getClass('BX.Messenger.v2.Application.Launch');\n\t\tif (!launch)\n\t\t{\n\t\t\treturn Promise.reject();\n\t\t}\n\n\t\treturn launch(applicationName, {\n\t\t\t...config,\n\t\t\tembedded: true,\n\t\t});\n\t}\n}\n\nconst getOpener = (): ?Opener => {\n\treturn Reflection.getClass('BX.Messenger.v2.Lib.Opener');\n};\n\nconst messenger = new Messenger();\nexport { messenger as Messenger };\n\n// pretty export\nconst namespace = Reflection.getClass('BX.Messenger');\nif (namespace)\n{\n\tnamespace.Public = messenger;\n}\n\n// compatibility layer\nif (\n\tmessenger.v2enabled\n\t&& Type.isUndefined(window.BXIM)\n\t&& window.parent === window\n)\n{\n\twindow.BXIM = legacyMessenger;\n}\n\nif (\n\tmessenger.v2enabled\n\t&& Type.isUndefined(window.BX.desktop)\n\t&& Type.isObject(window.BXDesktopSystem)\n\t&& window.parent === window\n)\n{\n\twindow.BX.desktop = legacyDesktop;\n}\n"],"names":["legacyMessenger","openMessenger","args","console","warn","Messenger","openChat","openMessengerSlider","dialogId","openHistory","Opener","Reflection","getClass","openNotify","openNotifications","openSettings","openVideoconf","code","openConference","openVideoconfByUrl","link","Utils","Type","isStringFilled","url","conference","isCurrentPortal","callTo","startVideoCall","phoneTo","startPhoneCall","startCallList","disk","saveToDiskAction","params","fileId","Promise","reject","saveFileToDisk","messenger","popupPopupMenu","settings","legacyDesktop","init","enableInVersion","getApiVersion","addCustomEvent","onCustomEvent","ready","log","Desktop","constructor","Extension","getSettings","v2enabled","get","openPage","options","resolve","DesktopManager","isDesktop","targetUrl","URL","host","location","skipNativeBrowser","Boolean","isRedirectAllowed","getInstance","checkForOpenBrowserPage","href","window","open","desktop","SectionNameMap","notify","prepareSettingsSection","legacySectionName","messageId","BXIM","checkForRedirect","redirectToChat","getOpener","openChatWithBotContext","context","redirectToChatWithBotContext","forwardEntityToChat","entityConfig","openLines","preparedDialogId","redirectToLines","openCopilot","contextId","redirectToCopilot","openCollab","redirectToCollab","openChannel","redirectToChannel","openTaskComments","FeatureManager","Feature","isFeatureAvailable","isTasksRecentListAvailable","redirectToTaskComments","openLinesHistory","redirectToNotifications","openRecentSearch","redirectToRecentSearch","isPlainObject","selected","active","section","onlyPanel","redirectToSettings","settingsSection","browser","openLink","getCodeByOptions","redirectToConference","openChatCreation","chatType","redirectToChatCreation","withVideo","redirectToVideoCall","number","desktopIsActive","checkStatusInDifferentContext","DesktopApi","isAirDesignEnabledInDesktop","redirectToPhoneCall","callListId","redirectToCallList","enableDesktopRedirect","enableRedirect","disableDesktopRedirect","disableRedirect","setWebRTCDebug","debug","PhoneManager","toggleDebugFlag","CallManager","DiskService","save","catch","error","Notifier","file","onDiskSaveComplete","openNavigationItem","id","entityId","target","LayoutManager","isLayout","isValidLayout","redirectToLayout","isEmbeddedMode","isMessengerSliderOpened","MessengerSlider","isOpened","isChatOpened","initApplication","applicationName","config","launch","embedded","namespace","Public","isUndefined","parent","BX","isObject","BXDesktopSystem"],"mappings":"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"}