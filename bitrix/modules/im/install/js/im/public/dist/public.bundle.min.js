this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};(function(e,n,t){"use strict";const s={};s.openMessenger=function(...e){console.warn("Developer: method BXIM.openMessenger is deprecated. Use method 'Messenger.openChat' from 'im.public' or 'im.public.iframe' extension.");return u.openChat(...e)};s.openMessengerSlider=function(e){console.warn("Developer: method BXIM.openMessengerSlider is deprecated. Use method 'Messenger.openChat' from 'im.public' or 'im.public.iframe' extension.");return u.openChat(e)};s.openHistory=function(...e){console.warn("Developer: method BXIM.openHistory is deprecated. Use method 'Messenger.openChat' from 'im.public' or 'im.public.iframe' extension.");const n=t.Reflection.getClass("BX.Messenger.v2.Lib.Opener");return n==null?void 0:n.openHistory(...e)};s.openNotify=function(...e){console.warn("Developer: method BXIM.openNotify is deprecated. Use method 'Messenger.openNotifications' from 'im.public' or 'im.public.iframe' extension.");return u.openNotifications(...e)};s.openSettings=function(...e){console.warn("Developer: method BXIM.openSettings is deprecated. Use method 'Messenger.openSettings' from 'im.public' or 'im.public.iframe' extension.");return u.openSettings(...e)};s.openVideoconf=function(e){console.warn("Developer: method BXIM.openVideoconf is deprecated. Use method 'Messenger.openConference' from 'im.public' or 'im.public.iframe' extension.");return u.openConference({code:e})};s.openVideoconfByUrl=function(e){console.warn("Developer: method BXIM.openVideoconfByUrl is deprecated. Use method 'Messenger.openConference' from 'im.public' or 'im.public.iframe' extension.");const n=t.Reflection.getClass("BX.Messenger.v2.Lib.Utils");if(n&&t.Type.isStringFilled(url)&&!n.conference.isCurrentPortal(url)){return false}u.openConference({link:e});return true};s.callTo=function(...e){console.warn("Developer: method BXIM.callTo is deprecated. Use method 'Messenger.startVideoCall' from 'im.public' or 'im.public.iframe' extension.");return u.startVideoCall(...e)};s.phoneTo=function(...e){console.warn("Developer: method BXIM.phoneTo is deprecated. Use method 'Messenger.startPhoneCall' from 'im.public' or 'im.public.iframe' extension.");return u.startPhoneCall(...e)};s.startCallList=function(...e){console.warn("Developer: method BXIM.startCallList is deprecated. Use method 'Messenger.startCallList' from 'im.public' or 'im.public.iframe' extension.");return u.startCallList(...e)};s.disk={saveToDiskAction(...e){console.warn("Developer: method BXIM.disk.saveToDiskAction is deprecated. Use method 'Messenger.saveFileToDisk' from 'im.public' or 'im.public.iframe' extension.");const[,n]=e;if(!n||!n.fileId){return Promise.reject()}return u.saveFileToDisk(n.fileId)}};s.messenger={};s.messenger.popupPopupMenu=false;s.settings={};const o={init:()=>{},enableInVersion:()=>false,getApiVersion:()=>0,addCustomEvent:()=>{},onCustomEvent:()=>{},ready:()=>true,log:()=>{}};class i{constructor(){const e=t.Extension.getSettings("im.public");this.v2enabled=e.get("v2enabled",false)}async openPage(e,n={}){if(!this.v2enabled){return Promise.resolve(false)}const s=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");if(s.isDesktop()){return Promise.resolve(true)}const o=new URL(e);if(o.host!==location.host){return Promise.resolve(false)}const i=Boolean(n.skipNativeBrowser);const r=await(s==null?void 0:s.getInstance().checkForOpenBrowserPage());if(r){return s==null?void 0:s.getInstance().openPage(o.href,{skipNativeBrowser:i})}if(i===true){return Promise.resolve(false)}window.open(o.href,"_blank");return Promise.resolve(true)}}const r=new i;const l={notify:"notification"};const a=e=>{var n;return(n=l[e])!=null?n:""};class c{constructor(){this.v2enabled=false;const e=t.Extension.getSettings("im.public");this.v2enabled=e.get("v2enabled",false);this.desktop=r}async openChat(e="",n=0){var s;if(!this.v2enabled){window.BXIM.openMessenger(e);return Promise.resolve()}const o=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const i=await(o==null?void 0:o.getInstance().checkForRedirect());if(i){return o==null?void 0:o.getInstance().redirectToChat(e,n)}return(s=d())==null?void 0:s.openChat(e,n)}async openChatWithBotContext(e="",n={}){var s;if(!this.v2enabled){window.BXIM.openMessenger(e);return Promise.resolve()}const o=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const i=await(o==null?void 0:o.getInstance().checkForRedirect());if(i){return o==null?void 0:o.getInstance().redirectToChatWithBotContext(e,n)}return(s=d())==null?void 0:s.openChatWithBotContext(e,n)}async forwardEntityToChat(e,n){var s;const o=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const i=await(o==null?void 0:o.getInstance().checkForRedirect());return(s=d())==null?void 0:s.forwardEntityToChat(e,n)}async openLines(e=""){var n;if(!this.v2enabled){const n=e===""?0:e;window.BXIM.openMessenger(n,"im-ol");return Promise.resolve()}const s=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const o=await(s==null?void 0:s.getInstance().checkForRedirect());if(o){return s==null?void 0:s.getInstance().redirectToLines(e)}return(n=d())==null?void 0:n.openLines(e)}async openCopilot(e="",n=0){var s;if(!this.v2enabled){window.BXIM.openMessenger(e);return Promise.resolve()}const o=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const i=await(o==null?void 0:o.getInstance().checkForRedirect());if(i){return o==null?void 0:o.getInstance().redirectToCopilot(e)}return(s=d())==null?void 0:s.openCopilot(e,n)}async openCollab(e=""){var n;const s=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const o=await(s==null?void 0:s.getInstance().checkForRedirect());if(o){return s==null?void 0:s.getInstance().redirectToCollab(e)}return(n=d())==null?void 0:n.openCollab(e)}async openChannel(e=""){var n;const s=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const o=await(s==null?void 0:s.getInstance().checkForRedirect());if(o){return s==null?void 0:s.getInstance().redirectToChannel(e)}return(n=d())==null?void 0:n.openChannel(e)}async openTaskComments(e="",n=0){var s;const o=t.Reflection.getClass("BX.Messenger.v2.Lib.FeatureManager");const i=t.Reflection.getClass("BX.Messenger.v2.Lib.Feature");if(!(o!=null&&o.isFeatureAvailable(i.isTasksRecentListAvailable))){return Promise.resolve()}const r=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const l=await(r==null?void 0:r.getInstance().checkForRedirect());if(l){return r==null?void 0:r.getInstance().redirectToTaskComments(e,n)}return(s=d())==null?void 0:s.openTaskComments(e,n)}async openLinesHistory(e=""){var n;if(!this.v2enabled){window.BXIM.openHistory(e);return Promise.resolve()}return(n=d())==null?void 0:n.openHistory(e)}async openNotifications(){var e;if(!this.v2enabled){window.BXIM.openNotify();return Promise.resolve()}const n=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const s=await(n==null?void 0:n.getInstance().checkForRedirect());if(s){return n==null?void 0:n.getInstance().redirectToNotifications()}return(e=d())==null?void 0:e.openNotifications()}async openRecentSearch(){var e;if(!this.v2enabled){window.BXIM.openMessenger();return Promise.resolve()}const n=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const s=await(n==null?void 0:n.getInstance().checkForRedirect());if(s){return n==null?void 0:n.getInstance().redirectToRecentSearch()}return(e=d())==null?void 0:e.openRecentSearch()}async openSettings(e={}){var n,s;if(!this.v2enabled){const n={};if(t.Type.isPlainObject(e)){if(t.Type.isStringFilled(e.selected)){n.active=e.selected}if(t.Type.isStringFilled(e.section)){n.onlyPanel=e.section}}window.BXIM.openSettings(n);return Promise.resolve()}const o=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const i=await(o==null?void 0:o.getInstance().checkForRedirect());if(i){var r;return o==null?void 0:o.getInstance().redirectToSettings((r=e.onlyPanel)!=null?r:"")}const l=a((n=e.onlyPanel)!=null?n:"");return(s=d())==null?void 0:s.openSettings(l)}async openConference(e={}){var n;if(!this.v2enabled){if(t.Type.isPlainObject(e)){if(t.Type.isStringFilled(e.code)){window.BXIM.openVideoconf(e.code)}if(t.Type.isStringFilled(e.link)){window.BXIM.openVideoconfByUrl(e.link)}}return Promise.resolve()}const s=t.Reflection.getClass("BX.Messenger.v2.Lib.Utils");if(t.Type.isStringFilled(e.url)&&!s.conference.isCurrentPortal(e.url)){s.browser.openLink(e.url);return Promise.resolve()}const o=s.conference.getCodeByOptions(e);const i=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");if(i!=null&&i.isDesktop()){return i==null?void 0:i.getInstance().openConference(o)}const r=await(i==null?void 0:i.getInstance().checkForRedirect());if(r){return i==null?void 0:i.getInstance().redirectToConference(o)}return(n=d())==null?void 0:n.openConference(o)}async openChatCreation(e,n={}){var s;const o=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const i=await(o==null?void 0:o.getInstance().checkForRedirect());if(i){return o==null?void 0:o.getInstance().redirectToChatCreation(e)}return(s=d())==null?void 0:s.openChatCreation(e,n)}async startVideoCall(e="",n=true){var s;if(!this.v2enabled){window.BXIM.callTo(e,n);return Promise.resolve()}const o=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const i=await(o==null?void 0:o.getInstance().checkForRedirect());if(i){return o==null?void 0:o.getInstance().redirectToVideoCall(e,n)}return(s=d())==null?void 0:s.startVideoCall(e,n)}async startPhoneCall(e,s){var o;if(!this.v2enabled){window.BXIM.phoneTo(e,s);return Promise.resolve()}const i=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const r=await(i==null?void 0:i.getInstance().checkStatusInDifferentContext());if(r&&!n.DesktopApi.isAirDesignEnabledInDesktop()){return i==null?void 0:i.getInstance().redirectToPhoneCall(e,s)}return(o=d())==null?void 0:o.startPhoneCall(e,s)}async startCallList(e,s){var o;if(!this.v2enabled){window.BXIM.startCallList(e,s);return Promise.resolve()}const i=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const r=await(i==null?void 0:i.getInstance().checkStatusInDifferentContext());if(r&&!n.DesktopApi.isAirDesignEnabledInDesktop()){return i==null?void 0:i.getInstance().redirectToCallList(e,s)}return(o=d())==null?void 0:o.startCallList(e,s)}enableDesktopRedirect(){const e=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");e==null?void 0:e.getInstance().enableRedirect()}disableDesktopRedirect(){const e=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");e==null?void 0:e.getInstance().disableRedirect()}setWebRTCDebug(e=false){if(!this.v2enabled){return}const n=t.Reflection.getClass("BX.Messenger.v2.Lib.PhoneManager");n==null?void 0:n.getInstance().toggleDebugFlag(e);const s=t.Reflection.getClass("BX.Messenger.v2.Lib.CallManager");s==null?void 0:s.getInstance().toggleDebugFlag(e)}async saveFileToDisk(e){const{DiskService:n}=t.Reflection.getClass("BX.Messenger.v2.Service");if(!n){return}await(new n).save([e]).catch((e=>{console.error("Messenger.saveFileToDisk error:",e)}));const s=t.Reflection.getClass("BX.Messenger.v2.Lib.Notifier");s==null?void 0:s.file.onDiskSaveComplete()}async openNavigationItem({id:e,entityId:n,target:s}){var o;const i=t.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const r=t.Reflection.getClass("BX.Messenger.v2.Lib.LayoutManager");const l=await(i==null?void 0:i.getInstance().checkForRedirect());const a=r==null?void 0:r.getInstance().isValidLayout(e);if(l&&a){return i==null?void 0:i.getInstance().redirectToLayout({id:e,entityId:n})}return(o=d())==null?void 0:o.openNavigationItem({id:e,entityId:n,target:s})}isEmbeddedMode(){const e=t.Reflection.getClass("BX.Messenger.v2.Lib.LayoutManager");if(!e){return false}return e.getInstance().isEmbeddedMode()}isMessengerSliderOpened(){const e=t.Reflection.getClass("BX.Messenger.v2.Lib.MessengerSlider");if(!e){return false}return e.getInstance().isOpened()}isChatOpened(e){var n;return(n=d())==null?void 0:n.isChatOpened(e)}async initApplication(e,n={}){const s=t.Reflection.getClass("BX.Messenger.v2.Application.Launch");if(!s){return Promise.reject()}return s(e,{...n,embedded:true})}}const d=()=>t.Reflection.getClass("BX.Messenger.v2.Lib.Opener");const u=new c;const g=t.Reflection.getClass("BX.Messenger");if(g){g.Public=u}if(u.v2enabled&&t.Type.isUndefined(window.BXIM)&&window.parent===window){window.BXIM=s}if(u.v2enabled&&t.Type.isUndefined(window.BX.desktop)&&t.Type.isObject(window.BXDesktopSystem)&&window.parent===window){window.BX.desktop=o}e.Messenger=u})(this.BX.Messenger.v2.Lib=this.BX.Messenger.v2.Lib||{},BX.Messenger.v2.Lib,BX);
//# sourceMappingURL=public.bundle.map.js