this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};(function(e,s,a,t,r,l,i,o,d,c,n,b,h,v,p,u,g,L,P,F,H,m){"use strict";var C=babelHelpers.classPrivateFieldLooseKey("store");var B=babelHelpers.classPrivateFieldLooseKey("updateModels");class y{constructor(){Object.defineProperty(this,B,{value:f});Object.defineProperty(this,C,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,C)[C]=L.Core.getStore()}async deleteChat(e){P.Logger.warn(`ChatService: deleteChat, dialogId: ${e}`);const s=await H.runAction(F.RestMethod.imV2ChatDelete,{data:{dialogId:e}}).catch((([e])=>{console.error("ChatService: deleteChat error:",e);p.Notifier.chat.onDeleteError()}));await babelHelpers.classPrivateFieldLooseBase(this,B)[B](e);return s}async deleteCollab(e){P.Logger.warn(`ChatService: deleteCollab, dialogId: ${e}`);try{await H.runAction(F.RestMethod.socialnetworkCollabDelete,{data:{dialogId:e}});await babelHelpers.classPrivateFieldLooseBase(this,B)[B](e);return Promise.resolve()}catch(e){const[s]=e;console.error("ChatService: deleteCollab error:",s);p.Notifier.collab.handleDeleteError(s);return Promise.resolve()}}}function f(e){void babelHelpers.classPrivateFieldLooseBase(this,C)[C].dispatch("chats/update",{dialogId:e,fields:{inited:false}});void babelHelpers.classPrivateFieldLooseBase(this,C)[C].dispatch("recent/delete",{id:e});const s=babelHelpers.classPrivateFieldLooseBase(this,C)[C].getters["chats/get"](e,true);void babelHelpers.classPrivateFieldLooseBase(this,C)[C].dispatch("messages/clearChatCollection",{chatId:s.chatId})}var M=babelHelpers.classPrivateFieldLooseKey("restResult");class I{constructor(e){Object.defineProperty(this,M,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,M)[M]=e}getChatId(){return babelHelpers.classPrivateFieldLooseBase(this,M)[M].chat.id}getDialogId(){return babelHelpers.classPrivateFieldLooseBase(this,M)[M].chat.dialogId}isOpenlinesChat(){return babelHelpers.classPrivateFieldLooseBase(this,M)[M].chat.type===F.ChatType.lines}isCopilotChat(){return babelHelpers.classPrivateFieldLooseBase(this,M)[M].chat.type===F.ChatType.copilot}isCollabChat(){return babelHelpers.classPrivateFieldLooseBase(this,M)[M].chat.type===F.ChatType.collab}getChats(){const e={...babelHelpers.classPrivateFieldLooseBase(this,M)[M].chat,hasPrevPage:babelHelpers.classPrivateFieldLooseBase(this,M)[M].hasPrevPage,hasNextPage:babelHelpers.classPrivateFieldLooseBase(this,M)[M].hasNextPage,tariffRestrictions:babelHelpers.classPrivateFieldLooseBase(this,M)[M].tariffRestrictions};const s={[babelHelpers.classPrivateFieldLooseBase(this,M)[M].chat.dialogId]:e};babelHelpers.classPrivateFieldLooseBase(this,M)[M].users.forEach((e=>{if(s[e.id]){s[e.id]={...s[e.id],...i.UserManager.getDialogForUser(e)}}else{s[e.id]=i.UserManager.getDialogForUser(e)}}));return Object.values(s)}getFiles(){var e;return(e=babelHelpers.classPrivateFieldLooseBase(this,M)[M].files)!=null?e:[]}getUsers(){var e;return(e=babelHelpers.classPrivateFieldLooseBase(this,M)[M].users)!=null?e:[]}getAdditionalUsers(){var e;return(e=babelHelpers.classPrivateFieldLooseBase(this,M)[M].usersShort)!=null?e:[]}getMessages(){var e;return(e=babelHelpers.classPrivateFieldLooseBase(this,M)[M].messages)!=null?e:[]}getCommentInfo(){var e;return(e=babelHelpers.classPrivateFieldLooseBase(this,M)[M].commentInfo)!=null?e:[]}getCollabInfo(){var e;return(e=babelHelpers.classPrivateFieldLooseBase(this,M)[M].collabInfo)!=null?e:null}getMessagesToStore(){var e;return(e=babelHelpers.classPrivateFieldLooseBase(this,M)[M].additionalMessages)!=null?e:[]}getPinnedMessageIds(){var e;const s=[];const a=(e=babelHelpers.classPrivateFieldLooseBase(this,M)[M].pins)!=null?e:[];a.forEach((e=>{s.push(e.messageId)}));return s}getReactions(){var e;return(e=babelHelpers.classPrivateFieldLooseBase(this,M)[M].reactions)!=null?e:[]}getCopilot(){return babelHelpers.classPrivateFieldLooseBase(this,M)[M].copilot}getSession(){return babelHelpers.classPrivateFieldLooseBase(this,M)[M].session}getAutoDeleteConfig(){return babelHelpers.classPrivateFieldLooseBase(this,M)[M].messagesAutoDeleteConfigs}}const{callInstalled:w}=g.Extension.getSettings("im.v2.lib.call");var S=babelHelpers.classPrivateFieldLooseKey("store");var U=babelHelpers.classPrivateFieldLooseKey("requestChat");var R=babelHelpers.classPrivateFieldLooseKey("markDialogAsLoading");var D=babelHelpers.classPrivateFieldLooseKey("markDialogAsLoaded");var O=babelHelpers.classPrivateFieldLooseKey("markDialogAsNotLoaded");var j=babelHelpers.classPrivateFieldLooseKey("isDialogLoadedMarkNeeded");var A=babelHelpers.classPrivateFieldLooseKey("updateModels");var K=babelHelpers.classPrivateFieldLooseKey("needLayoutRedirect");var T=babelHelpers.classPrivateFieldLooseKey("redirectToLayout");var k=babelHelpers.classPrivateFieldLooseKey("needRedirectToOpenLinesLayout");var E=babelHelpers.classPrivateFieldLooseKey("checkFeatureDisabled");var V=babelHelpers.classPrivateFieldLooseKey("checkCollabFeatureDisabled");var X=babelHelpers.classPrivateFieldLooseKey("openFeatureSlider");class N{constructor(){Object.defineProperty(this,X,{value:ee});Object.defineProperty(this,V,{value:Z});Object.defineProperty(this,E,{value:G});Object.defineProperty(this,k,{value:J});Object.defineProperty(this,T,{value:Q});Object.defineProperty(this,K,{value:z});Object.defineProperty(this,A,{value:_});Object.defineProperty(this,j,{value:W});Object.defineProperty(this,O,{value:Y});Object.defineProperty(this,D,{value:q});Object.defineProperty(this,R,{value:$});Object.defineProperty(this,U,{value:x});Object.defineProperty(this,S,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,S)[S]=L.Core.getStore()}loadChat(e){const s={dialogId:e};return babelHelpers.classPrivateFieldLooseBase(this,U)[U](F.RestMethod.imV2ChatShallowLoad,s)}loadChatByChatId(e){const s={chatId:e,messageLimit:r.MessageService.getMessageRequestLimit()};return babelHelpers.classPrivateFieldLooseBase(this,U)[U](F.RestMethod.imV2ChatLoad,s)}loadChatWithMessages(e){const s={dialogId:e,messageLimit:r.MessageService.getMessageRequestLimit()};return babelHelpers.classPrivateFieldLooseBase(this,U)[U](F.RestMethod.imV2ChatLoad,s)}loadChatWithContext(e,s){const a={dialogId:e,messageId:s,messageLimit:r.MessageService.getMessageRequestLimit()};return babelHelpers.classPrivateFieldLooseBase(this,U)[U](F.RestMethod.imV2ChatLoadInContext,a)}prepareDialogId(e){if(!v.Utils.dialog.isExternalId(e)){return Promise.resolve(e)}return H.runAction(F.RestMethod.imV2ChatGetDialogId,{data:{externalId:e}}).then((e=>e.dialogId)).catch((e=>{console.error("ChatService: Load: error preparing external id",e)}))}async loadComments(e){const s={postId:e,messageLimit:r.MessageService.getMessageRequestLimit(),autoJoin:true,createIfNotExists:true};const{chatId:a}=await babelHelpers.classPrivateFieldLooseBase(this,U)[U](F.RestMethod.imV2ChatLoad,s);return babelHelpers.classPrivateFieldLooseBase(this,S)[S].dispatch("messages/comments/set",{messageId:e,chatId:a})}async loadCommentInfo(e){const s=babelHelpers.classPrivateFieldLooseBase(this,S)[S].getters["chats/get"](e,true);const a=babelHelpers.classPrivateFieldLooseBase(this,S)[S].getters["messages/getByChatId"](s.chatId);const t=a.map((e=>e.id));const{commentInfo:r,usersShort:l}=await H.runAction(F.RestMethod.imV2ChatMessageCommentInfoList,{data:{messageIds:t}}).catch((e=>{console.error("ChatService: Load: error loading comment info",e)}));const o=new i.UserManager;void babelHelpers.classPrivateFieldLooseBase(this,S)[S].dispatch("messages/comments/set",r);void o.addUsersToModel(l)}clearChat(e){const s=babelHelpers.classPrivateFieldLooseBase(this,S)[S].getters["chats/get"](e,true);babelHelpers.classPrivateFieldLooseBase(this,S)[S].dispatch("messages/clearChatCollection",{chatId:s.chatId});babelHelpers.classPrivateFieldLooseBase(this,S)[S].dispatch("chats/update",{dialogId:e,fields:{inited:false}})}}async function x(e,s){const{dialogId:r,messageId:l}=s;babelHelpers.classPrivateFieldLooseBase(this,R)[R](r);const i=await H.runAction(e,{data:s}).catch((([e])=>{console.error("ChatService: Load: error loading chat",e);p.Notifier.chat.handleLoadError(e);babelHelpers.classPrivateFieldLooseBase(this,O)[O](r);throw e}));if(babelHelpers.classPrivateFieldLooseBase(this,E)[E](i)){await babelHelpers.classPrivateFieldLooseBase(this,O)[O](r);await t.Messenger.openChat();return babelHelpers.classPrivateFieldLooseBase(this,X)[X](i)}if(babelHelpers.classPrivateFieldLooseBase(this,K)[K](i)){return babelHelpers.classPrivateFieldLooseBase(this,T)[T](i,l)}const{dialogId:o,chatId:d}=await babelHelpers.classPrivateFieldLooseBase(this,A)[A](i);const{callInfo:c}=i;if(w){a.CallTokenManager.setToken(c.chatId,c.token)}if(babelHelpers.classPrivateFieldLooseBase(this,j)[j](e)){await babelHelpers.classPrivateFieldLooseBase(this,D)[D](o)}return{dialogId:o,chatId:d}}function $(e){void babelHelpers.classPrivateFieldLooseBase(this,S)[S].dispatch("chats/update",{dialogId:e,fields:{loading:true}})}function q(e){return babelHelpers.classPrivateFieldLooseBase(this,S)[S].dispatch("chats/update",{dialogId:e,fields:{inited:true,loading:false}})}function Y(e){return babelHelpers.classPrivateFieldLooseBase(this,S)[S].dispatch("chats/update",{dialogId:e,fields:{loading:false}})}function W(e){return e!==F.RestMethod.imV2ChatShallowLoad}async function _(e){const a=new I(e);const t=babelHelpers.classPrivateFieldLooseBase(this,S)[S].dispatch("chats/set",a.getChats());const r=babelHelpers.classPrivateFieldLooseBase(this,S)[S].dispatch("files/set",a.getFiles());const o=babelHelpers.classPrivateFieldLooseBase(this,S)[S].dispatch("chats/autoDelete/set",a.getAutoDeleteConfig());const d=new i.UserManager;const c=Promise.all([babelHelpers.classPrivateFieldLooseBase(this,S)[S].dispatch("users/set",a.getUsers()),d.addUsersToModel(a.getAdditionalUsers())]);const n=Promise.all([babelHelpers.classPrivateFieldLooseBase(this,S)[S].dispatch("messages/setChatCollection",{messages:a.getMessages(),clearCollection:true}),babelHelpers.classPrivateFieldLooseBase(this,S)[S].dispatch("messages/store",a.getMessagesToStore()),babelHelpers.classPrivateFieldLooseBase(this,S)[S].dispatch("messages/pin/setPinned",{chatId:a.getChatId(),pinnedMessages:a.getPinnedMessageIds()}),babelHelpers.classPrivateFieldLooseBase(this,S)[S].dispatch("messages/reactions/set",a.getReactions()),babelHelpers.classPrivateFieldLooseBase(this,S)[S].dispatch("messages/comments/set",a.getCommentInfo())]);const b=new l.CopilotManager;const h=b.handleChatLoadResponse(a.getCopilot());let v=Promise.resolve();if(s.OpenLinesManager){v=s.OpenLinesManager.handleChatLoadResponse(a.getSession())}const p=babelHelpers.classPrivateFieldLooseBase(this,S)[S].dispatch("chats/collabs/set",{chatId:a.getChatId(),collabInfo:a.getCollabInfo()});await Promise.all([t,r,c,n,h,v,p,o]);return{dialogId:a.getDialogId(),chatId:a.getChatId()}}function z(e){return babelHelpers.classPrivateFieldLooseBase(this,k)[k](e)}function Q(e){const s=new I(e);u.LayoutManager.getInstance().setLastOpenedElement(F.Layout.chat,"");if(babelHelpers.classPrivateFieldLooseBase(this,k)[k](e)){return t.Messenger.openLines(s.getDialogId())}return Promise.resolve()}function J(e){const s=m.FeatureManager.isFeatureAvailable(m.Feature.openLinesV2);if(s){return false}const a=new I(e);return a.isOpenlinesChat()&&g.Type.isStringFilled(a.getDialogId())}function G(e){return babelHelpers.classPrivateFieldLooseBase(this,V)[V](e)}function Z(e){const s=new I(e);return s.isCollabChat()&&!m.FeatureManager.collab.isAvailable()}function ee(e){if(babelHelpers.classPrivateFieldLooseBase(this,V)[V](e)){m.FeatureManager.collab.openFeatureSlider()}}const se="CHAT";const ae="OPEN";var te=babelHelpers.classPrivateFieldLooseKey("restClient");var re=babelHelpers.classPrivateFieldLooseKey("store");var le=babelHelpers.classPrivateFieldLooseKey("prepareFields");var ie=babelHelpers.classPrivateFieldLooseKey("addCollabToModel");var oe=babelHelpers.classPrivateFieldLooseKey("addChatToModel");var de=babelHelpers.classPrivateFieldLooseKey("sendAnalytics");var ce=babelHelpers.classPrivateFieldLooseKey("prepareType");class ne{constructor(){Object.defineProperty(this,ce,{value:ue});Object.defineProperty(this,de,{value:pe});Object.defineProperty(this,oe,{value:ve});Object.defineProperty(this,ie,{value:he});Object.defineProperty(this,le,{value:be});Object.defineProperty(this,te,{writable:true,value:void 0});Object.defineProperty(this,re,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,te)[te]=L.Core.getRestClient();babelHelpers.classPrivateFieldLooseBase(this,re)[re]=L.Core.getStore()}async createChat(e){P.Logger.warn("ChatService: createChat",e);const s=await babelHelpers.classPrivateFieldLooseBase(this,le)[le](e);const a=await babelHelpers.classPrivateFieldLooseBase(this,te)[te].callMethod(F.RestMethod.imV2ChatAdd,{fields:s}).catch((e=>{console.error("ChatService: createChat error:",e);p.Notifier.chat.onCreateError();throw e}));const{chatId:t}=a.data();P.Logger.warn("ChatService: createChat result",t);const r=`chat${t}`;babelHelpers.classPrivateFieldLooseBase(this,oe)[oe](r,s);babelHelpers.classPrivateFieldLooseBase(this,de)[de](r);return{newDialogId:r,newChatId:t}}async createCollab(e){P.Logger.warn("ChatService: createCollab",e);const s=await babelHelpers.classPrivateFieldLooseBase(this,le)[le](e);const a={ownerId:s.ownerId,name:s.title,description:s.description,avatarId:s.avatar,moderatorMembers:v.Utils.user.prepareSelectorIds(e.moderatorMembers),permissions:e.permissions,options:{...e.options,messagesAutoDeleteDelay:s.messagesAutoDeleteDelay}};const t=await H.runAction(F.RestMethod.socialnetworkCollabCreate,{data:a}).catch((([e])=>{console.error("ChatService: createCollab error:",e);p.Notifier.collab.handleCreateError(e);throw e}));const{chatId:r}=t;P.Logger.warn("ChatService: createCollab result",r);const l=`chat${r}`;babelHelpers.classPrivateFieldLooseBase(this,ie)[ie](l,s);babelHelpers.classPrivateFieldLooseBase(this,de)[de](l);return{newDialogId:l,newChatId:r}}}async function be(e){var s,a,t,r;const l={...e};if(l.type){l.type=babelHelpers.classPrivateFieldLooseBase(this,ce)[ce](l.type)}if(l.entityType){l.entityType=babelHelpers.classPrivateFieldLooseBase(this,ce)[ce](l.entityType)}if(l.avatar){l.avatar=await v.Utils.file.getBase64(e.avatar)}l.managers=(s=l.managers)!=null?s:[];l.members=(a=l.members)!=null?a:[];const i=[...l.members,...l.managers];if(l.ownerId){i.push(l.ownerId)}l.members=[...new Set(i)];const o={type:(t=l.type)==null?void 0:t.toUpperCase(),entityType:(r=l.entityType)==null?void 0:r.toUpperCase(),title:l.title,avatar:l.avatar,description:l.description,users:l.members,memberEntities:l.memberEntities,managers:l.managers,ownerId:l.ownerId,searchable:l.isAvailableInSearch?"Y":"N",manageUsersAdd:l.manageUsersAdd,manageUsersDelete:l.manageUsersDelete,manageUi:l.manageUi,manageSettings:l.manageSettings,manageMessages:l.manageMessages,conferencePassword:l.conferencePassword,copilotMainRole:l.copilotMainRole,messagesAutoDeleteDelay:l.autoDeleteDelay};Object.entries(o).forEach((([e,s])=>{if(g.Type.isUndefined(s)){delete o[e]}}));return o}function he(e,s){babelHelpers.classPrivateFieldLooseBase(this,re)[re].dispatch("chats/set",{dialogId:e,type:F.ChatType.collab,name:s.title})}function ve(e,s){let a=s.searchable==="Y"?ae:se;if(g.Type.isStringFilled(s.entityType)){a=s.entityType.toLowerCase()}if(g.Type.isStringFilled(s.type)){a=s.type.toLowerCase()}babelHelpers.classPrivateFieldLooseBase(this,re)[re].dispatch("chats/set",{dialogId:e,type:a.toLowerCase(),name:s.title,userCounter:s.users.length,role:F.UserRole.owner,permissions:{manageUi:s.manageUi,manageSettings:s.manageSettings,manageUsersAdd:s.manageUsersAdd,manageUsersDelete:s.manageUsersDelete,manageMessages:s.manageMessages}})}function pe(e){o.Analytics.getInstance().ignoreNextChatOpen(e)}function ue(e){return v.Utils.text.convertCamelToSnakeCase(e).toUpperCase()}var ge=babelHelpers.classPrivateFieldLooseKey("store");var Le=babelHelpers.classPrivateFieldLooseKey("prepareFields");var Pe=babelHelpers.classPrivateFieldLooseKey("updateChatInModel");class Fe{constructor(){Object.defineProperty(this,Pe,{value:me});Object.defineProperty(this,Le,{value:He});Object.defineProperty(this,ge,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,ge)[ge]=L.Core.getStore()}async prepareAvatar(e){if(!d.isResizableImage(e)){return Promise.reject(new Error("UpdateService: prepareAvatar: incorrect image"))}const s=180;const{preview:a}=await d.resizeImage(e,{width:s,height:s});return a}async changeAvatar(e,s){P.Logger.warn("ChatService: changeAvatar",e,s);const a=await v.Utils.file.getBase64(s);return H.runAction(F.RestMethod.imV2ChatUpdateAvatar,{data:{id:e,avatar:a}}).catch((([e])=>{console.error("ChatService: changeAvatar error:",e)}))}async updateChat(e,s){P.Logger.warn(`ChatService: updateChat, chatId: ${e}`,s);const a=await babelHelpers.classPrivateFieldLooseBase(this,Le)[Le](s);const t=await H.runAction(F.RestMethod.imV2ChatUpdate,{data:{id:e,fields:a},id:e}).catch((([e])=>{console.error("ChatService: updateChat error:",e);p.Notifier.chat.onUpdateError();throw e}));P.Logger.warn("ChatService: updateChat result",t);const r=`chat${e}`;await babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe](r,s);return t}async updateCollab(e,s){P.Logger.warn(`ChatService: updateCollab, dialogId: ${e}`,s);const a=await babelHelpers.classPrivateFieldLooseBase(this,Le)[Le](s);let t={dialogId:e,name:a.title,description:a.description,avatarId:a.avatar};if(s.groupSettings){const e=s.groupSettings;t={...t,ownerId:e.ownerId,addModeratorMembers:v.Utils.user.prepareSelectorIds(e.addModeratorMembers),deleteModeratorMembers:v.Utils.user.prepareSelectorIds(e.deleteModeratorMembers),permissions:e.permissions,options:e.options}}const r=await H.runAction(F.RestMethod.socialnetworkCollabUpdate,{data:t}).catch((([e])=>{console.error("ChatService: updateCollab error:",e);p.Notifier.collab.handleUpdateError(e);throw e}));P.Logger.warn("ChatService: updateCollab result",r);return r}async getMemberEntities(e){return H.runAction(F.RestMethod.imV2ChatMemberEntitiesList,{data:{chatId:e}}).catch((([e])=>{console.error("ChatService: getMemberEntities error:",e)}))}}async function He(e){const s={title:e.title,description:e.description,ownerId:e.ownerId,searchable:e.isAvailableInSearch?"Y":"N",manageUi:e.manageUi,manageUsersAdd:e.manageUsersAdd,manageUsersDelete:e.manageUsersDelete,manageMessages:e.manageMessages,addedMemberEntities:e.addedMemberEntities,deletedMemberEntities:e.deletedMemberEntities,addedManagers:e.addedManagers,deletedManagers:e.deletedManagers};if(e.avatar){s.avatar=await v.Utils.file.getBase64(e.avatar)}Object.entries(s).forEach((([e,a])=>{if(g.Type.isUndefined(a)){delete s[e]}}));return s}function me(e,s){return babelHelpers.classPrivateFieldLooseBase(this,ge)[ge].dispatch("chats/update",{dialogId:e,fields:{name:s.title,description:s.description,ownerId:s.ownerId,managerList:s.managers,type:s.type,role:c.getChatRoleForUser(s),permissions:{manageUi:s.manageUi,manageUsersAdd:s.manageUsersAdd,manageUsersDelete:s.manageUsersDelete,manageMessages:s.manageMessages}}})}var Ce=babelHelpers.classPrivateFieldLooseKey("store");var Be=babelHelpers.classPrivateFieldLooseKey("restClient");var ye=babelHelpers.classPrivateFieldLooseKey("updateChatTitleInModel");class fe{constructor(){Object.defineProperty(this,ye,{value:Me});Object.defineProperty(this,Ce,{writable:true,value:void 0});Object.defineProperty(this,Be,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]=L.Core.getStore();babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]=L.Core.getRestClient()}renameChat(e,s){P.Logger.warn("ChatService: renameChat",e,s);if(s===""){return Promise.resolve()}const a=babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce].getters["chats/get"](e);const t=a.name;babelHelpers.classPrivateFieldLooseBase(this,ye)[ye](e,s);return babelHelpers.classPrivateFieldLooseBase(this,Be)[Be].callMethod(F.RestMethod.imChatUpdateTitle,{dialog_id:e,title:s}).catch((s=>{babelHelpers.classPrivateFieldLooseBase(this,ye)[ye](e,t);console.error("ChatService: renameChat error",s.error());p.Notifier.chat.onRenameError()}))}}function Me(e,s){babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce].dispatch("chats/update",{dialogId:e,fields:{name:s}})}var Ie=babelHelpers.classPrivateFieldLooseKey("store");var we=babelHelpers.classPrivateFieldLooseKey("restClient");var Se=babelHelpers.classPrivateFieldLooseKey("sendMuteRequestDebounced");var Ue=babelHelpers.classPrivateFieldLooseKey("sendMuteRequest");class Re{constructor(){Object.defineProperty(this,Ue,{value:De});Object.defineProperty(this,Ie,{writable:true,value:void 0});Object.defineProperty(this,we,{writable:true,value:void 0});Object.defineProperty(this,Se,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie]=L.Core.getStore();babelHelpers.classPrivateFieldLooseBase(this,we)[we]=L.Core.getRestClient();const e=500;babelHelpers.classPrivateFieldLooseBase(this,Se)[Se]=g.Runtime.debounce(babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue],e)}muteChat(e){P.Logger.warn("ChatService: muteChat",e);void babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie].dispatch("chats/mute",{dialogId:e});const s={dialog_id:e,action:"Y"};babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](s)}unmuteChat(e){P.Logger.warn("ChatService: unmuteChat",e);void babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie].dispatch("chats/unmute",{dialogId:e});const s={dialog_id:e,action:"N"};babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](s)}}function De(e){const{dialog_id:s,action:a}=e;return babelHelpers.classPrivateFieldLooseBase(this,we)[we].callMethod(F.RestMethod.imChatMute,e).catch((e=>{const t=a==="Y"?"muting":"unmuting";console.error(`Im.RecentList: error ${t} chat`,e.error());const r=a==="Y"?"chats/unmute":"chats/mute";void babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie].dispatch(r,{dialogId:s})}))}var Oe=babelHelpers.classPrivateFieldLooseKey("store");class je{constructor(){Object.defineProperty(this,Oe,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe]=L.Core.getStore()}pinChat(e){P.Logger.warn("PinService: pinChat",e);void babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe].dispatch("recent/pin",{id:e,action:true});H.runAction(F.RestMethod.imV2RecentPin,{data:{dialogId:e}}).catch((([s])=>{console.error("PinService: error pinning chat",s);p.Notifier.recent.handlePinError(s);void babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe].dispatch("recent/pin",{id:e,action:false})}))}unpinChat(e){P.Logger.warn("PinService: unpinChat",e);void babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe].dispatch("recent/pin",{id:e,action:false});H.runAction(F.RestMethod.imV2RecentUnpin,{data:{dialogId:e}}).catch((([s])=>{console.error("PinService: error unpinning chat",s);p.Notifier.recent.onUnpinError();void babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe].dispatch("recent/pin",{id:e,action:true})}))}}const Ae=300;var Ke=babelHelpers.classPrivateFieldLooseKey("store");var Te=babelHelpers.classPrivateFieldLooseKey("restClient");var ke=babelHelpers.classPrivateFieldLooseKey("messagesToRead");var Ee=babelHelpers.classPrivateFieldLooseKey("readMessagesForChat");var Ve=babelHelpers.classPrivateFieldLooseKey("readMessageOnClient");var Xe=babelHelpers.classPrivateFieldLooseKey("decreaseCommentCounter");var Ne=babelHelpers.classPrivateFieldLooseKey("decreaseChatCounter");var xe=babelHelpers.classPrivateFieldLooseKey("readMessageOnServer");var $e=babelHelpers.classPrivateFieldLooseKey("checkChatCounter");var qe=babelHelpers.classPrivateFieldLooseKey("getDialogIdByChatId");var Ye=babelHelpers.classPrivateFieldLooseKey("getDialogByChatId");class We{constructor(){Object.defineProperty(this,Ye,{value:ss});Object.defineProperty(this,qe,{value:es});Object.defineProperty(this,$e,{value:Ze});Object.defineProperty(this,xe,{value:Ge});Object.defineProperty(this,Ne,{value:Je});Object.defineProperty(this,Xe,{value:Qe});Object.defineProperty(this,Ve,{value:ze});Object.defineProperty(this,Ee,{value:_e});Object.defineProperty(this,Ke,{writable:true,value:void 0});Object.defineProperty(this,Te,{writable:true,value:void 0});Object.defineProperty(this,ke,{writable:true,value:{}});babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke]=L.Core.getStore();babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]=L.Core.getRestClient()}readAll(){P.Logger.warn("ReadService: readAll");void babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].dispatch("chats/clearCounters");void babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].dispatch("recent/clearUnread");return babelHelpers.classPrivateFieldLooseBase(this,Te)[Te].callMethod(F.RestMethod.imV2ChatReadAll).catch((e=>{console.error("ReadService: readAll error",e.error())}))}readDialog(e){P.Logger.warn("ReadService: readDialog",e);void babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].dispatch("recent/unread",{id:e,action:false});void babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].dispatch("chats/update",{dialogId:e,fields:{counter:0}});babelHelpers.classPrivateFieldLooseBase(this,Te)[Te].callMethod(F.RestMethod.imV2ChatRead,{dialogId:e}).catch((e=>{console.error("ReadService: error reading chat",e.error())}))}unreadDialog(e){P.Logger.warn("ReadService: unreadDialog",e);void babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].dispatch("recent/unread",{id:e,action:true});babelHelpers.classPrivateFieldLooseBase(this,Te)[Te].callMethod(F.RestMethod.imV2ChatUnread,{dialogId:e}).catch((s=>{console.error("ReadService: error setting chat as unread",s.error());void babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].dispatch("recent/unread",{id:e,action:false})}))}readMessage(e,s){if(!babelHelpers.classPrivateFieldLooseBase(this,ke)[ke][e]){babelHelpers.classPrivateFieldLooseBase(this,ke)[ke][e]=new Set}babelHelpers.classPrivateFieldLooseBase(this,ke)[ke][e].add(s);clearTimeout(this.readTimeout);this.readTimeout=setTimeout((()=>{Object.entries(babelHelpers.classPrivateFieldLooseBase(this,ke)[ke]).forEach((([e,s])=>{void babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee](e,s)}))}),Ae)}async readChatQueuedMessages(e){if(!babelHelpers.classPrivateFieldLooseBase(this,ke)[ke][e]){return}clearTimeout(this.readTimeout);void babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee](e,babelHelpers.classPrivateFieldLooseBase(this,ke)[ke][e])}clearDialogMark(e){P.Logger.warn("ReadService: clear dialog mark",e);const s=babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].getters["chats/get"](e);const a=babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].getters["recent/get"](e);if(s.markedId===0&&!(a!=null&&a.unread)){return}void babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].dispatch("recent/unread",{id:e,action:false});void babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].dispatch("chats/update",{dialogId:e,fields:{markedId:0}});babelHelpers.classPrivateFieldLooseBase(this,Te)[Te].callMethod(F.RestMethod.imV2ChatRead,{dialogId:e,onlyRecent:"Y"}).catch((e=>{console.error("ReadService: error clearing dialog mark",e.error())}))}}async function _e(e,s){const a=Number.parseInt(e,10);P.Logger.warn("ReadService: readMessages",s);if(s.size===0){return true}const t=[...s];delete babelHelpers.classPrivateFieldLooseBase(this,ke)[ke][a];const r=await babelHelpers.classPrivateFieldLooseBase(this,Ve)[Ve](a,t);P.Logger.warn("ReadService: readMessage, need to reduce counter by",r);await babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](a,r);const l=await babelHelpers.classPrivateFieldLooseBase(this,xe)[xe](a,t).catch((([e])=>{console.error("ReadService: error reading message",e)}));babelHelpers.classPrivateFieldLooseBase(this,$e)[$e](l);return true}function ze(e,s){const a=Math.max(...s);const t=babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye](e);if(a>t.lastReadId){void babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].dispatch("chats/update",{dialogId:babelHelpers.classPrivateFieldLooseBase(this,qe)[qe](e),fields:{lastId:a}})}return babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].dispatch("messages/readMessages",{chatId:e,messageIds:s})}function Qe(e,s){const a=babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye](e);let t=a.counter-s;if(t<0){t=0}const r={[a.parentChatId]:{[e]:t}};return L.Core.getStore().dispatch("counters/setCommentCounters",r)}function Je(e,s){const a=babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye](e);if(a.type===F.ChatType.comment){return babelHelpers.classPrivateFieldLooseBase(this,Xe)[Xe](e,s)}let t=a.counter-s;if(t<0){t=0}return babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].dispatch("chats/update",{dialogId:babelHelpers.classPrivateFieldLooseBase(this,qe)[qe](e),fields:{counter:t}})}function Ge(e,s){P.Logger.warn("ReadService: readMessages on server",s);return H.runAction(F.RestMethod.imV2ChatMessageRead,{data:{chatId:e,ids:s,actionUuid:n.UuidManager.getInstance().getActionUuid()}})}function Ze(e){if(!e){return}const{chatId:s,counter:a}=e;const t=babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye](s);if(t.counter>a){P.Logger.warn("ReadService: counter from server is lower than local one",t.counter,a);void babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].dispatch("chats/update",{dialogId:t.dialogId,fields:{counter:a}})}}function es(e){const s=babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].getters["chats/getByChatId"](e);if(!s){return 0}return s.dialogId}function ss(e){return babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke].getters["chats/getByChatId"](e)}var as=babelHelpers.classPrivateFieldLooseKey("store");var ts=babelHelpers.classPrivateFieldLooseKey("restClient");var rs=babelHelpers.classPrivateFieldLooseKey("onChatLeave");class ls{constructor(){Object.defineProperty(this,rs,{value:is});Object.defineProperty(this,as,{writable:true,value:void 0});Object.defineProperty(this,ts,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,as)[as]=L.Core.getStore();babelHelpers.classPrivateFieldLooseBase(this,ts)[ts]=L.Core.getRestClient()}async leaveChat(e){const s={dialogId:e,userId:L.Core.getUserId()};try{await babelHelpers.classPrivateFieldLooseBase(this,ts)[ts].callMethod(F.RestMethod.imV2ChatDeleteUser,s);babelHelpers.classPrivateFieldLooseBase(this,rs)[rs](e)}catch(e){console.error("UserService: leave chat error",e.error());p.Notifier.chat.handleLeaveError(e.error())}}async leaveCollab(e){const s={data:{dialogId:e}};try{await H.runAction(F.RestMethod.socialnetworkMemberLeave,s);babelHelpers.classPrivateFieldLooseBase(this,rs)[rs](e)}catch(e){console.error("UserService: leave collab error",e[0]);p.Notifier.collab.onLeaveError()}}async kickUserFromChat(e,s){const a={dialogId:e,userId:s};await babelHelpers.classPrivateFieldLooseBase(this,ts)[ts].callMethod(F.RestMethod.imV2ChatDeleteUser,a).catch((e=>{console.error("UserService: error kicking from chat",e.error());p.Notifier.chat.handleUserKickError(e.error())}))}async kickUserFromCollab(e,s){const a=v.Utils.user.prepareSelectorIds(s);const t={data:{dialogId:e,members:a}};await H.runAction(F.RestMethod.socialnetworkMemberDelete,t).catch((([e])=>{console.error("UserService: error kicking from collab",e);p.Notifier.collab.onKickUserError()}))}addToChat(e){const s={chat_id:e.chatId,users:e.members,hide_history:!e.showHistory};return babelHelpers.classPrivateFieldLooseBase(this,ts)[ts].callMethod(F.RestMethod.imChatUserAdd,s).catch((e=>{console.error("UserService: error adding to chat",e.error());throw e.error()}))}joinChat(e){P.Logger.warn(`UserService: join chat ${e}`);void babelHelpers.classPrivateFieldLooseBase(this,as)[as].dispatch("chats/update",{dialogId:e,fields:{role:F.UserRole.member}});babelHelpers.classPrivateFieldLooseBase(this,ts)[ts].callMethod(F.RestMethod.imV2ChatJoin,{dialogId:e}).catch((e=>{console.error("UserService: error joining chat",e.error())}))}addManager(e,s){P.Logger.warn(`UserService: add manager ${s} to ${e}`);const{managerList:a}=babelHelpers.classPrivateFieldLooseBase(this,as)[as].getters["chats/get"](e);if(a.includes(s)){return}const t=[...a,s];void babelHelpers.classPrivateFieldLooseBase(this,as)[as].dispatch("chats/update",{dialogId:e,fields:{managerList:t}});const r={data:{dialogId:e,userIds:[s]}};H.runAction(F.RestMethod.imV2ChatAddManagers,r).catch((([e])=>{console.error("UserService: add manager error",e)}))}removeManager(e,s){P.Logger.warn(`UserService: remove manager ${s} from ${e}`);const{managerList:a}=babelHelpers.classPrivateFieldLooseBase(this,as)[as].getters["chats/get"](e);if(!a.includes(s)){return}const t=a.filter((e=>e!==s));void babelHelpers.classPrivateFieldLooseBase(this,as)[as].dispatch("chats/update",{dialogId:e,fields:{managerList:t}});const r={data:{dialogId:e,userIds:[s]}};H.runAction(F.RestMethod.imV2ChatDeleteManagers,r).catch((([e])=>{console.error("UserService: remove manager error",e)}))}}function is(e){void babelHelpers.classPrivateFieldLooseBase(this,as)[as].dispatch("chats/update",{dialogId:e,fields:{inited:false}});void babelHelpers.classPrivateFieldLooseBase(this,as)[as].dispatch("recent/delete",{id:e});const s=babelHelpers.classPrivateFieldLooseBase(this,as)[as].getters["application/isChatOpen"](e);if(s){u.LayoutManager.getInstance().clearCurrentLayoutEntityId();void u.LayoutManager.getInstance().deleteLastOpenedElementById(e)}}var os=babelHelpers.classPrivateFieldLooseKey("store");var ds=babelHelpers.classPrivateFieldLooseKey("sendRequestDebounced");var cs=babelHelpers.classPrivateFieldLooseKey("sendRequest");var ns=babelHelpers.classPrivateFieldLooseKey("handleResponse");var bs=babelHelpers.classPrivateFieldLooseKey("getChatId");class hs{constructor(){Object.defineProperty(this,bs,{value:us});Object.defineProperty(this,ns,{value:ps});Object.defineProperty(this,cs,{value:vs});Object.defineProperty(this,os,{writable:true,value:void 0});Object.defineProperty(this,ds,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,os)[os]=L.Core.getStore();const e=500;babelHelpers.classPrivateFieldLooseBase(this,ds)[ds]=g.Runtime.debounce(babelHelpers.classPrivateFieldLooseBase(this,cs)[cs],e)}setDelay(e,s){P.Logger.warn("MessagesAutoDeleteService: setDelay",e,s);const a=babelHelpers.classPrivateFieldLooseBase(this,bs)[bs](e);const t=babelHelpers.classPrivateFieldLooseBase(this,os)[os].getters["chats/autoDelete/getDelay"](a);if(t===s){return}void babelHelpers.classPrivateFieldLooseBase(this,os)[os].dispatch("chats/autoDelete/set",{chatId:a,delay:s});babelHelpers.classPrivateFieldLooseBase(this,ds)[ds]({dialogId:e,delay:s,previousDelay:t})}}async function vs(e){const{dialogId:s,delay:a,previousDelay:t}=e;try{const e=await H.runAction(F.RestMethod.imV2ChatSetMessagesAutoDeleteDelay,{data:{dialogId:s,hours:a}});babelHelpers.classPrivateFieldLooseBase(this,ns)[ns](a,e)}catch(e){console.error("MessagesAutoDeleteService: Error setting auto delete delay",e);void babelHelpers.classPrivateFieldLooseBase(this,os)[os].dispatch("chats/autoDelete/set",{chatId:babelHelpers.classPrivateFieldLooseBase(this,bs)[bs](s),delay:t})}}function ps(e,s){const[a]=s.messagesAutoDeleteConfigs;if(e!==a.delay&&a.delay===F.AutoDeleteDelay.Off){m.FeatureManager.messagesAutoDelete.openFeatureSlider()}void babelHelpers.classPrivateFieldLooseBase(this,os)[os].dispatch("chats/autoDelete/set",{chatId:a.chatId,delay:a.delay})}function us(e){return babelHelpers.classPrivateFieldLooseBase(this,os)[os].getters["chats/get"](e).chatId}var gs=babelHelpers.classPrivateFieldLooseKey("loadService");var Ls=babelHelpers.classPrivateFieldLooseKey("createService");var Ps=babelHelpers.classPrivateFieldLooseKey("updateService");var Fs=babelHelpers.classPrivateFieldLooseKey("renameService");var Hs=babelHelpers.classPrivateFieldLooseKey("muteService");var ms=babelHelpers.classPrivateFieldLooseKey("pinService");var Cs=babelHelpers.classPrivateFieldLooseKey("readService");var Bs=babelHelpers.classPrivateFieldLooseKey("userService");var ys=babelHelpers.classPrivateFieldLooseKey("deleteService");var fs=babelHelpers.classPrivateFieldLooseKey("messagesAutoDeleteService");var Ms=babelHelpers.classPrivateFieldLooseKey("initServices");class Is{constructor(){Object.defineProperty(this,Ms,{value:ws});Object.defineProperty(this,gs,{writable:true,value:void 0});Object.defineProperty(this,Ls,{writable:true,value:void 0});Object.defineProperty(this,Ps,{writable:true,value:void 0});Object.defineProperty(this,Fs,{writable:true,value:void 0});Object.defineProperty(this,Hs,{writable:true,value:void 0});Object.defineProperty(this,ms,{writable:true,value:void 0});Object.defineProperty(this,Cs,{writable:true,value:void 0});Object.defineProperty(this,Bs,{writable:true,value:void 0});Object.defineProperty(this,ys,{writable:true,value:void 0});Object.defineProperty(this,fs,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,Ms)[Ms]()}loadChat(e){return babelHelpers.classPrivateFieldLooseBase(this,gs)[gs].loadChat(e)}loadChatByChatId(e){return babelHelpers.classPrivateFieldLooseBase(this,gs)[gs].loadChatByChatId(e)}loadChatWithMessages(e){return babelHelpers.classPrivateFieldLooseBase(this,gs)[gs].loadChatWithMessages(e)}loadChatWithContext(e,s){return babelHelpers.classPrivateFieldLooseBase(this,gs)[gs].loadChatWithContext(e,s)}loadComments(e){return babelHelpers.classPrivateFieldLooseBase(this,gs)[gs].loadComments(e)}loadCommentInfo(e){return babelHelpers.classPrivateFieldLooseBase(this,gs)[gs].loadCommentInfo(e)}prepareDialogId(e){return babelHelpers.classPrivateFieldLooseBase(this,gs)[gs].prepareDialogId(e)}clearChat(e){return babelHelpers.classPrivateFieldLooseBase(this,gs)[gs].clearChat(e)}createChat(e){return babelHelpers.classPrivateFieldLooseBase(this,Ls)[Ls].createChat(e)}createCollab(e){return babelHelpers.classPrivateFieldLooseBase(this,Ls)[Ls].createCollab(e)}prepareAvatar(e){return babelHelpers.classPrivateFieldLooseBase(this,Ps)[Ps].prepareAvatar(e)}changeAvatar(e,s){return babelHelpers.classPrivateFieldLooseBase(this,Ps)[Ps].changeAvatar(e,s)}updateChat(e,s){return babelHelpers.classPrivateFieldLooseBase(this,Ps)[Ps].updateChat(e,s)}updateCollab(e,s){return babelHelpers.classPrivateFieldLooseBase(this,Ps)[Ps].updateCollab(e,s)}getMemberEntities(e){return babelHelpers.classPrivateFieldLooseBase(this,Ps)[Ps].getMemberEntities(e)}deleteChat(e){return babelHelpers.classPrivateFieldLooseBase(this,ys)[ys].deleteChat(e)}deleteCollab(e){return babelHelpers.classPrivateFieldLooseBase(this,ys)[ys].deleteCollab(e)}renameChat(e,s){return babelHelpers.classPrivateFieldLooseBase(this,Fs)[Fs].renameChat(e,s)}muteChat(e){babelHelpers.classPrivateFieldLooseBase(this,Hs)[Hs].muteChat(e)}unmuteChat(e){babelHelpers.classPrivateFieldLooseBase(this,Hs)[Hs].unmuteChat(e)}pinChat(e){babelHelpers.classPrivateFieldLooseBase(this,ms)[ms].pinChat(e)}unpinChat(e){babelHelpers.classPrivateFieldLooseBase(this,ms)[ms].unpinChat(e)}readAll(){babelHelpers.classPrivateFieldLooseBase(this,Cs)[Cs].readAll()}readDialog(e){babelHelpers.classPrivateFieldLooseBase(this,Cs)[Cs].readDialog(e)}unreadDialog(e){babelHelpers.classPrivateFieldLooseBase(this,Cs)[Cs].unreadDialog(e)}readMessage(e,s){babelHelpers.classPrivateFieldLooseBase(this,Cs)[Cs].readMessage(e,s)}readChatQueuedMessages(e){babelHelpers.classPrivateFieldLooseBase(this,Cs)[Cs].readChatQueuedMessages(e)}clearDialogMark(e){babelHelpers.classPrivateFieldLooseBase(this,Cs)[Cs].clearDialogMark(e)}leaveChat(e){babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs].leaveChat(e)}leaveCollab(e){babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs].leaveCollab(e)}kickUserFromChat(e,s){babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs].kickUserFromChat(e,s)}kickUserFromCollab(e,s){babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs].kickUserFromCollab(e,s)}addToChat(e){return babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs].addToChat(e)}joinChat(e){babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs].joinChat(e)}addManager(e,s){babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs].addManager(e,s)}removeManager(e,s){babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs].removeManager(e,s)}setMessagesAutoDeleteDelay(e,s){babelHelpers.classPrivateFieldLooseBase(this,fs)[fs].setDelay(e,s)}}function ws(){babelHelpers.classPrivateFieldLooseBase(this,gs)[gs]=new N;babelHelpers.classPrivateFieldLooseBase(this,Ls)[Ls]=new ne;babelHelpers.classPrivateFieldLooseBase(this,Ps)[Ps]=new Fe;babelHelpers.classPrivateFieldLooseBase(this,Fs)[Fs]=new fe;babelHelpers.classPrivateFieldLooseBase(this,Hs)[Hs]=new Re;babelHelpers.classPrivateFieldLooseBase(this,ms)[ms]=new je;babelHelpers.classPrivateFieldLooseBase(this,Cs)[Cs]=new We;babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs]=new ls;babelHelpers.classPrivateFieldLooseBase(this,ys)[ys]=new y;babelHelpers.classPrivateFieldLooseBase(this,fs)[fs]=new hs}e.ChatService=Is})(this.BX.Messenger.v2.Service=this.BX.Messenger.v2.Service||{},BX?.OpenLines?.v2?.Lib??{},BX?.Call?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Service??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.UI?.Uploader??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.Vue3?.Vuex??{},BX??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX??{},BX?.Messenger?.v2?.Application??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Const??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{});
//# sourceMappingURL=chat.bundle.map.js