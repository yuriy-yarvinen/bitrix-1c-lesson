{"version":3,"file":"registry.bundle.js","sources":["../src/legacy/classes/recent-data-extractor.js","../src/legacy/legacy-recent.js","../src/base/base-recent.js"],"sourcesContent":["import { Type } from 'main.core';\n\nimport { Core } from 'im.v2.application.core';\nimport { ChatType, UserRole, MessageStatus, FakeMessagePrefix } from 'im.v2.const';\n\nimport type { ImModelMessage } from 'im.v2.model';\nimport type {\n\tRawUser,\n\tRawChat,\n\tRawLegacyRecentItem,\n\tRawMessage,\n\tRawCopilot,\n\tRawMessagesAutoDeleteConfig,\n} from 'im.v2.provider.service.types';\nimport type { RecentRestResult } from '../types/recent';\n\ntype RecentFile = {\n\tid: number,\n\tname: string,\n\ttype: string,\n};\n\ntype ExtractionResult = {\n\tusers: RawUser[],\n\tchats: RawChat[],\n\tmessages: RawMessage[],\n\tfiles: RecentFile[],\n\trecentItems: RawLegacyRecentItem[],\n\tcopilot?: RawCopilot,\n\tmessagesAutoDeleteConfigs: RawMessagesAutoDeleteConfig[],\n};\n\nexport class RecentDataExtractor\n{\n\t#restResult: RecentRestResult;\n\t#withBirthdays: boolean;\n\n\t#users: { [id: string]: RawUser } = {};\n\t#chats: { [id: string]: RawChat } = {};\n\t#messages: { [id: string]: RawMessage } = {};\n\t#files: { [id: string]: RecentFile } = {};\n\t#recentItems: { [id: string]: RawLegacyRecentItem } = {};\n\n\tconstructor(params: { rawData: RecentRestResult, withBirthdays?: boolean })\n\t{\n\t\tconst { rawData, withBirthdays = true } = params;\n\t\tthis.#withBirthdays = withBirthdays;\n\t\tthis.#restResult = rawData;\n\t}\n\n\tgetItems(): ExtractionResult\n\t{\n\t\tconst { items = [], copilot, messagesAutoDeleteConfigs } = this.#restResult;\n\t\titems.forEach((item: RawLegacyRecentItem) => {\n\t\t\tthis.#extractUser(item);\n\t\t\tthis.#extractChat(item);\n\t\t\tthis.#extractMessage(item);\n\t\t\tthis.#extractRecentItem(item);\n\t\t});\n\n\t\tthis.#extractBirthdayItems();\n\n\t\treturn {\n\t\t\tusers: Object.values(this.#users),\n\t\t\tchats: Object.values(this.#chats),\n\t\t\tmessages: Object.values(this.#messages),\n\t\t\tfiles: Object.values(this.#files),\n\t\t\trecentItems: Object.values(this.#recentItems),\n\t\t\tcopilot,\n\t\t\tmessagesAutoDeleteConfigs,\n\t\t};\n\t}\n\n\t#extractUser(item: RawLegacyRecentItem)\n\t{\n\t\tif (item.user?.id && !this.#users[item.user.id])\n\t\t{\n\t\t\tthis.#users[item.user.id] = item.user;\n\t\t}\n\t}\n\n\t#extractChat(item: RawLegacyRecentItem)\n\t{\n\t\tif (item.type === ChatType.chat)\n\t\t{\n\t\t\tthis.#chats[item.id] = this.#prepareGroupChat(item);\n\n\t\t\tif (item.user.id && !this.#chats[item.user.id])\n\t\t\t{\n\t\t\t\tthis.#chats[item.user.id] = this.#prepareChatForAdditionalUser(item.user);\n\t\t\t}\n\t\t}\n\t\telse if (item.type === ChatType.user)\n\t\t{\n\t\t\tconst existingRecentItem = Core.getStore().getters['recent/get'](item.user.id);\n\t\t\t// we should not update real chat with \"default\" chat data\n\t\t\tif (!existingRecentItem || !item.options.default_user_record)\n\t\t\t{\n\t\t\t\tthis.#chats[item.user.id] = this.#prepareChatForUser(item);\n\t\t\t}\n\t\t}\n\t}\n\n\t#extractMessage(item: RawLegacyRecentItem): void\n\t{\n\t\tconst message = item.message;\n\t\tif (!message)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (message.id === 0)\n\t\t{\n\t\t\tmessage.id = `${FakeMessagePrefix}-${item.id}`;\n\t\t}\n\n\t\tlet viewedByOthers = false;\n\t\tif (message.status === MessageStatus.delivered)\n\t\t{\n\t\t\tviewedByOthers = true;\n\t\t}\n\n\t\tconst existingMessage: ImModelMessage = Core.getStore().getters['messages/getById'](message.id);\n\t\t// recent has shortened attach format, we should not rewrite attach if model has it\n\t\tif (Type.isArrayFilled(existingMessage?.attach))\n\t\t{\n\t\t\tdelete message.attach;\n\t\t}\n\n\t\tif (Type.isPlainObject(message.file))\n\t\t{\n\t\t\tconst file: RecentFile = message.file;\n\t\t\tif (existingMessage)\n\t\t\t{\n\t\t\t\t// recent doesn't know about several files in one message,\n\t\t\t\t// we should not rewrite message files, so we merge it.\n\t\t\t\tmessage.files = this.#mergeFileIds(existingMessage, file.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmessage.files = [file.id];\n\t\t\t}\n\n\t\t\tconst existingFile = Core.getStore().getters['files/get'](file.id);\n\t\t\t// recent has shortened file format, we should not rewrite file if model has it\n\t\t\tif (!existingFile)\n\t\t\t{\n\t\t\t\tthis.#files[file.id] = file;\n\t\t\t}\n\t\t}\n\n\t\tthis.#messages[message.id] = { ...message, viewedByOthers };\n\t}\n\n\t#extractRecentItem(item: RawLegacyRecentItem): void\n\t{\n\t\tconst messageId = item.message?.id ?? 0;\n\t\tthis.#recentItems[item.id] = { ...item, messageId };\n\t}\n\n\t#extractBirthdayItems()\n\t{\n\t\tif (!this.#withBirthdays)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst { birthdayList = [] } = this.#restResult;\n\t\tbirthdayList.forEach((item) => {\n\t\t\tif (Core.getUserId() === item.id)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.#users[item.id])\n\t\t\t{\n\t\t\t\tthis.#users[item.id] = item;\n\t\t\t}\n\n\t\t\tif (!this.#chats[item.id])\n\t\t\t{\n\t\t\t\tthis.#chats[item.id] = this.#prepareChatForAdditionalUser(item);\n\t\t\t}\n\n\t\t\tif (!this.#recentItems[item.id])\n\t\t\t{\n\t\t\t\tconst messageId = `${FakeMessagePrefix}-${item.id}`;\n\t\t\t\tthis.#recentItems[item.id] = { ...this.#getBirthdayPlaceholder(item), messageId };\n\t\t\t\tthis.#messages[messageId] = { id: messageId };\n\t\t\t}\n\t\t});\n\t}\n\n\t#prepareGroupChat(item: RawLegacyRecentItem): RawChat\n\t{\n\t\treturn {\n\t\t\t...item.chat,\n\t\t\tcounter: item.counter,\n\t\t\tdialogId: item.id,\n\t\t};\n\t}\n\n\t#prepareChatForUser(item: RawLegacyRecentItem): RawChat\n\t{\n\t\treturn {\n\t\t\tchatId: item.chat_id,\n\t\t\tavatar: item.user.avatar,\n\t\t\tcolor: item.user.color,\n\t\t\tdialogId: item.id,\n\t\t\tname: item.user.name,\n\t\t\ttype: ChatType.user,\n\t\t\tcounter: item.counter,\n\t\t\trole: UserRole.member,\n\t\t\tbackgroundId: item.chat.background_id,\n\t\t\ttextFieldEnabled: item.chat.text_field_enabled,\n\t\t\tmuteList: item.chat.mute_list,\n\t\t};\n\t}\n\n\t#prepareChatForAdditionalUser(user: RawUser): RawChat\n\t{\n\t\treturn {\n\t\t\tdialogId: user.id,\n\t\t\tavatar: user.avatar,\n\t\t\tcolor: user.color,\n\t\t\tname: user.name,\n\t\t\ttype: ChatType.user,\n\t\t\trole: UserRole.member,\n\t\t};\n\t}\n\n\t#getBirthdayPlaceholder(item: RawLegacyRecentItem): { id: string, isBirthdayPlaceholder: true }\n\t{\n\t\treturn {\n\t\t\tid: item.id,\n\t\t\tisBirthdayPlaceholder: true,\n\t\t};\n\t}\n\n\t#mergeFileIds(existingMessage: ImModelMessage, fileId: number): number[]\n\t{\n\t\tconst existingMessageFilesIds = existingMessage.files.map((id) => {\n\t\t\treturn Number.parseInt(id, 10);\n\t\t});\n\t\tconst setOfFileIds = new Set([...existingMessageFilesIds, fileId]);\n\n\t\treturn [...setOfFileIds];\n\t}\n}\n","import { Core } from 'im.v2.application.core';\nimport { RestMethod } from 'im.v2.const';\nimport { Logger } from 'im.v2.lib.logger';\nimport { CopilotManager } from 'im.v2.lib.copilot';\nimport { LayoutManager } from 'im.v2.lib.layout';\n\nimport { RecentDataExtractor } from './classes/recent-data-extractor';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelRecentItem } from 'im.v2.model';\n\nexport class LegacyRecentService\n{\n\tstatic instance = null;\n\n\tdataIsPreloaded: boolean = false;\n\tfirstPageIsLoaded: boolean = false;\n\titemsPerPage: number = 50;\n\tisLoading: boolean = false;\n\tpagesLoaded: number = 0;\n\thasMoreItemsToLoad: boolean = true;\n\tlastMessageDate: string = null;\n\n\tstatic getInstance(): LegacyRecentService\n\t{\n\t\tif (!this.instance)\n\t\t{\n\t\t\tthis.instance = new this();\n\t\t}\n\n\t\treturn this.instance;\n\t}\n\n\t// region public\n\tgetCollection(): ImModelRecentItem[]\n\t{\n\t\treturn Core.getStore().getters['recent/getRecentCollection'];\n\t}\n\n\tasync loadFirstPage({ ignorePreloadedItems = false } = {}): Promise\n\t{\n\t\tif (this.dataIsPreloaded && !ignorePreloadedItems)\n\t\t{\n\t\t\tLogger.warn('Im.RecentList: first page was preloaded');\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tthis.isLoading = true;\n\n\t\tconst result = await this.requestItems({ firstPage: true });\n\t\tthis.firstPageIsLoaded = true;\n\n\t\treturn result;\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tif (this.isLoading || !this.hasMoreItemsToLoad)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tthis.isLoading = true;\n\n\t\treturn this.requestItems();\n\t}\n\n\tsetPreloadedData(params)\n\t{\n\t\tLogger.warn('Im.RecentList: setting preloaded data', params);\n\t\tconst { items, hasMore } = params;\n\n\t\tthis.lastMessageDate = this.getLastMessageDate(items);\n\n\t\tif (!hasMore)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tthis.dataIsPreloaded = true;\n\n\t\tvoid this.updateModels(params);\n\t}\n\n\thideChat(dialogId: string): void\n\t{\n\t\tLogger.warn('Im.RecentList: hide chat', dialogId);\n\t\tconst recentItem = Core.getStore().getters['recent/get'](dialogId);\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tvoid Core.getStore().dispatch('recent/delete', { id: dialogId });\n\n\t\tconst chatIsOpened = Core.getStore().getters['application/isChatOpen'](dialogId);\n\t\tif (chatIsOpened)\n\t\t{\n\t\t\tLayoutManager.getInstance().clearCurrentLayoutEntityId();\n\t\t\tvoid LayoutManager.getInstance().deleteLastOpenedElementById(dialogId);\n\t\t}\n\n\t\tCore.getRestClient().callMethod(RestMethod.imRecentHide, { DIALOG_ID: dialogId })\n\t\t\t.catch((result: RestResult) => {\n\t\t\t\tconsole.error('Im.RecentList: hide chat error', result.error());\n\t\t\t});\n\t}\n\t// endregion public\n\n\tasync requestItems({ firstPage = false } = {}): Promise\n\t{\n\t\tconst queryParams = this.getQueryParams(firstPage);\n\n\t\tconst result: RestResult = await Core.getRestClient().callMethod(RestMethod.imRecentList, queryParams)\n\t\t\t.catch((errorResult: RestResult) => {\n\t\t\t\tconsole.error('Im.RecentList: page request error', errorResult.error());\n\t\t\t});\n\n\t\tthis.pagesLoaded++;\n\t\tLogger.warn(`Im.RecentList: ${firstPage ? 'First' : this.pagesLoaded} page request result`, result.data());\n\t\tconst { items, hasMore } = result.data();\n\t\tthis.lastMessageDate = this.getLastMessageDate(items);\n\t\tif (!hasMore)\n\t\t{\n\t\t\tthis.hasMoreItemsToLoad = false;\n\t\t}\n\n\t\tthis.isLoading = false;\n\n\t\treturn this.updateModels(result.data());\n\t}\n\n\tgetQueryParams(firstPage: boolean): JsonObject\n\t{\n\t\treturn {\n\t\t\tSKIP_OPENLINES: 'Y',\n\t\t\tLIMIT: this.itemsPerPage,\n\t\t\tLAST_MESSAGE_DATE: firstPage ? null : this.lastMessageDate,\n\t\t\tGET_ORIGINAL_TEXT: 'Y',\n\t\t\tPARSE_TEXT: 'Y',\n\t\t};\n\t}\n\n\tgetModelSaveMethod(): string\n\t{\n\t\treturn 'recent/setRecent';\n\t}\n\n\tupdateModels(rawData): Promise\n\t{\n\t\tconst extractor = new RecentDataExtractor({ rawData, ...this.getExtractorOptions() });\n\t\tconst extractedItems = extractor.getItems();\n\t\tconst {\n\t\t\tusers,\n\t\t\tchats,\n\t\t\tmessages,\n\t\t\tfiles,\n\t\t\trecentItems,\n\t\t\tcopilot,\n\t\t\tmessagesAutoDeleteConfigs,\n\t\t} = extractedItems;\n\t\tLogger.warn('LegacyRecentService: prepared data for models', extractedItems);\n\n\t\tconst usersPromise = Core.getStore().dispatch('users/set', users);\n\t\tconst dialoguesPromise = Core.getStore().dispatch('chats/set', chats);\n\t\tconst autoDeletePromise = Core.getStore().dispatch('chats/autoDelete/set', messagesAutoDeleteConfigs);\n\t\tconst messagesPromise = Core.getStore().dispatch('messages/store', messages);\n\t\tconst filesPromise = Core.getStore().dispatch('files/set', files);\n\t\tconst recentPromise = Core.getStore().dispatch(this.getModelSaveMethod(), recentItems);\n\n\t\tconst copilotManager = new CopilotManager();\n\t\tconst copilotPromise = copilotManager.handleRecentListResponse(copilot);\n\n\t\treturn Promise.all([\n\t\t\tusersPromise,\n\t\t\tdialoguesPromise,\n\t\t\tmessagesPromise,\n\t\t\tfilesPromise,\n\t\t\trecentPromise,\n\t\t\tcopilotPromise,\n\t\t\tautoDeletePromise,\n\t\t]);\n\t}\n\n\tgetLastMessageDate(items: Array): string\n\t{\n\t\tif (items.length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn items.slice(-1)[0].message.date;\n\t}\n\n\tgetExtractorOptions(): { withBirthdays?: boolean }\n\t{\n\t\treturn {};\n\t}\n}\n","import { Core } from 'im.v2.application.core';\nimport { CopilotManager } from 'im.v2.lib.copilot';\nimport { Logger } from 'im.v2.lib.logger';\nimport { runAction } from 'im.v2.lib.rest';\nimport { UserManager } from 'im.v2.lib.user';\n\nimport type { RawChat, RawMessage, RawRecentItem } from 'im.v2.provider.service.types';\nimport type { BaseRecentQueryParams, RecentRestResult } from './types/base-recent-types';\n\nexport class BaseRecentService\n{\n\t#itemsPerPage: number = 50;\n\t#isLoading: boolean = false;\n\t#pagesLoaded: number = 0;\n\t#hasMoreItemsToLoad: boolean = true;\n\t#lastMessageDate: number = 0;\n\n\tloadFirstPage(): Promise\n\t{\n\t\tthis.#isLoading = true;\n\n\t\treturn this.#requestItems({ firstPage: true });\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tif (this.#isLoading || !this.#hasMoreItemsToLoad)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tthis.#isLoading = true;\n\n\t\treturn this.#requestItems();\n\t}\n\n\thasMoreItemsToLoad(): boolean\n\t{\n\t\treturn this.#hasMoreItemsToLoad;\n\t}\n\n\tgetItemsPerPage(): number\n\t{\n\t\treturn this.#itemsPerPage;\n\t}\n\n\tgetRestMethodName(): string\n\t{\n\t\tthrow new Error('BaseRecentList: you should implement \"getRestMethodName\" for child class');\n\t}\n\n\tgetRecentSaveActionName(): string\n\t{\n\t\tthrow new Error('BaseRecentList: you should implement \"getRecentSaveActionName\" for child class');\n\t}\n\n\tgetQueryParams(firstPage: boolean = false): BaseRecentQueryParams\n\t{\n\t\treturn {\n\t\t\tlimit: this.getItemsPerPage(),\n\t\t\tfilter: this.getRequestFilter(firstPage),\n\t\t};\n\t}\n\n\tgetRequestFilter(firstPage: boolean = false): Record\n\t{\n\t\treturn {\n\t\t\tlastMessageDate: firstPage ? null : this.#lastMessageDate,\n\t\t};\n\t}\n\n\thandlePaginationField(result: RecentRestResult): void\n\t{\n\t\tthis.#lastMessageDate = this.#getLastMessageDate(result);\n\t}\n\n\tonAfterRequest(firstPage: boolean): void\n\t{\n\t\t// The base class does nothing here\n\t}\n\n\tasync #requestItems({ firstPage = false } = {}): Promise\n\t{\n\t\tconst queryParams = {\n\t\t\tdata: this.getQueryParams(firstPage),\n\t\t};\n\n\t\tconst result: RecentRestResult = await runAction(this.getRestMethodName(), queryParams)\n\t\t\t.catch(([error]) => {\n\t\t\t\tconsole.error('BaseRecentList: page request error', error);\n\t\t\t});\n\n\t\tthis.#pagesLoaded++;\n\t\tLogger.warn(`BaseRecentList: ${firstPage ? 'First' : this.#pagesLoaded} page request result`, result);\n\t\tconst { hasNextPage } = result;\n\t\tthis.handlePaginationField(result);\n\t\tthis.#hasMoreItemsToLoad = hasNextPage;\n\n\t\tthis.#isLoading = false;\n\n\t\tthis.onAfterRequest(firstPage);\n\n\t\treturn this.#updateModels(result);\n\t}\n\n\t#updateModels(restResult: RecentRestResult): Promise\n\t{\n\t\tconst { users, chats, messages, files, recentItems, messagesAutoDeleteConfigs, copilot } = restResult;\n\t\tconst chatsWithCounters = this.#getChatsWithCounters(chats, recentItems);\n\n\t\t// private chats objects are empty, so we should handle chats before users to not overwrite real info\n\t\tconst chatsPromise = Core.getStore().dispatch('chats/set', chatsWithCounters);\n\t\tconst usersPromise = (new UserManager()).setUsersToModel(users);\n\t\tconst autoDeletePromise = Core.getStore().dispatch('chats/autoDelete/set', messagesAutoDeleteConfigs);\n\t\tconst messagesPromise = Core.getStore().dispatch('messages/store', messages);\n\t\tconst filesPromise = Core.getStore().dispatch('files/set', files);\n\t\tconst recentPromise = Core.getStore().dispatch(this.getRecentSaveActionName(), recentItems);\n\n\t\tconst copilotManager = new CopilotManager();\n\t\tconst copilotPromise = copilotManager.handleRecentListResponse(copilot);\n\n\t\treturn Promise.all([\n\t\t\tusersPromise,\n\t\t\tchatsPromise,\n\t\t\tmessagesPromise,\n\t\t\tfilesPromise,\n\t\t\trecentPromise,\n\t\t\tautoDeletePromise,\n\t\t\tcopilotPromise,\n\t\t]);\n\t}\n\n\t#getChatsWithCounters(chats: RawChat[], recentItems: RawRecentItem[]): RawChat[]\n\t{\n\t\tconst chatMap = {};\n\t\tchats.forEach((chat) => {\n\t\t\tchatMap[chat.id] = chat;\n\t\t});\n\t\trecentItems.forEach((recentItem) => {\n\t\t\tconst { counter, chatId } = recentItem;\n\t\t\tif (counter === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tchatMap[chatId] = { ...chatMap[chatId], counter };\n\t\t});\n\n\t\treturn Object.values(chatMap);\n\t}\n\n\t#getLastMessageDate(restResult: RecentRestResult): string\n\t{\n\t\tconst messages = this.#filterPinnedItemsMessages(restResult);\n\t\tif (messages.length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\t// comparing strings in atom format works correctly because the format is lexically sortable\n\t\tlet firstMessageDate = messages[0].date;\n\t\tmessages.forEach((message) => {\n\t\t\tif (message.date < firstMessageDate)\n\t\t\t{\n\t\t\t\tfirstMessageDate = message.date;\n\t\t\t}\n\t\t});\n\n\t\treturn firstMessageDate;\n\t}\n\n\t#filterPinnedItemsMessages(restResult: RecentRestResult): RawMessage[]\n\t{\n\t\tconst { messages, recentItems } = restResult;\n\n\t\treturn messages.filter((message) => {\n\t\t\tconst chatId = message.chat_id;\n\t\t\tconst recentItem: RawRecentItem = recentItems.find((item) => {\n\t\t\t\treturn item.chatId === chatId;\n\t\t\t});\n\n\t\t\treturn recentItem.pinned === false;\n\t\t});\n\t}\n}\n"],"names":["RecentDataExtractor","constructor","params","rawData","withBirthdays","getItems","items","copilot","messagesAutoDeleteConfigs","forEach","item","users","Object","values","chats","messages","files","recentItems","user","id","type","ChatType","chat","existingRecentItem","Core","getStore","getters","options","default_user_record","message","FakeMessagePrefix","viewedByOthers","status","MessageStatus","delivered","existingMessage","Type","isArrayFilled","attach","isPlainObject","file","existingFile","messageId","birthdayList","getUserId","counter","dialogId","chatId","chat_id","avatar","color","name","role","UserRole","member","backgroundId","background_id","textFieldEnabled","text_field_enabled","muteList","mute_list","isBirthdayPlaceholder","fileId","existingMessageFilesIds","map","Number","parseInt","setOfFileIds","Set","LegacyRecentService","dataIsPreloaded","firstPageIsLoaded","itemsPerPage","isLoading","pagesLoaded","hasMoreItemsToLoad","lastMessageDate","getInstance","instance","getCollection","loadFirstPage","ignorePreloadedItems","Logger","warn","Promise","resolve","result","requestItems","firstPage","loadNextPage","setPreloadedData","hasMore","getLastMessageDate","updateModels","hideChat","recentItem","dispatch","chatIsOpened","LayoutManager","clearCurrentLayoutEntityId","deleteLastOpenedElementById","getRestClient","callMethod","RestMethod","imRecentHide","DIALOG_ID","catch","console","error","queryParams","getQueryParams","imRecentList","errorResult","data","SKIP_OPENLINES","LIMIT","LAST_MESSAGE_DATE","GET_ORIGINAL_TEXT","PARSE_TEXT","getModelSaveMethod","extractor","getExtractorOptions","extractedItems","usersPromise","dialoguesPromise","autoDeletePromise","messagesPromise","filesPromise","recentPromise","copilotManager","CopilotManager","copilotPromise","handleRecentListResponse","all","length","slice","date","BaseRecentService","getItemsPerPage","getRestMethodName","Error","getRecentSaveActionName","limit","filter","getRequestFilter","handlePaginationField","onAfterRequest","runAction","hasNextPage","restResult","chatsWithCounters","chatsPromise","UserManager","setUsersToModel","chatMap","firstMessageDate","find","pinned"],"mappings":"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"}