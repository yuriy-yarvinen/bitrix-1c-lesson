this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};this.BX.Messenger.v2.Component=this.BX.Messenger.v2.Component||{};(function(t,e,a,r,i,o,s,l){"use strict";const n=Object.freeze({XXS:"XXS",XS:"XS",S:"S",M:"M",L:"L",XL:"XL",XXL:"XXL",XXXL:"XXXL"});const u=Object.freeze({[n.XXXL]:94,[n.XXL]:60,[n.XL]:48,[n.L]:42,[n.M]:32,[n.S]:22,[n.XS]:18,[n.XXS]:14});const p={notes:"notes"};const d=Object.freeze({default:"default",squared:"squared",collab:"collab"});const c={name:"MessengerAvatar",props:{dialogId:{type:[String,Number],default:0},customSource:{type:String,default:""},size:{type:String,default:n.M},withAvatarLetters:{type:Boolean,default:true},withSpecialTypes:{type:Boolean,default:true},withSpecialTypeIcon:{type:Boolean,default:true},withTooltip:{type:Boolean,default:true},backgroundColor:{type:String,default:""}},data(){return{imageLoadError:false}},computed:{dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},isChannel(){return r.ChannelManager.isChannel(this.dialogId)},isSpecialType(){const t=[l.ChatType.user,l.ChatType.chat,l.ChatType.open,l.ChatType.lines,l.ChatType.copilot];return!t.includes(this.dialog.type)},containerTitle(){if(!this.withTooltip){return""}return this.dialog.name},containerClasses(){const t=[`--size-${this.size.toLowerCase()}`];if(this.withSpecialTypes&&this.isSpecialType){t.push("--special")}const e=l.ChatType[this.dialog.type]?`--${this.dialog.type}`:"--default";t.push(e);return t},backgroundColorStyle(){if(this.backgroundColor){return{backgroundColor:this.backgroundColor}}return{backgroundColor:this.dialog.color}},avatarText(){if(!this.showAvatarLetters||!this.isEnoughSizeForText){return""}return a.Utils.text.getFirstLetters(this.dialog.name)},showAvatarLetters(){const t=[l.ChatType.openChannel,l.ChatType.channel,l.ChatType.taskComments];if(t.includes(this.dialog.type)){return true}return!this.isSpecialType},showSpecialTypeIcon(){if(!this.withSpecialTypes||!this.withSpecialTypeIcon||this.isChannel){return false}return this.isSpecialType},isEnoughSizeForText(){const t=[n.M,n.L,n.XL,n.XXL,n.XXXL];return t.includes(this.size.toUpperCase())},avatarUrl(){return this.customSource.length>0?this.customSource:this.dialog.avatar},hasImage(){return this.avatarUrl&&!this.imageLoadError}},watch:{avatarUrl(){this.imageLoadError=false}},methods:{onImageLoadError(){this.imageLoadError=true}},template:`\n\t\t<div :title="containerTitle" :class="containerClasses" class="bx-im-avatar__scope bx-im-avatar__container">\n\t\t\t\x3c!-- Avatar --\x3e\n\t\t\t<template v-if="hasImage">\n\t\t\t\t<img :src="avatarUrl" :alt="dialog.name" class="bx-im-avatar__content --image" @error="onImageLoadError" draggable="false"/>\n\t\t\t\t<div v-if="showSpecialTypeIcon" :style="backgroundColorStyle" class="bx-im-avatar__special-type_icon"></div>\n\t\t\t</template>\n\t\t\t<div v-else-if="withAvatarLetters && avatarText" :style="backgroundColorStyle" class="bx-im-avatar__content --text">\n\t\t\t\t{{ avatarText }}\n\t\t\t</div>\n\t\t\t<div v-else :style="backgroundColorStyle" class="bx-im-avatar__content bx-im-avatar__icon"></div>\n\t\t</div>\n\t`};const h={extranet:"extranet",collaber:"collaber",collab:"collab",copilot:"copilot",default:"default"};const g={props:{type:{type:String,required:true,validator(t){return Object.values(h).includes(t)}},size:{type:String,default:n.M},url:{type:String,default:""},title:{type:String,default:""},backgroundColor:{type:String,default:""}},computed:{AvatarSize:()=>n,calculatedSize(){return u[this.size]}},watch:{title(){this.avatar.setTitle(this.title)},url(){this.setAvatarImage()}},created(){const t={extranet:i.AvatarRoundExtranet,collaber:i.AvatarRoundGuest,collab:i.AvatarHexagonGuest,copilot:i.AvatarRoundCopilot,default:i.AvatarBase};const e=t[this.type]||t.default;this.avatar=new e({size:this.calculatedSize,title:this.title});this.setAvatarImage();this.setBackgroundColor()},mounted(){if(this.avatar&&this.$refs.avatarContainer){this.avatar.renderTo(this.$refs.avatarContainer)}},methods:{setAvatarImage(){if(!this.url){return}this.avatar.setUserPic(this.url)},setBackgroundColor(){if(!this.backgroundColor){return}this.avatar.setBaseColor(this.backgroundColor)}},template:`\n\t\t<div class="bx-im-base-ui-avatar__container" ref="avatarContainer"></div>\n\t`};const v={name:"CollabChatAvatar",components:{BaseUiAvatar:g},props:{dialogId:{type:[String,Number],default:0},size:{type:String,default:n.M},withAvatarLetters:{type:Boolean,default:true},customSource:{type:String,default:""},withSpecialTypes:{type:Boolean,default:true},withSpecialTypeIcon:{type:Boolean,default:true},withTooltip:{type:Boolean,default:true}},computed:{AvatarType:()=>h,dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},dialogName(){return this.dialog.name},dialogAvatarUrl(){return this.dialog.avatar},collabBackgroundColor(){return l.Color.collab60}},template:`\n\t\t<BaseUiAvatar\n\t\t\t:type="AvatarType.collab"\n\t\t\t:key="dialogId"\n\t\t\t:title="dialogName" \n\t\t\t:size="size" \n\t\t\t:url="dialogAvatarUrl" \n\t\t\t:backgroundColor="collabBackgroundColor" \n\t\t/>\n\t`};const y={name:"CollaberAvatar",components:{BaseUiAvatar:g},props:{dialogId:{type:[String,Number],default:0},size:{type:String,default:n.M},withAvatarLetters:{type:Boolean,default:true},customSource:{type:String,default:""},withSpecialTypes:{type:Boolean,default:true},withSpecialTypeIcon:{type:Boolean,default:true},withTooltip:{type:Boolean,default:true}},computed:{AvatarType:()=>h,dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},dialogName(){return this.dialog.name},dialogAvatarUrl(){return this.dialog.avatar},collaberBackgroundColor(){return l.Color.collab60}},template:`\n\t\t<BaseUiAvatar\n\t\t\t:type="AvatarType.collaber"\n\t\t\t:key="dialogId"\n\t\t\t:title="dialogName" \n\t\t\t:size="size" \n\t\t\t:url="dialogAvatarUrl"\n\t\t\t:backgroundColor="collaberBackgroundColor" \n\t\t/>\n\t`};const m={name:"ExtranetChatAvatar",components:{Avatar:c},props:{dialogId:{type:[String,Number],default:0},size:{type:String,default:n.M},withAvatarLetters:{type:Boolean,default:true},customSource:{type:String,default:""},withSpecialTypes:{type:Boolean,default:true},withSpecialTypeIcon:{type:Boolean,default:true},withTooltip:{type:Boolean,default:true}},computed:{dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},dialogName(){return this.dialog.name},dialogAvatarUrl(){return this.dialog.avatar},extranetBackgroundColor(){return l.Color.orange50}},template:`\n\t\t<Avatar\n\t\t\t:dialogId="dialogId"\n\t\t\t:title="dialogName" \n\t\t\t:size="size" \n\t\t\t:url="dialogAvatarUrl" \n\t\t\t:backgroundColor="extranetBackgroundColor" \n\t\t/>\n\t`};const f={name:"ExtranetUserAvatar",components:{BaseUiAvatar:g},props:{dialogId:{type:[String,Number],default:0},size:{type:String,default:n.M},withAvatarLetters:{type:Boolean,default:true},customSource:{type:String,default:""},withSpecialTypes:{type:Boolean,default:true},withSpecialTypeIcon:{type:Boolean,default:true},withTooltip:{type:Boolean,default:true}},computed:{AvatarType:()=>h,dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},dialogName(){return this.dialog.name},dialogAvatarUrl(){return this.dialog.avatar}},template:`\n\t\t<BaseUiAvatar\n\t\t\t:type="AvatarType.extranet"\n\t\t\t:title="dialogName"\n\t\t\t:size="size"\n\t\t\t:url="dialogAvatarUrl"\n\t\t/>\n\t`};const S={name:"CopilotAvatar",components:{BaseUiAvatar:g},props:{dialogId:{type:[String,Number],default:0},size:{type:String,default:n.M},customSource:{type:String,default:""}},computed:{AvatarType:()=>h,dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},dialogName(){return this.dialog.name},dialogAvatarUrl(){return this.customSource.length>0?this.customSource:this.dialog.avatar}},template:`\n\t\t<BaseUiAvatar\n\t\t\t:type="AvatarType.copilot"\n\t\t\t:title="dialogName" \n\t\t\t:size="size" \n\t\t\t:url="dialogAvatarUrl" \n\t\t/>\n\t`};const C={name:"NotesAvatar",inheritAttrs:false,props:{size:{type:String,default:n.M}},computed:{sizeStyles(){return{width:`${u[this.size]}px`,height:`${u[this.size]}px`}}},methods:{loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div class="bx-im-notes-avatar__container" :style="sizeStyles" :title="loc('IM_ELEMENTS_CHAT_MY_NOTES')"></div>\n\t`};const A={name:"ChatAvatar",components:{Avatar:c,CollabAvatar:v,CollaberAvatar:y,ExtranetUserAvatar:f,NotesAvatar:C,CopilotAvatar:S},props:{avatarDialogId:{type:[String,Number],default:0},contextDialogId:{type:String,required:true},size:{type:String,default:n.M},withAvatarLetters:{type:Boolean,default:true},withSpecialTypes:{type:Boolean,default:true},withSpecialTypeIcon:{type:Boolean,default:true},withTooltip:{type:Boolean,default:true},customType:{type:String,default:""}},computed:{isUser(){return this.avatarDialog.type===l.ChatType.user},user(){return this.$store.getters["users/get"](this.avatarDialogId,true)},customAvatarUrl(){if(!this.isCopilot){return""}return this.copilotManager.getRoleAvatarUrl({avatarDialogId:this.avatarDialogId,contextDialogId:this.contextDialogId})},avatarDialog(){return this.$store.getters["chats/get"](this.avatarDialogId,true)},isCollabChat(){return this.avatarDialog.type===l.ChatType.collab},isCollaber(){var t;return((t=this.user)==null?void 0:t.type)===l.UserType.collaber},isExtranetChat(){return this.avatarDialog.extranet},isExtranet(){var t;return((t=this.user)==null?void 0:t.type)===l.UserType.extranet},isCopilot(){return this.copilotManager.isCopilotChatOrBot(this.avatarDialogId)},avatarComponent(){if(this.customType===p.notes){return C}if(this.isExtranet){return f}if(this.isCollaber){return y}if(this.isCollabChat){return v}if(this.isCopilot){return S}return this.isExtranetChat?m:c}},created(){this.copilotManager=new o.CopilotManager},template:`\n\t\t<component\n\t\t\t:is="avatarComponent"\n\t\t\t:dialogId="avatarDialogId"\n\t\t\t:customSource="customAvatarUrl"\n\t\t\t:size="size"\n\t\t\t:withAvatarLetters="withAvatarLetters"\n\t\t\t:withSpecialTypes="withSpecialTypes"\n\t\t\t:withSpecialTypeIcon="withSpecialTypeIcon"\n\t\t\t:withTooltip="withTooltip"\n\t\t/>\n\t`};const T={name:"MessageAvatar",components:{Avatar:c,CollaberAvatar:y,CopilotAvatar:S},props:{messageId:{type:[String,Number],default:0},authorId:{type:[String,Number],default:0},size:{type:String,default:n.M},withAvatarLetters:{type:Boolean,default:true},withSpecialTypes:{type:Boolean,default:true},withSpecialTypeIcon:{type:Boolean,default:true},withTooltip:{type:Boolean,default:true}},computed:{customAvatarUrl(){const t=new o.CopilotManager;if(!t.isCopilotMessage(this.messageId)){return""}return t.getMessageRoleAvatar(this.messageId)},user(){return this.$store.getters["users/get"](this.authorId,true)},avatarComponent(){var t;const e={[l.UserType.extranet]:f,[l.UserType.collaber]:y,[l.UserType.bot]:this.getBotAvatar()};return(t=e[this.user.type])!=null?t:c}},methods:{getBotAvatar(){const t=new o.CopilotManager;return t.isCopilotChatOrBot(this.authorId)?S:c}},template:`\n\t\t<component\n\t\t\t:is="avatarComponent"\n\t\t\t:dialogId="authorId"\n\t\t\t:customSource="customAvatarUrl"\n\t\t\t:size="size"\n\t\t\t:withAvatarLetters="withAvatarLetters"\n\t\t\t:withSpecialTypes="withSpecialTypes"\n\t\t\t:withSpecialTypeIcon="withSpecialTypeIcon"\n\t\t\t:withTooltip="withTooltip"\n\t\t/>\n\t`};const b="/bitrix/js/im/v2/component/elements/avatar/src/components/base/css/images/camera.png";const B={name:"EmptyAvatar",components:{BaseUiAvatar:g},props:{url:{type:String,default:""},title:{type:String,default:""},type:{type:String,default:d.default},size:{type:String,default:n.M}},data(){return{imageLoadError:false}},computed:{AvatarSize:()=>n,AvatarType:()=>h,Color:()=>l.Color,isSquared(){return this.type===d.squared},isCollabType(){return this.type===d.collab},collabEmptyAvatarUrl(){if(!s.Type.isStringFilled(this.url)){return b}return this.url},containerClasses(){const t=[`--size-${this.size.toLowerCase()}`];if(this.isSquared){t.push("--squared")}return t}},template:`\n\t\t<BaseUiAvatar\n\t\t\tv-if="isCollabType"\n\t\t\t:type="AvatarType.collab"\n\t\t\t:url="collabEmptyAvatarUrl" \n\t\t\t:size="size"\n\t\t\t:title="title"\n\t\t\t:backgroundColor="Color.collab10"\n\t\t/>\n\t\t<div v-else class="bx-im-empty-avatar__container" :class="containerClasses">\n\t\t\t<div v-if="!url" class="bx-im-empty-avatar__avatar --default"></div>\n\t\t\t<img v-else class="bx-im-empty-avatar__avatar --image" :src="url" :alt="title"/>\n\t\t</div>\n\t`};t.AvatarSize=n;t.ChatAvatarType=p;t.EmptyAvatarType=d;t.ChatAvatar=A;t.MessageAvatar=T;t.EmptyAvatar=B})(this.BX.Messenger.v2.Component.Elements=this.BX.Messenger.v2.Component.Elements||{},BX,BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX.UI,BX.Messenger.v2.Lib,BX,BX.Messenger.v2.Const);
//# sourceMappingURL=registry.bundle.map.js