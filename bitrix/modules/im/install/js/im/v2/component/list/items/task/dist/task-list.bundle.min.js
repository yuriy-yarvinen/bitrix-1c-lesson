this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};this.BX.Messenger.v2.Component=this.BX.Messenger.v2.Component||{};(function(t,e,n,i,s,a,r,o,c){"use strict";const g={name:"EmptyState",components:{RecentEmptyState:a.RecentEmptyState},methods:{loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<RecentEmptyState :title="loc('IM_LIST_TASK_EMPTY_STATE_TITLE')" />\n\t`};class l extends o.BaseRecentService{getRestMethodName(){return r.RestMethod.imV2RecentExternalChatTail}getQueryParams(t=false){return{...super.getQueryParams(t),type:r.ChatType.taskComments}}getRecentSaveActionName(){return"recent/setTask"}}class m extends c.RecentMenu{getMenuItems(){return[this.getUnreadMessageItem(),this.getPinMessageItem(),this.getHideItem()]}}const d={name:"TaskList",components:{EmptyState:g,LoadingState:i.ListLoadingState,RecentItem:s.RecentItem},emits:["chatClick"],data(){return{isLoading:false,isLoadingNextPage:false,firstPageLoaded:false}},computed:{collection(){return this.$store.getters["recent/getTaskCollection"]},preparedItems(){return[...this.collection].sort(((t,e)=>{const n=this.$store.getters["recent/getSortDate"](t.dialogId);const i=this.$store.getters["recent/getSortDate"](e.dialogId);return i-n}))},pinnedItems(){return this.preparedItems.filter((t=>t.pinned===true))},generalItems(){return this.preparedItems.filter((t=>t.pinned===false))},isEmptyCollection(){return this.collection.length===0}},created(){this.contextMenuManager=new m},beforeUnmount(){this.contextMenuManager.destroy()},async activated(){this.isLoading=true;await this.getRecentService().loadFirstPage();if(!this.firstPageLoaded){void e.DraftManager.getInstance().initDraftHistory()}this.firstPageLoaded=true;this.isLoading=false},methods:{async onScroll(t){this.contextMenuManager.close();if(!n.Utils.dom.isOneScreenRemaining(t.target)||!this.getRecentService().hasMoreItemsToLoad()){return}this.isLoadingNextPage=true;await this.getRecentService().loadNextPage();this.isLoadingNextPage=false},onClick(t){this.$emit("chatClick",t.dialogId)},onRightClick(t,e){e.preventDefault();const n={dialogId:t.dialogId,recentItem:t};this.contextMenuManager.openMenu(n,e.currentTarget)},getRecentService(){if(!this.service){this.service=new l}return this.service},loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div class="bx-im-list-task__container">\n\t\t\t<LoadingState v-if="isLoading && !firstPageLoaded" />\n\t\t\t<div v-else @scroll="onScroll" class="bx-im-list-task__scroll-container">\n\t\t\t\t<EmptyState v-if="isEmptyCollection" />\n\t\t\t\t<div v-if="pinnedItems.length > 0" class="bx-im-list-task__pinned_container">\n\t\t\t\t\t<RecentItem\n\t\t\t\t\t\tv-for="item in pinnedItems"\n\t\t\t\t\t\t:key="item.dialogId"\n\t\t\t\t\t\t:item="item"\n\t\t\t\t\t\t@click="onClick(item)"\n\t\t\t\t\t\t@click.right="onRightClick(item, $event)"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class="bx-im-list-task__general_container">\n\t\t\t\t\t<RecentItem\n\t\t\t\t\t\tv-for="item in generalItems"\n\t\t\t\t\t\t:key="item.dialogId"\n\t\t\t\t\t\t:item="item"\n\t\t\t\t\t\t@click="onClick(item)"\n\t\t\t\t\t\t@click.right="onRightClick(item, $event)"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<LoadingState v-if="isLoadingNextPage" />\n\t\t\t</div>\n\t\t</div>\n\t`};t.TaskList=d})(this.BX.Messenger.v2.Component.List=this.BX.Messenger.v2.Component.List||{},BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX.Messenger.v2.Component.Elements,BX.Messenger.v2.Component.List,BX.Messenger.v2.Component.List,BX.Messenger.v2.Const,BX.Messenger.v2.Service,BX.Messenger.v2.Lib);
//# sourceMappingURL=task-list.bundle.map.js