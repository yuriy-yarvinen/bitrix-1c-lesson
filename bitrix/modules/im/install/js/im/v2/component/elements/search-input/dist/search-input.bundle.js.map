{"version":3,"file":"search-input.bundle.js","sources":["../src/search-input.js"],"sourcesContent":["import { EventEmitter } from 'main.core.events';\n\nimport { EventType } from 'im.v2.const';\nimport { Utils } from 'im.v2.lib.utils';\nimport { EscEventAction } from 'im.v2.lib.esc-manager';\nimport { Spinner, SpinnerSize, SpinnerColor } from 'im.v2.component.elements.loader';\n\nimport './search-input.css';\n\nimport type { JsonObject } from 'main.core';\n\n// @vue/component\nexport const SearchInput = {\n\tname: 'SearchInput',\n\tcomponents: {\n\t\tSpinner,\n\t},\n\tprops: {\n\t\tplaceholder: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tsearchMode: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\twithIcon: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\twithLoader: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tdelayForFocusOnStart: {\n\t\t\ttype: Number || null,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\temits: ['queryChange', 'inputFocus', 'inputBlur', 'keyPressed', 'close', 'closeByEsc'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tquery: '',\n\t\t\thasFocus: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tSpinnerSize: () => SpinnerSize,\n\t\tSpinnerColor: () => SpinnerColor,\n\t\tisEmptyQuery(): boolean\n\t\t{\n\t\t\treturn this.query.length === 0;\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tsearchMode(newValue: boolean)\n\t\t{\n\t\t\tif (newValue === true)\n\t\t\t{\n\t\t\t\tthis.focus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.query = '';\n\t\t\t\tthis.blur();\n\t\t\t}\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe(EventType.key.onBeforeEscape, this.onBeforeEscape);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.key.onBeforeEscape, this.onBeforeEscape);\n\t},\n\tmounted()\n\t{\n\t\tif (this.delayForFocusOnStart === 0)\n\t\t{\n\t\t\tthis.focus();\n\t\t}\n\t\telse if (this.delayForFocusOnStart > 0)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.focus();\n\t\t\t}, this.delayForFocusOnStart);\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tonBeforeEscape(): boolean\n\t\t{\n\t\t\tif (!this.hasFocus)\n\t\t\t{\n\t\t\t\treturn EscEventAction.ignored;\n\t\t\t}\n\n\t\t\tif (this.isEmptyQuery)\n\t\t\t{\n\t\t\t\tthis.closeByEsc();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.onClearInput();\n\t\t\t}\n\n\t\t\treturn EscEventAction.handled;\n\t\t},\n\t\tonInputUpdate()\n\t\t{\n\t\t\tthis.$emit('queryChange', this.query);\n\t\t},\n\t\tonFocus()\n\t\t{\n\t\t\tthis.focus();\n\t\t\tthis.$emit('inputFocus');\n\t\t},\n\t\tonCloseClick()\n\t\t{\n\t\t\tthis.query = '';\n\t\t\tthis.hasFocus = false;\n\t\t\tthis.$emit('queryChange', this.query);\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tonClearInput()\n\t\t{\n\t\t\tthis.query = '';\n\t\t\tthis.focus();\n\t\t\tthis.$emit('queryChange', this.query);\n\t\t},\n\t\tonKeyUp(event: KeyboardEvent)\n\t\t{\n\t\t\tif (Utils.key.isCombination(event, 'Escape'))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('keyPressed', event);\n\t\t},\n\t\tcloseByEsc()\n\t\t{\n\t\t\tthis.query = '';\n\t\t\tthis.hasFocus = false;\n\t\t\tthis.$emit('queryChange', this.query);\n\t\t\tthis.$emit('closeByEsc');\n\t\t},\n\t\tfocus()\n\t\t{\n\t\t\tthis.hasFocus = true;\n\t\t\tthis.$refs.searchInput.focus();\n\t\t},\n\t\tblur()\n\t\t{\n\t\t\tthis.hasFocus = false;\n\t\t\tthis.$refs.searchInput.blur();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-search-input__scope bx-im-search-input__container\" :class=\"{'--has-focus': hasFocus}\">\n\t\t\t<div v-if=\"!isLoading\" class=\"bx-im-search-input__search-icon\"></div>\n\t\t\t<Spinner \n\t\t\t\tv-if=\"withLoader && isLoading\" \n\t\t\t\t:size=\"SpinnerSize.XXS\" \n\t\t\t\t:color=\"SpinnerColor.grey\" \n\t\t\t\tclass=\"bx-im-search-input__loader\"\n\t\t\t/>\n\t\t\t<input\n\t\t\t\t@focus=\"onFocus\"\n\t\t\t\t@input=\"onInputUpdate\"\n\t\t\t\t@keyup=\"onKeyUp\"\n\t\t\t\tv-model=\"query\"\n\t\t\t\tclass=\"bx-im-search-input__element\"\n\t\t\t\t:class=\"{'--with-icon': withIcon}\"\n\t\t\t\t:placeholder=\"placeholder\"\n\t\t\t\tref=\"searchInput\"\n\t\t\t/>\n\t\t\t<div v-if=\"hasFocus\" class=\"bx-im-search-input__close-icon\" @click=\"onCloseClick\"></div>\n\t\t</div>\n\t`,\n};\n"],"names":["SearchInput","name","components","Spinner","props","placeholder","type","String","default","searchMode","Boolean","withIcon","withLoader","isLoading","delayForFocusOnStart","Number","emits","data","query","hasFocus","computed","SpinnerSize","SpinnerColor","isEmptyQuery","length","watch","newValue","focus","blur","created","EventEmitter","subscribe","EventType","key","onBeforeEscape","beforeUnmount","unsubscribe","mounted","setTimeout","methods","EscEventAction","ignored","closeByEsc","onClearInput","handled","onInputUpdate","$emit","onFocus","onCloseClick","onKeyUp","event","Utils","isCombination","$refs","searchInput","template"],"mappings":"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"}