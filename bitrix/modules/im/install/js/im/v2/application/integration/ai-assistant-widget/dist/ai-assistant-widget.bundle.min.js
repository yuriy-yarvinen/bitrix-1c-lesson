this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};(function(t,e,i,s,n,a,o,r,d,h,c){"use strict";const l="IM.AiAssistantWidget:minimize";const g={name:"AiAssistantWidgetChatHeader",components:{ChatHeader:h.ChatHeader,BIcon:r.BIcon},props:{dialogId:{type:String,default:""}},computed:{OutlineIcons:()=>r.Outline,Color:()=>c.Color},methods:{onMinimize(){d.EventEmitter.emit(l)},loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<ChatHeader\n\t\t\t:dialogId="dialogId"\n\t\t\t:withCallButton="false"\n\t\t\t:withSearchButton="false"\n\t\t\t:withAddToChatButton="false"\n\t\t>\n\t\t\t<template #before-actions>\n\t\t\t\t<BIcon\n\t\t\t\t\t:name="OutlineIcons.CROSS_L"\n\t\t\t\t\t:hoverable="true"\n\t\t\t\t\t:color="Color.base4"\n\t\t\t\t\t:title="loc('IM_AI_ASSISTANT_WIDGET_MINIMIZE')"\n\t\t\t\t\tclass="bx-im-ai-assistant-chat-header__icon"\n\t\t\t\t\t@click="onMinimize"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</ChatHeader>\n\t`};const p={name:"AiAssistantWidgetChatContent",components:{AiAssistantWidgetChatHeader:g,AiAssistantBotContent:a.AiAssistantBotContent},props:{dialogId:{type:String,default:""},withSidebar:{type:Boolean,default:true}},created(){d.EventEmitter.subscribe(c.EventType.notifier.onBeforeShowMessage,this.onBeforeNotificationShow)},beforeUnmount(){d.EventEmitter.unsubscribe(c.EventType.notifier.onBeforeShowMessage,this.onBeforeNotificationShow)},methods:{onBeforeNotificationShow(t){const e=t.getData();if(e.dialogId!==this.dialogId){return o.NotifierShowMessageAction.show}return o.NotifierShowMessageAction.skip}},template:`\n\t\t<AiAssistantBotContent :dialogId="dialogId" :withSidebar="withSidebar">\n\t\t\t<template #header>\n\t\t\t\t<AiAssistantWidgetChatHeader :dialogId="dialogId"/>\n\t\t\t</template>\n\t\t</AiAssistantBotContent>\n\t`};const A={name:"AiAssistantWidgetChatOpener",components:{AiAssistantWidgetChatContent:p},props:{dialogId:{type:String,required:true}},computed:{dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},chatId(){return this.dialog.chatId}},created(){return this.onChatOpen()},methods:{async onChatOpen(){if(this.dialog.inited){s.Logger.warn(`AiAssistantChatOpener: chat ${this.chatId} is already loaded`);return}await this.loadChat()},async loadChat(){s.Logger.warn(`AiAssistantChatOpener: loading chat ${this.chatId}`);await this.getChatService().loadChatWithMessages(this.dialogId);s.Logger.warn(`AiAssistantChatOpener: chat ${this.chatId} is loaded`)},getChatService(){if(!this.chatService){this.chatSerivce=new n.ChatService}return this.chatSerivce}},template:`\n\t\t<div class="bx-im-messenger__scope bx-im-ai-assistant-chat-opener__container">\n\t\t\t<AiAssistantWidgetChatContent :dialogId="dialogId" :withSidebar="false"/>\n\t\t</div>\n\t`};const C="AiAssistantWidgetApplication";var u=babelHelpers.classPrivateFieldLooseKey("initPromise");var m=babelHelpers.classPrivateFieldLooseKey("init");class v{constructor(){Object.defineProperty(this,m,{value:B});Object.defineProperty(this,u,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,u)[u]=babelHelpers.classPrivateFieldLooseBase(this,m)[m]()}ready(){return babelHelpers.classPrivateFieldLooseBase(this,u)[u]}async mount(t){await this.ready();const{rootContainer:i,aiAssistantBotId:s,onError:n}=t;if(!i){return Promise.reject(new Error("Provide node or selector for root container"))}const a=s.toString();return e.Core.createVue(this,{name:C,el:i,onError:n,components:{AiAssistantWidgetChatOpener:A},template:`<AiAssistantWidgetChatOpener dialogId="${a}" />`})}}async function B(){await e.Core.ready();return this}t.AiAssistantWidgetApplication=v})(this.BX.Messenger.v2.Application=this.BX.Messenger.v2.Application||{},BX.Messenger.v2.Application,BX.Messenger.v2.Css,BX.Messenger.v2.Lib,BX.Messenger.v2.Service,BX.Messenger.v2.Component.Content,BX.Messenger.v2.Lib,BX.UI.IconSet,BX.Event,BX.Messenger.v2.Component.Content,BX.Messenger.v2.Const);
//# sourceMappingURL=ai-assistant-widget.bundle.map.js