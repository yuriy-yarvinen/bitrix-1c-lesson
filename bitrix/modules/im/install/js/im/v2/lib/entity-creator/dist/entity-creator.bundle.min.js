this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};(function(e,s,t,a,r,l,i,o){"use strict";const n="BX.Calendar:onEntrySave";var c=babelHelpers.classPrivateFieldLooseKey("chatId");var d=babelHelpers.classPrivateFieldLooseKey("restClient");var b=babelHelpers.classPrivateFieldLooseKey("onCalendarEntrySaveHandler");var p=babelHelpers.classPrivateFieldLooseKey("createMeeting");var v=babelHelpers.classPrivateFieldLooseKey("createAiText");var h=babelHelpers.classPrivateFieldLooseKey("createTask");var u=babelHelpers.classPrivateFieldLooseKey("requestPreparedParams");var P=babelHelpers.classPrivateFieldLooseKey("openTaskSlider");var B=babelHelpers.classPrivateFieldLooseKey("openTaskV2Card");var L=babelHelpers.classPrivateFieldLooseKey("openCalendarSlider");var F=babelHelpers.classPrivateFieldLooseKey("onCalendarEntrySave");class y{constructor(e){Object.defineProperty(this,F,{value:E});Object.defineProperty(this,L,{value:m});Object.defineProperty(this,B,{value:g});Object.defineProperty(this,P,{value:M});Object.defineProperty(this,u,{value:I});Object.defineProperty(this,h,{value:C});Object.defineProperty(this,v,{value:f});Object.defineProperty(this,p,{value:H});Object.defineProperty(this,c,{writable:true,value:0});Object.defineProperty(this,d,{writable:true,value:void 0});Object.defineProperty(this,b,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,d)[d]=i.Core.getRestClient();babelHelpers.classPrivateFieldLooseBase(this,c)[c]=e}createAiTextForChat(e){babelHelpers.classPrivateFieldLooseBase(this,v)[v](e)}createTaskForChat(){return babelHelpers.classPrivateFieldLooseBase(this,h)[h]()}createTaskForMessage(e){return babelHelpers.classPrivateFieldLooseBase(this,h)[h](e)}createMeetingForChat(){return babelHelpers.classPrivateFieldLooseBase(this,p)[p]()}createMeetingForMessage(e){return babelHelpers.classPrivateFieldLooseBase(this,p)[p](e)}}function H(e){const s={CHAT_ID:babelHelpers.classPrivateFieldLooseBase(this,c)[c]};if(e){s.MESSAGE_ID=e}return babelHelpers.classPrivateFieldLooseBase(this,u)[u](o.RestMethod.imChatCalendarPrepare,s).then((s=>{const{params:a}=s;babelHelpers.classPrivateFieldLooseBase(this,b)[b]=babelHelpers.classPrivateFieldLooseBase(this,F)[F].bind(this,a.sliderId,e);t.EventEmitter.subscribeOnce(n,babelHelpers.classPrivateFieldLooseBase(this,b)[b]);return babelHelpers.classPrivateFieldLooseBase(this,L)[L](a)}))}function f(e){const s=new a.Picker({startMessage:e,moduleId:"im",contextId:"im_menu_plus",history:true,onSelect:e=>{t.EventEmitter.emit(o.EventType.textarea.insertText,{text:e.data,replace:true})}});s.setLangSpace(a.Picker.LangSpace.text).text()}function C(e){const s={data:{chatId:babelHelpers.classPrivateFieldLooseBase(this,c)[c]}};if(e){s.data.messageId=e}return l.runAction(o.RestMethod.imV2ChatTaskPrepare,s).then((e=>{const{link:s,params:t}=e;return t.is_tasks_v2?babelHelpers.classPrivateFieldLooseBase(this,B)[B](t):babelHelpers.classPrivateFieldLooseBase(this,P)[P](s,t)}))}function I(e,s){return babelHelpers.classPrivateFieldLooseBase(this,d)[d].callMethod(e,s).then((e=>e.data())).catch((e=>{console.error(e)}))}function M(e,s){BX.SidePanel.Instance.open(e,{requestMethod:"post",requestParams:s,cacheable:false})}async function g(e){var t,a,r,l;const{TaskCard:i}=await s.Runtime.loadExtension("tasks.v2.application.task-card");const o=(t=e.entityId)!=null?t:null;const n=(a=e.subEntityId)!=null?a:null;const c=e.auditors?e.auditors.split(",").map((e=>parseInt(e.trim(),10))):[];i.showCompactCard({groupId:(r=e.groupId)!=null?r:null,description:(l=e.description)!=null?l:null,auditorsIds:c,fileIds:e.UF_TASK_WEBDAV_FILES,analytics:{context:e.ta_sec,element:e.ta_el},source:{type:"chat",entityId:o,subEntityId:n}})}function m(e){new(window.top.BX||window.BX).Calendar.SliderLoader(0,e).show()}function E(e,s,t){const a=t.getData();if(a.sliderId!==e){return}const r={CALENDAR_ID:a.responseData.entryId,CHAT_ID:babelHelpers.classPrivateFieldLooseBase(this,c)[c]};if(s){r.MESSAGE_ID=s}return babelHelpers.classPrivateFieldLooseBase(this,d)[d].callMethod(o.RestMethod.imChatCalendarAdd,r).catch((e=>{console.error(e)}))}e.EntityCreator=y})(this.BX.Messenger.v2.Lib=this.BX.Messenger.v2.Lib||{},BX,BX.Event,BX.AI,BX.Calendar,BX.Messenger.v2.Lib,BX.Messenger.v2.Application,BX.Messenger.v2.Const);
//# sourceMappingURL=entity-creator.bundle.map.js