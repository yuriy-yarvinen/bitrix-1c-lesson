{"version":3,"file":"main.bundle.js","sources":["../src/external.controls.js","../src/internal/has-block.js","../src/internal/has-create-button.js","../src/internal/on-animation-end.js","../src/internal/is-empty.js","../src/main.js"],"sourcesContent":["import { Dom } from 'main.core';\n\nimport { Main } from './main';\n\ntype Block = {\n\tid: number,\n\tstate: boolean,\n\tpermissions: {\n\t\tallowDesignBlock: boolean,\n\t\tallowModifyStyles: boolean,\n\t\tallowEditContent: boolean,\n\t\tallowSorting: boolean,\n\t\tallowRemove: boolean,\n\t\tallowChangeState: boolean,\n\t},\n};\n\ntype MobileTop = {\n\tblockId: number,\n\ttop: number,\n\theight: number,\n};\n\nexport class ExternalControls\n{\n\t#postMessages = {\n\t\tmode: 'mode',\n\t\tregister: 'register',\n\t\tchangeState: 'changestate',\n\t\teditorEnable: 'editorenable',\n\t\tshowControls: 'showcontrols',\n\t\tshowBlockControls: 'showblockcontrols',\n\t\thideAll: 'hideall',\n\t\tbackendAction: 'backendaction',\n\t};\n\n\t#currentMobileTop: number = -1;\n\t#mouseEntered: boolean = false;\n\t#disableControls: boolean = false;\n\t#currentMousePosition: number = 0;\n\t#blocksMobileTops: Array<MobileTop> = [];\n\n\tconstructor()\n\t{\n\t\tif (Main.isExternalControlsEnabled())\n\t\t{\n\t\t\tthis.#registerListeners();\n\t\t}\n\t}\n\n\t/**\n\t * Registers all required listeners.\n\t */\n\t#registerListeners()\n\t{\n\t\tsetTimeout(() => {\n\t\t\tthis.#registerBlocks();\n\t\t}, 0);\n\n\t\t// listening commands from outer frame\n\t\twindow.addEventListener('message', (event) => {\n\t\t\tif (this.isControlsExternal())\n\t\t\t{\n\t\t\t\tthis.listenExternalCommands(event.data.action, event.data.payload);\n\t\t\t}\n\t\t});\n\n\t\t// catching the mouse and scrolling\n\t\tdocument.addEventListener('mouseenter', (event) => {\n\t\t\tthis.#mouseEntered = true;\n\t\t});\n\t\tdocument.addEventListener('mouseleave', (event) => {\n\t\t\tthis.#mouseEntered = false;\n\t\t});\n\t\tdocument.addEventListener('mousemove', (event) => {\n\t\t\tthis.onMobileMouseMove(event.y);\n\t\t});\n\t\tdocument.addEventListener('scroll', () => {\n\t\t\tif (this.#mouseEntered)\n\t\t\t{\n\t\t\t\tthis.recalculateTopsIfExternals();\n\t\t\t}\n\t\t});\n\n\t\t// checking when external commands become enabled\n\t\tBX.addCustomEvent('BX.Landing.Main:changeControls', (type, topInPercent) =>\n\t\t{\n\t\t\tif (type === 'internal')\n\t\t\t{\n\t\t\t\tthis.postExternalCommand(this.#postMessages.hideAll, {});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// mode switching some time\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.recalculateTops(true);\n\t\t\t\t}, 400);\n\t\t\t}\n\t\t});\n\n\t\t// checking inline editor â€” enabled or disabled\n\t\tBX.addCustomEvent('BX.Landing.Editor:enable', () =>\n\t\t{\n\t\t\tthis.#disableControls = true;\n\t\t\tif (this.isControlsExternal())\n\t\t\t{\n\t\t\t\tthis.postExternalCommand(this.#postMessages.hideAll, {});\n\t\t\t}\n\t\t});\n\t\tBX.addCustomEvent('BX.Landing.Editor:disable', () =>\n\t\t{\n\t\t\tthis.#disableControls = false;\n\t\t\tthis.recalculateTopsIfExternals(true);\n\t\t});\n\n\t\t// checking that new block was added and any block changed its active status\n\t\tBX.addCustomEvent('BX.Landing.Block:onAfterAdd', (event) => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst blockData = event.getData();\n\t\t\t\tthis.#registerNewBlock(blockData.id);\n\t\t\t}, 500);\n\t\t});\n\t\tBX.addCustomEvent('BX.Landing.Block:changeState', (blockId, state) => {\n\t\t\tthis.postExternalCommand(this.#postMessages.changeState, { blockId, state });\n\t\t});\n\n\t\t// form's settings were opened and then closed\n\t\tBX.addCustomEvent('BX.Landing.Block:onFormSettingsOpen', () => {\n\t\t\tif (this.isControlsExternal())\n\t\t\t{\n\t\t\t\tthis.postExternalCommand(this.#postMessages.hideAll, {});\n\t\t\t}\n\t\t\tthis.#disableControls = true;\n\t\t});\n\t\tBX.addCustomEvent('BX.Landing.Block:onFormSettingsClose', (blockId) => {\n\t\t\t// after form completely closed\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.#disableControls = false;\n\t\t\t\tthis.recalculateTopsIfExternals(true);\n\t\t\t}, 400);\n\t\t\tthis.postExternalCommand(this.#postMessages.hideAll, {});\n\t\t});\n\t\tBX.addCustomEvent('BX.Landing.Block:onAfterFormSave', (blockId) =>\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.postExternalCommand(this.#postMessages.backendAction, {\n\t\t\t\t\taction: 'Landing\\\\Block::saveForm', data: {block: blockId},\n\t\t\t\t});\n\t\t\t}, 1000);\n\t\t});\n\t\tBX.addCustomEvent('BX.Landing.Block:onBlockEditClose', () => {\n\t\t\tthis.#disableControls = false;\n\t\t\tthis.recalculateTopsIfExternals(true);\n\t\t});\n\n\t\tBX.addCustomEvent('BX.Landing.Block:onContentSave', this.recalculateTopsIfExternals.bind(this));\n\t\tBX.addCustomEvent('BX.Landing.Block:onDesignerBlockSave', this.recalculateTopsIfExternals.bind(this));\n\t\tBX.addCustomEvent('BX.Landing.Block:Card:add', this.recalculateTopsIfExternals.bind(this));\n\t\tBX.addCustomEvent('BX.Landing.Block:Card:remove', this.recalculateTopsIfExternals.bind(this));\n\t\tBX.addCustomEvent('BX.Landing.Block:afterRemove', this.recalculateTopsIfExternals.bind(this));\n\t\tBX.addCustomEvent('BX.Landing.Backend:action', this.onBackendAction.bind(this));\n\t\tBX.addCustomEvent('BX.Landing.Backend:batch', this.onBackendAction.bind(this));\n\t}\n\n\t/**\n\t * Invokes when backend action occurred.\n\t */\n\tonBackendAction(action, data)\n\t{\n\t\tthis.#disableControls = false;\n\t\tthis.postExternalCommand(this.#postMessages.backendAction, { action, data });\n\t}\n\n\t/**\n\t * Creates and returns Block object for sending to external window.\n\t *\n\t * @param {BX.Landing.} block\n\t * @return {Block}\n\t */\n\t#createBlockObject(block: BX.Landing.Block): Block\n\t{\n\t\treturn {\n\t\t\tid: parseInt(block.id),\n\t\t\tstate: block.isEnabled(),\n\t\t\tpermissions: {\n\t\t\t\tallowDesignBlock: block.isDesignBlockAllowed(),\n\t\t\t\tallowModifyStyles: block.isStyleModifyAllowed(),\n\t\t\t\tallowEditContent: block.isEditBlockAllowed(),\n\t\t\t\tallowSorting: block.isEditBlockAllowed(),\n\t\t\t\tallowRemove: block.isRemoveBlockAllowed(),\n\t\t\t\tallowChangeState: block.isChangeStateBlockAllowed(),\n\t\t\t\tallowPaste: block.isPasteBlockAllowed(),\n\t\t\t\tallowSaveInLibrary: block.isSaveBlockInLibraryAllowed(),\n\t\t\t}\n\t\t};\n\t}\n\n\t/**\n\t * Registers all blocks on entire page.\n\t */\n\t#registerBlocks()\n\t{\n\t\tconst blocksCollection = BX.Landing.PageObject.getBlocks();\n\t\tconst data = [];\n\n\t\t[...blocksCollection].map(block => data.push(this.#createBlockObject(block)));\n\n\t\tthis.postExternalCommand(this.#postMessages.register, {\n\t\t\tblocks: data,\n\t\t});\n\t}\n\n\t/**\n\t * Registers new block.\n\t *\n\t * @param {number} blockId\n\t */\n\t#registerNewBlock(blockId: number)\n\t{\n\t\tconst block = BX.Landing.PageObject.getBlocks().get(blockId);\n\t\tif (block)\n\t\t{\n\t\t\tthis.postExternalCommand(this.#postMessages.register, {\n\t\t\t\tblocks: [this.#createBlockObject(block)],\n\t\t\t});\n\t\t\t// because new block adding some time\n\t\t\tif (this.isControlsExternal()) {\n\t\t\t\tthis.recalculateTops();\n\t\t\t} else {\n\t\t\t\tthis.postExternalCommand(this.#postMessages.hideAll, {});\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Checks that landing controls is external\n\t *\n\t * @return {boolean}\n\t */\n\tisControlsExternal()\n\t{\n\t\treturn Dom.hasClass(document.body, 'landing-ui-external-controls');\n\t}\n\n\t/**\n\t * Recalculates block tops.\n\t *\n\t * @param {boolean} resetMobileTop\n\t */\n\trecalculateTops(resetMobileTop: boolean)\n\t{\n\t\tthis.#blocksMobileTops = [];\n\n\t\tif (resetMobileTop)\n\t\t{\n\t\t\tthis.#currentMobileTop = -1;\n\t\t}\n\n\t\t[...document.body.querySelectorAll('.block-wrapper')].map(block => {\n\t\t\tconst blockRect = block.getBoundingClientRect();\n\t\t\tif (blockRect.height > 1)// hidden on mobile blocks\n\t\t\t{\n\t\t\t\tthis.#blocksMobileTops.push({\n\t\t\t\t\tblockId: parseInt(block.getAttribute('data-id')),\n\t\t\t\t\ttop: blockRect.top,\n\t\t\t\t\theight: blockRect.height,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.onMobileMouseMove(this.#currentMousePosition);\n\t}\n\n\t/**\n\t * Recalculates block tops only if external controls are enabled.\n\t *\n\t * @param {boolean} resetMobileTop\n\t */\n\trecalculateTopsIfExternals(resetMobileTop: boolean)\n\t{\n\t\tif (this.isControlsExternal())\n\t\t{\n\t\t\tthis.recalculateTops(resetMobileTop);\n\t\t}\n\t}\n\n\t/**\n\t * Call when user moves mouse over the mobile page.\n\t *\n\t * @param {number} top\n\t */\n\tonMobileMouseMove(top: number)\n\t{\n\t\tif (this.#disableControls || !this.isControlsExternal())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (top <= 0)\n\t\t{\n\t\t\tthis.#currentMobileTop = -1;\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#currentMousePosition = top;\n\n\t\tfor (let i = 0, c = this.#blocksMobileTops.length; i < c; i++)\n\t\t{\n\t\t\tif (\n\t\t\t\ttop >= this.#blocksMobileTops[i]['top']\n\t\t\t\t&& (!this.#blocksMobileTops[i+1] || top < this.#blocksMobileTops[i+1]['top'])\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (this.#blocksMobileTops[i]['top'] !== this.#currentMobileTop)\n\t\t\t\t{\n\t\t\t\t\tthis.#currentMobileTop = this.#blocksMobileTops[i]['top'];\n\n\t\t\t\t\tthis.postExternalCommand(this.#postMessages.showControls, {\n\t\t\t\t\t\tblockId: this.#blocksMobileTops[i]['blockId'],\n\t\t\t\t\t\ttop: this.#blocksMobileTops[i]['top'],\n\t\t\t\t\t\theight: this.#blocksMobileTops[i]['height'],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Sends action with payload to parent window.\n\t *\n\t * @param {string} action\n\t * @param {Object} payload\n\t */\n\tpostExternalCommand(action, payload)\n\t{\n\t\tif (window.parent)\n\t\t{\n\t\t\twindow.parent.postMessage({action, payload}, window.location.origin);\n\t\t}\n\t}\n\n\t/**\n\t * Receives actions with payload from parent window.\n\t *\n\t * @param {string} action\n\t * @param {Object} payload\n\t */\n\tlistenExternalCommands(action, payload)\n\t{\n\t\tconst block = BX.Landing.PageObject.getBlocks().get(\n\t\t\tpayload?.blockId ? payload.blockId : -1\n\t\t);\n\n\t\tif (payload?.blockId && !block)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst successCallback = () => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.#currentMousePosition = 0;\n\t\t\t\tthis.recalculateTops();\n\t\t\t}, 300);\n\t\t};\n\n\t\tswitch (action)\n\t\t{\n\t\t\tcase 'onDesignerBlockClick':\n\t\t\t{\n\t\t\t\tblock.onDesignerBlockClick();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'onEditBlockClick':\n\t\t\t{\n\t\t\t\tblock.onShowContentPanel();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'onStyleBlockClick':\n\t\t\t{\n\t\t\t\tblock.onStyleShow();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'onSortDownBlockClick':\n\t\t\t{\n\t\t\t\tblock.moveDown();\n\t\t\t\tsuccessCallback();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'onSortUpBlockClick':\n\t\t\t{\n\t\t\t\tblock.moveUp();\n\t\t\t\tsuccessCallback();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'onRemoveBlockClick':\n\t\t\t{\n\t\t\t\tblock.deleteBlock();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'onChangeStateBlockClick':\n\t\t\t{\n\t\t\t\tblock.onStateChange();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'onCutBlockClick':\n\t\t\t{\n\t\t\t\tMain.getInstance().onCutBlock.bind(Main.getInstance(), block)();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'onCopyBlockClick':\n\t\t\t{\n\t\t\t\tMain.getInstance().onCopyBlock.bind(Main.getInstance(), block)();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'onPasteBlockClick':\n\t\t\t{\n\t\t\t\tMain.getInstance().onPasteBlock.bind(\n\t\t\t\t\tMain.getInstance(),\n\t\t\t\t\tblock,\n\t\t\t\t\t(blockId) => {\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthis.#registerNewBlock(blockId);\n\t\t\t\t\t\t}, 300);\n\t\t\t\t\t}\n\t\t\t\t)();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'onFeedbackClick':\n\t\t\t{\n\t\t\t\tblock.showFeedbackForm();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'onSaveInLibraryClick':\n\t\t\t{\n\t\t\t\tblock.saveBlock();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'onHideEditorPanel':\n\t\t\t{\n\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n","/**\n * Checks that element contains block\n * @param {HTMLElement} element\n * @return {boolean}\n */\nexport default function hasBlock(element: HTMLElement): boolean\n{\n\treturn !!element && !!element.querySelector('.block-wrapper');\n}","/**\n * Checks that element contains \"Add new Block\" button\n * @param {HTMLElement} element\n * @return {boolean}\n */\nexport default function hasCreateButton(element: HTMLElement): boolean\n{\n\treturn !!element && !!element.querySelector('button[data-id=\"insert_first_block\"]');\n}","import {Event} from 'main.core';\n\nexport default function onAnimationEnd(element: HTMLElement, animationName: string)\n{\n\treturn new Promise(((resolve) => {\n\t\tconst onAnimationEndListener = (event) => {\n\t\t\tif (!animationName || (event.animationName === animationName))\n\t\t\t{\n\t\t\t\tresolve(event);\n\t\t\t\tEvent.bind(element, 'animationend', onAnimationEndListener);\n\t\t\t}\n\t\t};\n\n\t\tEvent.bind(element, 'animationend', onAnimationEndListener);\n\t}));\n}","import {Type} from 'main.core';\n\nexport default function isEmpty(value): boolean\n{\n\tif (Type.isNil(value))\n\t{\n\t\treturn true;\n\t}\n\n\tif (Type.isArrayLike(value))\n\t{\n\t\treturn !value.length;\n\t}\n\n\tif (Type.isObject(value))\n\t{\n\t\treturn Object.keys(value).length <= 0;\n\t}\n\n\treturn true;\n}","import { Type, Dom, Cache, Tag, Text, Runtime } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Env } from 'landing.env';\nimport { Loc } from 'landing.loc';\nimport { Content } from 'landing.ui.panel.content';\nimport { SaveBlock } from 'landing.ui.panel.saveblock';\nimport { SliderHacks } from 'landing.sliderhacks';\nimport { PageObject } from 'landing.pageobject';\nimport { Backend } from 'landing.backend';\nimport { ExternalControls } from './external.controls';\nimport hasBlock from './internal/has-block';\nimport hasCreateButton from './internal/has-create-button';\nimport onAnimationEnd from './internal/on-animation-end';\nimport isEmpty from './internal/is-empty';\n\nBX.Landing.getMode = () => 'edit';\n\n/**\n * @memberOf BX.Landing\n */\nexport class Main extends EventEmitter\n{\n\tstatic TYPE_PAGE = 'PAGE';\n\tstatic TYPE_STORE = 'STORE';\n\tstatic TYPE_KNOWLEDGE = 'KNOWLEDGE';\n\tstatic TYPE_GROUP = 'GROUP';\n\n\tstatic getMode()\n\t{\n\t\treturn 'edit';\n\t}\n\n\tstatic createInstance(id: number)\n\t{\n\t\tconst rootWindow = BX.Landing.PageObject.getRootWindow();\n\t\tif (rootWindow.BX.Landing.Main.instance)\n\t\t{\n\t\t\trootWindow.BX.Landing.Main.instance.clear();\n\t\t}\n\t\trootWindow.BX.Landing.Main.instance = new BX.Landing.Main(id);\n\t}\n\n\tstatic getInstance(): Main\n\t{\n\t\tconst rootWindow = BX.Landing.PageObject.getRootWindow();\n\t\trootWindow.BX.Reflection.namespace('BX.Landing.Main');\n\t\tif (rootWindow.BX.Landing.Main.instance)\n\t\t{\n\t\t\treturn rootWindow.BX.Landing.Main.instance;\n\t\t}\n\n\t\trootWindow.BX.Landing.Main.instance = new Main(-1);\n\n\t\treturn rootWindow.BX.Landing.Main.instance;\n\t}\n\n\t/**\n\t * Returns true, if current page is Editor.\n\t * @return {boolean}\n\t */\n\tstatic isEditorMode()\n\t{\n\t\treturn Dom.hasClass(document.body, 'landing-editor');\n\t}\n\n\t/**\n\t * Returns true, if external controls is enabled.\n\t * @return {boolean}\n\t */\n\tstatic isExternalControlsEnabled()\n\t{\n\t\treturn Dom.hasClass(document.body, 'enable-external-controls');\n\t}\n\n\t/**\n\t * Returns in percent scroll position of page.\n\t *\n\t * @return {number}\n\t */\n\tstatic topInPercent(): number\n\t{\n\t\tconst scrollHeight = Math.max(\n\t\t\tdocument.body.scrollHeight, document.documentElement.scrollHeight,\n\t\t\tdocument.body.offsetHeight, document.documentElement.offsetHeight,\n\t\t\tdocument.body.clientHeight, document.documentElement.clientHeight\n\t\t);\n\n\t\tconst scrollTop = document.documentElement.scrollTop || document.body.scrollTop;\n\n\t\treturn scrollTop / scrollHeight * 100;\n\t}\n\n\t/**\n\t * Maps site type to analytics category.\n\t *\n\t * @return {string}\n\t */\n\tstatic getAnalyticsCategoryByType()\n\t{\n\t\tconst siteType = BX.Landing.Env.getInstance().getType();\n\n\t\tswitch (siteType)\n\t\t{\n\t\t\tcase 'STORE':\n\t\t\t\treturn 'shop';\n\t\t\tcase 'KNOWLEDGE':\n\t\t\tcase 'GROUP':\n\t\t\t\treturn 'kb';\n\t\t\tcase 'MAINPAGE':\n\t\t\t\treturn 'vibe';\n\t\t\tdefault:\n\t\t\t\treturn 'site';\n\t\t}\n\t}\n\n\t/**\n\t * Landing ID\n\t * @type {number}\n\t */\n\tid: number;\n\n\tconstructor(id: number)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Landing.Main');\n\n\t\tconst options = Env.getInstance().getOptions();\n\n\t\tthis.id = id;\n\t\tthis.options = Object.freeze(options);\n\t\tthis.blocks = this.options.blocks;\n\t\tthis.currentBlock = null;\n\t\tthis.isDesignBlockModeFlag = this.options[\"design_block\"] === true;\n\t\tthis.loadedDeps = {};\n\t\tthis.cache = new Cache.MemoryCache();\n\t\tthis.externalControls = new ExternalControls;\n\n\t\tthis.onSliderFormLoaded = this.onSliderFormLoaded.bind(this);\n\t\tthis.onBlockDelete = this.onBlockDelete.bind(this);\n\n\t\tBX.addCustomEvent('Landing.Block:onAfterDelete', this.onBlockDelete);\n\n\t\tthis.adjustEmptyAreas();\n\n\t\tBX.Landing.UI.Panel.StatusPanel.setLastModified(options.lastModified);\n\t\tif (!this.isDesignBlockModeFlag)\n\t\t{\n\t\t\tBX.Landing.UI.Panel.StatusPanel.getInstance().show();\n\t\t}\n\n\t\tconst pageType = Env.getInstance().getType();\n\t\tif (\n\t\t\tpageType === Main.TYPE_KNOWLEDGE\n\t\t\t|| pageType === Main.TYPE_GROUP\n\t\t)\n\t\t{\n\t\t\tconst mainArea = document.querySelector('.landing-main');\n\t\t\tif (Type.isDomNode(mainArea))\n\t\t\t{\n\t\t\t\tDom.addClass(mainArea, 'landing-ui-collapse');\n\t\t\t}\n\t\t}\n\t}\n\n\tclear(): void\n\t{\n\t\tBX.removeCustomEvent('Landing.Block:onAfterDelete', this.onBlockDelete);\n\t}\n\n\tisCrmFormPage(): boolean\n\t{\n\t\treturn Env.getInstance().getSpecialType() === 'crm_forms';\n\t}\n\n\tisDesignBlockMode()\n\t{\n\t\treturn this.isDesignBlockModeFlag;\n\t}\n\n\tgetSaveBlockPanel(): Content\n\t{\n\t\tconst panel = new SaveBlock('save_block_panel', {block: this.currentBlock});\n\t\tpanel.layout.hidden = true;\n\t\tpanel.content.hidden = false;\n\t\tDom.append(panel.layout, window.parent.document.body);\n\n\t\treturn panel;\n\t}\n\n\tgetBlocksPanel(): Content\n\t{\n\t\treturn this.cache.remember('blockPanel', () => {\n\t\t\tconst blocksPanel = this.createBlocksPanel();\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (blocksPanel.sidebarButtons.get(this.options.default_section))\n\t\t\t\t{\n\t\t\t\t\tblocksPanel.sidebarButtons.get(this.options.default_section).layout.click();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t[...blocksPanel.sidebarButtons][0].layout.click();\n\t\t\t\t}\n\t\t\t});\n\t\t\tblocksPanel.layout.hidden = true;\n\t\t\tblocksPanel.content.hidden = false;\n\t\t\tDom.append(blocksPanel.layout, window.parent.document.body);\n\n\t\t\treturn blocksPanel;\n\t\t});\n\t}\n\n\tgetBlocksPanelContent(): Content\n\t{\n\t\treturn this.getBlocksPanel().content;\n\t}\n\n\thideBlocksPanel()\n\t{\n\t\tif (this.getBlocksPanel())\n\t\t{\n\t\t\treturn this.getBlocksPanel().hide();\n\t\t}\n\n\t\treturn Promise.resolve();\n\t}\n\n\tgetLayoutAreas(): Array<HTMLElement>\n\t{\n\t\treturn this.cache.remember('layoutAreas', () => {\n\t\t\treturn [\n\t\t\t\t...document.body.querySelectorAll('.landing-header'),\n\t\t\t\t...document.body.querySelectorAll('.landing-sidebar'),\n\t\t\t\t...document.body.querySelectorAll('.landing-main'),\n\t\t\t\t...document.body.querySelectorAll('.landing-footer'),\n\t\t\t];\n\t\t});\n\t}\n\n\t/**\n\t * Creates insert block button\n\t * @param {HTMLElement} area\n\t * @return {BX.Landing.UI.Button.Plus}\n\t */\n\tcreateInsertBlockButton(area: HTMLElement)\n\t{\n\t\tconst button = new BX.Landing.UI.Button.Plus('insert_first_block', {\n\t\t\ttext: Loc.getMessage('ACTION_BUTTON_CREATE'),\n\t\t});\n\n\t\tbutton.on('click', this.showBlocksPanel.bind(this, null, area, button));\n\t\tbutton.on('mouseover', this.onCreateButtonMouseover.bind(this, area, button));\n\t\tbutton.on('mouseout', this.onCreateButtonMouseout.bind(this, area, button));\n\n\t\treturn button;\n\t}\n\n\tonCreateButtonMouseover(area: HTMLElement, button)\n\t{\n\t\tif (\n\t\t\tDom.hasClass(area, 'landing-header')\n\t\t\t|| Dom.hasClass(area, 'landing-footer')\n\t\t)\n\t\t{\n\t\t\tconst areas = this.getLayoutAreas();\n\n\t\t\tif (areas.length > 1)\n\t\t\t{\n\t\t\t\tconst createText = Loc.getMessage('ACTION_BUTTON_CREATE');\n\n\t\t\t\tif (Dom.hasClass(area, 'landing-main'))\n\t\t\t\t{\n\t\t\t\t\tbutton.setText(\n\t\t\t\t\t\t`${createText} ${Loc.getMessage('LANDING_ADD_BLOCK_TO_MAIN')}`,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (Dom.hasClass(area, 'landing-header'))\n\t\t\t\t{\n\t\t\t\t\tbutton.setText(\n\t\t\t\t\t\t`${createText} ${Loc.getMessage('LANDING_ADD_BLOCK_TO_HEADER')}`,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (Dom.hasClass(area, 'landing-sidebar'))\n\t\t\t\t{\n\t\t\t\t\tbutton.setText(\n\t\t\t\t\t\t`${createText} ${Loc.getMessage('LANDING_ADD_BLOCK_TO_SIDEBAR')}`,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (Dom.hasClass(area, 'landing-footer'))\n\t\t\t\t{\n\t\t\t\t\tbutton.setText(\n\t\t\t\t\t\t`${createText} ${Loc.getMessage('LANDING_ADD_BLOCK_TO_FOOTER')}`,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tclearTimeout(this.fadeTimeout);\n\t\t\t\tthis.fadeTimeout = setTimeout(() => {\n\t\t\t\t\tDom.addClass(area, 'landing-area-highlight');\n\n\t\t\t\t\tareas\n\t\t\t\t\t\t.filter((currentArea) => currentArea !== area)\n\t\t\t\t\t\t.forEach((currentArea) => {\n\t\t\t\t\t\t\tDom.addClass(currentArea, 'landing-area-fade');\n\t\t\t\t\t\t});\n\t\t\t\t}, 400);\n\t\t\t}\n\t\t}\n\t}\n\n\tonCreateButtonMouseout(area, button)\n\t{\n\t\tclearTimeout(this.fadeTimeout);\n\n\t\tif (Dom.hasClass(area, 'landing-header')\n\t\t\t|| Dom.hasClass(area, 'landing-footer'))\n\t\t{\n\t\t\tconst areas = this.getLayoutAreas();\n\n\t\t\tif (areas.length > 1)\n\t\t\t{\n\t\t\t\tbutton.setText(Loc.getMessage('ACTION_BUTTON_CREATE'));\n\t\t\t\tareas.forEach((currentArea) => {\n\t\t\t\t\tDom.removeClass(currentArea, 'landing-area-highlight');\n\t\t\t\t\tDom.removeClass(currentArea, 'landing-area-fade');\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tinitEmptyArea(area: HTMLElement)\n\t{\n\t\tif (area)\n\t\t{\n\t\t\tarea.innerHTML = '';\n\t\t\tDom.append(this.createInsertBlockButton(area).layout, area);\n\t\t\tDom.addClass(area, 'landing-empty');\n\t\t}\n\t}\n\n\n\t// eslint-disable-next-line class-methods-use-this\n\tdestroyEmptyArea(area: HTMLElement)\n\t{\n\t\tif (area)\n\t\t{\n\t\t\tconst button = area.querySelector('button[data-id=\"insert_first_block\"]');\n\n\t\t\tif (button)\n\t\t\t{\n\t\t\t\tDom.remove(button);\n\t\t\t}\n\n\t\t\tDom.removeClass(area, 'landing-empty');\n\t\t}\n\t}\n\n\n\t/**\n\t * Adjusts areas\n\t */\n\tadjustEmptyAreas()\n\t{\n\t\tthis.getLayoutAreas()\n\t\t\t.filter((area) => {\n\t\t\t\treturn hasBlock(area) && hasCreateButton(area);\n\t\t\t})\n\t\t\t.forEach(this.destroyEmptyArea, this);\n\n\t\tthis.getLayoutAreas()\n\t\t\t.filter((area) => {\n\t\t\t\treturn !hasBlock(area) && !hasCreateButton(area);\n\t\t\t})\n\t\t\t.forEach(this.initEmptyArea, this);\n\n\t\tconst main = document.body.querySelector('main.landing-edit-mode');\n\t\tconst isAllEmpty = !this.getLayoutAreas().some(hasBlock);\n\n\t\tif (main)\n\t\t{\n\t\t\tif (isAllEmpty)\n\t\t\t{\n\t\t\t\tDom.addClass(main, 'landing-empty');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.removeClass(main, 'landing-empty');\n\t\t}\n\t}\n\n\n\t/**\n\t * Enables landing controls\n\t */\n\t// eslint-disable-next-line class-methods-use-this\n\tenableControls()\n\t{\n\t\tDom.removeClass(document.body, 'landing-ui-hide-controls');\n\t}\n\n\n\t/**\n\t * Disables landing controls\n\t */\n\t// eslint-disable-next-line class-methods-use-this\n\tdisableControls()\n\t{\n\t\tDom.addClass(document.body, 'landing-ui-hide-controls');\n\t}\n\n\n\t/**\n\t * Checks that landing controls is enabled\n\t * @return {boolean}\n\t */\n\t// eslint-disable-next-line class-methods-use-this\n\tisControlsEnabled()\n\t{\n\t\treturn !Dom.hasClass(document.body, 'landing-ui-hide-controls');\n\t}\n\n\t/**\n\t * Makes landing controls internal.\n\t */\n\t// eslint-disable-next-line class-methods-use-this\n\tmakeControlsInternal()\n\t{\n\t\tBX.onCustomEvent('BX.Landing.Main:changeControls', ['internal', Main.topInPercent()]);\n\t\tDom.removeClass(document.body, 'landing-ui-external-controls');\n\t}\n\n\t/**\n\t * Makes landing controls external.\n\t */\n\t// eslint-disable-next-line class-methods-use-this\n\tmakeControlsExternal()\n\t{\n\t\tBX.onCustomEvent('BX.Landing.Main:changeControls', ['external', Main.topInPercent()]);\n\t\tDom.addClass(document.body, 'landing-ui-external-controls');\n\t}\n\n\t/**\n\t * Checks that landing controls is external.\n\t * @return {boolean}\n\t */\n\t// eslint-disable-next-line class-methods-use-this\n\tisControlsExternal()\n\t{\n\t\treturn Dom.hasClass(document.body, 'landing-ui-external-controls');\n\t}\n\n\t/**\n\t * Set device code in body data-attribute.\n\t * @param {string} code\n\t */\n\tsetDeviceCode(code: string)\n\t{\n\t\tdocument.body.setAttribute('data-device', code);\n\t}\n\n\t/**\n\t * Get device code from body attribute.\n\t * @return {string}\n\t */\n\tgetDeviceCode(): ?string\n\t{\n\t\treturn document.body.getAttribute('data-device');\n\t}\n\n\t/**\n\t * Set BX classes to mark this landing frame as mobile (touch) device\n\t */\n\tsetTouchDevice()\n\t{\n\t\tDom.removeClass(document.documentElement, 'bx-no-touch');\n\t\tDom.addClass(document.documentElement, 'bx-touch');\n\t}\n\n\t/**\n\t * Set BX classes to mark this landing frame as desktop (no touch) device\n\t */\n\tsetNoTouchDevice()\n\t{\n\t\tDom.removeClass(document.documentElement, 'bx-touch');\n\t\tDom.addClass(document.documentElement, 'bx-no-touch');\n\t}\n\n\n\t/**\n\t * Appends block\n\t * @param {addBlockResponse} data\n\t * @param {boolean} [withoutAnimation]\n\t * @returns {HTMLElement}\n\t */\n\tappendBlock(data, withoutAnimation)\n\t{\n\t\tif (!this.isAllowedAppendBlock(data))\n\t\t{\n\t\t\treturn Tag.render``;\n\t\t}\n\n\t\tconst block = Tag.render`${data.content}`;\n\t\tblock.id = `block${data.id}`;\n\n\t\tif (!withoutAnimation)\n\t\t{\n\t\t\tDom.addClass(block, 'landing-ui-show');\n\t\t\tonAnimationEnd(block, 'showBlock').then(() => {\n\t\t\t\tDom.removeClass(block, 'landing-ui-show');\n\t\t\t});\n\t\t}\n\n\t\tthis.insertToBlocksFlow(block);\n\n\t\treturn block;\n\t}\n\n\t/**\n\t * Check if the block can be appended\n\t * @param {addBlockResponse} data\n\t * @returns {boolean} - Returns true if the block can be appended, otherwise false\n\t */\n\tisAllowedAppendBlock(data)\n\t{\n\t\tconst type = BX.Landing.Env.getInstance().getType().toLowerCase();\n\t\tlet allowedBlockTypes = data.manifest.block.type ?? [];\n\t\tif (\n\t\t\ttype === 'mainpage'\n\t\t\t|| allowedBlockTypes.includes('mainpage')\n\t\t)\n\t\t{\n\t\t\tif (Type.isString(allowedBlockTypes))\n\t\t\t{\n\t\t\t\tallowedBlockTypes = [allowedBlockTypes];\n\t\t\t}\n\n\t\t\tif (!allowedBlockTypes.includes(type))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\n\t/**\n\t * Shows blocks list panel\n\t * @param {BX.Landing.Block} block\n\t * @param {HTMLElement} [area]\n\t * @param [button]\n\t * @param [insertBefore]\n\t */\n\tshowBlocksPanel(block, area, button, insertBefore)\n\t{\n\t\tBX.UI.Analytics.sendData({\n\t\t\ttool: 'landing',\n\t\t\tcategory: BX.Landing.Main.getAnalyticsCategoryByType(),\n\t\t\tevent: 'open_list',\n\t\t});\n\n\t\tthis.currentBlock = block;\n\t\tthis.currentArea = area;\n\t\tthis.insertBefore = insertBefore;\n\n\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\n\t\tif (this.isCrmFormPage() || this.isControlsExternal())\n\t\t{\n\t\t\tconst rootWindow = PageObject.getRootWindow();\n\t\t\tDom.append(this.getBlocksPanel().layout, rootWindow.document.body);\n\t\t\tDom.append(this.getBlocksPanel().overlay, rootWindow.document.body);\n\t\t}\n\n\t\tthis.getBlocksPanel().show();\n\t\tthis.disableAddBlockButtons();\n\n\t\tif (!!area && !!button)\n\t\t{\n\t\t\tthis.onCreateButtonMouseout(area, button);\n\t\t}\n\t}\n\n\tshowSaveBlock(block)\n\t{\n\t\tthis.currentBlock = block;\n\t\tthis.getSaveBlockPanel().show();\n\t}\n\n\tdisableAddBlockButtons()\n\t{\n\t\tPageObject.getBlocks().forEach((block) => {\n\t\t\tconst panel = block.panels.get('create_action');\n\t\t\tif (panel)\n\t\t\t{\n\t\t\t\tconst button = panel.buttons.get('insert_after');\n\t\t\t\tif (button)\n\t\t\t\t{\n\t\t\t\t\tbutton.disable();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tenableAddBlockButtons()\n\t{\n\t\tPageObject.getBlocks().forEach((block) => {\n\t\t\tconst panel = block.panels.get('create_action');\n\t\t\tif (panel)\n\t\t\t{\n\t\t\t\tconst button = panel.buttons.get('insert_after');\n\t\t\t\tif (button)\n\t\t\t\t{\n\t\t\t\t\tbutton.enable();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Creates blocks list panel\n\t * @returns {BX.Landing.UI.Panel.Content}\n\t */\n\tcreateBlocksPanel()\n\t{\n\t\tconst {blocks} = this.options;\n\t\tconst categories = Object.keys(blocks);\n\n\t\tconst panel = new Content('blocks_panel', {\n\t\t\ttitle: Loc.getMessage('LANDING_CONTENT_BLOCKS_TITLE'),\n\t\t\tclassName: 'landing-ui-panel-block-list',\n\t\t\tscrollAnimation: true,\n\t\t});\n\n\t\tpanel.subscribe('onCancel', () => {\n\t\t\tthis.enableAddBlockButtons();\n\t\t});\n\n\t\tcategories.forEach((categoryId) => {\n\t\t\tconst hasItems = !isEmpty(blocks[categoryId].items);\n\t\t\tconst isPopular = categoryId === 'popular';\n\t\t\tconst isSeparator = blocks[categoryId].separator;\n\t\t\tconst isFavourite = categoryId === 'favourite';\n\n\t\t\tif ((hasItems && !isPopular) || isSeparator || isFavourite)\n\t\t\t{\n\t\t\t\tpanel.appendSidebarButton(\n\t\t\t\t\tthis.createBlockPanelSidebarButton(categoryId, blocks[categoryId]),\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\n\t\tpanel.appendSidebarButton(\n\t\t\tnew BX.Landing.UI.Button.SidebarButton('feedback_button', {\n\t\t\t\tclassName: 'landing-ui-button-sidebar-feedback',\n\t\t\t\ttext: Loc.getMessage('LANDING_BLOCKS_LIST_FEEDBACK_BUTTON'),\n\t\t\t\tonClick: this.showFeedbackForm.bind(this),\n\t\t\t}),\n\t\t);\n\n\t\treturn panel;\n\t}\n\n\n\t/**\n\t * Shows feedback form\n\t * @param data\n\t */\n\tshowSliderFeedbackForm(data = {})\n\t{\n\t\tRuntime.loadExtension('ui.feedback.form').then(() => {\n\t\t\tconst data = {};\n\t\t\tdata.bitrix24 = this.options.server_name;\n\t\t\tdata.siteId = this.options.site_id;\n\t\t\tdata.siteUrl = this.options.url;\n\t\t\tdata.siteTemplate = this.options.xml_id;\n\t\t\tdata.productType = this.options.productType || 'Undefined';\n\t\t\tdata.typeproduct = (() =>\n\t\t\t{\n\t\t\t\tif (this.options.params.type === Main.TYPE_GROUP)\n\t\t\t\t{\n\t\t\t\t\treturn 'KNOWLEDGE_GROUP';\n\t\t\t\t}\n\n\t\t\t\treturn this.options.params.type;\n\t\t\t})();\n\n\t\t\tBX.UI.Feedback.Form.open(\n\t\t\t\t{\n\t\t\t\t\tid: Math.random()+'',\n\t\t\t\t\tforms: this.getFeedbackFormOptions(),\n\t\t\t\t\tpresets: data,\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\n\t}\n\n\n\t/**\n\t * Gets feedback form options\n\t * @return {{id: string, sec: string, lang: string}}\n\t */\n\t// eslint-disable-next-line class-methods-use-this\n\tgetFeedbackFormOptions()\n\t{\n\t\treturn [\n\t\t\t{zones: ['en', 'eu', 'in', 'uk'], id: 16, lang: 'en', sec: '3h483y'},\n\t\t\t{zones: ['ru', 'by', 'kz'], id: 8, lang: 'ru', sec: 'x80yjw'},\n\t\t\t{zones: ['ua'], id: 18, lang: 'ua', sec: 'd9e09o'},\n\t\t\t{zones: ['la', 'co', 'mx'], id: 14, lang: 'la', sec: 'wu561i'},\n\t\t\t{zones: ['de'], id: 10, lang: 'de', sec: 'eraz2q'},\n\t\t\t{zones: ['com.br', 'br'], id: 12, lang: 'br', sec: 'r6wvge'},\n\t\t];\n\t}\n\n\n\t/**\n\t * Handles feedback loaded event\n\t */\n\tonSliderFormLoaded()\n\t{\n\t\tthis.sliderFormLoader.hide();\n\t}\n\n\n\t/**\n\t * Shows feedback form for blocks list panel\n\t */\n\tshowFeedbackForm()\n\t{\n\t\tthis.showSliderFeedbackForm({target: 'blocksList'});\n\t}\n\n\n\t/**\n\t * Creates blocks list panel sidebar button\n\t * @param {string} category\n\t * @param {object} options\n\t * @returns {BX.Landing.UI.Button.SidebarButton}\n\t */\n\tcreateBlockPanelSidebarButton(category, options)\n\t{\n\t\treturn new BX.Landing.UI.Button.SidebarButton(category, {\n\t\t\ttext: options.name,\n\t\t\tchild: !options.separator,\n\t\t\tclassName: options.new ? 'landing-ui-new-section' : '',\n\t\t\tonClick: this.onBlocksListCategoryChange.bind(this, category),\n\t\t});\n\t}\n\n\t/**\n\t * Adds dynamically new block to the category.\n\t * @param {string} category Category code.\n\t * @param {{code: string, name: string, preview: string, section: Array<string>}} block Block data.\n\t */\n\taddNewBlockToCategory(category, block)\n\t{\n\t\tif (this.blocks[category])\n\t\t{\n\t\t\tconst blockCode = block['codeOriginal'] || block['code'];\n\t\t\tif (category === 'last')\n\t\t\t{\n\t\t\t\tif (!this.lastBlocks)\n\t\t\t\t{\n\t\t\t\t\tthis.lastBlocks = Object.keys(this.blocks.last.items);\n\t\t\t\t}\n\t\t\t\tthis.lastBlocks.unshift(blockCode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.blocks[category].items[blockCode] = block;\n\t\t\t}\n\t\t\tthis.onBlocksListCategoryChange(category);\n\t\t}\n\t}\n\n\tremoveBlockFromList(blockCode: string)\n\t{\n\t\tlet removed = false;\n\t\tfor (let category in this.blocks)\n\t\t{\n\t\t\tif (this.blocks[category].items[blockCode] !== undefined)\n\t\t\t{\n\t\t\t\tdelete this.blocks[category].items[blockCode];\n\t\t\t\tremoved = true;\n\t\t\t}\n\t\t}\n\t\tif (this.lastBlocks.indexOf(blockCode) !== -1)\n\t\t{\n\t\t\tthis.lastBlocks.splice(this.lastBlocks.indexOf(blockCode), 1);\n\t\t\tremoved = true;\n\t\t}\n\n\t\t// refresh panel\n\t\tif (removed)\n\t\t{\n\t\t\tconst activeCategoryButton = this.getBlocksPanel().sidebarButtons.find((button) => {\n\t\t\t\treturn Dom.hasClass(button.layout, 'landing-ui-active');\n\t\t\t});\n\t\t\tif (activeCategoryButton)\n\t\t\t{\n\t\t\t\tthis.onBlocksListCategoryChange(activeCategoryButton.id);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Returns page's template code if exists.\n\t * @return {string|null}\n\t */\n\tgetTemplateCode()\n\t{\n\t\tlet { tplCode } = Env.getInstance().getOptions();\n\t\tif (tplCode.indexOf('@') > 0)\n\t\t{\n\t\t\ttplCode = tplCode.split('@')[1];\n\t\t}\n\t\tif (!tplCode || tplCode.length <= 0)\n\t\t{\n\t\t\ttplCode = null;\n\t\t}\n\t\treturn tplCode;\n\t}\n\n\n\t/**\n\t * Handles event on blocks list category change\n\t * @param {string} category - Category id\n\t */\n\tasync onBlocksListCategoryChange(category)\n\t{\n\t\tthis.currentCategory = category;\n\n\t\tif (this.currentCategory === 'favourite')\n\t\t{\n\t\t\tBX.UI.Analytics.sendData({\n\t\t\t\ttool: 'landing',\n\t\t\t\tcategory: BX.Landing.Main.getAnalyticsCategoryByType(),\n\t\t\t\tevent: 'click_on_favourite',\n\t\t\t});\n\t\t}\n\n\t\tconst templateCode = this.getTemplateCode();\n\t\tthis.getBlocksPanel().content.hidden = false;\n\n\t\tthis.getBlocksPanel().sidebarButtons.forEach((button) => {\n\t\t\tconst action = button.id === category ? 'add' : 'remove';\n\t\t\tbutton.layout.classList[action]('landing-ui-active');\n\t\t});\n\n\t\tthis.getBlocksPanel().content.innerHTML = '';\n\n\t\tconst loader = new BX.Loader({\n\t\t\ttarget: this.getBlocksPanel().content,\n\t\t\tsize: 90,\n\t\t});\n\t\tloader.show();\n\n\t\ttry\n\t\t{\n\t\t\tthis.favouriteBlocks = await BX.Landing.Backend.getInstance()\n\t\t\t\t.action('Landing::getFavouriteBlocks');\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tconsole.warn('Failed to fetch favourite blocks', e);\n\t\t\tthis.favouriteBlocks = [];\n\t\t}\n\n\t\tloader.hide();\n\n\t\tif (category === 'last')\n\t\t{\n\t\t\tif (!this.lastBlocks)\n\t\t\t{\n\t\t\t\tthis.lastBlocks = Object.keys(this.blocks.last.items);\n\t\t\t}\n\n\t\t\tthis.lastBlocks = [...new Set(this.lastBlocks)];\n\n\t\t\tthis.lastBlocks.forEach((blockKey) => {\n\t\t\t\tconst block = this.getBlockFromRepository(blockKey);\n\t\t\t\tif (block)\n\t\t\t\t{\n\t\t\t\t\tblock.currentCategory = category;\n\t\t\t\t\tthis.getBlocksPanel().appendCard(this.createBlockCard(blockKey, block));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (category === 'favourite')\n\t\t{\n\t\t\tif (!this.favouriteBlocks)\n\t\t\t{\n\t\t\t\tthis.favouriteBlocks = Object.keys(this.blocks.favourite.items);\n\t\t\t}\n\n\t\t\tconst blockCards = [];\n\t\t\tthis.favouriteBlocks = [...new Set(this.favouriteBlocks)];\n\t\t\tthis.favouriteBlocks.forEach((blockKey) => {\n\t\t\t\tconst block = this.getBlockFromRepository(blockKey);\n\t\t\t\tif (block)\n\t\t\t\t{\n\t\t\t\t\tblock.currentCategory = category;\n\t\t\t\t\tblockCards.push(this.createBlockCard(blockKey, block));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (blockCards.length === 0)\n\t\t\t{\n\t\t\t\tDom.append(this.createFavouriteCategoryEmptyState(), this.getBlocksPanelContent());\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tblockCards.forEach((blockCard) => {\n\t\t\t\tthis.getBlocksPanel().appendCard(blockCard);\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tObject.keys(this.blocks[category].items).forEach((blockKey) => {\n\t\t\tconst block = this.blocks[category].items[blockKey];\n\t\t\tconst blockTplCode = (block['tpl_code'] && block['tpl_code'].length > 0) ? block['tpl_code'] : null;\n\t\t\tif (\n\t\t\t\t!templateCode || !blockTplCode ||\n\t\t\t\t(blockTplCode && blockTplCode === templateCode)\n\t\t\t)\n\t\t\t{\n\t\t\t\tblock.currentCategory = category;\n\t\t\t\tthis.getBlocksPanel().appendCard(this.createBlockCard(blockKey, block));\n\t\t\t}\n\t\t});\n\n\t\tif (this.getBlocksPanel().content.scrollTop)\n\t\t{\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tthis.getBlocksPanel().content.scrollTop = 0;\n\t\t\t});\n\t\t}\n\t}\n\n\t// eslint-disable-next-line consistent-return\n\tgetBlockFromRepository(code)\n\t{\n\t\tconst {blocks} = this.options;\n\t\tconst categories = Object.keys(blocks);\n\t\tconst category = categories.find((categoryId) => {\n\t\t\treturn code in blocks[categoryId].items;\n\t\t});\n\n\t\tif (category)\n\t\t{\n\t\t\treturn blocks[category].items[code];\n\t\t}\n\t}\n\n\t/**\n\t * Handles copy block event\n\t * @param {BX.Landing.Block} block\n\t */\n\t// eslint-disable-next-line class-methods-use-this\n\tonCopyBlock(block)\n\t{\n\t\twindow.localStorage.landingBlockId = block.id;\n\t\twindow.localStorage.landingBlockName = block.manifest.block.name;\n\t\twindow.localStorage.landingBlockAction = 'copy';\n\n\t\ttry\n\t\t{\n\t\t\twindow.localStorage.requiredUserAction = JSON.stringify(\n\t\t\t\tblock.requiredUserActionOptions,\n\t\t\t);\n\t\t}\n\t\tcatch (err)\n\t\t{\n\t\t\twindow.localStorage.requiredUserAction = '';\n\t\t}\n\t}\n\n\n\t/**\n\t * Handles cut block event\n\t * @param {BX.Landing.Block} block\n\t */\n\t// eslint-disable-next-line class-methods-use-this\n\tonCutBlock(block)\n\t{\n\t\twindow.localStorage.landingBlockId = block.id;\n\t\twindow.localStorage.landingBlockName = block.manifest.block.name;\n\t\twindow.localStorage.landingBlockAction = 'cut';\n\n\t\ttry\n\t\t{\n\t\t\twindow.localStorage.requiredUserAction = JSON.stringify(\n\t\t\t\tblock.requiredUserActionOptions,\n\t\t\t);\n\t\t}\n\t\tcatch (err)\n\t\t{\n\t\t\twindow.localStorage.requiredUserAction = '';\n\t\t}\n\n\t\tBX.Landing.PageObject.getBlocks().remove(block);\n\t\tDom.remove(block.node);\n\t\tBX.onCustomEvent('Landing.Block:onAfterDelete', [block]);\n\t}\n\n\n\t/**\n\t * Handles paste block event\n\t * @param {BX.Landing.Block} block\n\t * @param {() => {}} callback\n\t */\n\tonPasteBlock(block, callback)\n\t{\n\t\tif (window.localStorage.landingBlockId)\n\t\t{\n\t\t\tlet action = 'Landing::copyBlock';\n\n\t\t\tif (window.localStorage.landingBlockAction === 'cut')\n\t\t\t{\n\t\t\t\taction = 'Landing::moveBlock';\n\t\t\t}\n\n\t\t\tconst requestBody = {};\n\n\t\t\trequestBody[action] = {\n\t\t\t\taction,\n\t\t\t\tdata: {\n\t\t\t\t\tlid: block.lid || BX.Landing.Main.getInstance().id,\n\t\t\t\t\tblock: window.localStorage.landingBlockId,\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tAFTER_ID: block.id,\n\t\t\t\t\t\tRETURN_CONTENT: 'Y',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tBackend.getInstance()\n\t\t\t\t.batch(action, requestBody, {action})\n\t\t\t\t.then((res) => {\n\t\t\t\t\tthis.currentBlock = block;\n\t\t\t\t\treturn this.addBlock(res[action].result.content, false, false, callback);\n\t\t\t\t});\n\t\t}\n\t}\n\n\n\t/**\n\t * Adds block from server response\n\t * @param {addBlockResponse} res\n\t * @param {boolean} [withoutAnimation = false]\n\t * @param {boolean} [insertBefore = false]\n\t * @param {() => {}} callback\n\t * @return {Promise<T>}\n\t */\n\taddBlock(res, withoutAnimation, insertBefore = false, callback)\n\t{\n\t\tif (this.lastBlocks)\n\t\t{\n\t\t\tthis.lastBlocks.unshift(res.manifest.codeOriginal || res.manifest.code);\n\t\t}\n\n\t\tconst self = this;\n\t\tconst block = this.appendBlock(res, withoutAnimation);\n\n\t\treturn this.loadBlockDeps(res)\n\t\t\t.then((blockRes) => {\n\t\t\t\tself.currentBlock = null;\n\t\t\t\tself.currentArea = null;\n\n\t\t\t\tconst blockId = parseInt(res.id);\n\t\t\t\tconst allOldBlocks = BX.Landing.PageObject.getBlocks();\n\t\t\t\tif (allOldBlocks)\n\t\t\t\t{\n\t\t\t\t\tallOldBlocks.forEach((oldBlock) => {\n\t\t\t\t\t\tif (oldBlock.id === blockId)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.remove(oldBlock.node);\n\t\t\t\t\t\t\tBX.Landing.PageObject.getBlocks().remove(oldBlock);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// Init block entity\n\t\t\t\tvoid new BX.Landing.Block(block, {\n\t\t\t\t\tid: blockId,\n\t\t\t\t\tsections: res.sections,\n\t\t\t\t\trequiredUserAction: res.requiredUserAction,\n\t\t\t\t\tmanifest: res.manifest,\n\t\t\t\t\taccess: res.access,\n\t\t\t\t\tactive: Text.toBoolean(res.active),\n\t\t\t\t\tphp: res.php,\n\t\t\t\t\tdesigned: res.designed,\n\t\t\t\t\tanchor: res.anchor,\n\t\t\t\t\tdynamicParams: res.dynamicParams,\n\t\t\t\t\trepoId: res.repoId,\n\t\t\t\t});\n\n\t\t\t\treturn self.runBlockScripts(res)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tif (callback)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcallback(blockId);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn block;\n\t\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tconsole.warn(err);\n\t\t\t});\n\t}\n\n\n\t/**\n\t * Handles edd block event\n\t * @param {string} blockCode\n\t * @param {*} [restoreId]\n\t * @param {?boolean} [preventHistory = false]\n\t * @return {Promise<BX.Landing.Block>}\n\t */\n\tonAddBlock(blockCode, restoreId, preventHistory: ?boolean  = false)\n\t{\n\t\tconst id = Text.toNumber(restoreId);\n\t\tthis.hideBlocksPanel();\n\n\t\treturn this.showBlockLoader()\n\t\t\t.then(this.loadBlock(blockCode, id, preventHistory))\n\t\t\t.then((res) => {\n\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tresolve(res);\n\t\t\t\t\t}, 500);\n\t\t\t\t});\n\t\t\t})\n\t\t\t.then((res) => {\n\t\t\t\tres.manifest.codeOriginal = blockCode;\n\t\t\t\tconst p = this.addBlock(res, false, this.insertBefore);\n\t\t\t\tthis.insertBefore = false;\n\t\t\t\tthis.adjustEmptyAreas();\n\t\t\t\tvoid this.hideBlockLoader();\n\t\t\t\tthis.enableAddBlockButtons();\n\t\t\t\tBX.onCustomEvent('BX.Landing.Block:onAfterAdd', res);\n\n\t\t\t\treturn p;\n\t\t\t});\n\t}\n\n\n\t/**\n\t * Inserts element to blocks flow.\n\t * Element can be inserted after current block or after last block\n\t * @param {HTMLElement} element\n\t */\n\tinsertToBlocksFlow(element)\n\t{\n\t\tconst isCurrentBlockAvailable = (\n\t\t\tthis.currentBlock\n\t\t\t&& this.currentBlock.node\n\t\t\t&& this.currentBlock.node.parentNode\n\t\t);\n\n\t\tif (isCurrentBlockAvailable && !this.insertBefore)\n\t\t{\n\t\t\tDom.insertAfter(element, this.currentBlock.node);\n\t\t\treturn;\n\t\t}\n\n\t\tif (isCurrentBlockAvailable && this.insertBefore)\n\t\t{\n\t\t\tDom.insertBefore(element, this.currentBlock.node);\n\t\t}\n\n\t\tDom.prepend(element, this.currentArea);\n\t}\n\n\n\t/**\n\t * Gets block loader\n\t * @return {HTMLElement}\n\t */\n\tgetBlockLoader()\n\t{\n\t\tif (!this.blockLoader)\n\t\t{\n\t\t\tthis.blockLoader = new BX.Loader({size: 60});\n\t\t\tthis.blockLoaderContainer = Dom.create('div', {\n\t\t\t\tprops: {className: 'landing-block-loader-container'},\n\t\t\t\tchildren: [this.blockLoader.layout],\n\t\t\t});\n\t\t}\n\n\t\treturn this.blockLoaderContainer;\n\t}\n\n\n\t/**\n\t * Shows block loader\n\t * @return {Function}\n\t */\n\tshowBlockLoader()\n\t{\n\t\tthis.insertToBlocksFlow(this.getBlockLoader());\n\t\tthis.blockLoader.show();\n\t\treturn Promise.resolve();\n\t}\n\n\n\t/**\n\t * Hides block loader\n\t * @return {Function}\n\t */\n\thideBlockLoader()\n\t{\n\t\tDom.remove(this.getBlockLoader());\n\t\tthis.blockLoader = null;\n\t\treturn Promise.resolve();\n\t}\n\n\n\t/**\n\t * Loads block dependencies\n\t * @param {addBlockResponse} data\n\t * @returns {Promise<addBlockResponse>}\n\t */\n\tloadBlockDeps(data)\n\t{\n\t\tconst ext = BX.processHTML(data.content_ext);\n\n\t\tif (BX.type.isArray(ext.SCRIPT))\n\t\t{\n\t\t\text.SCRIPT = ext.SCRIPT.filter((item) => {\n\t\t\t\treturn !item.isInternal;\n\t\t\t});\n\t\t}\n\n\t\tif (BX.type.isObject(data.lang))\n\t\t{\n\t\t\tLoc.setMessage(data.lang);\n\t\t}\n\n\t\tlet loadedScripts = 0;\n\t\tconst scriptsCount = (data.js.length + ext.SCRIPT.length + ext.STYLE.length + data.css.length);\n\t\tlet resPromise = null;\n\n\t\tif (!this.loadedDeps[data.manifest.code] && scriptsCount > 0)\n\t\t{\n\t\t\tresPromise = new Promise(((resolve) => {\n\t\t\t\tfunction onLoad()\n\t\t\t\t{\n\t\t\t\t\tloadedScripts += 1;\n\n\t\t\t\t\tif (loadedScripts === scriptsCount)\n\t\t\t\t\t{\n\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (scriptsCount > loadedScripts)\n\t\t\t\t{\n\t\t\t\t\t// Load extensions files\n\t\t\t\t\text.SCRIPT.forEach((item) => {\n\t\t\t\t\t\tif (!item.isInternal)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.loadScript(item.JS, onLoad);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\text.STYLE.forEach((item) => {\n\t\t\t\t\t\tBX.loadScript(item, onLoad);\n\t\t\t\t\t});\n\n\t\t\t\t\t// Load block files\n\t\t\t\t\tdata.css.forEach((item) => {\n\t\t\t\t\t\tBX.loadScript(item, onLoad);\n\t\t\t\t\t});\n\n\t\t\t\t\tdata.js.forEach((item) => {\n\t\t\t\t\t\tBX.loadScript(item, onLoad);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tonLoad();\n\t\t\t\t}\n\n\t\t\t\tthis.loadedDeps[data.manifest.code] = true;\n\t\t\t}));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresPromise = Promise.resolve(data);\n\t\t}\n\n\t\treturn resPromise.then(data => {\n\t\t\tif (BX.type.isArray(data.assetStrings))\n\t\t\t{\n\t\t\t\tconst head = document.head;\n\t\t\t\tdata.assetStrings.forEach(string => {\n\t\t\t\t\tconst element = Tag.render`${string}`;\n\t\t\t\t\tDom.insertAfter(element, head.lastChild);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn data;\n\t\t});\n\t}\n\n\t/**\n\t * Executes block scripts\n\t * @param data\n\t * @return {Promise}\n\t */\n\t// eslint-disable-next-line class-methods-use-this\n\trunBlockScripts(data)\n\t{\n\t\treturn new Promise(((resolve) => {\n\t\t\tconst scripts = BX.processHTML(data.content).SCRIPT;\n\n\t\t\tif (scripts.length)\n\t\t\t{\n\t\t\t\tBX.ajax.processScripts(scripts, undefined, () => {\n\t\t\t\t\tresolve(data);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve(data);\n\t\t\t}\n\t\t}));\n\t}\n\n\n\t/**\n\t * Load new block from server\n\t * @param {string} blockCode\n\t * @param {int} [restoreId]\n\t * @param {boolean} [preventHistory = false]\n\t * @returns {Function}\n\t */\n\tloadBlock(blockCode, restoreId, preventHistory)\n\t{\n\t\treturn () => {\n\t\t\tlet lid = this.id;\n\t\t\tlet siteId = this.options.site_id;\n\n\t\t\tif (this.currentBlock)\n\t\t\t{\n\t\t\t\tlid = this.currentBlock.lid;\n\t\t\t\tsiteId = this.currentBlock.siteId;\n\t\t\t}\n\n\t\t\tif (this.currentArea)\n\t\t\t{\n\t\t\t\tlid = Dom.attr(this.currentArea, 'data-landing');\n\t\t\t\tsiteId = Dom.attr(this.currentArea, 'data-site');\n\t\t\t}\n\n\t\t\tlet requestBody = {\n\t\t\t\tlid,\n\t\t\t\tsiteId,\n\t\t\t\tpreventHistory: preventHistory ? 1 : 0,\n\t\t\t};\n\n\t\t\tconst fields = {\n\t\t\t\tACTIVE: 'Y',\n\t\t\t\tCODE: blockCode,\n\t\t\t\tAFTER_ID: this.currentBlock ? this.currentBlock.id : 0,\n\t\t\t\tRETURN_CONTENT: 'Y',\n\t\t\t\tCATEGORY: this.currentCategory,\n\t\t\t};\n\n\t\t\tif (!Type.isBoolean(preventHistory) || preventHistory === false)\n\t\t\t{\n\t\t\t\t// Change history steps\n\t\t\t\tBX.Landing.History.getInstance().push();\n\t\t\t}\n\n\t\t\tif (!restoreId)\n\t\t\t{\n\t\t\t\trequestBody.fields = fields;\n\t\t\t\treturn Backend\n\t\t\t\t\t.getInstance()\n\t\t\t\t\t.action('Landing::addBlock', requestBody, {code: blockCode})\n\t\t\t\t\t.then(result => {\n\t\t\t\t\t\tif (this.insertBefore)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn Backend\n\t\t\t\t\t\t\t\t.getInstance()\n\t\t\t\t\t\t\t\t.action('Landing::upBlock', {\n\t\t\t\t\t\t\t\t\tlid,\n\t\t\t\t\t\t\t\t\tsiteId,\n\t\t\t\t\t\t\t\t\tblock: result.id,\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn Backend.getInstance()\n\t\t\t\t.action('Block::getContent', {\n\t\t\t\t\tblock: restoreId,\n\t\t\t\t\tlid,\n\t\t\t\t\tfields,\n\t\t\t\t\teditMode: 1,\n\t\t\t\t})\n\t\t\t\t.then((res) => {\n\t\t\t\t\tres.id = restoreId;\n\t\t\t\t\treturn res;\n\t\t\t\t});\n\t\t};\n\t}\n\n\n\t/**\n\t * Creates block preview card\n\t * @param {string} blockKey - Block key (folder name)\n\t * @param {{name: string, [preview]: ?string, [new]: ?boolean}} block - Object with block data\n\t * @param {string} [mode]\n\t * @returns {BX.Landing.UI.Card.BlockPreviewCard}\n\t */\n\tcreateBlockCard(blockKey, block, mode)\n\t{\n\t\treturn new BX.Landing.UI.Card.BlockPreviewCard({\n\t\t\ttitle: block.name,\n\t\t\timage: block.preview,\n\t\t\tcode: blockKey,\n\t\t\tapp_expired: block.app_expired,\n\t\t\tfavorite: !!block.favorite,\n\t\t\tfavoriteMy: !!block.favoriteMy,\n\t\t\trepo_id: block.repo_id,\n\t\t\tmode,\n\t\t\tisNew: block.new === true,\n\t\t\tonClick: this.onAddBlock.bind(this, blockKey),\n\t\t\tcurrentCategory: block.currentCategory,\n\t\t\tuseFavouriteBadge: true,\n\t\t\tisFavorite: Array.isArray(this.favouriteBlocks) && this.favouriteBlocks.includes(blockKey),\n\t\t});\n\t}\n\n\tcreateFavouriteCategoryEmptyState()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"landing-favourite-category-empty-state text-center\">\n\t\t\t\t<img \n\t\t\t\t\tclass=\"landing-favourite-category-empty-state--image\" \n\t\t\t\t\tsrc=\"/bitrix/images/landing/empty-favourite.png\" \n\t\t\t\t\tstyle=\"margin-bottom: 14px;\"\n\t\t\t\t/>\n\t\t\t\t<p \n\t\t\t\t\tclass=\"landing-favourite-category-empty-state--title\"\n\t\t\t\t\tstyle=\"color: #333333; font-weight: 500; font-size: 19px; line-height: 26px; margin-bottom: 10px;\"\n\t\t\t\t>\n\t\t\t\t\t${Loc.getMessage('LANDING_SECTION_FAVOURITE_EMPTY_STATE_TITLE')}\n\t\t\t\t</p>\n\t\t\t\t<p \n\t\t\t\t\tclass=\"landing-favourite-category-empty-state--text\"\n\t\t\t\t\tstyle=\"color: #414A56; font-weight: 400; font-size: 16px; line-height: 21px; max-width: 340px; margin: auto;\"\n\t\t\t\t>\n\t\t\t\t\t${Loc.getMessage('LANDING_SECTION_FAVOURITE_EMPTY_STATE_TEXT')}\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\n\t/**\n\t * Handles block delete event\n\t */\n\tonBlockDelete(block)\n\t{\n\t\tif (!block.parent.querySelector('.block-wrapper'))\n\t\t{\n\t\t\tthis.adjustEmptyAreas();\n\t\t}\n\t}\n\n\n\t/**\n\t * Shows page overlay\n\t */\n\t// eslint-disable-next-line class-methods-use-this\n\tshowOverlay()\n\t{\n\t\tconst main = document.querySelector('main.landing-edit-mode');\n\t\tif (main)\n\t\t{\n\t\t\tDom.addClass(main, 'landing-ui-overlay');\n\t\t}\n\t}\n\n\t/**\n\t * Hides page overlay\n\t */\n\t// eslint-disable-next-line class-methods-use-this\n\thideOverlay()\n\t{\n\t\tconst main = document.querySelector('main.landing-edit-mode');\n\t\tif (main)\n\t\t{\n\t\t\tDom.removeClass(main, 'landing-ui-overlay');\n\t\t}\n\t}\n\n\treloadSlider(url: string): Promise<any>\n\t{\n\t\treturn SliderHacks.reloadSlider(url, window.parent);\n\t}\n}"],"names":["ExternalControls","mode","register","changeState","editorEnable","showControls","showBlockControls","hideAll","backendAction","Main","isExternalControlsEnabled","action","data","postExternalCommand","Dom","hasClass","document","body","resetMobileTop","querySelectorAll","map","block","blockRect","getBoundingClientRect","height","push","blockId","parseInt","getAttribute","top","onMobileMouseMove","isControlsExternal","recalculateTops","i","c","length","payload","window","parent","postMessage","location","origin","BX","Landing","PageObject","getBlocks","get","successCallback","setTimeout","onDesignerBlockClick","onShowContentPanel","onStyleShow","moveDown","moveUp","deleteBlock","onStateChange","getInstance","onCutBlock","bind","onCopyBlock","onPasteBlock","showFeedbackForm","saveBlock","UI","Panel","EditorPanel","hide","addEventListener","event","listenExternalCommands","y","recalculateTopsIfExternals","addCustomEvent","type","topInPercent","blockData","getData","id","state","onBackendAction","isEnabled","permissions","allowDesignBlock","isDesignBlockAllowed","allowModifyStyles","isStyleModifyAllowed","allowEditContent","isEditBlockAllowed","allowSorting","allowRemove","isRemoveBlockAllowed","allowChangeState","isChangeStateBlockAllowed","allowPaste","isPasteBlockAllowed","allowSaveInLibrary","isSaveBlockInLibraryAllowed","blocksCollection","blocks","hasBlock","element","querySelector","hasCreateButton","onAnimationEnd","animationName","Promise","resolve","onAnimationEndListener","Event","isEmpty","value","Type","isNil","isArrayLike","isObject","Object","keys","getMode","rootWindow","getRootWindow","instance","clear","Reflection","namespace","scrollHeight","Math","max","documentElement","offsetHeight","clientHeight","scrollTop","siteType","Env","getType","setEventNamespace","options","getOptions","freeze","currentBlock","isDesignBlockModeFlag","loadedDeps","cache","Cache","MemoryCache","externalControls","onSliderFormLoaded","onBlockDelete","adjustEmptyAreas","StatusPanel","setLastModified","lastModified","show","pageType","TYPE_KNOWLEDGE","TYPE_GROUP","mainArea","isDomNode","addClass","removeCustomEvent","getSpecialType","panel","SaveBlock","layout","hidden","content","append","remember","blocksPanel","createBlocksPanel","sidebarButtons","default_section","click","getBlocksPanel","area","button","Button","Plus","text","Loc","getMessage","on","showBlocksPanel","onCreateButtonMouseover","onCreateButtonMouseout","areas","getLayoutAreas","createText","setText","clearTimeout","fadeTimeout","filter","currentArea","forEach","removeClass","innerHTML","createInsertBlockButton","remove","destroyEmptyArea","initEmptyArea","main","isAllEmpty","some","onCustomEvent","code","setAttribute","withoutAnimation","isAllowedAppendBlock","Tag","render","then","insertToBlocksFlow","toLowerCase","allowedBlockTypes","manifest","includes","isString","insertBefore","Analytics","sendData","tool","category","getAnalyticsCategoryByType","isCrmFormPage","overlay","disableAddBlockButtons","getSaveBlockPanel","panels","buttons","disable","enable","categories","Content","title","className","scrollAnimation","subscribe","enableAddBlockButtons","categoryId","hasItems","items","isPopular","isSeparator","separator","isFavourite","appendSidebarButton","createBlockPanelSidebarButton","SidebarButton","onClick","Runtime","loadExtension","bitrix24","server_name","siteId","site_id","siteUrl","url","siteTemplate","xml_id","productType","typeproduct","params","Feedback","Form","open","random","forms","getFeedbackFormOptions","presets","zones","lang","sec","sliderFormLoader","showSliderFeedbackForm","target","name","child","onBlocksListCategoryChange","blockCode","lastBlocks","last","unshift","removed","undefined","indexOf","splice","activeCategoryButton","find","tplCode","split","currentCategory","templateCode","getTemplateCode","classList","loader","Loader","size","Backend","favouriteBlocks","console","warn","Set","blockKey","getBlockFromRepository","appendCard","createBlockCard","favourite","blockCards","createFavouriteCategoryEmptyState","getBlocksPanelContent","blockCard","blockTplCode","requestAnimationFrame","localStorage","landingBlockId","landingBlockName","landingBlockAction","requiredUserAction","JSON","stringify","requiredUserActionOptions","err","node","callback","requestBody","lid","AFTER_ID","RETURN_CONTENT","batch","res","addBlock","result","codeOriginal","self","appendBlock","loadBlockDeps","blockRes","allOldBlocks","oldBlock","Block","sections","access","active","Text","toBoolean","php","designed","anchor","dynamicParams","repoId","runBlockScripts","restoreId","preventHistory","toNumber","hideBlocksPanel","showBlockLoader","loadBlock","p","hideBlockLoader","isCurrentBlockAvailable","parentNode","insertAfter","prepend","blockLoader","blockLoaderContainer","create","props","children","getBlockLoader","ext","processHTML","content_ext","isArray","SCRIPT","item","isInternal","setMessage","loadedScripts","scriptsCount","js","STYLE","css","resPromise","onLoad","loadScript","JS","assetStrings","head","string","lastChild","scripts","ajax","processScripts","attr","fields","ACTIVE","CODE","CATEGORY","isBoolean","History","editMode","Card","BlockPreviewCard","image","preview","app_expired","favorite","favoriteMy","repo_id","isNew","onAddBlock","useFavouriteBadge","isFavorite","Array","SliderHacks","reloadSlider","EventEmitter"],"mappings":"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"}