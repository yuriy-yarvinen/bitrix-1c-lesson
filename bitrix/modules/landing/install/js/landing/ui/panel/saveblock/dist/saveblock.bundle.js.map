{"version":3,"file":"saveblock.bundle.js","sources":["../src/saveblock.js"],"sourcesContent":["import {Backend} from 'landing.backend';\nimport {Env} from 'landing.env';\nimport {ImageCompressor} from 'landing.imagecompressor';\nimport {Loc} from 'landing.loc';\nimport {Main} from 'landing.main';\nimport {Screenshoter} from 'landing.screenshoter';\nimport {MessageCard} from 'landing.ui.card.messagecard';\nimport {TextField} from 'landing.ui.field.textfield';\nimport {Content} from 'landing.ui.panel.content';\nimport {Dom, Cache, Tag} from 'main.core';\n\nimport 'translit';\nimport './css/style.css';\n\n/**\n * @memberOf BX.Landing.UI.Panel\n */\nexport class SaveBlock extends Content\n{\n\tstatic getInstance(): SaveBlock\n\t{\n\t\tif (!SaveBlock.instance)\n\t\t{\n\t\t\tSaveBlock.instance = new SaveBlock('landing_save_block_panel');\n\t\t}\n\n\t\treturn SaveBlock.instance;\n\t}\n\n\tcache = new Cache.MemoryCache();\n\tbock = null;\n\tpreviewFileIds = [];\n\n\tconstructor(id, data)\n\t{\n\t\tdata = data || {};\n\t\tdata.title = Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_TITLE_MSGVER_1');\n\t\tdata.showFromRight = true;\n\n\t\tif (!data.block)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsuper(id, data);\n\t\tthis.block = data.block;\n\t\tthis.mainInstance = Main.getInstance();\n\n\t\tDom.addClass(this.layout, 'landing-ui-panel-save-block');\n\t\tDom.addClass(this.overlay, 'landing-ui-panel-save-block');\n\n\t\tthis.setButtons();\n\t\tthis.renderTo(window.parent.document.body);\n\t}\n\n\tsetButtons()\n\t{\n\t\tthis.appendFooterButton(\n\t\t\tnew BX.Landing.UI.Button.BaseButton('save_block_content', {\n\t\t\t\ttext: Loc.getMessage('BLOCK_SAVE'),\n\t\t\t\tonClick: this.onSave.bind(this),\n\t\t\t\tclassName: 'landing-ui-button-content-save',\n\t\t\t}),\n\t\t);\n\t\tthis.appendFooterButton(\n\t\t\tnew BX.Landing.UI.Button.BaseButton('cancel_block_content', {\n\t\t\t\ttext: Loc.getMessage('BLOCK_CANCEL'),\n\t\t\t\tonClick: this.hide.bind(this),\n\t\t\t\tclassName: 'landing-ui-button-content-cancel',\n\t\t\t}),\n\t\t);\n\t}\n\n\tgetTitleField(): TextField\n\t{\n\t\treturn this.cache.remember('titleField', () => {\n\t\t\treturn new TextField({\n\t\t\t\ttitle: Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_FIELD_TITLE'),\n\t\t\t\ttextOnly: true\n\t\t\t});\n\t\t});\n\t}\n\n\tgetSectionsField(): BX.Landing.UI.Field.MultiSelect\n\t{\n\t\treturn this.cache.remember('sectionsField', () => {\n\t\t\tconst items = [];\n\t\t\tconst { blocks } = Env.getInstance().getOptions();\n\t\t\tObject.keys(blocks).map(key => {\n\t\t\t\tif (key !== 'last' && key !== 'favourite' && key !== 'separator_apps' && key.indexOf('.') === -1)\n\t\t\t\t{\n\t\t\t\t\titems.push({value: key, name: blocks[key].name});\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn new BX.Landing.UI.Field.MultiSelect({\n\t\t\t\ttitle: Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_FIELD_SECTIONS'),\n\t\t\t\titems\n\t\t\t});\n\t\t});\n\t}\n\n\tgetTemplateRefField(): BX.Landing.UI.Field.Checkbox\n\t{\n\t\treturn this.cache.remember('templateRefField', () => {\n\t\t\treturn new BX.Landing.UI.Field.Checkbox({\n\t\t\t\titems: [\n\t\t\t\t\t{value: 'N', name: Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_FIELD_TEMPLATE_REF')}\n\t\t\t\t]\n\t\t\t});\n\t\t});\n\t}\n\n\tgetPreviewField()\n\t{\n\t\treturn this.cache.remember('preview', () => {\n\t\t\treturn new BX.Landing.UI.Field.Image({\n\t\t\t\ttitle: Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_FIELD_PREVIEW'),\n\t\t\t\tdisableLink: true,\n\t\t\t\tdisableAltField: true,\n\t\t\t\tuploadParams: {\n\t\t\t\t\taction: 'Block::uploadFile',\n\t\t\t\t\tblock: this.block.id\n\t\t\t\t},\n\t\t\t\tcontent: {\n\t\t\t\t\tsrc: '/bitrix/images/1.gif',\n\t\t\t\t\tid : -1,\n\t\t\t\t\talt : ''\n\t\t\t\t},\n\t\t\t\tdimensions: {\n\t\t\t\t\twidth: 1200,\n\t\t\t\t\theight: 600\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tgetMessage(): MessageCard\n\t{\n\t\treturn this.cache.remember('message', () => {\n\t\t\treturn new MessageCard({\n\t\t\t\tid: 'fieldsMessage',\n\t\t\t\theader: Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_MESSAGE_TITLE_MSGVER_1'),\n\t\t\t\tdescription: Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_MESSAGE_TEXT_MSGVER_1'),\n\t\t\t\t//icon: messageIcon,\n\t\t\t\trestoreState: true\n\t\t\t});\n\t\t});\n\t}\n\n\tgetForm(): BX.Landing.UI.Form.BaseForm\n\t{\n\t\treturn this.cache.remember('form', () => {\n\t\t\treturn new BX.Landing.UI.Form.BaseForm({\n\t\t\t\tfields: [\n\t\t\t\t\tthis.getTitleField(),\n\t\t\t\t\tthis.getSectionsField(),\n\t\t\t\t\tthis.mainInstance.getTemplateCode() ? this.getTemplateRefField() : null,\n\t\t\t\t\tthis.getPreviewField()\n\t\t\t\t]\n\t\t\t});\n\t\t});\n\t}\n\n\tmakeScreenshot()\n\t{\n\t\tthis.getPreviewField().showLoader();\n\n\t\tvoid Screenshoter\n\t\t\t.makeBlockScreenshot(this.block.id)\n\t\t\t.then((sourceFile) => {\n\t\t\t\treturn ImageCompressor.compress(sourceFile, {\n\t\t\t\t\tmaxWidth: 830,\n\t\t\t\t\tmaxHeight: 300,\n\t\t\t\t});\n\t\t\t})\n\t\t\t.then((compressedFile) => {\n\t\t\t\treturn Backend\n\t\t\t\t\t.getInstance()\n\t\t\t\t\t.upload(compressedFile, {\n\t\t\t\t\t\tblock: this.block.id,\n\t\t\t\t\t\ttemp: true\n\t\t\t\t\t});\n\t\t\t})\n\t\t\t.then((response: {id: string, src: string}) => {\n\t\t\t\tthis.getPreviewField().setValue(response);\n\t\t\t\tthis.getPreviewField().hideLoader();\n\t\t\t});\n\t}\n\n\tshow(options?: any): Promise<any>\n\t{\n\t\tDom.style(this.footer, 'display', null);\n\n\t\tthis.getTitleField().setValue(this.block?.manifest?.block?.name);\n\t\tthis.getSectionsField().setValue(this.block?.manifest?.block?.section || []);\n\t\tthis.getTemplateRefField().setValue(['Y']);\n\t\tthis.getPreviewField().setValue({src: this.block?.manifest?.preview || this.block?.manifest?.block?.preview || ''});\n\n\t\tthis.makeScreenshot();\n\n\t\tthis.clear();\n\t\tDom.prepend(this.getMessage().getLayout(), this.content);\n\t\tthis.appendForm(this.getForm());\n\t\treturn super.show();\n\t}\n\n\tgetFailMessage()\n\t{\n\t\treturn this.cache.remember('failMessage', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"landing-ui-panel-save-block-fail\">\n\t\t\t\t\t<div class=\"landing-ui-panel-save-block-fail-header\">\n\t\t\t\t\t\t${Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_FAIL_MESSAGE_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tonSave()\n\t{\n\t\tconst backend = Backend.getInstance();\n\t\tconst title = this.getTitleField().getValue();\n\t\tconst templateRef = this.getTemplateRefField().getValue().length > 0;\n\t\tconst preview = this.getPreviewField().getValue();\n\t\tconst blockCode = this.block?.manifest?.code;\n\t\tlet sections = this.getSectionsField().getValue();\n\n\t\tthis.clear();\n\t\tthis.hide();\n\n\t\tif (!blockCode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tbackend.action(\n\t\t\t'Landing::favoriteBlock',\n\t\t\t{\n\t\t\t\tlid: this.block.lid,\n\t\t\t\tblock: this.block.id,\n\t\t\t\tmeta: {\n\t\t\t\t\tname: title,\n\t\t\t\t\tsection: sections,\n\t\t\t\t\tpreview: Math.max(preview.id, 0),\n\t\t\t\t\ttpl_code: templateRef ? this.mainInstance.getTemplateCode() : null\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tcode: blockCode\n\t\t\t}\n\t\t).then((newBlockId) => {\n\t\t\tif (newBlockId)\n\t\t\t{\n\t\t\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage('LANDING_SAVE_BLOCK_PANEL_SUCCESS')\n\t\t\t\t});\n\t\t\t\tsections.push('last');\n\t\t\t\tsections.map(section => {\n\t\t\t\t\tthis.mainInstance.addNewBlockToCategory(\n\t\t\t\t\t\tsection,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcode: blockCode,\n\t\t\t\t\t\t\tcodeOriginal: blockCode + '@' + newBlockId,\n\t\t\t\t\t\t\tname: title,\n\t\t\t\t\t\t\tpreview: preview.src,\n\t\t\t\t\t\t\tsection: sections,\n\t\t\t\t\t\t\tfavorite: true,\n\t\t\t\t\t\t\tfavoriteMy: true,\n\t\t\t\t\t\t\trepo_id: this.block.repoId,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.append(this.getFailMessage(), this.content);\n\t\t\t}\n\t\t});\n\t}\n}\n"],"names":["SaveBlock","instance","id","data","title","Loc","getMessage","showFromRight","block","Cache","MemoryCache","mainInstance","Main","getInstance","Dom","addClass","layout","overlay","setButtons","renderTo","window","parent","document","body","appendFooterButton","BX","Landing","UI","Button","BaseButton","text","onClick","onSave","bind","className","hide","cache","remember","TextField","textOnly","items","Env","getOptions","blocks","Object","keys","map","key","indexOf","push","value","name","Field","MultiSelect","Checkbox","Image","disableLink","disableAltField","uploadParams","action","content","src","alt","dimensions","width","height","MessageCard","header","description","restoreState","Form","BaseForm","fields","getTitleField","getSectionsField","getTemplateCode","getTemplateRefField","getPreviewField","showLoader","Screenshoter","makeBlockScreenshot","then","sourceFile","ImageCompressor","compress","maxWidth","maxHeight","compressedFile","Backend","upload","temp","response","setValue","hideLoader","options","style","footer","manifest","section","preview","makeScreenshot","clear","prepend","getLayout","appendForm","getForm","Tag","render","backend","getValue","templateRef","length","blockCode","code","sections","lid","meta","Math","max","tpl_code","newBlockId","top","Notification","Center","notify","addNewBlockToCategory","codeOriginal","favorite","favoriteMy","repo_id","repoId","append","getFailMessage","Content"],"mappings":"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"}