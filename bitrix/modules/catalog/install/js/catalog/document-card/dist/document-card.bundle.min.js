this.BX=this.BX||{};this.BX.Catalog=this.BX.Catalog||{};(function(e,t,n,r,i,a,o,l,s,c,u){"use strict";var d=function e(){babelHelpers.classCallCheck(this,e)};babelHelpers.defineProperty(d,"DEFAULT","ui-label-default");babelHelpers.defineProperty(d,"DANGER","ui-label-danger");babelHelpers.defineProperty(d,"SUCCESS","ui-label-success");babelHelpers.defineProperty(d,"WARNING","ui-label-warning");babelHelpers.defineProperty(d,"PRIMARY","ui-label-primary");babelHelpers.defineProperty(d,"SECONDARY","ui-label-secondary");babelHelpers.defineProperty(d,"LIGHT","ui-label-light");babelHelpers.defineProperty(d,"TAG_SECONDARY","ui-label-tag-secondary");babelHelpers.defineProperty(d,"TAG_LIGHT","ui-label-tag-light");babelHelpers.defineProperty(d,"LIGHT_BLUE","ui-label-lightblue");babelHelpers.defineProperty(d,"LIGHT_GREEN","ui-label-lightgreen");babelHelpers.defineProperty(d,"ORANGE","ui-label-orange");babelHelpers.defineProperty(d,"LIGHT_ORANGE","ui-label-lightorange");babelHelpers.defineProperty(d,"YELLOW","ui-label-yellow");babelHelpers.defineProperty(d,"LIGHT_YELLOW","ui-label-lightyellow");babelHelpers.defineProperty(d,"LIGHT_RED","ui-label-lightred");babelHelpers.defineProperty(d,"LAVENDER","ui-label-lavender");babelHelpers.defineProperty(d,"COPILOT_LIGHT","ui-label-copilot-light");babelHelpers.defineProperty(d,"COPILOT_LIGHT_REVERSE","ui-label-copilot-light-reverse");var p=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"getOptionContainer",value:function e(){var n=babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getOptionContainer",this).call(this);this._isRequiredCheckBox=this.getField().getData().requiredIsEditable?this.getIsRequiredCheckBox():null;return n}},{key:"onSaveButtonClick",value:function e(){this.getField().getSchemeElement()._isRequired=this._isRequiredCheckBox.checked;babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onSaveButtonClick",this).call(this);BX.ajax.runComponentAction("bitrix:catalog.store.document.detail","changeRequired",{mode:"class",data:{documentType:this.getEditor().getModel().getData().DOC_TYPE,fieldName:this.getField()._id,required:this.getField().isRequired()?"Y":"N"}})}},{key:"getIsRequiredCheckBox",value:function e(){var t=this.createOption({caption:u.Loc.getMessage("UI_ENTITY_EDITOR_UF_REQUIRED_FIELD")});t.checked=this._field&&this._field.isRequired();return t}}],[{key:"create",value:function e(t,n){var r=new this;r.initialize(t,n);return r}}]);return t}(BX.UI.EntityEditorFieldConfigurator);u.Reflection.namespace("BX.Catalog").StoreDocumentFieldConfigurator=p;var h=function(e){babelHelpers.inherits(t,e);function t(){babelHelpers.classCallCheck(this,t);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}babelHelpers.createClass(t,[{key:"getSimpleFieldConfigurator",value:function e(t,n){var r="";var i=u.Type.isObject(t.field)?t.field:null;if(i){r=i.getType();i.setVisible(false);var a=i.getSchemeElement().getData().userType;a=u.Type.isString(a)?a:false;if(a){r=a}}else{r=u.Type.isString(t.TypeId)?t.TypeId:BX.UI.EntityUserFieldType.string}this._fieldConfigurator=p.create("",{editor:this._editor,schemeElement:null,model:n._model,mode:BX.UI.EntityEditorMode.edit,parent:n,typeId:r,field:i,mandatoryConfigurator:null});return this._fieldConfigurator}}],[{key:"create",value:function e(t,n){var r=new this;r.initialize(t,n);return r}}]);return t}(BX.UI.EntityConfigurationManager);var f=function(e){babelHelpers.inherits(t,e);function t(e,n){var r;babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(r),"getCurrencyId",(function(){return this._currencyId}));r.initialize(e,n);r._setProductListHandler=r.handleSetProductList.bind(babelHelpers.assertThisInitialized(r));r._tabShowHandler=r.onTabShow.bind(babelHelpers.assertThisInitialized(r));r._editorControlChangeHandler=r.onEditorControlChange.bind(babelHelpers.assertThisInitialized(r));r._currencyId=r._model.getField("CURRENCY","");s.EventEmitter.subscribe(r._editor,"onControlChanged",r.onEditorControlChange.bind(babelHelpers.assertThisInitialized(r)));s.EventEmitter.subscribe("DocumentProductListController",r._setProductListHandler);s.EventEmitter.subscribe("onEntityDetailsTabShow",r._tabShowHandler);s.EventEmitter.subscribe("BX.UI.EntityEditorList:onItemSelect",(function(e){var t=babelHelpers.slicedToArray(e.data,2),n=t[0],i=t[1];if((n===null||n===void 0?void 0:n.getId())==="TOTAL_WITH_CURRENCY"){r.changeCurrency(i.item.value)}}));return r}babelHelpers.createClass(t,[{key:"handleSetProductList",value:function e(t){var n=t.getData()[0];this.setProductList(n);s.EventEmitter.unsubscribe("DocumentProductListController",this._setProductListHandler)}},{key:"reinitializeProductList",value:function e(){if(this.productList){this.productList.reloadGrid(false)}}},{key:"onTabShow",value:function e(t){var n=t.getData(),r=babelHelpers.slicedToArray(n,1),i=r[0];if(i.id==="tab_products"&&this.productList){this.productList.handleOnTabShow();s.EventEmitter.unsubscribe("onEntityDetailsTabShow",this._tabShowHandler);s.EventEmitter.emit("onDocumentProductListTabShow",this)}}},{key:"innerCancel",value:function e(){this.rollback();if(this.productList){this.productList.onInnerCancel()}this._currencyId=this._model.getField("CURRENCY");if(this.productList){this.productList.changeCurrencyId(this._currencyId);this.productList.updateTotalUiCurrency()}this._isChanged=false}},{key:"setProductList",value:function e(t){if(this.productList===t){return}if(this.productList){this.productList.destroy()}this.productList=t;if(this.productList){this.productList.setController(this);this.productList.setForm(this._editor.getFormElement());if(this.productList.getCurrencyId()!==this.getCurrencyId()){this.productList.changeCurrencyId(this.getCurrencyId())}this._prevProductCount=this._curProductCount=this.productList.getProductCount()}}},{key:"onAfterSave",value:function e(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onAfterSave",this).call(this);if(this.productList){this.productList.removeFormFields()}this._editor._toolPanel.showViewModeButtons()}},{key:"productChange",value:function e(){var t;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;n=(t=n)!==null&&t!==void 0?t:false;this.markAsChanged();if(n){this.disableSaveButton()}s.EventEmitter.emit("onDocumentProductChange",this.productList.getProductsFields())}},{key:"onBeforeSubmit",value:function e(){if(this.productList&&(this.isChanged()||this._editor.isNew())){this.productList.compileProductData()}}},{key:"enableSaveButton",value:function e(){var t;if((t=this._editor)!==null&&t!==void 0&&t._toolPanel){this._editor._toolPanel.enableSaveButton()}}},{key:"disableSaveButton",value:function e(){var t;if((t=this._editor)!==null&&t!==void 0&&t._toolPanel){this._editor._toolPanel.disableSaveButton()}}},{key:"onEditorControlChange",value:function e(t){var n=t.getData(),r=babelHelpers.slicedToArray(n,2),i=r[0],a=r[1];if(i instanceof BX.UI.EntityEditorMoney&&(a===null||a===void 0?void 0:a.fieldName)==="CURRENCY"){this.changeCurrency(a.fieldValue)}}},{key:"changeCurrency",value:function e(t){this._currencyId=t;if(this.productList&&this._currencyId){this.productList.changeCurrencyId(this._currencyId);this.markAsChanged()}}},{key:"setTotal",value:function e(t){this._model.setField("FORMATTED_TOTAL",BX.Currency.currencyFormat(t.totalCost,this.getCurrencyId(),false));this._model.setField("FORMATTED_TOTAL_WITH_CURRENCY",BX.Currency.currencyFormat(t.totalCost,this.getCurrencyId(),true));this._model.setField("TOTAL",t.totalCost);var n=this._editor.getControlById("TOTAL_WITH_CURRENCY");if(n instanceof BX.UI.EntityEditorMoney){n.refreshLayout()}}},{key:"validateProductList",value:function e(){var t=this.productList.validate();if(t.length>0){this._editor._toolPanel.addError(t[0]);s.EventEmitter.emit("onProductsCheckFailed",t);return false}return true}}]);return t}(BX.UI.EntityEditorController);function v(e,t){b(e,t);t.add(e)}function b(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function g(e,t,n){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return n}var y=new WeakSet;var C=new WeakSet;var m=function(e){babelHelpers.inherits(t,e);function t(e,n){var r;babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));v(babelHelpers.assertThisInitialized(r),C);v(babelHelpers.assertThisInitialized(r),y);r.initialize(e,n);r._model.lockField("TOTAL");return r}babelHelpers.createClass(t,[{key:"doInitialize",value:function e(){g(this,y,E).call(this)}},{key:"onAfterSave",value:function e(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onAfterSave",this).call(this);window.top.BX.onCustomEvent("DocumentCard:onDocumentCardSave");var n=BX.SidePanel.Instance.getOpenSliders();n.forEach((function(e){var t,n;if((t=e.getWindow())!==null&&t!==void 0&&(n=t.BX.Catalog)!==null&&n!==void 0&&n.DocumentGridManager){e.getWindow().BX.onCustomEvent("DocumentCard:onDocumentCardSave")}}))}}]);return t}(BX.UI.EntityEditorController);function E(){g(this,C,T).call(this)}function T(){s.EventEmitter.subscribe("BX.UI.EntityEditorProductRowSummary:onDetailProductListLinkClick",(function(){s.EventEmitter.emit("BX.Catalog.EntityCard.TabManager:onOpenTab",{tabId:"tab_products"})}));s.EventEmitter.subscribe("BX.UI.EntityEditorProductRowSummary:onAddNewRowInProductList",(function(){s.EventEmitter.emit("BX.Catalog.EntityCard.TabManager:onOpenTab",{tabId:"tab_products"});setTimeout((function(){s.EventEmitter.emit("onFocusToProductList")}),500)}))}var _=function(){function e(t){var n=this;babelHelpers.classCallCheck(this,e);s.EventEmitter.subscribe(t,(function(e){var t=e.getCompatData(),r=babelHelpers.slicedToArray(t,2),i=r[1];i.methods["entityCard"]=n.factory.bind(n)}))}babelHelpers.createClass(e,[{key:"factory",value:function e(t,n,r){if(t==="document_card"){return new m(n,r)}if(t==="catalog_store_document_product_list"){return new f(n,r)}return null}}]);return e}();var L=function(e){babelHelpers.inherits(t,e);function t(e,n){var r;babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));r.initialize(e,n);r._loader=null;r._productsContainer=null;r._previousData=[];r._itemCount=0;r._totalCount=0;r._moreButton=null;r._moreButtonRow=null;r._totalsRow=null;r._moreButtonClickHandler=BX.delegate(r._onMoreButtonClick,babelHelpers.assertThisInitialized(r));r._visibleItemsLimit=5;return r}babelHelpers.createClass(t,[{key:"layout",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(this._hasLayout){return}this.ensureWrapperCreated({});this.adjustWrapper();var n=this.getValue();if(!BX.type.isPlainObject(n)){return}var r=this.getTitle();var i=BX.prop.getArray(n,"items",[]);this._totalCount=BX.prop.getInteger(n,"count",0);this._itemCount=i.length;var a=this._itemCount;var o=this._visibleItemsLimit;var l=0;if(a>o){l=this._totalCount-o;a=o}if(this.isDragEnabled()){this._wrapper.appendChild(this.createDragButton())}this._wrapper.appendChild(this.createTitleNode(r));this._productsContainer=BX.create("div",{props:{className:"catalog-entity-widget-content-block-products-list"}});for(var s=0;s<a;s++){this.addProductRow(i[s])}this._moreButton=null;if(l>0){this.addMoreButton(l)}this.addTotalRow(n["total"]);this._wrapper.appendChild(BX.create("div",{props:{className:"catalog-entity-widget-content-block-products"},children:[this._productsContainer]}));if(this.isContextMenuEnabled()){this._wrapper.appendChild(this.createContextMenuButton())}if(this.isDragEnabled()){this.initializeDragDropAbilities()}this.registerLayout(t);this._hasLayout=true}},{key:"addMoreButton",value:function e(t){var n=BX.create("div",{props:{className:"catalog-entity-widget-content-block-products-item"}});this._moreButtonRow=n;this._productsContainer.appendChild(n);var r=BX.create("div",{props:{className:"catalog-entity-widget-content-block-products-item-name"}});n.appendChild(r);this._moreButton=BX.create("span",{attrs:{className:"catalog-entity-widget-content-block-products-show-more"},events:{click:this._moreButtonClickHandler},text:u.Loc.getMessage("DOCUMENT_PRODUCTS_NOT_SHOWN",{"#COUNT#":t.toString()})});r.appendChild(this._moreButton);n.appendChild(BX.create("div",{props:{className:"catalog-entity-widget-content-block-products-price"}}))}},{key:"addTotalRow",value:function e(t){var n=BX.create("div",{props:{className:"catalog-entity-widget-content-block-products-item"}});this._totalsRow=n;this._productsContainer.appendChild(n);var r=BX.create("div",{props:{className:"catalog-entity-widget-content-block-products-item-name"},html:u.Loc.getMessage("DOCUMENT_PRODUCTS_TOTAL")});n.appendChild(r);var i=BX.create("div",{props:{className:"catalog-entity-widget-content-block-products-price"},html:o.CurrencyCore.currencyFormat(t.amount,t.currency,true)});n.appendChild(i)}},{key:"addAddProductButton",value:function e(){var t=BX.create("a",{props:{href:"#"}});t.text=u.Loc.getMessage("DOCUMENT_PRODUCTS_ADD_PRODUCT");t.onclick=function(){s.EventEmitter.emit("BX.Catalog.EntityCard.TabManager:onOpenTab",{tabId:"tab_products"})};var n=BX.create("div",{props:{className:"catalog-entity-widget-content-block-products-add-products"},children:[t]});this._productsContainer.appendChild(n)}},{key:"_onMoreButtonClick",value:function e(t){s.EventEmitter.emit("BX.Catalog.EntityCard.TabManager:onOpenTab",{tabId:"tab_products"})}},{key:"doClearLayout",value:function e(){this._productsContainer=null;this._moreButton=null;this._moreButtonRow=null;this._totalsRow=null}},{key:"addProductRow",value:function e(t){var n=BX.create("div",{props:{className:"catalog-entity-widget-content-block-products-item"}});this._productsContainer.appendChild(n);var r=BX.create("div",{props:{className:"catalog-entity-widget-content-block-products-item-name"}});r.innerHTML=BX.util.htmlspecialchars(t["PRODUCT_NAME"]);n.appendChild(r);var i=BX.create("div",{props:{className:"catalog-entity-widget-content-block-products-price"}});n.appendChild(i);i.appendChild(BX.create("div",{attrs:{className:"catalog-entity-widget-content-block-products-price-value"},html:t["SUM"]}))}}]);return t}(BX.UI.EntityEditorField);var I,k,w,B;var P=function(e){babelHelpers.inherits(t,e);function t(e,n){var r;babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));r.initialize(e,n);r._input=null;r.innerWrapper=null;r.currentContractorName="";r.viewModeDisplay=null;return r}babelHelpers.createClass(t,[{key:"getContentWrapper",value:function e(){return this.innerWrapper}},{key:"layout",value:function e(){var t=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(this._hasLayout){return}this.ensureWrapperCreated({});this.adjustWrapper();var r=this.getTitle();if(this.isDragEnabled()){this._wrapper.appendChild(this.createDragButton())}this._wrapper.appendChild(this.createTitleNode(r));var i=this.getName();var a=this.getValue();var o=this._schemeElement.getData();if(!this.currentContractorName){this.currentContractorName=this.getContractorNameFromModel()}this._input=u.Tag.render(I||(I=babelHelpers.taggedTemplateLiteral(['<input name="','" type="hidden" value="','"/>'])),i,a);this._wrapper.appendChild(this._input);this.innerWrapper=u.Tag.render(k||(k=babelHelpers.taggedTemplateLiteral(['<div class="ui-entity-editor-content-block"></div>'])));this._wrapper.appendChild(this.innerWrapper);if(this._mode===BX.UI.EntityEditorMode.edit){var s=[];if(a){s.push({id:a,entityId:"contractor",title:this.currentContractorName})}var c=new l.TagSelector({items:s,placeholder:u.Loc.getMessage("DOCUMENT_CONTRACTOR_FIELD_PLACEHOLDER"),textBoxWidth:"100%",multiple:false,dialogOptions:{context:"catalog_document_contractors",entities:[{id:"contractor",dynamicLoad:true,dynamicSearch:true}],searchOptions:{allowCreateItem:true,footerOptions:{label:u.Loc.getMessage("DOCUMENT_ADD_CONTRACTOR")}},events:{"Item:onSelect":function e(n){t._input.value=n.data.item.getId();if(t.viewModeDisplay){t.currentContractorName=n.data.item.getTitle();t.viewModeDisplay.innerHTML=BX.util.htmlspecialchars(t.currentContractorName)}t._changeHandler()},"Search:onItemCreateAsync":this.createContractor.bind(this),"Item:onDeselect":function e(n){t._input.value="";t._changeHandler()}}}});c.renderTo(this.innerWrapper);if(BX.UI.EntityEditorModeOptions.check(this._modeOptions,BX.UI.EntityEditorModeOptions.individual)){c.getDialog().show()}}else{if(this.hasContentToDisplay()){this.viewModeDisplay=u.Tag.render(w||(w=babelHelpers.taggedTemplateLiteral(['<div class="ui-entity-editor-content-block-text">',"</div>"])),BX.util.htmlspecialchars(this.currentContractorName))}else{this.viewModeDisplay=u.Tag.render(B||(B=babelHelpers.taggedTemplateLiteral(['<div class="ui-entity-editor-content-block-text">',"</div>"])),u.Loc.getMessage("DOCUMENT_CONTRACTOR_NOT_FILLED"))}this.innerWrapper.appendChild(this.viewModeDisplay)}if(this.isContextMenuEnabled()){this._wrapper.appendChild(this.createContextMenuButton())}if(this.isDragEnabled()){this.initializeDragDropAbilities()}this.registerLayout(n);this._hasLayout=true}},{key:"validate",value:function e(t){if(!(this._mode===BX.UI.EntityEditorMode.edit&&this._input)){throw"BX.Catalog.DocumentCard.Contractor. Invalid validation context"}this.clearError();if(this.hasValidators()){return this.executeValidators(t)}var n=!(this.isRequired()||this.isRequiredByAttribute())||BX.util.trim(this._input.value)!=="";if(!n){t.addError(BX.UI.EntityValidationError.create({field:this}));this.showRequiredFieldError(this._input)}return n}},{key:"hasValue",value:function e(){if(this.getValue()==="0"){return false}return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"hasValue",this).call(this)}},{key:"getModeSwitchType",value:function e(t){var n=BX.UI.EntityEditorModeSwitchType.common;if(t===BX.UI.EntityEditorMode.edit){n|=BX.UI.EntityEditorModeSwitchType.button|BX.UI.EntityEditorModeSwitchType.content}return n}},{key:"createContractor",value:function e(t){var n=t.getData(),r=n.searchQuery;var i=r.getQuery();return new Promise((function(e,n){var a=t.getTarget();var o={companyName:i};a.showLoader();u.ajax.runAction("catalog.contractor.createContractor",{data:{fields:o}}).then((function(t){a.hideLoader();var n=a.addItem({id:t.data.id,entityId:"contractor",title:r.getQuery(),tabs:a.getRecentTab().getId()});if(n){n.select()}a.hide();e()}))["catch"]((function(){a.hideLoader();BX.UI.Notification.Center.notify({content:u.Loc.getMessage("DOCUMENT_ADD_CONTRACTOR_ERROR")});a.hide();n()}))}))}},{key:"getContractorNameFromModel",value:function e(){return this._model.getSchemeField(this._schemeElement,"contractorName","")}},{key:"rollback",value:function e(){this.currentContractorName=this.getContractorNameFromModel()}}]);return t}(BX.UI.EntityEditorField);var O=function(){function e(){var t=this;babelHelpers.classCallCheck(this,e);s.EventEmitter.subscribe("BX.UI.EntityEditorControlFactory:onInitialize",(function(e){var n=e.getCompatData(),r=babelHelpers.slicedToArray(n,2),i=r[1];i.methods["documentCard"]=t.factory.bind(t)}))}babelHelpers.createClass(e,[{key:"factory",value:function e(t,n,r){if(t==="contractor"){return new P(n,r)}return null}}]);return e}();var S=function(e){babelHelpers.inherits(t,e);function t(e,n){var r;babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));r.initialize(e,n);return r}babelHelpers.createClass(t,[{key:"isCaptionEditable",value:function e(){return true}},{key:"getCaption",value:function e(){var t=this.getField("TITLE");return BX.type.isString(t)?t:""}},{key:"setCaption",value:function e(t){this.setField("TITLE",t)}},{key:"prepareCaptionData",value:function e(t){t["TITLE"]=this.getField("TITLE","")}}]);return t}(BX.UI.EntityModel);var D=function(){function e(){var t=this;babelHelpers.classCallCheck(this,e);s.EventEmitter.subscribe("BX.UI.EntityEditorModelFactory:onInitialize",(function(e){var n=e.getCompatData(),r=babelHelpers.slicedToArray(n,2),i=r[1];i.methods["store_document"]=t.factory.bind(t)}))}babelHelpers.createClass(e,[{key:"factory",value:function e(t,n,r){if(t==="store_document"){return new S(n,r)}return null}}]);return e}();var N,H,M,U,X,A;function R(e,t,n){z(e,t);j(n,"get");return F(e,n)}function F(e,t){if(t.get){return t.get.call(e)}return t.value}function x(e,t,n,r){z(e,t);j(n,"set");G(e,n,r);return r}function j(e,t){if(e===undefined){throw new TypeError("attempted to "+t+" private static field before its declaration")}}function z(e,t){if(e!==t){throw new TypeError("Private static access of wrong provenance")}}function G(e,t,n){if(t.set){t.set.call(e,n)}else{if(!t.writable){throw new TypeError("attempted to set read only private field")}t.value=n}}var W=function(e){babelHelpers.inherits(t,e);function t(e,n){var r;babelHelpers.classCallCheck(this,t);r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e,n));r.documentType=n.documentType;r.isDocumentConducted=n.documentStatus==="Y";r.componentName=n.componentName;r.signedParameters=n.signedParameters;r.isConductLocked=n.isConductLocked;r.masterSliderUrl=n.masterSliderUrl;r.isInventoryManagementDisabled=n.isInventoryManagementDisabled;r.inventoryManagementFeatureCode=n.inventoryManagementFeatureCode;r.editorName=n.includeCrmEntityEditor?"BX.Crm.EntityEditor":"BX.UI.EntityEditor";r.inventoryManagementSource=n.inventoryManagementSource;r.lockedCancellation=n.lockedCancellation||false;r.activeTabId="main";r.insidePageTitleConfig=n.insidePageTitleConfig||{};r.isTabAnalyticsSent=false;if(u.Type.isPlainObject(r.insidePageTitleConfig)){r.appendInsidePageTitle(r.insidePageTitleConfig)}r.setSliderText();r.addCopyLinkPopup();r.subscribeToEvents();if(n.documentTypeSelector){r.initDocumentTypeSelector()}x(t,t,Y,babelHelpers.assertThisInitialized(r));BX.UI.SidePanel.Wrapper.setParam("closeAfterSave",true);r.showNotificationOnClose=false;return r}babelHelpers.createClass(t,[{key:"appendInsidePageTitle",value:function e(t){var n,r;var i=(n=BX.UI)===null||n===void 0?void 0:(r=n.ToolbarManager)===null||r===void 0?void 0:r.getDefaultToolbar();var o=i===null||i===void 0?void 0:i.titleContainer.querySelector(".ui-toolbar-title-item-box");if(!o){return}var l=null;var s=null;if(t.enableEditTitle){l=u.Tag.render(N||(N=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span id="pagetitle_edit" class="pagetitle-edit-button"></span>\n\t\t\t'])))}if(t.enablePageLink){s=u.Tag.render(H||(H=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span id="','" class="page-link-btn"></span>\n\t\t\t'])),this.settings.copyLinkButtonId)}if(l||s){var c=u.Tag.render(M||(M=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span id="pagetitle_btn_wrapper" class="pagetitile-button-container"></span>\n\t\t\t'])));if(l){u.Dom.append(l,c)}if(s){u.Dom.append(s,c)}u.Dom.append(c,o)}if(t.enableStatusLabel){var d={text:t.statusLabel.text,color:t.statusLabel.color,size:a.LabelSize.LG,link:"",fill:true,customClass:"document-status-label"};var p=new a.Label(d);u.Dom.append(p.render(),o)}}},{key:"initDocumentTypeSelector",value:function e(){var t=this;var n=this.settings.documentTypeSelector;var i=this.settings.documentTypeSelectorTypes;if(!n||!i){return}var a=[];i.forEach((function(e){a.push({text:u.Loc.getMessage("DOC_TYPE_SHORT_".concat(e)),onclick:function n(r){var i=BX.SidePanel.Instance.getTopSlider();if(i){i.url=BX.Uri.addParam(i.getUrl(),{DOCUMENT_TYPE:e});i.url=BX.Uri.removeParam(i.url,["firstTime","focusedTab"]);if(t.activeTabId!=="main"){i.url=BX.Uri.addParam(i.getUrl(),{focusedTab:t.activeTabId})}if(e==="A"||e==="S"){i.requestMethod="post";i.requestParams={preloadedFields:{DOCUMENT_FIELDS:t.getDocumentFieldsForTypeSwitching(),PRODUCTS:t.getProductsForTypeSwitching()}}}i.setFrameSrc()}}})}));var o=r.MenuManager.create({id:"document-type-selector",bindElement:n,items:a});n.addEventListener("click",(function(e){e.preventDefault();o.show()}))}},{key:"getDocumentFieldsForTypeSwitching",value:function e(){var t={};var n=this.getEditorInstance();if(!n){return t}var r=n.getFormElement();var i=new FormData(r);var a=Object.fromEntries(i);var o=["TITLE","CURRENCY","TOTAL"];o.forEach((function(e){var n;t[e]=(n=a[e])!==null&&n!==void 0?n:""}));return t}},{key:"getProductsForTypeSwitching",value:function e(){var t=[];if(!u.Reflection.getClass("BX.Catalog.Store.ProductList.Instance")){return t}var n=["ID","STORE_TO",{ELEMENT_ID:"SKU_ID"},"AMOUNT","PURCHASING_PRICE","BASE_PRICE","BASE_PRICE_EXTRA","BASE_PRICE_EXTRA_RATE"];BX.Catalog.Store.ProductList.Instance.getProductsFields().forEach((function(e){var r={};n.forEach((function(t){if(u.Type.isObject(t)){var n;var i=Object.keys(t)[0];var a=t[i];r[i]=(n=e[a])!==null&&n!==void 0?n:""}else{var o;r[t]=(o=e[t])!==null&&o!==void 0?o:""}}));t.push(r)}));return t}},{key:"openMasterSlider",value:function e(){var t=this;(new n.EnableWizardOpener).open(this.masterSliderUrl,{urlParams:{analyticsContextSection:n.AnalyticsContextList.DOCUMENT_CARD},data:{openGridOnDone:false},events:{onCloseComplete:function e(n){var r=n.getSlider();if(!r){return}if(r.getData().get("isInventoryManagementEnabled")){t.isConductLocked=false;BX.SidePanel.Instance.getOpenSliders().forEach((function(e){var t,n;if((t=e.getWindow())!==null&&t!==void 0&&(n=t.BX.Catalog)!==null&&n!==void 0&&n.DocumentGridManager){e.allowChangeHistory=false;e.getWindow().location.reload()}}))}}}})}},{key:"adjustToolPanel",value:function e(){}},{key:"focusOnTab",value:function e(t){s.EventEmitter.emit("BX.Catalog.EntityCard.TabManager:onOpenTab",{tabId:t})}},{key:"setViewModeButtons",value:function e(t){t._toolPanel.showViewModeButtons()}},{key:"setEditModeButtons",value:function e(t){t._toolPanel.showEditModeButtons()}},{key:"getEditorInstance",value:function e(){var t=u.Reflection.getClass(this.editorName);if(t){return t.getDefault()}return null}},{key:"subscribeToEvents",value:function e(){this.subscribeToUserSelectorEvent();this.subscribeToValidationFailedEvent();this.subscribeToOnSaveEvent();this.subscribeToTabOpenEvent();this.subscribeToDirectActionEvent();this.subscribeToEntityCreateEvent();this.subscribeToBeforeEntityRedirectEvent();this.subscribeToCreateUserFieldEvent();this.subscribeToFieldConfiguratorEvent()}},{key:"subscribeToFieldConfiguratorEvent",value:function e(){s.EventEmitter.subscribe("BX.UI.EntityConfigurationManager:onInitialize",this.onConfigurationManagerInit.bind(this))}},{key:"onConfigurationManagerInit",value:function e(t){var n=t.getCompatData(),r=babelHelpers.slicedToArray(n,2),i=r[1];if(!i.type||i.type==="editor"){i.configurationFieldManager=h.create(this.id,i)}t.stopImmediatePropagation()}},{key:"subscribeToCreateUserFieldEvent",value:function e(){var t=this;s.EventEmitter.subscribe("BX.UI.EntityConfigurationManager:onCreateClick",(function(e){e.data.isCanceled=true;var n=t.getEditorInstance();var r=n.getConfigurationFieldManager().getCreationPageUrl("custom");if(r){top.BX.SidePanel.Instance.open(r)}}))}},{key:"subscribeToUserSelectorEvent",value:function e(){var t=this;if(this.editorName!=="BX.UI.EntityEditor"){return}s.EventEmitter.subscribe("BX.UI.EntityEditorUser:openSelector",(function(e){var n=e.data[1];var r=new l.Dialog({targetNode:n.anchor,enableSearch:true,multiple:false,context:"CATALOG_DOCUMENT",entities:[{id:"user"},{id:"department"}],events:{"Item:onSelect":function e(i){var a=n.id;var o=i.data.item;var l={entityId:o.id,avatar:o.avatar,name:u.Text.encode(o.title.text)};if(t.entityId>0){var s={};s[a]=o.id;BX.ajax.runComponentAction(t.componentName,"save",{mode:"class",signedParameters:t.signedParameters,data:{fields:s}}).then((function(e){n.callback(r,l)}))}else{n.callback(r,l)}}}});r.show()}))}},{key:"subscribeToValidationFailedEvent",value:function e(){s.EventEmitter.subscribe("".concat(this.editorName,":onFailedValidation"),(function(e){s.EventEmitter.emit("BX.Catalog.EntityCard.TabManager:onOpenTab",{tabId:"main"})}));s.EventEmitter.subscribe("onProductsCheckFailed",(function(e){s.EventEmitter.emit("BX.Catalog.EntityCard.TabManager:onOpenTab",{tabId:"tab_products"})}))}},{key:"subscribeToOnSaveEvent",value:function e(){var t=this;s.EventEmitter.subscribe("".concat(this.editorName,":onSave"),(function(e){var n;var r=e.data[0];var i=(n=e.data[1])===null||n===void 0?void 0:n.actionId;if(r&&r._ajaxForm){var a;(a=r._toolPanel)===null||a===void 0?void 0:a.clearErrors();if(t.isInventoryManagementDisabled&&t.inventoryManagementFeatureCode){var o;e.data[1].cancel=true;(o=e.data[0]._toolPanel)===null||o===void 0?void 0:o.setLocked(false);top.BX.UI.InfoHelper.show(t.inventoryManagementFeatureCode);return}if(i==="SAVE_AND_CONDUCT"){if(t.isConductLocked){var l;e.data[1].cancel=true;(l=e.data[0]._toolPanel)===null||l===void 0?void 0:l.setLocked(false);t.openMasterSlider();return}if(!t.validateControllers(r.getControllers())){var s;e.data[1].cancel=true;(s=r._toolPanel)===null||s===void 0?void 0:s.setLocked(false);return}if(e.data[1].cancel){return}}var c=r._ajaxForms[i];if(c){c.addUrlParams({documentType:t.documentType,isNewDocument:t.entityId<=0?"Y":"N",inventoryManagementSource:t.inventoryManagementSource})}}}))}},{key:"subscribeToTabOpenEvent",value:function e(){var t=this;s.EventEmitter.subscribe("BX.Catalog.EntityCard.TabManager:onSelectItem",(function(e){var n=e.data.tabId;if(n==="tab_products"&&!t.isTabAnalyticsSent){t.sendAnalyticsData({tab:"products",isNewDocument:t.entityId<=0?"Y":"N",documentType:t.documentType,inventoryManagementSource:t.inventoryManagementSource});t.isTabAnalyticsSent=true}if(n){t.activeTabId=n}}))}},{key:"subscribeToDirectActionEvent",value:function e(){var t=this;s.EventEmitter.subscribe("".concat(this.editorName,":onDirectAction"),(function(e){var n,r;var i=e.data[0];if(t.isInventoryManagementDisabled&&t.inventoryManagementFeatureCode){var a;e.data[1].cancel=true;(a=e.data[0]._toolPanel)===null||a===void 0?void 0:a.setLocked(false);top.BX.UI.InfoHelper.show(t.inventoryManagementFeatureCode);return}if(((n=e.data[1])===null||n===void 0?void 0:n.actionId)==="CONDUCT"){var o;(o=i._toolPanel)===null||o===void 0?void 0:o.clearErrors();if(t.isConductLocked){var l;e.data[1].cancel=true;(l=e.data[0]._toolPanel)===null||l===void 0?void 0:l.setLocked(false);t.openMasterSlider();return}if(!t.validateControllers(i.getControllers())){var s;e.data[1].cancel=true;(s=i._toolPanel)===null||s===void 0?void 0:s.setLocked(false);return}e.data[0]._ajaxForms.CONDUCT.addUrlParams({documentType:t.documentType,inventoryManagementSource:t.inventoryManagementSource})}if(((r=e.data[1])===null||r===void 0?void 0:r.actionId)==="CANCEL_CONDUCT"){if(t.isLockedCancellation()){var c;t.showCancellationInfo();e.data[1].cancel=true;(c=e.data[0]._toolPanel)===null||c===void 0?void 0:c.setLocked(false);return}e.data[0]._ajaxForms.CANCEL_CONDUCT.addUrlParams({documentType:t.documentType,inventoryManagementSource:t.inventoryManagementSource})}}))}},{key:"subscribeToEntityCreateEvent",value:function e(){s.EventEmitter.subscribe("onEntityCreate",(function(e){var t;window.top.BX.onCustomEvent("DocumentCard:onEntityCreate");BX.SidePanel.Instance.getOpenSliders().forEach((function(e){var t,n;if((t=e.getWindow())!==null&&t!==void 0&&(n=t.BX.Catalog)!==null&&n!==void 0&&n.DocumentGridManager){e.getWindow().BX.onCustomEvent("DocumentCard:onEntityCreate")}}));var n=e===null||e===void 0?void 0:(t=e.data[0])===null||t===void 0?void 0:t.sender;if(n){n._toolPanel.disableSaveButton();n.hideToolPanel()}}))}},{key:"subscribeToBeforeEntityRedirectEvent",value:function e(){var t=this;s.EventEmitter.subscribe("beforeEntityRedirect",(function(e){var n;window.top.BX.onCustomEvent("DocumentCard:onBeforeEntityRedirect");BX.SidePanel.Instance.getOpenSliders().forEach((function(e){e.getWindow().BX.onCustomEvent("DocumentCard:onBeforeEntityRedirect")}));var r=e===null||e===void 0?void 0:(n=e.data[0])===null||n===void 0?void 0:n.sender;if(r){var i;r._toolPanel.disableSaveButton();r.hideToolPanel();t.showNotificationOnClose=(e===null||e===void 0?void 0:(i=e.data[0])===null||i===void 0?void 0:i.showNotificationOnClose)==="Y";if(t.showNotificationOnClose){var a=e.data[0].redirectUrl;if(!a){return}a=BX.Uri.removeParam(a,"closeOnSave");window.top.BX.UI.Notification.Center.notify({content:u.Loc.getMessage("DOCUMENT_CONDUCT_SUCCESSFUL"),actions:[{title:u.Loc.getMessage("DOCUMENT_CONDUCT_SUCCESSFUL_VIEW"),href:a,events:{click:function e(t,n,r){n.close()}}}]})}}}))}},{key:"validateControllers",value:function e(t){var n=true;if(Array.isArray(t)){t.forEach((function(e){if(e instanceof f&&!e.validateProductList()){n=false}}))}else{n=false}return n}},{key:"sendAnalyticsData",value:function e(t){BX.ajax.runAction("catalog.analytics.sendAnalyticsLabel",{analyticsLabel:t})}},{key:"addCopyLinkPopup",value:function e(){var t=this;var n=document.getElementById(this.settings.copyLinkButtonId);if(!n){return}n.onclick=function(){t.copyDocumentLinkToClipboard()}}},{key:"copyDocumentLinkToClipboard",value:function e(){var t=BX.util.remove_url_param(window.location.href,["IFRAME","IFRAME_TYPE"]);if(!BX.clipboard.copy(t)){return}var n=new BX.PopupWindow("catalog_copy_document_url_to_clipboard",document.getElementById(this.settings.copyLinkButtonId),{content:u.Loc.getMessage("DOCUMENT_LINK_COPIED"),darkMode:true,autoHide:true,zIndex:1e3,angle:true,bindOptions:{position:"top"}});n.show();setTimeout((function(){n.close()}),1500)}},{key:"setSliderText",value:function e(){var t=BX.SidePanel.Instance.getTopSlider();if(t){t.getLabel().setText(u.Loc.getMessage("SLIDER_LABEL_".concat(this.documentType)))}}},{key:"disableSaveAndConductButton",value:function e(){if(!this.conductAndSaveButton){return}this.conductAndSaveButton.disabled=true;BX.addClass(this.conductAndSaveButton,"ui-btn-disabled")}},{key:"enableSaveAndConductButton",value:function e(){if(!this.conductAndSaveButton){return}this.conductAndSaveButton.disabled=false;BX.removeClass(this.conductAndSaveButton,"ui-btn-disabled")}},{key:"isLockedCancellation",value:function e(){return this.lockedCancellation}},{key:"showCancellationInfo",value:function e(){var t=this;var n=new r.Popup(null,null,{events:{onPopupClose:function e(){n.destroy()}},content:this.getCancellationPopupContent(),overlay:true,buttons:[new i.Button({text:u.Loc.getMessage("CANCEL_CONDUCT_CANCELLATION_POPUP_YES"),color:i.Button.Color.PRIMARY,onclick:function e(){var r;t.lockedCancellation=false;(r=t.getEditorInstance())===null||r===void 0?void 0:r.performAction("CANCEL_CONDUCT");n.close()}}),new BX.UI.Button({text:u.Loc.getMessage("CANCEL_CONDUCT_CANCELLATION_POPUP_NO"),color:BX.UI.Button.Color.LINK,onclick:function e(){n.close()}})]});n.show()}},{key:"getCancellationPopupContent",value:function e(){var t=u.Tag.render(U||(U=babelHelpers.taggedTemplateLiteral(['<a href="#" class="ui-form-link">',"</a>"])),u.Loc.getMessage("CANCEL_CONDUCT_CANCELLATION_POPUP_LINK"));u.Event.bind(t,"click",(function(){var e=17858278;top.BX.Helper.show("redirect=detail&code=".concat(e))}));var n=u.Tag.render(X||(X=babelHelpers.taggedTemplateLiteral(["\n\t\t\t<div>","</div>\n\t\t"])),u.Loc.getMessage("CANCEL_CONDUCT_CANCELLATION_POPUP_HINT",{"#HELP_LINK#":"<help-link></help-link>"}));u.Dom.replace(n.querySelector("help-link"),t);return u.Tag.render(A||(A=babelHelpers.taggedTemplateLiteral(["\n\t\t\t<div>\n\t\t\t\t<h3>","</h3>\n\t\t\t\t<div>","\n\t\t\t\t<br>","<div>\n\t\t\t</div>\n\t\t"])),u.Loc.getMessage("CANCEL_CONDUCT_CANCELLATION_POPUP_TITLE"),u.Text.encode(u.Loc.getMessage("CANCEL_CONDUCT_CANCELLATION_POPUP_QUESTION")),n)}}],[{key:"getInstance",value:function e(){return R(t,t,Y)}},{key:"registerFieldFactory",value:function e(){x(t,t,q,new O)}},{key:"registerModelFactory",value:function e(){x(t,t,V,new D)}},{key:"registerDocumentControllersFactory",value:function e(n){x(t,t,K,new _(n))}}]);return t}(t.BaseCard);var Y={writable:true,value:void 0};var q={writable:true,value:void 0};var V={writable:true,value:void 0};var K={writable:true,value:void 0};var Q;var J=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"render",value:function e(t,n){var r=u.Loc.getMessage("FEEDBACK_BUTTON_TITLE");var i=u.Tag.render(Q||(Q=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<button class="ui-btn ui-btn-light-border ui-btn-themes" title="','">\n\t\t\t\t<span class="ui-btn-text">\n\t\t\t\t\t',"\n\t\t\t\t</span>\n\t\t\t</button>\n\t\t"])),r,r);if(n){i.style.zIndex=140;i.style.backgroundColor="#fff"}i.addEventListener("click",(function(){BX.Catalog.DocumentCard.Slider.openFeedbackForm()}));t.appendChild(i);return i}}]);return e}();function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ee(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ee=function t(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function e(t,n,r){return t[n]=r}}function c(e,t,n,i){var a=t&&t.prototype instanceof p?t:p,o=Object.create(a.prototype),l=new I(i||[]);return r(o,"_invoke",{value:E(e,n,l)}),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function p(){}function h(){}function f(){}var v={};s(v,a,(function(){return this}));var b=Object.getPrototypeOf,g=b&&b(b(k([])));g&&g!==t&&n.call(g,a)&&(v=g);var y=f.prototype=p.prototype=Object.create(v);function C(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function m(e,t){function i(r,a,o,l){var s=u(e[r],e,a);if("throw"!==s.type){var c=s.arg,d=c.value;return d&&"object"==babelHelpers["typeof"](d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,o,l)}),(function(e){i("throw",e,o,l)})):t.resolve(d).then((function(e){c.value=e,o(c)}),(function(e){return i("throw",e,o,l)}))}l(s.arg)}var a;r(this,"_invoke",{value:function e(n,r){function o(){return new t((function(e,t){i(n,r,e,t)}))}return a=a?a.then(o,o):o()}})}function E(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return w()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var l=T(o,n);if(l){if(l===d)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=u(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}function T(e,t){var n=t.method,r=e.iterator[n];if(undefined===r)return t.delegate=null,"throw"===n&&e.iterator["return"]&&(t.method="return",t.arg=undefined,T(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=u(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=undefined),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function k(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=undefined,t.done=!0,t};return i.next=i}}return{next:w}}function w(){return{value:undefined,done:!0}}return h.prototype=f,r(y,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:h,configurable:!0}),h.displayName=s(f,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,s(e,l,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},C(m.prototype),s(m.prototype,o,(function(){return this})),e.AsyncIterator=m,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new m(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},C(y),s(y,l,"Generator"),s(y,a,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=k,I.prototype={constructor:I,reset:function e(t){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(L),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=undefined)},stop:function e(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function e(t){if(this.done)throw t;var r=this;function i(e,n){return l.type="throw",l.arg=t,r.next=e,n&&(r.method="next",r.arg=undefined),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],l=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function e(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=r&&r<=o.finallyLoc&&(o=null);var l=o?o.completion:{};return l.type=t,l.arg=r,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(l)},complete:function e(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),d},finish:function e(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),d}},catch:function e(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var a=i.arg;L(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function e(t,n,r){return this.delegate={iterator:k(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=undefined),d}},e}var te=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"openFeedbackForm",value:function t(){BX.UI.Feedback.Form.open(e.getFeedbackParams())}},{key:"openIntegrationRequestForm",value:function(){var e=babelHelpers.asyncToGenerator(ee().mark((function e(t){var n,r,i,a,o;return ee().wrap((function e(l){while(1)switch(l.prev=l.next){case 0:if(t&&u.Type.isFunction(t.preventDefault)){t.preventDefault()}l.prev=1;l.next=4;return u.ajax.runComponentAction("bitrix:catalog.feedback","getFormParams",{mode:"class"});case 4:n=l.sent;l.next=7;return u.Runtime.loadExtension(["ui.feedback.form"]);case 7:r=l.sent;i=r.Form;a=Math.round(Math.random()*1e3);o=n.data;o.id+=a.toString();i.open(o);l.next=19;break;case 15:l.prev=15;l.t0=l["catch"](1);l.next=19;return console.error(l.t0);case 19:case"end":return l.stop()}}),e,null,[[1,15]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"open",value:function e(t,n){var r=u.Type.isPlainObject(n)?n:{};r=$({cacheable:false,allowChangeHistory:false,events:{}},r);return new Promise((function(e){if(u.Type.isString(t)&&t.length>1){r.events.onClose=function(t){e(t.getSlider())};BX.SidePanel.Instance.open(t,n)}else{e()}}))}},{key:"getFeedbackParams",value:function e(){return{id:"catalog-feedback-".concat(parseInt(Math.random()*1e3,10)),forms:[{id:384,lang:"ru",sec:"0pskpd",zones:["ru","by","kz"]},{id:392,lang:"en",sec:"siqjqa",zones:["en","ua"]},{id:388,lang:"es",sec:"53t2bu",zones:["es"]},{id:390,lang:"de",sec:"mhglfc",zones:["de"]},{id:386,lang:"com.br",sec:"t6tdpy",zones:["com.br"]}]}}}]);return e}();e.DocumentCard=W;e.ProductListController=f;e.FeedbackButton=J;e.Slider=te})(this.BX.Catalog.DocumentCard=this.BX.Catalog.DocumentCard||{},BX.Catalog.EntityCard,BX.Catalog.Store,BX.Main,BX.UI,BX.UI,BX.Currency,BX.UI.EntitySelector,BX.Event,BX.UI.Feedback,BX);
//# sourceMappingURL=document-card.bundle.map.js