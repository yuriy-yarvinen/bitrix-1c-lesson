{"version":3,"file":"registry.bundle.js","sources":["../src/pay-system-application.js","../src/payment-paid-application.js","../src/payment.js"],"sourcesContent":["import { BitrixVue } from 'ui.vue';\n\nimport 'sale.payment-pay.components';\n\nBitrixVue.component('sale-checkout-view-payment-pay_system_application', {\n\tprops: ['order', 'paySystems', 'config'],\n\tmethods:\n\t{\n\t\tprepare(items)\n\t\t{\n\t\t\tlet paymentProcess = {\n\t\t\t\treturnUrl: this.config.returnUrl,\n\t\t\t\torderId: this.order.id,\n\t\t\t\taccessCode: this.order.hash,\n\t\t\t\tallowPaymentRedirect: true\n\t\t\t}\n\n\t\t\tlet paySystems = items.map((item)=>\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tID: item.id,\n\t\t\t\t\tNAME: item.name,\n\t\t\t\t\tLOGOTIP: item.picture,\n\t\t\t\t}\n\t\t\t})\n\n\t\t\treturn {\n\t\t\t\tapp: { paySystems },\n\t\t\t\tpaymentProcess\n\t\t\t}\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<sale-payment_pay-components-application-pay_system :options=\"prepare(paySystems)\"/>\n\t`\n});","import { BitrixVue } from 'ui.vue';\nimport { Type } from 'main.core';\nimport {CurrencyCore} from 'currency.currency-core';\n\nimport 'sale.payment-pay.components';\n\nBitrixVue.component('sale-checkout-view-payment-payment_paid_application', {\n\tprops: ['order', 'payments', 'paySystems', 'check', 'config'],\n\tmethods:\n\t{\n\t\tgetChecksByPaymentId(paymentId)\n\t\t{\n\t\t\tconst result = [];\n\t\t\tlet list = this.check;\n\n\t\t\tif(Type.isArrayFilled(list))\n\t\t\t{\n\t\t\t\tlist.forEach((fields) =>\n\t\t\t\t{\n\t\t\t\t\tif(fields.paymentId === paymentId)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push({\n\t\t\t\t\t\t\tstatus: fields.status,\n\t\t\t\t\t\t\tlink: fields.link,\n\t\t\t\t\t\t\tid: fields.id,\n\t\t\t\t\t\t\tdateFormatted: fields.dateFormatted\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\treturn result\n\t\t},\n\n\t\tgetFirstPaymentPaidY()\n\t\t{\n\t\t\treturn this.payments[0];\n\t\t},\n\n\t\tgetPaySystemById(id)\n\t\t{\n\t\t\tlet paySystem = this.paySystems.find(item => item.id === id)\n\t\t\treturn !!paySystem ? paySystem:null\n\t\t},\n\n\t\tprepare()\n\t\t{\n\t\t\tlet result = null\n\n\t\t\tlet item = this.getFirstPaymentPaidY()\n\t\t\tif(item !== null)\n\t\t\t{\n\t\t\t\tlet paySystem = this.getPaySystemById(item.paySystemId)\n\n\t\t\t\tlet list = [];\n\t\t\t\tlist.push({\n\t\t\t\t\tID: paySystem.id,\n\t\t\t\t\tNAME: paySystem.name,\n\t\t\t\t\tLOGOTIP: paySystem.picture\n\t\t\t\t})\n\n\t\t\t\tlet app = {\n\t\t\t\t\tpaySystems: list,\n\t\t\t\t\ttitle: this.getTitle(item)\n\t\t\t\t}\n\n\t\t\t\tlet payment = {\n\t\t\t\t\tsumFormatted: this.sumFormatted(item),\n\t\t\t\t\tpaid: item.paid === 'Y',\n\t\t\t\t\tchecks: this.getChecksByPaymentId(item.id),\n\t\t\t\t};\n\n\t\t\t\tlet paymentProcess = {\n\t\t\t\t\treturnUrl: this.config.returnUrl,\n\t\t\t\t\torderId: this.order.id,\n\t\t\t\t\taccessCode: this.order.hash,\n\t\t\t\t\tallowPaymentRedirect: true,\n\t\t\t\t\tpaymentId: item.id\n\t\t\t\t}\n\n\t\t\t\tresult = {\n\t\t\t\t\tapp,\n\t\t\t\t\tpayment,\n\t\t\t\t\tpaymentProcess\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result\n\t\t},\n\t\tsumFormatted(item)\n\t\t{\n\t\t\treturn CurrencyCore.currencyFormat(item.sum, item.currency, true);\n\t\t},\n\t\tgetTitle(item)\n\t\t{\n\t\t\treturn this.localize.CHECKOUT_VIEW_PAYMENT_PAYMENT_INFO\n\t\t\t\t.replace('#DATE_INSERT#', item.dateBillFormatted)\n\t\t\t\t.replace('#ACCOUNT_NUMBER#', item.accountNumber)\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn Object.freeze(\n\t\t\t\tBitrixVue.getFilteredPhrases('CHECKOUT_VIEW_PAYMENT'))\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<sale-payment_pay-components-application-payment :options=\"prepare()\"/>\n\t`\n});","import { BitrixVue } from 'ui.vue';\n\nimport './pay-system-application'\nimport './payment-paid-application'\n\nBitrixVue.component('sale-checkout-view-payment', {\n\tprops: ['order', 'payments', 'paySystems', 'check', 'config'],\n\tmethods:\n\t{\n\t\thasPaymentPaidY()\n\t\t{\n\t\t\treturn this\n\t\t\t.getPaymentPaidY()\n\t\t\t\t.length > 0\n\t\t},\n\t\tgetPaymentPaidY()\n\t\t{\n\t\t\tconst result = [];\n\t\t\tlet list = this.payments;\n\t\t\tlist.forEach((fields) =>\n\t\t\t{\n\t\t\t\tif(fields.paid !== 'N')\n\t\t\t\t{\n\t\t\t\t\tresult.push(fields)\n\t\t\t\t}\n\t\t\t})\n\t\t\treturn result\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t  <div>\n\t  <template v-if=\"hasPaymentPaidY()\">\n        <sale-checkout-view-payment-payment_paid_application :order=\"order\" :payments=\"getPaymentPaidY()\" :paySystems=\"paySystems\" :check=\"check\" :config=\"config\"/>\n      </template>\n      <template v-else>\n        <sale-checkout-view-payment-pay_system_application :order=\"order\" :paySystems=\"paySystems\" :config=\"config\"/>\n\t  </template>\n\t</div>\n\t`\n});"],"names":["BitrixVue","component","props","methods","prepare","items","paymentProcess","returnUrl","config","orderId","order","id","accessCode","hash","allowPaymentRedirect","paySystems","map","item","ID","NAME","name","LOGOTIP","picture","app","template","getChecksByPaymentId","paymentId","result","list","check","Type","isArrayFilled","forEach","fields","push","status","link","dateFormatted","getFirstPaymentPaidY","payments","getPaySystemById","paySystem","find","paySystemId","title","getTitle","payment","sumFormatted","paid","checks","CurrencyCore","currencyFormat","sum","currency","localize","CHECKOUT_VIEW_PAYMENT_PAYMENT_INFO","replace","dateBillFormatted","accountNumber","computed","Object","freeze","getFilteredPhrases","hasPaymentPaidY","getPaymentPaidY","length"],"mappings":";;;;;;;;AAIAA,iBAAS,CAACC,SAAS,CAAC,mDAAmD,EAAE;GACxEC,KAAK,EAAE,CAAC,OAAO,EAAE,YAAY,EAAE,QAAQ,CAAC;GACxCC,OAAO,EACP;KACCC,OAAO,mBAACC,KAAK,EACb;OACC,IAAIC,cAAc,GAAG;SACpBC,SAAS,EAAE,IAAI,CAACC,MAAM,CAACD,SAAS;SAChCE,OAAO,EAAE,IAAI,CAACC,KAAK,CAACC,EAAE;SACtBC,UAAU,EAAE,IAAI,CAACF,KAAK,CAACG,IAAI;SAC3BC,oBAAoB,EAAE;QACtB;OAED,IAAIC,UAAU,GAAGV,KAAK,CAACW,GAAG,CAAC,UAACC,IAAI,EAChC;SACC,OAAO;WACNC,EAAE,EAAED,IAAI,CAACN,EAAE;WACXQ,IAAI,EAAEF,IAAI,CAACG,IAAI;WACfC,OAAO,EAAEJ,IAAI,CAACK;UACd;QACD,CAAC;OAEF,OAAO;SACNC,GAAG,EAAE;WAAER,UAAU,EAAVA;UAAY;SACnBT,cAAc,EAAdA;QACA;;IAEF;;GAEDkB,QAAQ;CAGT,CAAC,CAAC;;AC9BFxB,iBAAS,CAACC,SAAS,CAAC,qDAAqD,EAAE;GAC1EC,KAAK,EAAE,CAAC,OAAO,EAAE,UAAU,EAAE,YAAY,EAAE,OAAO,EAAE,QAAQ,CAAC;GAC7DC,OAAO,EACP;KACCsB,oBAAoB,gCAACC,SAAS,EAC9B;OACC,IAAMC,MAAM,GAAG,EAAE;OACjB,IAAIC,IAAI,GAAG,IAAI,CAACC,KAAK;OAErB,IAAGC,cAAI,CAACC,aAAa,CAACH,IAAI,CAAC,EAC3B;SACCA,IAAI,CAACI,OAAO,CAAC,UAACC,MAAM,EACpB;WACC,IAAGA,MAAM,CAACP,SAAS,KAAKA,SAAS,EACjC;aACCC,MAAM,CAACO,IAAI,CAAC;eACXC,MAAM,EAAEF,MAAM,CAACE,MAAM;eACrBC,IAAI,EAAEH,MAAM,CAACG,IAAI;eACjBzB,EAAE,EAAEsB,MAAM,CAACtB,EAAE;eACb0B,aAAa,EAAEJ,MAAM,CAACI;cACtB,CAAC;;UAEH,CAAC;;OAEH,OAAOV,MAAM;MACb;KAEDW,oBAAoB,kCACpB;OACC,OAAO,IAAI,CAACC,QAAQ,CAAC,CAAC,CAAC;MACvB;KAEDC,gBAAgB,4BAAC7B,EAAE,EACnB;OACC,IAAI8B,SAAS,GAAG,IAAI,CAAC1B,UAAU,CAAC2B,IAAI,CAAC,UAAAzB,IAAI;SAAA,OAAIA,IAAI,CAACN,EAAE,KAAKA,EAAE;SAAC;OAC5D,OAAO,CAAC,CAAC8B,SAAS,GAAGA,SAAS,GAAC,IAAI;MACnC;KAEDrC,OAAO,qBACP;OACC,IAAIuB,MAAM,GAAG,IAAI;OAEjB,IAAIV,IAAI,GAAG,IAAI,CAACqB,oBAAoB,EAAE;OACtC,IAAGrB,IAAI,KAAK,IAAI,EAChB;SACC,IAAIwB,SAAS,GAAG,IAAI,CAACD,gBAAgB,CAACvB,IAAI,CAAC0B,WAAW,CAAC;SAEvD,IAAIf,IAAI,GAAG,EAAE;SACbA,IAAI,CAACM,IAAI,CAAC;WACThB,EAAE,EAAEuB,SAAS,CAAC9B,EAAE;WAChBQ,IAAI,EAAEsB,SAAS,CAACrB,IAAI;WACpBC,OAAO,EAAEoB,SAAS,CAACnB;UACnB,CAAC;SAEF,IAAIC,GAAG,GAAG;WACTR,UAAU,EAAEa,IAAI;WAChBgB,KAAK,EAAE,IAAI,CAACC,QAAQ,CAAC5B,IAAI;UACzB;SAED,IAAI6B,OAAO,GAAG;WACbC,YAAY,EAAE,IAAI,CAACA,YAAY,CAAC9B,IAAI,CAAC;WACrC+B,IAAI,EAAE/B,IAAI,CAAC+B,IAAI,KAAK,GAAG;WACvBC,MAAM,EAAE,IAAI,CAACxB,oBAAoB,CAACR,IAAI,CAACN,EAAE;UACzC;SAED,IAAIL,cAAc,GAAG;WACpBC,SAAS,EAAE,IAAI,CAACC,MAAM,CAACD,SAAS;WAChCE,OAAO,EAAE,IAAI,CAACC,KAAK,CAACC,EAAE;WACtBC,UAAU,EAAE,IAAI,CAACF,KAAK,CAACG,IAAI;WAC3BC,oBAAoB,EAAE,IAAI;WAC1BY,SAAS,EAAET,IAAI,CAACN;UAChB;SAEDgB,MAAM,GAAG;WACRJ,GAAG,EAAHA,GAAG;WACHuB,OAAO,EAAPA,OAAO;WACPxC,cAAc,EAAdA;UACA;;OAGF,OAAOqB,MAAM;MACb;KACDoB,YAAY,wBAAC9B,IAAI,EACjB;OACC,OAAOiC,kCAAY,CAACC,cAAc,CAAClC,IAAI,CAACmC,GAAG,EAAEnC,IAAI,CAACoC,QAAQ,EAAE,IAAI,CAAC;MACjE;KACDR,QAAQ,oBAAC5B,IAAI,EACb;OACC,OAAO,IAAI,CAACqC,QAAQ,CAACC,kCAAkC,CACrDC,OAAO,CAAC,eAAe,EAAEvC,IAAI,CAACwC,iBAAiB,CAAC,CAChDD,OAAO,CAAC,kBAAkB,EAAEvC,IAAI,CAACyC,aAAa,CAAC;;IAElD;GACDC,QAAQ,EACR;KACCL,QAAQ,sBACR;OACC,OAAOM,MAAM,CAACC,MAAM,CACnB7D,gBAAS,CAAC8D,kBAAkB,CAAC,uBAAuB,CAAC,CAAC;;IAExD;;GAEDtC,QAAQ;CAGT,CAAC,CAAC;;AC1GFxB,iBAAS,CAACC,SAAS,CAAC,4BAA4B,EAAE;GACjDC,KAAK,EAAE,CAAC,OAAO,EAAE,UAAU,EAAE,YAAY,EAAE,OAAO,EAAE,QAAQ,CAAC;GAC7DC,OAAO,EACP;KACC4D,eAAe,6BACf;OACC,OAAO,IAAI,CACVC,eAAe,EAAE,CAChBC,MAAM,GAAG,CAAC;MACZ;KACDD,eAAe,6BACf;OACC,IAAMrC,MAAM,GAAG,EAAE;OACjB,IAAIC,IAAI,GAAG,IAAI,CAACW,QAAQ;OACxBX,IAAI,CAACI,OAAO,CAAC,UAACC,MAAM,EACpB;SACC,IAAGA,MAAM,CAACe,IAAI,KAAK,GAAG,EACtB;WACCrB,MAAM,CAACO,IAAI,CAACD,MAAM,CAAC;;QAEpB,CAAC;OACF,OAAON,MAAM;;IAEd;;GAEDH,QAAQ;CAUT,CAAC,CAAC;;;;"}