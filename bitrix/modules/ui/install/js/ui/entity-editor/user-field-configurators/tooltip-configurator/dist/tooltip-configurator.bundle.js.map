{"version":3,"file":"tooltip-configurator.bundle.js","sources":["../src/text-input.js","../src/tooltip-configurator.js"],"sourcesContent":["import { Type, Tag, Loc, util, Dom } from 'main.core';\nimport type { TooltipConfigurator } from './tooltip-configurator';\nimport './style.css';\n\nexport class TextInput\n{\n\t#id: string;\n\t#inputText: string;\n\t#labelText: string;\n\t#configurator: TooltipConfigurator;\n\t#errorLayout: HTMLElement;\n\t#inputLayout: HTMLInputElement;\n\t#wrapper: HTMLElement;\n\n\tconstructor(\n\t\tid: string,\n\t\tconfigurator: TooltipConfigurator,\n\t\tinputText: string,\n\t)\n\t{\n\t\tthis.#id = id !== '' ? id : util.getRandomString(4);\n\t\tthis.#configurator = configurator;\n\t\tthis.#inputText = inputText;\n\n\t\tthis.#labelText = Loc.getMessage('UI_ENTITY_EDITOR_UF_CONFIGURATORS_TOOLTIP_INPUT_LABEL');\n\t\tthis.#errorLayout = null;\n\t\tthis.#inputLayout = null;\n\t\tthis.#wrapper = null;\n\t}\n\n\tprepareLayout(): HTMLElement\n\t{\n\t\tthis.#inputLayout = Tag.render`\n\t\t\t<textarea \n\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\trows=\"3\"\n\t\t\t\tid=\"${this.#id}\"\n\t\t\t>${this.#inputText}</textarea>\n\t\t`;\n\n\t\tconst label = Tag.render`\n\t\t\t<label class=\"ui-entity-editor-block-title\">\n\t\t\t\t${this.#labelText}\n\t\t\t</label>\n\t\t`;\n\n\t\tthis.#wrapper = Tag.render`\n\t\t\t<div class=\"ui-entity-editor-new-field-visibility-wrapper\">\n\t\t\t\t${label}\n\t\t\t\t${this.#inputLayout}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#wrapper;\n\t}\n\n\trenderError(errorText): void\n\t{\n\t\tif (Type.isNull(this.#errorLayout))\n\t\t{\n\t\t\tthis.#errorLayout = Tag.render`\n\t\t\t\t<label class=\"ui-entity-editor-user-field-setting-error-text\"></label>\n\t\t\t`;\n\n\t\t\tthis.#wrapper.append(this.#errorLayout);\n\t\t}\n\n\t\tthis.#errorLayout.innerHTML = errorText;\n\t}\n\n\tadjustVisibility(): void\n\t{\n\t\tif (this.#configurator.isInputEnabled())\n\t\t{\n\t\t\tDom.show(this.#wrapper);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.hide(this.#wrapper);\n\t\t}\n\t}\n\n\tgetInputText(): string\n\t{\n\t\treturn this.#inputLayout.value;\n\t}\n}\n","import { Type, Event, Loc, util } from 'main.core';\nimport { TextInput } from './text-input';\n\nconst MAX_TOOLTIP_LENGTH = 250;\n\nexport class TooltipConfigurator\n{\n\t#id: string;\n\t#editor: BX.UI.EntityEditor;\n\t#field: BX.UI.EntityEditorUserField;\n\t#previousTooltip: string;\n\t#caption: string;\n\t#textInput: TextInput;\n\t#checkBox: HTMLElement;\n\t#isShowInput: boolean;\n\t#checkBoxHandler: function;\n\n\tconstructor(\n\t\tid: string,\n\t\teditor: BX.UI.EntityEditor,\n\t\tfield: BX.UI.EntityEditorUserField,\n\t)\n\t{\n\t\tthis.#id = id !== '' ? id : util.getRandomString(4);\n\t\tthis.#editor = editor;\n\t\tthis.#field = field;\n\n\t\tthis.#previousTooltip = this.#field?._schemeElement?._hint ?? '';\n\t\tthis.#isShowInput = Boolean(this.#previousTooltip);\n\n\t\tthis.#checkBoxHandler = this.#onCheckBoxClick.bind(this);\n\t\tthis.#textInput = null;\n\t\tthis.#checkBox = null;\n\t\tthis.#caption = Loc.getMessage('UI_ENTITY_EDITOR_UF_CONFIGURATORS_TOOLTIP_CHECKBOX_LABEL');\n\t}\n\n\tvalidateInputText(): boolean\n\t{\n\t\tconst input = this.getInput();\n\t\tconst text = input.getInputText();\n\n\t\tif (text.length > MAX_TOOLTIP_LENGTH)\n\t\t{\n\t\t\tconst errorText = Loc.getMessage(\n\t\t\t\t'UI_ENTITY_EDITOR_UF_CONFIGURATORS_TOOLTIP_LENGTH_VALIDATION_ERROR',\n\t\t\t\t{\n\t\t\t\t\t'#MAX_LENGTH#': MAX_TOOLTIP_LENGTH,\n\t\t\t\t},\n\t\t\t);\n\t\t\tinput.renderError(errorText);\n\n\t\t\treturn false;\n\t\t}\n\n\t\tinput.renderError('');\n\n\t\treturn true;\n\t}\n\n\tsetCheckBox(checkBox: HTMLElement)\n\t{\n\t\tif (!Type.isNull(this.#checkBox))\n\t\t{\n\t\t\tEvent.unbind(this.#checkBox, 'click', this.#checkBoxHandler);\n\t\t}\n\n\t\tthis.#checkBox = checkBox;\n\t\tif (this.isInputEnabled())\n\t\t{\n\t\t\tthis.#checkBox.checked = true;\n\t\t}\n\n\t\tif (!Type.isNull(this.#checkBox))\n\t\t{\n\t\t\tEvent.bind(this.#checkBox, 'click', this.#checkBoxHandler);\n\t\t}\n\t}\n\n\tgetTooltip(): string\n\t{\n\t\treturn this.isInputEnabled() ? this.getInput().getInputText() : '';\n\t}\n\n\tgetCaption(): string\n\t{\n\t\treturn this.#caption;\n\t}\n\n\tisInputEnabled(): boolean\n\t{\n\t\treturn this.#isShowInput;\n\t}\n\n\tgetInput(): TextInput\n\t{\n\t\tif (Type.isNull(this.#textInput))\n\t\t{\n\t\t\tthis.#textInput = new TextInput(\n\t\t\t\tthis.#id,\n\t\t\t\tthis,\n\t\t\t\tthis.#previousTooltip,\n\t\t\t);\n\t\t}\n\n\t\treturn this.#textInput;\n\t}\n\n\t#onCheckBoxClick(): void\n\t{\n\t\tthis.#isShowInput = !this.#isShowInput;\n\t\tthis.#textInput.adjustVisibility();\n\t}\n}\n"],"names":["TextInput","id","configurator","inputText","util","getRandomString","Loc","getMessage","Tag","render","label","errorText","Type","isNull","append","innerHTML","isInputEnabled","Dom","show","hide","value","MAX_TOOLTIP_LENGTH","TooltipConfigurator","editor","field","_classPrivateFieldInitSpec","_schemeElement","_hint","Boolean","bind","input","getInput","text","getInputText","length","renderError","checkBox","Event","unbind","checked","adjustVisibility"],"mappings":"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"}