{"version":3,"file":"v2.bundle.js","sources":["../src/service/value/type/base.js","../src/service/value/type/dependent-variables.js","../src/service/value/type/multivariables.js","../src/service/value/type/toggler.js","../src/service/value/type/variables.js","../src/integration/entity-selector/dictionary.js","../src/service/selector-service.js","../src/service/service-locator.js","../src/components/header/members/selector.js","../src/components/header/members/single-member.js","../src/components/header/members.js","../src/components/header/role-heading.js","../src/integration/entity-selector/items-mapper.js","../src/store/model/user-groups-model.js","../src/utils.js","../src/components/layout/cell-layout.js","../src/components/layout/column-layout.js","../src/components/header/roles-control.js","../src/components/util/sync-horizontal-scroll.js","../src/components/header.js","../src/components/searchbox.js","../src/components/member-selector.js","../src/store/model/transformation/internalizer/access-rights-internalizer.js","../src/store/model/access-rights-model.js","../src/components/section/column/menu-cell.js","../src/components/section/icon.js","../src/components/section/value/popup-header/locator.js","../src/components/section/value/popup-header/master-switcher.js","../src/components/section/value/popup-header/master-switcher/single-role-title.js","../src/components/section/value/dependent-variables/popup-header.js","../src/components/section/value/dependent-variables/popup-content.js","../src/components/section/value/popup-header/master-switcher/all-roles-title.js","../src/components/section/value/value-popup.js","../src/components/section/title-column/value/dependent-variables.js","../src/integration/entity-selector/footer.js","../src/integration/entity-selector/header.js","../src/components/section/value/multivariables/selector.js","../src/components/section/title-column/value/multivariables.js","../src/components/section/title-column/value/variables.js","../src/components/util/selected-hint.js","../src/components/section/column/value/dependent-variables.js","../src/components/section/column/value/multivariables.js","../src/components/section/column/value/toggler.js","../src/components/section/column/value/variables.js","../src/components/section/value/registry.js","../src/components/section/column/value-cell.js","../src/components/section/column.js","../src/components/section/column-list.js","../src/components/util/hint.js","../src/components/section/header.js","../src/components/section/title-column/menu-cell.js","../src/components/section/title-column/row-value.js","../src/components/section/title-column/title-cell.js","../src/components/section/title-column.js","../src/components/section.js","../src/components/loader/grid/grid-skeleton.js","../src/components/grid.js","../src/integration/analytics-manager.js","../src/store/model/application-model.js","../src/store/index.js","../src/store/model/transformation/backend-exporter/access-rights-exporter.js","../src/store/model/transformation/backend-exporter/user-groups/base-user-groups-exporter.js","../src/store/model/transformation/backend-exporter/user-groups/all-user-groups-exporter.js","../src/store/model/transformation/backend-exporter/user-groups/only-changed-user-groups-exporter.js","../src/store/model/transformation/internalizer/application-internalizer.js","../src/store/model/transformation/internalizer/user-groups-internalizer.js","../src/store/model/transformation/shown-user-groups-copier.js","../src/app.js"],"sourcesContent":["import { Type } from 'main.core';\nimport type { AccessRightItem } from '../../../store/model/access-rights-model';\nimport { type ValueType } from './value-type';\n\n/**\n * @abstract\n */\nexport class Base implements ValueType\n{\n\t/*\n\t * @abstract\n\t */\n\tgetComponentName(): string\n\t{\n\t\tthrow new Error('not implemented');\n\t}\n\n\tgetEmptyValue(item: AccessRightItem): Set<string>\n\t{\n\t\treturn item.emptyValue ?? new Set();\n\t}\n\n\tgetMinValue(item: AccessRightItem): ?Set<string>\n\t{\n\t\tif (!Type.isNil(item.minValue))\n\t\t{\n\t\t\treturn item.minValue;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetMaxValue(item: AccessRightItem): ?Set<string>\n\t{\n\t\tif (!Type.isNil(item.maxValue))\n\t\t{\n\t\t\treturn item.maxValue;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tisRowValueConfigurable(): boolean\n\t{\n\t\treturn true;\n\t}\n}\n","import { Base } from './base';\n\nexport class DependentVariables extends Base\n{\n\tgetComponentName(): string\n\t{\n\t\treturn 'DependentVariables';\n\t}\n}\n","import { Base } from './base';\n\nexport class Multivariables extends Base\n{\n\tgetComponentName(): string\n\t{\n\t\treturn 'Multivariables';\n\t}\n}\n","import { Type } from 'main.core';\nimport type { AccessRightItem } from '../../../store/model/access-rights-model';\nimport { Base } from './base';\n\nexport class Toggler extends Base\n{\n\tgetComponentName(): string\n\t{\n\t\treturn 'Toggler';\n\t}\n\n\tgetEmptyValue(item: AccessRightItem): Set<string>\n\t{\n\t\tconst isFalsy = !item.emptyValue || !item.emptyValue[0];\n\t\tif (isFalsy)\n\t\t{\n\t\t\t// use explicit '0' for correctly identify modifications\n\t\t\treturn new Set(['0']);\n\t\t}\n\n\t\treturn super.getEmptyValue(item);\n\t}\n\n\tgetMinValue(item: AccessRightItem): ?Set<string>\n\t{\n\t\tconst explicit = super.getMinValue(item);\n\t\tif (!Type.isNull(explicit))\n\t\t{\n\t\t\treturn explicit;\n\t\t}\n\n\t\treturn new Set(['0']);\n\t}\n\n\tgetMaxValue(item: AccessRightItem): ?Set<string>\n\t{\n\t\tconst explicit = super.getMaxValue(item);\n\t\tif (!Type.isNull(explicit))\n\t\t{\n\t\t\treturn explicit;\n\t\t}\n\n\t\treturn new Set(['1']);\n\t}\n\n\tisRowValueConfigurable(): boolean\n\t{\n\t\treturn false;\n\t}\n}\n","import { Base } from './base';\n\nexport class Variables extends Base\n{\n\tgetComponentName(): string\n\t{\n\t\treturn 'Variables';\n\t}\n}\n","export const EntitySelectorContext = Object.freeze({\n\tROLE: 'ui.accessrights.v2~role-selector',\n\tMEMBER: 'ui.accessrights.v2~member-selector',\n\tVARIABLE: 'ui.accessrights.v2~variable-selector',\n\tUSER: 'ui.accessrights.v2~user-selector',\n});\n\nexport const EntitySelectorEntities = Object.freeze({\n\tROLE: 'ui.accessrights.v2~role',\n\tVARIABLE: 'ui.accessrights.v2~variable',\n});\n","import { Type } from 'main.core';\nimport { Dialog, type DialogOptions, type EntityOptions, type Item, type ItemId } from 'ui.entity-selector';\nimport { EntitySelectorContext } from '../integration/entity-selector/dictionary';\nimport type { AdditionalMembersParams } from '../store/model/application-model';\nimport type { Member } from '../store/model/user-groups-model';\n\ndeclare type StructureNodeEntityTypeInfo = {\n\tcommonPrefix: string,\n\trecursivePrefix: string,\n\tmemberType: string,\n};\n\nconst STRUCTURE_NODE_ENTITY_TYPE = Object.freeze({\n\tTEAM: 'team',\n\tDEPARTMENT: 'department',\n});\n\nconst STRUCTURE_NODE_ENTITY_TYPE_INFO: Object<string, StructureNodeEntityTypeInfo> = Object.freeze({\n\t[STRUCTURE_NODE_ENTITY_TYPE.DEPARTMENT]: {\n\t\tcommonPrefix: 'SND',\n\t\trecursivePrefix: 'SNDR',\n\t\tmemberType: 'structuredepartments',\n\t},\n\t[STRUCTURE_NODE_ENTITY_TYPE.TEAM]: {\n\t\tcommonPrefix: 'SNT',\n\t\trecursivePrefix: 'SNTR',\n\t\tmemberType: 'structureteams',\n\t},\n});\n\nexport class SelectorService\n{\n\t#options: AdditionalMembersParams;\n\n\tconstructor(options: AdditionalMembersParams)\n\t{\n\t\tthis.#options = options;\n\t}\n\n\tcreateDialog(dialogOptions: DialogOptions): Dialog\n\t{\n\t\treturn new Dialog({\n\t\t\t...dialogOptions,\n\t\t\tcontext: EntitySelectorContext.MEMBER,\n\t\t\tenableSearch: true,\n\t\t\talwaysShowLabels: true,\n\t\t\tcacheable: false,\n\t\t\tentities: dialogOptions.entities ?? this.entities(),\n\t\t});\n\t}\n\n\tentities(): EntityOptions[]\n\t{\n\t\tconst entities: EntityOptions[] = [\n\t\t\t{\n\t\t\t\tid: 'user',\n\t\t\t\toptions: {\n\t\t\t\t\tintranetUsersOnly: true,\n\t\t\t\t\temailUsers: false,\n\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\tinviteGuestLink: false,\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\n\t\tconst includedNodeEntityTypes = [];\n\t\tif (this.#options.useStructureDepartmentsProviderTab)\n\t\t{\n\t\t\tincludedNodeEntityTypes.push('department');\n\t\t}\n\n\t\tif (this.#options.addStructureTeamsProviderTab)\n\t\t{\n\t\t\tincludedNodeEntityTypes.push('team');\n\t\t}\n\n\t\tif (includedNodeEntityTypes.length > 0)\n\t\t{\n\t\t\tentities.push({\n\t\t\t\tid: 'structure-node',\n\t\t\t\toptions: {\n\t\t\t\t\tselectMode: 'usersAndDepartments',\n\t\t\t\t\tallowSelectRootDepartment: true,\n\t\t\t\t\tallowFlatDepartments: true,\n\t\t\t\t\tincludedNodeEntityTypes,\n\t\t\t\t\tuseMultipleTabs: true,\n\t\t\t\t\tvisual: {\n\t\t\t\t\t\tavatarMode: 'node',\n\t\t\t\t\t\ttagStyle: 'none',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tif (!this.#options.useStructureDepartmentsProviderTab)\n\t\t{\n\t\t\tentities.push({\n\t\t\t\tid: 'department',\n\t\t\t\toptions: {\n\t\t\t\t\tselectMode: 'usersAndDepartments',\n\t\t\t\t\tallowSelectRootDepartment: true,\n\t\t\t\t\tallowFlatDepartments: true,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tentities.push({\n\t\t\tid: 'site-groups',\n\t\t\tdynamicLoad: true,\n\t\t\tdynamicSearch: true,\n\t\t});\n\n\t\tif (this.#options.addStructureRolesProviderTab)\n\t\t{\n\t\t\tentities.push({\n\t\t\t\tid: 'structure-role',\n\t\t\t\toptions: {\n\t\t\t\t\tincludedNodeEntityTypes: ['team', 'department'],\n\t\t\t\t},\n\t\t\t\tdynamicLoad: true,\n\t\t\t\tdynamicSearch: true,\n\t\t\t});\n\t\t}\n\n\t\tif (this.#options.addProjectsProviderTab)\n\t\t{\n\t\t\tentities.push({\n\t\t\t\tid: 'project-access-codes',\n\t\t\t});\n\t\t}\n\n\t\tif (this.#options.addUserGroupsProviderTab)\n\t\t{\n\t\t\tentities.push({\n\t\t\t\tid: 'user-groups',\n\t\t\t\tdynamicLoad: true,\n\t\t\t\toptions: {},\n\t\t\t});\n\t\t}\n\n\t\treturn entities;\n\t}\n\n\t// eslint-disable-next-line sonarjs/cognitive-complexity\n\tgetItemIdByAccessCode(accessCode: string): ItemId\n\t{\n\t\tif (/^I?U(\\d+)$/.test(accessCode))\n\t\t{\n\t\t\tconst match = accessCode.match(/^I?U(\\d+)$/) || null;\n\t\t\tconst userId = match ? match[1] : null;\n\n\t\t\treturn ['user', userId];\n\t\t}\n\n\t\tif (/^DR(\\d+)$/.test(accessCode))\n\t\t{\n\t\t\tconst match = accessCode.match(/^DR(\\d+)$/) || null;\n\t\t\tconst departmentId = match ? match[1] : null;\n\n\t\t\treturn ['department', departmentId];\n\t\t}\n\n\t\tif (/^D(\\d+)$/.test(accessCode))\n\t\t{\n\t\t\tconst match = accessCode.match(/^D(\\d+)$/) || null;\n\t\t\tconst departmentId = match ? match[1] : null;\n\n\t\t\treturn ['department', `${departmentId}:F`];\n\t\t}\n\n\t\tif (/^G(\\d+)$/.test(accessCode))\n\t\t{\n\t\t\tconst match = accessCode.match(/^G(\\d+)$/) || null;\n\t\t\tconst groupId = match ? match[1] : null;\n\n\t\t\treturn ['site-groups', groupId];\n\t\t}\n\n\t\tif (/^(?:ATD|ATE|ATT|AD|AE|AT)[1-9]\\d*$/.test(accessCode))\n\t\t{\n\t\t\treturn ['structure-role', accessCode];\n\t\t}\n\n\t\tif (accessCode.at(0) === 'A')\n\t\t{\n\t\t\treturn ['user-groups', accessCode];\n\t\t}\n\n\t\tif (/^SG(\\d+)_([AEK])$/.test(accessCode))\n\t\t{\n\t\t\treturn ['project-access-codes', accessCode];\n\t\t}\n\n\t\tif (/^SNT(\\d+)$/.test(accessCode))\n\t\t{\n\t\t\tconst match = accessCode.match(/^SNT(\\d+)$/) || null;\n\t\t\tconst structureNodeId = match ? match[1] : null;\n\n\t\t\treturn ['structure-node', `${structureNodeId}:F`];\n\t\t}\n\n\t\tif (/^SNTR(\\d+)$/.test(accessCode))\n\t\t{\n\t\t\tconst match = accessCode.match(/^SNTR(\\d+)$/) || null;\n\t\t\tconst structureNodeId = match ? match[1] : null;\n\n\t\t\treturn ['structure-node', structureNodeId];\n\t\t}\n\n\t\tif (/^SND(\\d+)$/.test(accessCode))\n\t\t{\n\t\t\tconst match = accessCode.match(/^SND(\\d+)$/) || null;\n\t\t\tconst structureNodeId = match ? match[1] : null;\n\n\t\t\treturn ['structure-node', `${structureNodeId}:F`];\n\t\t}\n\n\t\tif (/^SNDR(\\d+)$/.test(accessCode))\n\t\t{\n\t\t\tconst match = accessCode.match(/^SNDR(\\d+)$/) || null;\n\t\t\tconst structureNodeId = match ? match[1] : null;\n\n\t\t\treturn ['structure-node', structureNodeId];\n\t\t}\n\n\t\treturn ['unknown', accessCode];\n\t}\n\n\tgetMemberTypeByItem(item: Item): string\n\t{\n\t\tswitch (item.entityId)\n\t\t{\n\t\t\tcase 'user':\n\t\t\t\treturn 'users';\n\t\t\tcase 'intranet':\n\t\t\tcase 'department':\n\t\t\t\treturn 'departments';\n\t\t\tcase 'socnetgroup':\n\t\t\tcase 'project-access-codes':\n\t\t\t\treturn 'sonetgroups';\n\t\t\tcase 'group':\n\t\t\t\treturn 'groups';\n\t\t\tcase 'structure-node':\n\t\t\t\treturn this.getItemStructureNodeEntityTypeInfo(item, STRUCTURE_NODE_ENTITY_TYPE.TEAM).memberType;\n\t\t\tcase 'site-groups':\n\t\t\tcase 'user-groups':\n\t\t\tcase 'structure-role':\n\t\t\t\treturn 'usergroups';\n\t\t\tdefault:\n\t\t\t\treturn '';\n\t\t}\n\t}\n\n\tgetItemStructureNodeEntityTypeInfo(\n\t\titem: Item,\n\t\tdefaultNodeEntityType: $Values<typeof STRUCTURE_NODE_ENTITY_TYPE>,\n\t): StructureNodeEntityTypeInfo\n\t{\n\t\tconst availableNodeEntityTypes = Object.values(STRUCTURE_NODE_ENTITY_TYPE);\n\n\t\tlet itemNodeEntityType = item.getCustomData().get('nodeEntityType') ?? '';\n\t\tif (availableNodeEntityTypes.includes(itemNodeEntityType))\n\t\t{\n\t\t\treturn STRUCTURE_NODE_ENTITY_TYPE_INFO[itemNodeEntityType];\n\t\t}\n\n\t\tconst accessCode: string = item.getCustomData().get('accessCode') ?? '';\n\t\tObject.entries(STRUCTURE_NODE_ENTITY_TYPE_INFO)\n\t\t\t.forEach(([nodeEntityType, info]) => {\n\t\t\t\tif (accessCode.startsWith(info.commonPrefix))\n\t\t\t\t{\n\t\t\t\t\titemNodeEntityType = nodeEntityType;\n\t\t\t\t}\n\t\t\t});\n\n\t\tif (!availableNodeEntityTypes.includes(itemNodeEntityType))\n\t\t{\n\t\t\titemNodeEntityType = defaultNodeEntityType;\n\t\t}\n\n\t\treturn STRUCTURE_NODE_ENTITY_TYPE_INFO[itemNodeEntityType];\n\t}\n\n\t// eslint-disable-next-line sonarjs/cognitive-complexity\n\tgetAccessCodeByItem(item: Item): string\n\t{\n\t\tconst entityId = item.entityId;\n\n\t\tif (entityId === 'user')\n\t\t{\n\t\t\treturn `U${item.id}`;\n\t\t}\n\n\t\tif (entityId === 'department')\n\t\t{\n\t\t\tif (Type.isString(item.id) && item.id.endsWith(':F'))\n\t\t\t{\n\t\t\t\tconst match = item.id.match(/^(\\d+):F$/);\n\t\t\t\tconst originalId = match ? match[1] : null;\n\n\t\t\t\t// only members of the department itself\n\t\t\t\treturn `D${originalId}`;\n\t\t\t}\n\n\t\t\t// whole department recursively\n\t\t\treturn `DR${item.id}`;\n\t\t}\n\n\t\tif (entityId === 'structure-node')\n\t\t{\n\t\t\tconst itemNodeEntityType = this.getItemStructureNodeEntityTypeInfo(item, STRUCTURE_NODE_ENTITY_TYPE.TEAM);\n\t\t\tif (Type.isString(item.id) && item.id.endsWith(':F'))\n\t\t\t{\n\t\t\t\tconst match = item.id.match(/^(\\d+):F$/);\n\t\t\t\tconst originalId = match ? match[1] : null;\n\t\t\t\tconst prefix = itemNodeEntityType.commonPrefix;\n\n\t\t\t\treturn `${prefix}${originalId}`;\n\t\t\t}\n\n\t\t\tconst prefix = itemNodeEntityType.recursivePrefix;\n\n\t\t\treturn `${prefix}${item.id}`;\n\t\t}\n\n\t\tif (entityId === 'site-groups')\n\t\t{\n\t\t\treturn `G${item.id}`;\n\t\t}\n\n\t\tif (entityId === 'structure-role')\n\t\t{\n\t\t\treturn item.id;\n\t\t}\n\n\t\tif (entityId === 'user-groups')\n\t\t{\n\t\t\treturn item.id;\n\t\t}\n\n\t\tif (entityId === 'project-access-codes')\n\t\t{\n\t\t\treturn item.id;\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tgetItemIdsByAccessCodes(accessCodes: string[]): Map<string, ItemId>\n\t{\n\t\tconst map = new Map();\n\t\taccessCodes.forEach((accessCode: string) => {\n\t\t\tmap.set(accessCode, this.getItemIdByAccessCode(accessCode));\n\t\t});\n\n\t\treturn map;\n\t}\n\n\tgetMemberByItem(item: Item): Member\n\t{\n\t\treturn {\n\t\t\tid: this.getAccessCodeByItem(item),\n\t\t\ttype: this.getMemberTypeByItem(item),\n\t\t\tname: item.title.text,\n\t\t\tavatar: Type.isStringFilled(item.avatar) ? item.avatar : null,\n\t\t};\n\t}\n}\n","import { Cache } from 'main.core';\nimport type { AccessRightItem } from '../store/model/access-rights-model';\nimport type { AdditionalMembersParams } from '../store/model/application-model';\nimport { DependentVariables } from './value/type/dependent-variables';\nimport { Multivariables } from './value/type/multivariables';\nimport { Toggler } from './value/type/toggler';\nimport type { ValueType } from './value/type/value-type';\nimport { Variables } from './value/type/variables';\nimport { SelectorService } from './selector-service';\n\nexport class ServiceLocator\n{\n\tstatic #cache = new Cache.MemoryCache();\n\n\t/**\n\t * `BX.UI.Hint.createInstance` takes up to 30% of CPU time when multiple hints are mounted on page\n\t * (e.g. on a load, search), probably because of `Manager.initByClassName` call in `new Manager`.\n\t * therefore, we share a Manager instance across all hints in the app\n\t */\n\tstatic getHint(appGuid: string): BX.UI.Hint\n\t{\n\t\treturn this.#cache.remember(`hint-${appGuid}`, () => {\n\t\t\treturn BX.UI.Hint.createInstance({\n\t\t\t\tid: `ui-access-rights-v2-hint-${appGuid}`,\n\t\t\t\tclassNameIcon: 'ui-icon-set --o-question',\n\t\t\t\tpopupParameters: {\n\t\t\t\t\tclassName: 'ui-access-rights-v2-popup-pointer-events ui-hint-popup',\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tdarkMode: true,\n\t\t\t\t\tmaxWidth: 280,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: 8,\n\t\t\t\t\tangle: true,\n\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic getValueTypeByRight(right: AccessRightItem): ?ValueType\n\t{\n\t\treturn this.getValueType(right.type);\n\t}\n\n\tstatic getValueType(type: string): ?ValueType\n\t{\n\t\tconst stringType = String(type);\n\n\t\treturn this.#cache.remember(stringType, () => {\n\t\t\tif (stringType === 'dependent_variables')\n\t\t\t{\n\t\t\t\treturn new DependentVariables();\n\t\t\t}\n\n\t\t\tif (stringType === 'multivariables')\n\t\t\t{\n\t\t\t\treturn new Multivariables();\n\t\t\t}\n\n\t\t\tif (stringType === 'toggler')\n\t\t\t{\n\t\t\t\treturn new Toggler();\n\t\t\t}\n\n\t\t\tif (stringType === 'variables')\n\t\t\t{\n\t\t\t\treturn new Variables();\n\t\t\t}\n\n\t\t\tconsole.warn('ui.accessrights.v2: Unknown access right type', type);\n\n\t\t\treturn null;\n\t\t});\n\t}\n\n\tstatic getSelectorService(memberOptions: AdditionalMembersParams): SelectorService\n\t{\n\t\treturn new SelectorService(memberOptions);\n\t}\n}\n","import { BaseEvent } from 'main.core.events';\nimport { type ItemId } from 'ui.entity-selector';\nimport { mapState } from 'ui.vue3.vuex';\nimport { type SelectorService } from '../../../service/selector-service';\nimport { ServiceLocator } from '../../../service/service-locator';\nimport type { Member } from '../../../store/model/user-groups-model';\n\nexport const Selector = {\n\tname: 'Selector',\n\temits: ['close'],\n\tprops: {\n\t\tuserGroup: {\n\t\t\t/** @type UserGroup */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tbindNode: {\n\t\t\ttype: HTMLElement,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tselectedItems(): ItemId[] {\n\t\t\tconst result = [];\n\t\t\tfor (const accessCode of this.userGroup.members.keys())\n\t\t\t{\n\t\t\t\tresult.push(\n\t\t\t\t\tthis.getSelectorService().getItemIdByAccessCode(accessCode),\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\t...mapState({\n\t\t\toptions: (state) => state.application.options,\n\t\t\tmemberOptions: (state) => state.application.options.additionalMembersParams,\n\t\t}),\n\t},\n\tmounted()\n\t{\n\t\tthis.getSelectorService()\n\t\t\t.createDialog({\n\t\t\t\ttargetNode: this.bindNode,\n\t\t\t\tpreselectedItems: this.selectedItems,\n\t\t\t\tevents: {\n\t\t\t\t\tonHide: this.onHide,\n\t\t\t\t},\n\t\t\t})\n\t\t\t.show();\n\t},\n\tmethods: {\n\t\tonHide(event: BaseEvent): void {\n\t\t\tconst dialog: Dialog = event.getTarget();\n\t\t\tconst members = [];\n\t\t\tdialog.selectedItems.forEach((item) => {\n\t\t\t\tmembers.push(this.getSelectorService().getMemberByItem(item));\n\t\t\t});\n\n\t\t\tthis.$store.dispatch('userGroups/updateMembersForUserGroup', {\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\tmembers,\n\t\t\t});\n\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tgetMemberFromEvent(event: BaseEvent): ?Member {\n\t\t\tconst { item } = event.getData();\n\n\t\t\treturn this.getSelectorService().getMemberByItem(item);\n\t\t},\n\t\tgetSelectorService(): SelectorService\n\t\t{\n\t\t\treturn ServiceLocator.getSelectorService(this.memberOptions);\n\t\t},\n\t},\n\t// just a template stub\n\ttemplate: '<div hidden></div>',\n};\n","import { Type } from 'main.core';\n\nexport const SingleMember = {\n\tname: 'SingleMember',\n\tprops: {\n\t\tmember: {\n\t\t\t/** @type Member */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tavatarBackgroundImage(): string {\n\t\t\treturn `url('${encodeURI(this.member.avatar)}')`;\n\t\t},\n\t\tnoAvatarClass(): string {\n\t\t\tif (this.member.type === 'groups')\n\t\t\t{\n\t\t\t\treturn 'ui-icon-common-user-group';\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tthis.member.type === 'sonetgroups'\n\t\t\t\t|| this.member.type === 'departments'\n\t\t\t\t|| this.member.type === 'structuredepartments'\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn 'ui-icon-common-company';\n\t\t\t}\n\n\t\t\tif (this.member.type === 'usergroups')\n\t\t\t{\n\t\t\t\treturn 'ui-icon-common-user-group';\n\t\t\t}\n\n\t\t\tif (this.member.type === 'structureteams')\n\t\t\t{\n\t\t\t\treturn 'ui-icon-common-my-plan';\n\t\t\t}\n\n\t\t\treturn 'ui-icon-common-user';\n\t\t},\n\t\tmemberTitle(): string\n\t\t{\n\t\t\tif (Type.isStringFilled(this.member.name))\n\t\t\t{\n\t\t\t\treturn this.member.name;\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class='ui-access-rights-v2-members-item'>\n\t\t\t<a\n\t\t\t\tv-if=\"member.avatar\"\n\t\t\t\tclass='ui-access-rights-v2-members-item-avatar'\n\t\t\t\t:title=\"memberTitle\"\n\t\t\t\t:style=\"{\n\t\t\t\t\t\tbackgroundImage: avatarBackgroundImage,\n\t\t\t\t\t\tbackgroundSize: 'cover',\n\t\t\t\t\t}\"\n\t\t\t>\n\t\t\t</a>\n\t\t\t<a v-else class='ui-icon ui-access-rights-v2-members-item-icon' :class=\"noAvatarClass\" :title=\"memberTitle\">\n\t\t\t\t<i></i>\n\t\t\t</a>\n\t\t</div>\n\t`,\n};\n","import { Extension } from 'main.core';\nimport type { MemberCollection } from '../../store/model/user-groups-model';\nimport { Selector } from './members/selector';\nimport { SingleMember } from './members/single-member';\n\nconst MAX_SHOWN_MEMBERS = 5;\n\nexport const Members = {\n\tname: 'Members',\n\tcomponents: { SingleMember, Selector },\n\tprops: {\n\t\tuserGroup: {\n\t\t\t/** @type UserGroup */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tisSelectorShown: false,\n\t\t\tisSelectedMembersPopupShown: false,\n\t\t};\n\t},\n\tpopup: null,\n\tcomputed: {\n\t\tshownMembers(): MemberCollection\n\t\t{\n\t\t\tif (this.userGroup.members.size <= MAX_SHOWN_MEMBERS)\n\t\t\t{\n\t\t\t\treturn this.userGroup.members;\n\t\t\t}\n\n\t\t\tconst shownKeyValuePairs = [...this.userGroup.members].slice(0, MAX_SHOWN_MEMBERS);\n\n\t\t\treturn new Map(shownKeyValuePairs);\n\t\t},\n\t\tnotShownMembersCount(): number\n\t\t{\n\t\t\tif (this.userGroup.members.size > MAX_SHOWN_MEMBERS)\n\t\t\t{\n\t\t\t\treturn this.userGroup.members.size - MAX_SHOWN_MEMBERS;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t},\n\t\tbindNode(): HTMLElement\n\t\t{\n\t\t\treturn this.$refs.container;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div ref=\"container\" class=\"ui-access-rights-v2-members-container\"  @click=\"isSelectorShown = true\">\n\t\t\t<div v-if=\"userGroup.members.size > 0\" class='ui-access-rights-v2-members'>\n\t\t\t\t<SingleMember v-for=\"[accessCode, member] in shownMembers\" :key=\"accessCode\" :member=\"member\"/>\n\t\t\t\t<span v-if=\"notShownMembersCount > 0\" class=\"ui-access-rights-v2-members-more\">\n\t\t\t\t\t+ {{ notShownMembersCount }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclass='ui-access-rights-v2-members-item ui-access-rights-v2-members-item-add'\n\t\t\t\t:class=\"{\n\t\t\t\t\t'--show-always': userGroup.members.size <= 0,\n\t\t\t\t\t'--has-siblings': userGroup.members.size > 0,\n\t\t\t\t}\"\n\t\t\t>\n\t\t\t\t<div class=\"ui-icon-set --plus-m\"></div>\n\t\t\t</div>\n\t\t\t<Selector\n\t\t\t\tv-if=\"isSelectorShown\"\n\t\t\t\t:user-group=\"userGroup\"\n\t\t\t\t:bind-node=\"bindNode\"\n\t\t\t\t@close=\"isSelectorShown = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { Button, ButtonColor, ButtonSize, CancelButton } from 'ui.buttons';\nimport { RichMenuItem, RichMenuItemIcon, RichMenuPopup } from 'ui.vue3.components.rich-menu';\nimport { mapGetters, mapState } from 'ui.vue3.vuex';\n\nexport const RoleHeading = {\n\tname: 'RoleHeading',\n\tcomponents: { RichMenuPopup, RichMenuItem },\n\tprops: {\n\t\tuserGroup: {\n\t\t\t/** @type UserGroup */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tisEdit: false,\n\t\t\tisPopupShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tRichMenuItemIcon: () => RichMenuItemIcon,\n\t\t...mapState({\n\t\t\tisProgress: (state) => state.application.isProgress,\n\t\t\tguid: (state) => state.application.guid,\n\t\t\tmaxVisibleUserGroups: (state) => state.application.options.maxVisibleUserGroups,\n\t\t}),\n\t\t...mapGetters({\n\t\t\tisMaxVisibleUserGroupsReached: 'userGroups/isMaxVisibleUserGroupsReached',\n\t\t\tisMaxValueSetForAny: 'accessRights/isMaxValueSetForAny',\n\t\t\tisMinValueSetForAny: 'accessRights/isMinValueSetForAny',\n\t\t}),\n\t\ttitle: {\n\t\t\tget(): string {\n\t\t\t\treturn this.userGroup.title;\n\t\t\t},\n\t\t\tset(title: string): void {\n\t\t\t\tthis.$store.dispatch('userGroups/setRoleTitle', {\n\t\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\t\ttitle,\n\t\t\t\t});\n\t\t\t},\n\t\t},\n\t},\n\twatch: {\n\t\tisEdit(newValue): void {\n\t\t\tif (newValue === true)\n\t\t\t{\n\t\t\t\tthis.bindClickedOutsideHandler();\n\n\t\t\t\tvoid this.$nextTick(() => {\n\t\t\t\t\tthis.$refs.input.scrollIntoView({\n\t\t\t\t\t\tbehavior: 'smooth',\n\t\t\t\t\t\tblock: 'nearest',\n\t\t\t\t\t\tinline: 'nearest',\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.$refs.input.focus();\n\t\t\t\t\tthis.$refs.input.select();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.unbindClickedOutsideHandler();\n\t\t\t}\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\t// todo fix hide/show new role\n\t\tif (this.userGroup.isNew)\n\t\t{\n\t\t\t// start editing a newly created role right away\n\t\t\tthis.isEdit = true;\n\t\t}\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.unbindClickedOutsideHandler();\n\t},\n\tmethods: {\n\t\tbindClickedOutsideHandler(): void {\n\t\t\tEvent.bind(window, 'click', this.turnOffEditWhenClickedOutside, {\n\t\t\t\tcapture: true,\n\t\t\t});\n\t\t},\n\t\tunbindClickedOutsideHandler(): void {\n\t\t\tEvent.unbind(window, 'click', this.turnOffEditWhenClickedOutside, {\n\t\t\t\tcapture: true,\n\t\t\t});\n\t\t},\n\t\tturnOffEditWhenClickedOutside(event: PointerEvent): void {\n\t\t\tif (event.target !== this.$refs.input)\n\t\t\t{\n\t\t\t\tthis.isEdit = false;\n\t\t\t}\n\t\t},\n\t\tshowDeleteConfirmation(): void {\n\t\t\tconst popup = new Popup({\n\t\t\t\tbindElement: this.$refs.container,\n\t\t\t\twidth: 250,\n\t\t\t\toverlay: true,\n\t\t\t\tcontentPadding: 10,\n\t\t\t\tcontent: this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_POPUP_REMOVE_ROLE'),\n\t\t\t\tclassName: 'ui-access-rights-v2-text-center',\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t\tcacheable: false,\n\t\t\t\tbuttons: [\n\t\t\t\t\tnew Button({\n\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_POPUP_REMOVE_ROLE_YES'),\n\t\t\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\tpopup.destroy();\n\t\t\t\t\t\t\t\tthis.$store.dispatch('userGroups/removeUserGroup', {\n\t\t\t\t\t\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t\tnew CancelButton({\n\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_CANCEL'),\n\t\t\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\tpopup.destroy();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t});\n\n\t\t\tpopup.show();\n\t\t},\n\t\tshowActionsMenu(): void {\n\t\t\tif (!this.isProgress)\n\t\t\t{\n\t\t\t\tthis.isPopupShown = true;\n\t\t\t}\n\t\t},\n\t\tonSetMaxValuesClick(): void {\n\t\t\tthis.isPopupShown = false;\n\n\t\t\tthis.$store.dispatch('userGroups/setMaxAccessRightValues', {\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t});\n\t\t},\n\t\tonSetMinValuesClick(): void {\n\t\t\tthis.isPopupShown = false;\n\n\t\t\tthis.$store.dispatch('userGroups/setMinAccessRightValues', {\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t});\n\t\t},\n\t\tonEnableEditClick(): void {\n\t\t\tthis.isPopupShown = false;\n\n\t\t\tthis.isEdit = true;\n\t\t},\n\t\tonCopyRoleClick(): void {\n\t\t\tif (this.isMaxVisibleUserGroupsReached)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isPopupShown = false;\n\n\t\t\tthis.$store.dispatch('userGroups/copyUserGroup', { userGroupId: this.userGroup.id });\n\t\t},\n\t\tonDeleteRoleClick(): void {\n\t\t\tthis.isPopupShown = false;\n\n\t\t\tthis.showDeleteConfirmation();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div ref=\"container\" class='ui-access-rights-v2-role'>\n\t\t\t<div class=\"ui-access-rights-v2-role-value-container\">\n\t\t\t\t<input\n\t\t\t\t\tv-if=\"isEdit && !isProgress\"\n\t\t\t\t\tref=\"input\"\n\t\t\t\t\ttype='text'\n\t\t\t\t\tclass='ui-access-rights-v2-role-input'\n\t\t\t\t\tv-model=\"title\"\n\t\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE_NAME')\"\n\t\t\t\t\t@keydown.enter=\"isEdit = false\"\n\t\t\t\t/>\n\t\t\t\t<div v-else class='ui-access-rights-v2-role-value' :title=\"title\">{{ title }}</div>\n\t\t\t</div>\n\t\t\t<div \n\t\t\t\tref=\"menu\"\n\t\t\t\tclass=\"ui-icon-set --more-l ui-access-rights-v2-icon-more\"\n\t\t\t\tstyle=\"position: absolute; right: 11px; top: 5px;\"\n\t\t\t\t@click=\"showActionsMenu\"\n\t\t\t>\n\t\t\t\t<RichMenuPopup v-if=\"isPopupShown\" @close=\"isPopupShown = false\" :popup-options=\"{bindElement: $refs.menu}\">\n\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\tv-if=\"isMaxValueSetForAny\"\n\t\t\t\t\t\t:icon=\"RichMenuItemIcon.check\"\n\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MAX_ACCESS_RIGHTS')\"\n\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MAX_ACCESS_RIGHTS_SUBTITLE')\"\n\t\t\t\t\t\t@click=\"onSetMaxValuesClick\"\n\t\t\t\t\t/>\n\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\tv-if=\"isMinValueSetForAny\"\n\t\t\t\t\t\t:icon=\"RichMenuItemIcon['red-lock']\"\n\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MIN_ACCESS_RIGHTS')\"\n\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MIN_ACCESS_RIGHTS_SUBTITLE')\"\n\t\t\t\t\t\t@click=\"onSetMinValuesClick\"\n\t\t\t\t\t/>\n\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\t:icon=\"RichMenuItemIcon.pencil\"\n\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_RENAME')\"\n\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_RENAME_SUBTITLE')\"\n\t\t\t\t\t\t@click=\"onEnableEditClick\"\n\t\t\t\t\t/>\n\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\t:icon=\"RichMenuItemIcon.copy\"\n\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_COPY')\"\n\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_COPY_ROLE_SUBTITLE')\"\n\t\t\t\t\t\t:disabled=\"isMaxVisibleUserGroupsReached\"\n\t\t\t\t\t\t:hint=\"\n\t\t\t\t\t\t\tisMaxVisibleUserGroupsReached\n\t\t\t\t\t\t\t\t? $Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE_COPYING_DISABLED', {\n\t\t\t\t\t\t\t\t\t'#COUNT#': maxVisibleUserGroups,\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\"\n\t\t\t\t\t\t@click=\"onCopyRoleClick\"\n\t\t\t\t\t/>\n\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\t:icon=\"RichMenuItemIcon['trash-bin']\"\n\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_REMOVE')\"\n\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_REMOVE_SUBTITLE')\"\n\t\t\t\t\t\t@click=\"onDeleteRoleClick\"\n\t\t\t\t\t/>\n\t\t\t\t</RichMenuPopup>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Loc, Runtime } from 'main.core';\nimport { type ItemOptions } from 'ui.entity-selector';\nimport type { Variable, VariableCollection } from '../../store/model/access-rights-model';\nimport type { UserGroup, UserGroupsCollection } from '../../store/model/user-groups-model';\nimport { EntitySelectorEntities } from './dictionary';\n\nexport class ItemsMapper\n{\n\tstatic mapUserGroups(userGroups: UserGroupsCollection): ItemOptions[]\n\t{\n\t\tconst result: ItemOptions[] = [];\n\n\t\tfor (const userGroup: UserGroup of userGroups.values())\n\t\t{\n\t\t\tresult.push({\n\t\t\t\tid: userGroup.id,\n\t\t\t\tentityId: EntitySelectorEntities.ROLE,\n\t\t\t\ttitle: userGroup.title,\n\t\t\t\tsupertitle: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE'),\n\t\t\t\tavatar: '/bitrix/js/ui/accessrights/v2/images/role-avatar.svg',\n\t\t\t\ttabs: [\n\t\t\t\t\t'recents',\n\t\t\t\t],\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tstatic mapVariables(variables: VariableCollection): ItemOptions[]\n\t{\n\t\tconst items: ItemOptions[] = [];\n\n\t\tfor (const variable: Variable of variables.values())\n\t\t{\n\t\t\tconst item = Runtime.clone(variable);\n\t\t\titem.entityId = item.entityId || EntitySelectorEntities.VARIABLE;\n\t\t\titem.tabs = 'recents';\n\n\t\t\titems.push(item);\n\t\t}\n\n\t\treturn items;\n\t}\n}\n","import { Loc, Runtime, Text, Type } from 'main.core';\nimport { type ActionTree, BuilderModel, type GetterTree, type MutationTree, type Store } from 'ui.vue3.vuex';\nimport { ServiceLocator } from '../../service/service-locator';\nimport type { AccessRightItem, AccessRightSection } from './access-rights-model';\n\nexport type UserGroupsState = {\n\tcollection: UserGroupsCollection,\n\tdeleted: Set<string>,\n\tselectedMember: SelectedMember,\n\tsortConfig: Record<string, Record<string, number>>,\n}\n\nexport type UserGroupsStore = Store<UserGroupsState>;\n\nexport type UserGroupsCollection = Map<string, UserGroup>;\n\n// aka Role\nexport type UserGroup = {\n\tid: string,\n\tisNew: boolean,\n\tisModified: boolean, // whether group metadata is modified - title, members\n\ttitle: string,\n\taccessRights: Map<string, AccessRightValue>,\n\tmembers: MemberCollection, // access code => member\n};\n\nexport type AccessRightValue = {\n\tid: string,\n\tvalues: Set<string>,\n\tisModified: boolean,\n};\n\nexport type MemberCollection = Map<string, Member>; // access code => member\n\n// user/group/department/set of users\nexport type Member = {\n\tid: string,\n\ttype: ?string, // see main/install/components/bitrix/main.ui.selector/templates/.default/script.js\n\tname: ?string,\n\tavatar: ?string,\n};\n\ntype SetAccessRightValuesPayload = SetAccessRightValuesForShownPayload & {\n\tuserGroupId: string,\n};\n\ntype SetAccessRightValuesForShownPayload = {\n\tsectionCode: string,\n\tvalueId: string,\n\tvalues: Set<string>,\n};\n\nexport type UserGroupsOption = {\n\tselectedMember: SelectedMember,\n\tsortConfig: Record<string, Record<string, number>>,\n};\n\nexport type SelectedMember = {\n\tid: string,\n\tmember: ?Member,\n\taccessCodes: string[],\n}\n\nexport const NEW_USER_GROUP_ID_PREFIX = 'new~~~';\n\nexport const SELECTED_ALL_USER_ID = 'all-users';\n\nexport class UserGroupsModel extends BuilderModel\n{\n\t#initialUserGroups: UserGroupsCollection = new Map();\n\t#sortConfig: Record<string, Record<string, number>> = {};\n\t#selectedMember: SelectedMember;\n\n\tgetName(): string\n\t{\n\t\treturn 'userGroups';\n\t}\n\n\tsetInitialUserGroups(groups: UserGroupsCollection): UserGroupsModel\n\t{\n\t\tthis.#initialUserGroups = groups;\n\n\t\treturn this;\n\t}\n\n\tsetSortConfig(sortConfig: Record<string, Record<string, number>>): UserGroupsModel\n\t{\n\t\tthis.#sortConfig = sortConfig;\n\n\t\treturn this;\n\t}\n\n\tsetSelectedMember(selectedMember: SelectedMember): UserGroupsModel\n\t{\n\t\tthis.#selectedMember = selectedMember;\n\n\t\treturn this;\n\t}\n\n\tgetState(): UserGroupsState\n\t{\n\t\treturn {\n\t\t\tcollection: Runtime.clone(this.#initialUserGroups),\n\t\t\tdeleted: new Set(),\n\t\t\tselectedMember: this.#selectedMember,\n\t\t\tsortConfig: this.#sortConfig,\n\t\t};\n\t}\n\n\tgetElementState(params = {}): UserGroup\n\t{\n\t\treturn {\n\t\t\tid: `${NEW_USER_GROUP_ID_PREFIX}${Text.getRandom()}`,\n\t\t\tisNew: true,\n\t\t\tisModified: true,\n\t\t\ttitle: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE_NAME'),\n\t\t\taccessRights: new Map(),\n\t\t\tmembers: new Map(),\n\t\t};\n\t}\n\n\t#getUserGroupsCollectionBySelectedMember(state: UserGroupsState): UserGroupsCollection\n\t{\n\t\tconst result = new Map();\n\t\tconst selectedMemberId = state.selectedMember?.id ?? SELECTED_ALL_USER_ID;\n\t\tconst accessCodes = state.selectedMember?.accessCodes ? [...(state.selectedMember.accessCodes)] : [];\n\n\t\tfor (const [userGroupId, userGroup] of state.collection)\n\t\t{\n\t\t\tif (selectedMemberId === SELECTED_ALL_USER_ID || accessCodes.some((code) => userGroup.members.has(code)))\n\t\t\t{\n\t\t\t\tresult.set(userGroupId, userGroup);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tgetGetters(): GetterTree<UserGroupsState>\n\t{\n\t\treturn {\n\t\t\tshown: (state, getters, rootState): UserGroupsCollection => {\n\t\t\t\tconst selectedMemberId = state.selectedMember?.id ?? SELECTED_ALL_USER_ID;\n\t\t\t\tconst collection = this.#getUserGroupsCollectionBySelectedMember(state);\n\n\t\t\t\tif (!state.sortConfig || !state.sortConfig[selectedMemberId])\n\t\t\t\t{\n\t\t\t\t\tif (rootState.application.options.maxVisibleUserGroups > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn new Map([...collection].slice(0, rootState.application.options.maxVisibleUserGroups));\n\t\t\t\t\t}\n\n\t\t\t\t\treturn collection;\n\t\t\t\t}\n\n\t\t\t\tconst sortedGroups = [...collection]\n\t\t\t\t\t.filter(([userGroupId]) => state.sortConfig[selectedMemberId][userGroupId] >= 0)\n\t\t\t\t\t.sort(\n\t\t\t\t\t\t([idA], [idB]) => (state.sortConfig[selectedMemberId][idA] ?? Infinity)\n\t\t\t\t\t\t\t- (state.sortConfig[selectedMemberId][idB] ?? Infinity),\n\t\t\t\t\t);\n\n\t\t\t\tif (rootState.application.options.maxVisibleUserGroups > 0)\n\t\t\t\t{\n\t\t\t\t\treturn new Map(sortedGroups.slice(0, rootState.application.options.maxVisibleUserGroups));\n\t\t\t\t}\n\n\t\t\t\treturn new Map(sortedGroups);\n\t\t\t},\n\t\t\tuserGroupsBySelectedMember: (state): UserGroupsCollection => {\n\t\t\t\treturn this.#getUserGroupsCollectionBySelectedMember(state);\n\t\t\t},\n\t\t\tgetEmptyAccessRightValue: (state, getters, rootState, rootGetters) => (userGroupId: string, sectionCode: string, valueId: string): AccessRightValue => {\n\t\t\t\tconst values = rootGetters['accessRights/getEmptyValue'](sectionCode, valueId);\n\n\t\t\t\treturn {\n\t\t\t\t\tid: valueId,\n\t\t\t\t\tvalues,\n\t\t\t\t\tisModified: state.collection.get(userGroupId).isNew,\n\t\t\t\t};\n\t\t\t},\n\t\t\tdefaultAccessRightValues: (state, getters, rootState): Map<string, AccessRightValue> => {\n\t\t\t\tconst result = new Map();\n\n\t\t\t\tfor (const section of rootState.accessRights.collection.values())\n\t\t\t\t{\n\t\t\t\t\tfor (const [rightId, right] of section.rights)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (Type.isNil(right.defaultValue))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresult.set(rightId, {\n\t\t\t\t\t\t\tid: rightId,\n\t\t\t\t\t\t\tvalues: right.defaultValue,\n\t\t\t\t\t\t\tisModified: true,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\tisModified: (state): boolean => {\n\t\t\t\tif (state.deleted.size > 0)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tfor (const userGroup of state.collection.values())\n\t\t\t\t{\n\t\t\t\t\tif (userGroup.isNew || userGroup.isModified)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (const value of userGroup.accessRights.values())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (value.isModified)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tisMaxVisibleUserGroupsReached: (state, getters, rootState, rootGetters): boolean => {\n\t\t\t\tif (!rootGetters['application/isMaxVisibleUserGroupsSet'])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn getters.shown.size >= rootState.application.options.maxVisibleUserGroups;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree<UserGroupsState>\n\t{\n\t\treturn {\n\t\t\tsetAccessRightValues: (store, payload): void => {\n\t\t\t\tthis.#setAccessRightValuesAction(store, payload);\n\t\t\t},\n\t\t\tsetAccessRightValuesForShown: (store, payload): void => {\n\t\t\t\tthis.#setAccessRightValuesForShownAction(store, payload);\n\t\t\t},\n\t\t\tsetMinAccessRightValues: (store, payload): void => {\n\t\t\t\tthis.#setMinAccessRightValuesAction(store, payload);\n\t\t\t},\n\t\t\tsetMaxAccessRightValues: (store, payload): void => {\n\t\t\t\tthis.#setMaxAccessRightValuesAction(store, payload);\n\t\t\t},\n\t\t\tsetMinAccessRightValuesInSection: (store, payload): void => {\n\t\t\t\tthis.#setMinAccessRightValuesInSectionAction(store, payload);\n\t\t\t},\n\t\t\tsetMaxAccessRightValuesInSection: (store, payload): void => {\n\t\t\t\tthis.#setMaxAccessRightValuesInSectionAction(store, payload);\n\t\t\t},\n\t\t\tsetMinAccessRightValuesForRight: (store, payload): void => {\n\t\t\t\tthis.#setMinAccessRightValuesForRight(store, payload);\n\t\t\t},\n\t\t\tsetMaxAccessRightValuesForRight: (store, payload): void => {\n\t\t\t\tthis.#setMaxAccessRightValuesForRight(store, payload);\n\t\t\t},\n\t\t\tsetRoleTitle: (store, payload): void => {\n\t\t\t\tthis.#setRoleTitleAction(store, payload);\n\t\t\t},\n\t\t\taddMember: (store, payload): void => {\n\t\t\t\tthis.#addMemberAction(store, payload);\n\t\t\t},\n\t\t\tremoveMember: (store, payload): void => {\n\t\t\t\tthis.#removeMemberAction(store, payload);\n\t\t\t},\n\t\t\tupdateMembersForUserGroup: (store, payload): void => {\n\t\t\t\tthis.#updateMembersForUserGroupAction(store, payload);\n\t\t\t},\n\t\t\tcopyUserGroup: (store, payload): void => {\n\t\t\t\tthis.#copyUserGroupAction(store, payload);\n\t\t\t},\n\t\t\tcopySectionValues: (store, payload): void => {\n\t\t\t\tthis.#copySectionValuesAction(store, payload);\n\t\t\t},\n\t\t\taddUserGroup: (store): void => {\n\t\t\t\tthis.#addUserGroupAction(store);\n\t\t\t},\n\t\t\tremoveUserGroup: (store, payload): void => {\n\t\t\t\tthis.#removeUserGroupAction(store, payload);\n\t\t\t},\n\t\t\tupdateUserGroupSort: (store, payload): void => {\n\t\t\t\tthis.#updateUserGroupSortAction(store, payload);\n\t\t\t},\n\t\t\tupdateSortConfigForSelectedMember: (store, payload): void => {\n\t\t\t\tthis.#updateSortConfigForSelectedMemberAction(store, payload);\n\t\t\t},\n\t\t\tupdateSortConfig: (store, payload): void => {\n\t\t\t\tthis.#updateSortConfigAction(store, payload);\n\t\t\t},\n\t\t\tdeleteRight: (store, payload): void => {\n\t\t\t\tthis.#deleteRightAction(store, payload);\n\t\t\t},\n\t\t\tselectMember: (store, payload): void => {\n\t\t\t\tthis.#selectMemberAction(store, payload);\n\t\t\t},\n\t\t};\n\t}\n\n\t#setAccessRightValuesAction(store: UserGroupsStore, payload: SetAccessRightValuesPayload): void\n\t{\n\t\tif (!Type.isSet(payload.values))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to set not-Set values', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#isUserGroupExists(store, payload.userGroupId))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to set value to a user group that dont exists', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#isValueExistsInStructure(store, payload.sectionCode, payload.valueId))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to set value to a right that dont exists in structure', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('setAccessRightValues', {\n\t\t\tuserGroupId: payload.userGroupId,\n\t\t\tvalueId: payload.valueId,\n\t\t\tvalues: payload.values,\n\t\t\tisModified: this.#isValueModified(\n\t\t\t\tpayload.userGroupId,\n\t\t\t\tpayload.valueId,\n\t\t\t\tpayload.values,\n\t\t\t\tstore.rootGetters['accessRights/getEmptyValue'](payload.sectionCode, payload.valueId),\n\t\t\t),\n\t\t});\n\t}\n\n\t#setAccessRightValuesForShownAction(store: UserGroupsStore, payload: SetAccessRightValuesForShownPayload): void\n\t{\n\t\tfor (const userGroupId of store.getters.shown.keys())\n\t\t{\n\t\t\tvoid store.dispatch('setAccessRightValues', {\n\t\t\t\t...payload,\n\t\t\t\tuserGroupId,\n\t\t\t});\n\t\t}\n\t}\n\n\t#setMinAccessRightValuesAction(store: UserGroupsStore, { userGroupId }): void\n\t{\n\t\tfor (const sectionCode: string of store.rootState.accessRights.collection.keys())\n\t\t{\n\t\t\tvoid store.dispatch('setMinAccessRightValuesInSection', { userGroupId, sectionCode });\n\t\t}\n\n\t\tvoid store.dispatch('accessRights/expandAllSections', null, { root: true });\n\t}\n\n\t#setMinAccessRightValuesInSectionAction(store: UserGroupsStore, { userGroupId, sectionCode }): void\n\t{\n\t\tconst section: ?AccessRightSection = store.rootState.accessRights.collection.get(sectionCode);\n\t\tif (!section)\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: attempt to set min values in section that dont exists', { sectionCode });\n\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const item of section.rights.values())\n\t\t{\n\t\t\tconst valueToSet = this.#getMinValueForColumnAction(\n\t\t\t\titem,\n\t\t\t\tstore.rootGetters['accessRights/getEmptyValue'](section.sectionCode, item.id),\n\t\t\t);\n\t\t\tif (Type.isNil(valueToSet))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvoid store.dispatch('setAccessRightValues', {\n\t\t\t\tuserGroupId,\n\t\t\t\tsectionCode: section.sectionCode,\n\t\t\t\tvalueId: item.id,\n\t\t\t\tvalues: valueToSet,\n\t\t\t});\n\t\t}\n\t}\n\n\t#setMinAccessRightValuesForRight(store: UserGroupsStore, { sectionCode, rightId }): void\n\t{\n\t\tconst right: ?AccessRightItem = store.rootState.accessRights.collection.get(sectionCode)?.rights.get(rightId);\n\t\tif (!right)\n\t\t{\n\t\t\tconsole.warn(\n\t\t\t\t'ui.accessrights.v2: attempt to set min values for right that dont exists',\n\t\t\t\t{ sectionCode, rightId },\n\t\t\t);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst valueToSet = this.#getMinValue(right);\n\t\tif (Type.isNil(valueToSet))\n\t\t{\n\t\t\tconsole.warn(\n\t\t\t\t'ui.accessrights.v2: attempt to set min values for right that dont have min value set',\n\t\t\t\t{ sectionCode, rightId },\n\t\t\t);\n\n\t\t\treturn;\n\t\t}\n\n\t\tvoid store.dispatch('setAccessRightValuesForShown', {\n\t\t\tsectionCode,\n\t\t\tvalueId: rightId,\n\t\t\tvalues: valueToSet,\n\t\t});\n\t}\n\n\t#getMinValueForColumnAction(item: AccessRightItem, emptyValue: Set<string>): ?Set<string>\n\t{\n\t\tconst setEmpty = Type.isBoolean(item.setEmptyOnSetMinMaxValueInColumn) && item.setEmptyOnSetMinMaxValueInColumn;\n\t\tif (setEmpty)\n\t\t{\n\t\t\treturn emptyValue;\n\t\t}\n\n\t\treturn this.#getMinValue(item);\n\t}\n\n\t#getMinValue(item: AccessRightItem): ?Set<string>\n\t{\n\t\treturn ServiceLocator.getValueTypeByRight(item)?.getMinValue(item);\n\t}\n\n\t#setMaxAccessRightValuesAction(store: UserGroupsStore, { userGroupId }): void\n\t{\n\t\tfor (const sectionCode: string of store.rootState.accessRights.collection.keys())\n\t\t{\n\t\t\tvoid store.dispatch('setMaxAccessRightValuesInSection', { userGroupId, sectionCode });\n\t\t}\n\n\t\tvoid store.dispatch('accessRights/expandAllSections', null, { root: true });\n\t}\n\n\t#setMaxAccessRightValuesInSectionAction(store: UserGroupsStore, { userGroupId, sectionCode }): void\n\t{\n\t\tconst section: ?AccessRightSection = store.rootState.accessRights.collection.get(sectionCode);\n\t\tif (!section)\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: attempt to set max values in section that dont exists', { sectionCode });\n\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const item of section.rights.values())\n\t\t{\n\t\t\tconst valueToSet = this.#getMaxValueForColumnAction(\n\t\t\t\titem,\n\t\t\t\tstore.rootGetters['accessRights/getEmptyValue'](section.sectionCode, item.id),\n\t\t\t);\n\t\t\tif (Type.isNil(valueToSet))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvoid store.dispatch('setAccessRightValues', {\n\t\t\t\tuserGroupId,\n\t\t\t\tsectionCode: section.sectionCode,\n\t\t\t\tvalueId: item.id,\n\t\t\t\tvalues: valueToSet,\n\t\t\t});\n\t\t}\n\t}\n\n\t#setMaxAccessRightValuesForRight(store: UserGroupsStore, { sectionCode, rightId }): void\n\t{\n\t\tconst right: ?AccessRightItem = store.rootState.accessRights.collection.get(sectionCode)?.rights.get(rightId);\n\t\tif (!right)\n\t\t{\n\t\t\tconsole.warn(\n\t\t\t\t'ui.accessrights.v2: attempt to set max values for right that dont exists',\n\t\t\t\t{ sectionCode, rightId },\n\t\t\t);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst valueToSet = this.#getMaxValue(right);\n\t\tif (Type.isNil(valueToSet))\n\t\t{\n\t\t\tconsole.warn(\n\t\t\t\t'ui.accessrights.v2: attempt to set max values for right that dont have max value set',\n\t\t\t\t{ sectionCode, rightId },\n\t\t\t);\n\n\t\t\treturn;\n\t\t}\n\n\t\tvoid store.dispatch('setAccessRightValuesForShown', {\n\t\t\tsectionCode,\n\t\t\tvalueId: rightId,\n\t\t\tvalues: valueToSet,\n\t\t});\n\t}\n\n\t#getMaxValueForColumnAction(item: AccessRightItem, emptyValue: Set<string>): ?Set<string>\n\t{\n\t\tconst setEmpty = Type.isBoolean(item.setEmptyOnSetMinMaxValueInColumn) && item.setEmptyOnSetMinMaxValueInColumn;\n\t\tif (setEmpty)\n\t\t{\n\t\t\treturn emptyValue;\n\t\t}\n\n\t\treturn this.#getMaxValue(item);\n\t}\n\n\t#getMaxValue(item: AccessRightItem): ?Set<string>\n\t{\n\t\treturn ServiceLocator.getValueTypeByRight(item)?.getMaxValue(item);\n\t}\n\n\t#copySectionValuesAction(\n\t\tstore: UserGroupsStore,\n\t\tpayload: { srcUserGroupId: string, dstUserGroupId: string, sectionCode: string },\n\t): void\n\t{\n\t\tconst src = this.#getUserGroup(store.state, payload.srcUserGroupId);\n\t\tif (!src)\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to copy values from user group that dont exists', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst section: ?AccessRightSection = store.rootState.accessRights.collection.get(payload.sectionCode);\n\t\tif (!section)\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to copy values for section that dont exists', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const rightId of section.rights.keys())\n\t\t{\n\t\t\tconst value = src.accessRights.get(rightId);\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tvoid store.dispatch('setAccessRightValues', {\n\t\t\t\t\tuserGroupId: payload.dstUserGroupId,\n\t\t\t\t\tsectionCode: section.sectionCode,\n\t\t\t\t\tvalueId: value.id,\n\t\t\t\t\tvalues: value.values,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst emptyValue = store.rootGetters['accessRights/getEmptyValue'](section.sectionCode, rightId);\n\n\t\t\t\tvoid store.dispatch('setAccessRightValues', {\n\t\t\t\t\tuserGroupId: payload.dstUserGroupId,\n\t\t\t\t\tsectionCode: section.sectionCode,\n\t\t\t\t\tvalueId: rightId,\n\t\t\t\t\tvalues: emptyValue,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t#setRoleTitleAction(store: UserGroupsStore, payload: {userGroupId: string, title: string}): void\n\t{\n\t\tif (!Type.isString(payload.title))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to set role title with something other than string', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#isUserGroupExists(store, payload.userGroupId))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to update user group that dont exists', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('setRoleTitle', payload);\n\t}\n\n\t#addMemberAction(store: UserGroupsStore, payload: {userGroupId: string, accessCode: string, member: Member }): void\n\t{\n\t\tif (!this.#isUserGroupExists(store, payload.userGroupId))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to add member to a user group that dont exists', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\t!Type.isStringFilled(payload.accessCode)\n\t\t\t|| !this.#isMemberValid(payload)\n\t\t)\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to add member with invalid payload', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('addMember', payload);\n\t}\n\n\t#isMemberValid(payload: {member: Member}): boolean\n\t{\n\t\treturn Type.isStringFilled(payload.member.id)\n\t\t\t&& Type.isStringFilled(payload.member.type)\n\t\t\t&& Type.isStringFilled(payload.member.name)\n\t\t\t&& (Type.isNil(payload.member.avatar) || Type.isStringFilled(payload.member.avatar));\n\t}\n\n\t#removeMemberAction(store: UserGroupsStore, payload: {userGroupId: string, accessCode: string }): void\n\t{\n\t\tif (!this.#isUserGroupExists(store, payload.userGroupId))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to remove member from a user group that dont exists', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Type.isStringFilled(payload.accessCode))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to remove member with invalid payload', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('removeMember', payload);\n\t}\n\n\t#updateMembersForUserGroupAction(store: UserGroupsStore, payload: {userGroupId: string, members: array<Member> }): void\n\t{\n\t\tif (!this.#isUserGroupExists(store, payload.userGroupId))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to remove member from a user group that dont exists', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst memberCollection = new Map();\n\t\tpayload.members.forEach((member) => {\n\t\t\tif (\n\t\t\t\t!Type.isStringFilled(member.id)\n\t\t\t\t|| !Type.isStringFilled(member.type)\n\t\t\t\t|| !Type.isStringFilled(member.name)\n\t\t\t\t|| !(Type.isNil(member.avatar) || Type.isStringFilled(member.avatar))\n\t\t\t)\n\t\t\t{\n\t\t\t\tconsole.warn('ui.accessrights.v2: Attempt to add member with invalid payload', member);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmemberCollection.set(member.id, member);\n\t\t\t}\n\t\t});\n\n\t\tstore.commit('updateMembersForUserGroup', {\n\t\t\tuserGroupId: payload.userGroupId,\n\t\t\tmemberCollection,\n\t\t});\n\t}\n\n\t#copyUserGroupAction(store: UserGroupsStore, { userGroupId }): void\n\t{\n\t\tconst sourceGroup = this.#getUserGroup(store.state, userGroupId);\n\n\t\tif (!sourceGroup)\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to copy user group that dont exists', { userGroupId });\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst emptyGroup = this.getElementState();\n\n\t\tconst copy: UserGroup = {\n\t\t\t...Runtime.clone(sourceGroup),\n\t\t\tid: emptyGroup.id,\n\t\t\ttitle: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_COPIED_ROLE_NAME', {\n\t\t\t\t'#ORIGINAL#': sourceGroup.title,\n\t\t\t}),\n\t\t\tisNew: true,\n\t\t\tisModified: true,\n\t\t};\n\n\t\tfor (const value of copy.accessRights.values())\n\t\t{\n\t\t\t// is a new group all values are modified\n\t\t\tvalue.isModified = true;\n\t\t}\n\n\t\tconst updatedSortConfig = this.#updateSortConfig(\n\t\t\tstore.state.sortConfig,\n\t\t\tcopy.id,\n\t\t);\n\n\t\tthis.#updateSortConfigAction(store, { sortConfig: updatedSortConfig });\n\n\t\tstore.commit('addUserGroup', {\n\t\t\tuserGroup: copy,\n\t\t});\n\t}\n\n\t#addUserGroupAction(store: UserGroupsStore): void\n\t{\n\t\tconst newGroup = {\n\t\t\t...this.getElementState(),\n\t\t\taccessRights: Runtime.clone(store.getters.defaultAccessRightValues),\n\t\t\tmembers: new Map(),\n\t\t};\n\n\t\tif (store.state.selectedMember && store.state.selectedMember.member)\n\t\t{\n\t\t\tnewGroup.members.set(store.state.selectedMember.member.id, store.state.selectedMember.member);\n\t\t}\n\n\t\tconst updatedSortConfig = this.#updateSortConfig(\n\t\t\tstore.state.sortConfig,\n\t\t\tnewGroup.id,\n\t\t\tstore.state.selectedMember?.id,\n\t\t);\n\n\t\tthis.#updateSortConfigAction(store, { sortConfig: updatedSortConfig });\n\t\tstore.commit('addUserGroup', { userGroup: newGroup });\n\t}\n\n\t#removeUserGroupAction(store: UserGroupsStore, { userGroupId }): void\n\t{\n\t\tconst userGroup = this.#getUserGroup(store.state, userGroupId);\n\t\tif (!userGroup)\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to remove user group that dont exists', { userGroupId });\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('removeUserGroup', { userGroupId });\n\t\tif (!userGroup.isNew)\n\t\t{\n\t\t\tstore.commit('markUserGroupForDeletion', { userGroupId });\n\t\t}\n\t}\n\n\t#updateUserGroupSortAction(store: UserGroupsStore, { userGroupId, sort }): void\n\t{\n\t\tif (!this.#isUserGroupExists(store, userGroupId))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to show user group that dont exists', { userGroupId });\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('updateUserGroupSort', { userGroupId, sort });\n\t}\n\n\t#updateSortConfigForSelectedMemberAction(store: UserGroupsStore, { sortConfigForSelectedMember }): void\n\t{\n\t\tif (!this.#isValidSortConfigForSelectedMember(sortConfigForSelectedMember))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Invalid sort configuration provided', sortConfigForSelectedMember);\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('updateSortConfigForSelectedMember', { sortConfigForSelectedMember });\n\t}\n\n\t#updateSortConfigAction(store: UserGroupsStore, { sortConfig }): void\n\t{\n\t\tif (!this.#isValidSortConfig(sortConfig))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Invalid sort configuration provided', sortConfig);\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('updateSortConfig', { sortConfig });\n\t}\n\n\t#selectMemberAction(store: UserGroupsStore, payload: { member: SelectedMember }): void\n\t{\n\t\tif (!this.#isValidSelectedMember(payload.member))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Invalid selected member provided', payload.member);\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('selectMember', Runtime.clone(payload));\n\t}\n\n\t#hideUserGroupAction(store: UserGroupsState, { userGroupId }): void\n\t{\n\t\tif (!this.#isUserGroupExists(store, userGroupId))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to shrink user group that dont exists', { userGroupId });\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('hideUserGroup', { userGroupId });\n\t}\n\n\t#updateSortConfig(\n\t\tcurrentSorting: Record<string, Record<string, number>>,\n\t\tgroupId: string,\n\t\tselectedMemberId?: string,\n\t): Record<string, Record<string, number>> {\n\t\tconst userIdsToUpdate = new Set([SELECTED_ALL_USER_ID]);\n\t\tif (selectedMemberId)\n\t\t{\n\t\t\tuserIdsToUpdate.add(selectedMemberId);\n\t\t}\n\n\t\tconst newSortConfig = { ...currentSorting };\n\n\t\tfor (const userId of userIdsToUpdate)\n\t\t{\n\t\t\tif (!newSortConfig[userId])\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst currentValues = Object.values(newSortConfig[userId]);\n\t\t\tconst maxValue = currentValues.length > 0 ? Math.max(...currentValues) : 0;\n\n\t\t\tnewSortConfig[userId] = {\n\t\t\t\t...newSortConfig[userId],\n\t\t\t\t[groupId]: maxValue + 1,\n\t\t\t};\n\t\t}\n\n\t\treturn newSortConfig;\n\t}\n\n\t#isUserGroupExists(store, userGroupId: string): boolean\n\t{\n\t\tconst group = this.#getUserGroup(store.state, userGroupId);\n\n\t\treturn Boolean(group);\n\t}\n\n\t#isValidSortConfigForSelectedMember(config: Record<string, number>): boolean {\n\t\treturn Object.values(config).every(\n\t\t\t(value) => Type.isNumber(value),\n\t\t);\n\t}\n\n\t#isValidSortConfig(config: Record<string, Record<string, number>>): boolean {\n\t\treturn Object.values(config).every(\n\t\t\t(userConfig) => this.#isValidSortConfigForSelectedMember(userConfig),\n\t\t);\n\t}\n\n\t#isValidSelectedMember(selectedMember: SelectedMember): boolean {\n\t\tif (selectedMember.id === SELECTED_ALL_USER_ID)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn (\n\t\t\tType.isString(selectedMember.id)\n\t\t\t&& Type.isObject(selectedMember.member)\n\t\t\t&& Type.isArray(selectedMember.accessCodes)\n\t\t);\n\t}\n\n\t#getUserGroup(state: UserGroupsState, userGroupId: string): ?UserGroup\n\t{\n\t\treturn state.collection.get(userGroupId);\n\t}\n\n\t#isValueExistsInStructure(store, sectionCode: string, valueId: string): boolean\n\t{\n\t\tconst section: ?AccessRightSection = store.rootState.accessRights.collection.get(sectionCode);\n\n\t\treturn section?.rights.has(valueId);\n\t}\n\n\t#deleteRightAction(store: UserGroupsState, { rightId }): void\n\t{\n\t\tstore.commit('deleteRight', { rightId });\n\t}\n\n\tgetMutations(): MutationTree<UserGroupsState>\n\t{\n\t\treturn {\n\t\t\tsetAccessRightValues: (state, { userGroupId, valueId, values, isModified }) => {\n\t\t\t\tconst userGroup = this.#getUserGroup(state, userGroupId);\n\n\t\t\t\tconst accessRightValue = userGroup.accessRights.get(valueId);\n\n\t\t\t\tif (!accessRightValue)\n\t\t\t\t{\n\t\t\t\t\tuserGroup.accessRights.set(\n\t\t\t\t\t\tvalueId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: valueId,\n\t\t\t\t\t\t\tvalues,\n\t\t\t\t\t\t\tisModified,\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccessRightValue.values = values;\n\t\t\t\taccessRightValue.isModified = isModified;\n\t\t\t},\n\t\t\tsetRoleTitle: (state, { userGroupId, title }) => {\n\t\t\t\tconst userGroup = this.#getUserGroup(state, userGroupId);\n\t\t\t\tuserGroup.title = title;\n\t\t\t\tuserGroup.isModified = this.#isUserGroupModified(userGroup);\n\t\t\t},\n\t\t\taddMember: (state, { userGroupId, accessCode, member }) => {\n\t\t\t\tconst userGroup = this.#getUserGroup(state, userGroupId);\n\t\t\t\tuserGroup.members.set(accessCode, member);\n\t\t\t\tuserGroup.isModified = this.#isUserGroupModified(userGroup);\n\t\t\t},\n\t\t\tremoveMember: (state, { userGroupId, accessCode }) => {\n\t\t\t\tconst userGroup = this.#getUserGroup(state, userGroupId);\n\t\t\t\tuserGroup.members.delete(accessCode);\n\t\t\t\tuserGroup.isModified = this.#isUserGroupModified(userGroup);\n\t\t\t},\n\t\t\tupdateMembersForUserGroup: (state, { userGroupId, memberCollection }) => {\n\t\t\t\tconst userGroup = this.#getUserGroup(state, userGroupId);\n\t\t\t\tuserGroup.members = memberCollection;\n\t\t\t\tuserGroup.isModified = this.#isUserGroupModified(userGroup);\n\t\t\t},\n\t\t\taddUserGroup: (state, { userGroup }) => {\n\t\t\t\tstate.collection.set(userGroup.id, userGroup);\n\t\t\t},\n\t\t\tremoveUserGroup: (state, { userGroupId }) => {\n\t\t\t\tstate.collection.delete(userGroupId);\n\t\t\t},\n\t\t\tmarkUserGroupForDeletion: (state, { userGroupId }) => {\n\t\t\t\tstate.deleted.add(userGroupId);\n\t\t\t},\n\t\t\tupdateSortConfigForSelectedMember: (state, { sortConfigForSelectedMember }) => {\n\t\t\t\tconst selectedMemberId = state.selectedMember?.id ?? SELECTED_ALL_USER_ID;\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.sortConfig[selectedMemberId] = sortConfigForSelectedMember;\n\t\t\t},\n\t\t\tupdateSortConfig: (state, { sortConfig }) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.sortConfig = sortConfig;\n\t\t\t},\n\t\t\tdeleteRight: (state: UserGroupsState, { rightId }) => {\n\t\t\t\tfor (const role: UserGroup of state.collection.values())\n\t\t\t\t{\n\t\t\t\t\tif (role.accessRights.get(rightId))\n\t\t\t\t\t{\n\t\t\t\t\t\trole.accessRights.delete(rightId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tselectMember: (state, { member }) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.selectedMember = member;\n\t\t\t},\n\t\t};\n\t}\n\n\t#isValueModified(userGroupId: string, valueId: string, values: Set<string>, emptyValue: Set<string>): boolean\n\t{\n\t\tconst initialGroup = this.#initialUserGroups.get(userGroupId);\n\t\tif (!initialGroup)\n\t\t{\n\t\t\t// its a newly created group, all values are modified\n\n\t\t\treturn true;\n\t\t}\n\n\t\tconst initialValues = initialGroup.accessRights.get(valueId)?.values ?? emptyValue;\n\n\t\t// use native Sets instead of Vue-wrapped proxy-sets, they throw an error on `symmetricDifference`\n\t\treturn !this.#isSetsEqual(new Set(initialValues), new Set(values));\n\t}\n\n\t#isSetsEqual(a: Set, b: Set): boolean\n\t{\n\t\tif (Type.isFunction(a.symmetricDifference))\n\t\t{\n\t\t\t// native way to compare sets for modern browsers\n\t\t\treturn a.symmetricDifference(b).size === 0;\n\t\t}\n\n\t\t// polyfill\n\n\t\tif (a.size !== b.size)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (const value of a)\n\t\t{\n\t\t\tif (!b.has(value))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (const value of b)\n\t\t{\n\t\t\tif (!a.has(value))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t#isUserGroupModified(userGroup: UserGroup): boolean\n\t{\n\t\tif (userGroup.isNew)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst initialGroup = this.#initialUserGroups.get(userGroup.id);\n\t\tif (!initialGroup)\n\t\t{\n\t\t\tthrow new Error('ui.accessrights.v2: initial user group not found');\n\t\t}\n\n\t\tif (userGroup.title !== initialGroup.title)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst initialAccessCodes = new Set(initialGroup.members.keys());\n\t\tconst currentAccessCodes = new Set(userGroup.members.keys());\n\n\t\treturn !this.#isSetsEqual(initialAccessCodes, currentAccessCodes);\n\t}\n}\n","import { ajax as Ajax, Loc, Text, Type } from 'main.core';\nimport type { AccessRightItem, Variable, VariableCollection } from './store/model/access-rights-model';\n\nexport function shouldRowBeRendered(accessRightItem: AccessRightItem): boolean\n{\n\tif (!accessRightItem.isShown)\n\t{\n\t\treturn false;\n\t}\n\n\treturn !accessRightItem.group || accessRightItem.isGroupExpanded;\n}\n\nexport function getSelectedVariables(\n\tvariables: VariableCollection,\n\tselected: Set<string>,\n\tisAllSelected: boolean,\n): VariableCollection\n{\n\tif (isAllSelected)\n\t{\n\t\treturn variables;\n\t}\n\n\tconst selectedVariables = new Map();\n\n\tfor (const [variableId, variable] of variables)\n\t{\n\t\tif (selected.has(variableId))\n\t\t{\n\t\t\tselectedVariables.set(variableId, variable);\n\t\t}\n\t}\n\n\treturn selectedVariables;\n}\n\nexport function getMultipleSelectedVariablesTitle(selectedVariables: VariableCollection): string\n{\n\tconst lastVariable: Variable = [...selectedVariables.values()].pop();\n\n\tif (selectedVariables.size === 1)\n\t{\n\t\treturn lastVariable.title;\n\t}\n\n\treturn Loc.getMessage(\n\t\t'JS_UI_ACCESSRIGHTS_V2_HAS_SELECTED_ITEMS',\n\t\t{\n\t\t\t'#FIRST_ITEM_NAME#': cutLongTitle(lastVariable.title),\n\t\t\t'#COUNT_REST_ITEMS#': selectedVariables.size - 1,\n\t\t},\n\t);\n}\n\nfunction cutLongTitle(title: string): string\n{\n\tconst VARIABLE_TITLE_MAX_LENGTH = 15;\n\n\tif (title.length > VARIABLE_TITLE_MAX_LENGTH)\n\t{\n\t\treturn `${title.slice(0, VARIABLE_TITLE_MAX_LENGTH)}...`;\n\t}\n\n\treturn title;\n}\n\nexport function getMultipleSelectedVariablesHintHtml(\n\tselectedVariables: VariableCollection,\n\thintTitle: string,\n\tallVariables: VariableCollection,\n): string\n{\n\tif (selectedVariables.size < 2)\n\t{\n\t\treturn '';\n\t}\n\n\tlet listItems = '';\n\tfor (const value of makeSortedVariablesArray(selectedVariables, allVariables))\n\t{\n\t\tlistItems += `<li>${Text.encode(value.title)}</li>`;\n\t}\n\n\treturn `\n\t\t<p>${Text.encode(hintTitle)}</p>\n\t\t<ul>${listItems}</ul>\n\t`;\n}\n\nfunction makeSortedVariablesArray(toSort: VariableCollection, example: VariableCollection): Variable[]\n{\n\tconst orderMap = new Map();\n\n\tlet index = 0;\n\tfor (const [variableId] of example)\n\t{\n\t\torderMap.set(variableId, index);\n\n\t\tindex++;\n\t}\n\n\treturn [...toSort.values()].sort((a, b) => {\n\t\tconst indexA = orderMap.get(a.id);\n\t\tconst indexB = orderMap.get(b.id);\n\n\t\tif (Type.isNil(indexA))\n\t\t{\n\t\t\treturn 1;\n\t\t}\n\n\t\tif (Type.isNil(indexB))\n\t\t{\n\t\t\treturn -1;\n\t\t}\n\n\t\treturn indexA - indexB;\n\t});\n}\n\nexport const DEFAULT_ALIAS_SEPARATOR = '|';\n\nexport function parseAliasKey(key: string, separator = DEFAULT_ALIAS_SEPARATOR): Set<string>\n{\n\tconst parts = key.split(separator);\n\n\treturn new Set(parts);\n}\n\nexport function compileAliasKey(parts: Set<string>, separator = DEFAULT_ALIAS_SEPARATOR): string\n{\n\tconst sortedParts = [...parts].sort();\n\n\treturn sortedParts.join(separator);\n}\n\nexport function normalizeAliasKey(key: string, separator = DEFAULT_ALIAS_SEPARATOR): string\n{\n\tconst parsed = parseAliasKey(key, separator);\n\n\treturn compileAliasKey(parsed, separator);\n}\n\nexport function saveSortConfigForAllUserGroups(categoryName: string, sortConfig: Record<string, number>): Promise\n{\n\treturn Ajax.runAction('ui.accessrights.setUserSortConfig', {\n\t\tdata: {\n\t\t\tname: categoryName,\n\t\t\tuserSortConfig: sortConfig,\n\t\t},\n\t});\n}","export const CellLayout = {\n\ttemplate: `\n\t\t<div class='ui-access-rights-v2-column-item'>\n\t\t\t<slot/>\n\t\t</div>\n\t`,\n};\n","export const ColumnLayout = {\n\ttemplate: `\n\t\t<div class='ui-access-rights-v2-column'>\n\t\t\t<slot/>\n\t\t</div>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport { type BaseEvent } from 'main.core.event';\nimport { Dialog, type ItemOptions } from 'ui.entity-selector';\nimport { RichMenuItem, RichMenuItemIcon, RichMenuPopup } from 'ui.vue3.components.rich-menu';\nimport { mapGetters, mapState } from 'ui.vue3.vuex';\nimport { EntitySelectorContext } from '../../integration/entity-selector/dictionary';\nimport { ItemsMapper } from '../../integration/entity-selector/items-mapper';\nimport { SELECTED_ALL_USER_ID } from '../../store/model/user-groups-model';\nimport { saveSortConfigForAllUserGroups } from '../../utils';\nimport { CellLayout } from '../layout/cell-layout';\nimport { ColumnLayout } from '../layout/column-layout';\nimport '../../css/header/roles-control.css';\nimport { ItemListSelector } from 'ui.accessrights.v2.item-list-selector';\n\nexport const RolesControl = {\n\tname: 'RolesControl',\n\tcomponents: { CellLayout, ColumnLayout, RichMenuPopup, RichMenuItem },\n\tprops: {\n\t\tuserGroups: {\n\t\t\ttype: Map,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tviewDialog: null,\n\tcomputed: {\n\t\tRichMenuItemIcon: () => RichMenuItemIcon,\n\t\t...mapState({\n\t\t\tallUserGroups: (state) => state.userGroups.collection,\n\t\t\tmaxVisibleUserGroups: (state) => state.application.options.maxVisibleUserGroups,\n\t\t\tguid: (state) => state.application.guid,\n\t\t\tuserSortConfigName: (state) => state.application.options.userSortConfigName,\n\t\t\tselectedMember: (state) => state.userGroups.selectedMember,\n\t\t\tsortConfig: (state) => state.userGroups.sortConfig,\n\t\t}),\n\t\t...mapGetters({\n\t\t\tisMaxVisibleUserGroupsSet: 'application/isMaxVisibleUserGroupsSet',\n\t\t\tisMaxVisibleUserGroupsReached: 'userGroups/isMaxVisibleUserGroupsReached',\n\t\t\tuserGroupsBySelectedMember: 'userGroups/userGroupsBySelectedMember',\n\t\t}),\n\t\tshownGroupsCounter(): string {\n\t\t\treturn this.$Bitrix.Loc.getMessage(\n\t\t\t\t'JS_UI_ACCESSRIGHTS_V2_ROLE_COUNTER',\n\t\t\t\t{\n\t\t\t\t\t'#VISIBLE_ROLES#': this.userGroups.size,\n\t\t\t\t\t'#ALL_ROLES#': this.userGroupsBySelectedMember.size,\n\t\t\t\t\t'#GREY_START#': '<span style=\"opacity: var(--ui-opacity-30)\">',\n\t\t\t\t\t'#GREY_FINISH#': '</span>',\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tcopyDialogItems(): ItemOptions[] {\n\t\t\treturn ItemsMapper.mapUserGroups(this.userGroupsBySelectedMember);\n\t\t},\n\t\tviewDialogItems(): ItemOptions[] {\n\t\t\tconst result: ItemOptions[] = [];\n\t\t\tconst selectedMemberId = this.selectedMember?.id ? this.selectedMember.id : SELECTED_ALL_USER_ID;\n\n\t\t\tfor (const copyDialogItem of ItemsMapper.mapUserGroups(this.userGroupsBySelectedMember))\n\t\t\t{\n\t\t\t\tresult.push({\n\t\t\t\t\t...copyDialogItem,\n\t\t\t\t\tselected: this.userGroups.has(copyDialogItem.id),\n\t\t\t\t\tsort: this.sortConfig[selectedMemberId] ? this.sortConfig[selectedMemberId][copyDialogItem.id] : null,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tisPopupShown: false,\n\t\t};\n\t},\n\tmethods: {\n\t\tonCreateNewRoleClick(): void {\n\t\t\tif (this.isMaxVisibleUserGroupsReached)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isPopupShown = false;\n\n\t\t\tthis.$store.dispatch('userGroups/addUserGroup');\n\t\t},\n\t\tonRoleViewClick(): void {\n\t\t\tthis.isPopupShown = false;\n\n\t\t\tthis.showViewDialog(this.$refs.configure);\n\t\t},\n\t\tonCopyRoleClick(): void {\n\t\t\tif (this.isMaxVisibleUserGroupsReached)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isPopupShown = false;\n\n\t\t\tthis.showCopyDialog();\n\t\t},\n\t\tshowCopyDialog(): void {\n\t\t\tconst copyDialog = new Dialog({\n\t\t\t\tcontext: EntitySelectorContext.ROLE,\n\t\t\t\ttargetNode: this.$refs.configure,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tenableSearch: true,\n\t\t\t\tcacheable: false,\n\t\t\t\titems: this.copyDialogItems,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (dialogEvent: BaseEvent) => {\n\t\t\t\t\t\tconst { item } = dialogEvent.getData();\n\n\t\t\t\t\t\tthis.$store.dispatch('userGroups/copyUserGroup', { userGroupId: item.getId() });\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tcopyDialog.show();\n\t\t},\n\t\tshowViewDialog(target: HTMLElement): void {\n\t\t\tthis.viewDialog = new ItemListSelector({\n\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLES_SELECTOR_TITLE'),\n\t\t\t\tsubtitle: this.maxVisibleUserGroups ? Loc.getMessagePlural(\n\t\t\t\t\t'JS_UI_ACCESSRIGHTS_V2_ROLES_SELECTOR_SUBTITLE',\n\t\t\t\t\tthis.maxVisibleUserGroups,\n\t\t\t\t\t{ '#COUNT#': this.maxVisibleUserGroups },\n\t\t\t\t)\n\t\t\t\t\t: null,\n\t\t\t\ttargetNode: target,\n\t\t\t\titems: this.viewDialogItems,\n\t\t\t\tmaxSelected: this.maxVisibleUserGroups,\n\t\t\t\tevents: {\n\t\t\t\t\tonSave: () => {\n\t\t\t\t\t\tconst selectedItems = this.viewDialog.getSelectedItems();\n\t\t\t\t\t\tconst userSortConfig = {};\n\n\t\t\t\t\t\tselectedItems.forEach((item, index) => {\n\t\t\t\t\t\t\tuserSortConfig[item.id] = index;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.$store.dispatch('userGroups/updateSortConfigForSelectedMember', { sortConfigForSelectedMember: userSortConfig });\n\n\t\t\t\t\t\tif (!this.selectedMember?.id || this.selectedMember.id === SELECTED_ALL_USER_ID)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsaveSortConfigForAllUserGroups(this.userSortConfigName, userSortConfig);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.viewDialog = null;\n\t\t\t\t\t},\n\t\t\t\t\tonHide: () => {\n\t\t\t\t\t\tthis.viewDialog = null;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.viewDialog.show();\n\t\t},\n\t\ttoggleViewDialog(target: HTMLElement): void {\n\t\t\tif (this.viewDialog)\n\t\t\t{\n\t\t\t\tthis.viewDialog.hide();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showViewDialog(target);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ColumnLayout>\n\t\t\t<CellLayout class=\"ui-access-rights-v2-header-roles-control\">\n\t\t\t\t<div class='ui-access-rights-v2-column-item-text ui-access-rights-v2-header-roles-control-header'>\n\t\t\t\t\t<div>{{ $Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLES') }}</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tref=\"configure\"\n\t\t\t\t\t\tclass=\"ui-icon-set --more-l ui-access-rights-v2-icon-more\"\n\t\t\t\t\t\tstyle=\"position: absolute; right: 11px; top: 5px;\"\n\t\t\t\t\t\t@click=\"isPopupShown = true\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<RichMenuPopup v-if=\"isPopupShown\" @close=\"isPopupShown = false\" :popup-options=\"{bindElement: $refs.configure}\">\n\t\t\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\t\t\t:icon=\"RichMenuItemIcon.role\"\n\t\t\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_NEW_ROLE')\"\n\t\t\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_NEW_ROLE_SUBTITLE')\"\n\t\t\t\t\t\t\t\t:disabled=\"isMaxVisibleUserGroupsReached\"\n\t\t\t\t\t\t\t\t:hint=\"\n\t\t\t\t\t\t\t\t\tisMaxVisibleUserGroupsReached\n\t\t\t\t\t\t\t\t\t\t? $Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE_ADDING_DISABLED', {\n\t\t\t\t\t\t\t\t\t\t\t'#COUNT#': maxVisibleUserGroups,\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\t@click=\"onCreateNewRoleClick\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\t\t\t:icon=\"RichMenuItemIcon.copy\"\n\t\t\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_COPY_ROLE')\"\n\t\t\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_COPY_ROLE_SUBTITLE')\"\n\t\t\t\t\t\t\t\t:disabled=\"isMaxVisibleUserGroupsReached\"\n\t\t\t\t\t\t\t\t:hint=\"\n\t\t\t\t\t\t\t\t\tisMaxVisibleUserGroupsReached\n\t\t\t\t\t\t\t\t\t\t? $Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE_COPYING_DISABLED', {\n\t\t\t\t\t\t\t\t\t\t\t'#COUNT#': maxVisibleUserGroups,\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\t@click=\"onCopyRoleClick\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\t\t\t:icon=\"RichMenuItemIcon['opened-eye']\"\n\t\t\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE_VIEW')\"\n\t\t\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE_VIEW_SUBTITLE_MSGVER_1')\"\n\t\t\t\t\t\t\t\t@click=\"onRoleViewClick\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</RichMenuPopup>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-access-rights-v2-header-roles-control-actions\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tref=\"counter\"\n\t\t\t\t\t\tclass=\"ui-access-rights-v2-header-roles-control-counter\"\n\t\t\t\t\t\t@click=\"toggleViewDialog($refs.counter)\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"ui-icon-set --o-observer\" style=\"--ui-icon-set__icon-size: 18px;\"></div>\n\t\t\t\t\t\t<span v-html=\"shownGroupsCounter\"></span>\n\t\t\t\t\t\t<div class=\"ui-icon-set --chevron-down ui-access-rights-v2-header-roles-control-chevron\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-access-rights-v2-header-roles-control-expander\">\n\t\t\t\t\t\t<div class=\"ui-access-rights-v2-header-roles-control-expander-button\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"ui-icon-set --collapse\"\n\t\t\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_COLLAPSE_ALL_SECTIONS')\"\n\t\t\t\t\t\t\t\t@click=\"$store.dispatch('accessRights/collapseAllSections')\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-access-rights-v2-header-roles-control-expander-button\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"ui-icon-set --expand-1\"\n\t\t\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_EXPAND_ALL_SECTIONS')\"\n\t\t\t\t\t\t\t\t@click=\"$store.dispatch('accessRights/expandAllSections')\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</CellLayout>\n\t\t</ColumnLayout>\n\t`,\n};\n","import { Text } from 'main.core';\nimport { type BaseEvent } from 'main.core.events';\nimport { mapState } from 'ui.vue3.vuex';\n\nconst isMaxListenersSet: Map<string, boolean> = new Map();\nconst lastScrollLeft: Map<string, number> = new Map();\n\n/**\n * A div without styling that synchronizes horizontal scroll of all elements wrapped in this component with other\n * wrapped elements in this Vue application.\n */\nexport const SyncHorizontalScroll = {\n\tname: 'SyncHorizontalScroll',\n\tdata(): Object {\n\t\treturn {\n\t\t\tcomponentGuid: Text.getRandom(16),\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapState({\n\t\t\tguid: (state) => state.application.guid,\n\t\t}),\n\t},\n\tthrottledEmitScrollEvent: null,\n\tcreated()\n\t{\n\t\tthis.throttledEmitScrollEvent = requestAnimationFrameThrottle(this.emitScrollEvent);\n\t},\n\tmounted(): void {\n\t\tif (!isMaxListenersSet.has(this.guid))\n\t\t{\n\t\t\t// + 1 for header\n\t\t\tconst sectionsNumber = this.$store.state.accessRights.collection.size + 1;\n\n\t\t\t// correctly notify about memory leak\n\t\t\tthis.$Bitrix.eventEmitter.incrementMaxListeners('ui:accessrights:v2:syncScroll', sectionsNumber);\n\n\t\t\tisMaxListenersSet.set(this.guid, true);\n\t\t}\n\n\t\tthis.$Bitrix.eventEmitter.subscribe('ui:accessrights:v2:syncScroll', this.handleScrollEvent);\n\n\t\tvoid this.$nextTick(() => {\n\t\t\tif (lastScrollLeft.has(this.guid))\n\t\t\t{\n\t\t\t\tthis.syncScroll(lastScrollLeft.get(this.guid));\n\t\t\t}\n\t\t});\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.$Bitrix.eventEmitter.unsubscribe('ui:accessrights:v2:syncScroll', this.handleScrollEvent);\n\t},\n\tmethods: {\n\t\temitScrollEvent(event): void {\n\t\t\t// this component instance is being scrolled, we need to notify other instances\n\t\t\tconst { scrollLeft } = event.target;\n\n\t\t\tlastScrollLeft.set(this.guid, scrollLeft);\n\n\t\t\t// emit global application event so other SyncHorizontalScroll instances receive it\n\t\t\tthis.$Bitrix.eventEmitter.emit('ui:accessrights:v2:syncScroll', {\n\t\t\t\tscrollLeft,\n\t\t\t\tcomponentGuid: this.componentGuid,\n\t\t\t});\n\t\t},\n\t\thandleScrollEvent(event: BaseEvent): void {\n\t\t\tconst { scrollLeft, componentGuid } = event.getData();\n\t\t\tif (this.componentGuid === componentGuid)\n\t\t\t{\n\t\t\t\t// this event was sent by this exact instance\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.syncScroll(scrollLeft);\n\t\t},\n\t\tsyncScroll(scrollLeft: number): void {\n\t\t\t// magic hack - don't update the element if value not changed.\n\t\t\t// I'm not sure whether this works, but why not\n\t\t\tif (this.$el.scrollLeft !== scrollLeft)\n\t\t\t{\n\t\t\t\tthis.$el.scrollLeft = scrollLeft;\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div @scroll=\"throttledEmitScrollEvent\">\n\t\t\t<slot/>\n\t\t</div>\n\t`,\n};\n\n/**\n * Same as `Runtime.throttle`, but uses `requestAnimationFrame` instead of setTimeout.\n * Why? To sync wait time with display refresh rate for smother animations.\n */\nfunction requestAnimationFrameThrottle(func: Function): Function\n{\n\tlet callbackSet = false;\n\tlet invoke = false;\n\n\treturn function wrapper(...args)\n\t{\n\t\tinvoke = true;\n\n\t\tif (!callbackSet)\n\t\t{\n\t\t\tconst q = function q()\n\t\t\t{\n\t\t\t\tif (invoke)\n\t\t\t\t{\n\t\t\t\t\tfunc(...args);\n\t\t\t\t\tinvoke = false;\n\t\t\t\t\trequestAnimationFrame(q);\n\t\t\t\t\tcallbackSet = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tcallbackSet = false;\n\t\t\t\t}\n\t\t\t};\n\t\t\tq();\n\t\t}\n\t};\n}\n","import { mapGetters, mapState } from 'ui.vue3.vuex';\nimport { Members } from './header/members';\nimport { RoleHeading } from './header/role-heading';\nimport { RolesControl } from './header/roles-control';\nimport { CellLayout } from './layout/cell-layout';\nimport { ColumnLayout } from './layout/column-layout';\nimport { SyncHorizontalScroll } from './util/sync-horizontal-scroll';\nimport { hint } from 'ui.vue3.directives.hint';\nimport 'ui.buttons';\n\n/**\n * A special case of Section\n */\n// @vue/component\nexport const Header = {\n\tname: 'Header',\n\tcomponents: { RoleHeading, SyncHorizontalScroll, Members, RolesControl, ColumnLayout, CellLayout },\n\tdirectives: {\n\t\thint,\n\t},\n\tprops: {\n\t\tuserGroups: {\n\t\t\ttype: Map,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapState({\n\t\t\tmaxVisibleUserGroups: (state) => state.application.options.maxVisibleUserGroups,\n\t\t}),\n\t\t...mapGetters({\n\t\t\tisMaxVisibleUserGroupsReached: 'userGroups/isMaxVisibleUserGroupsReached',\n\t\t}),\n\t},\n\tmethods: {\n\t\tonCreateNewRoleClick(): void\n\t\t{\n\t\t\tif (this.isMaxVisibleUserGroupsReached)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$store.dispatch('userGroups/addUserGroup');\n\t\t},\n\t},\n\t// data attributes are needed for e2e automated tests\n\ttemplate: `\n\t\t<div class=\"ui-access-rights-v2-section ui-access-rights-v2--head-section\">\n\t\t\t<div class='ui-access-rights-v2-section-container'>\n\t\t\t\t<div class='ui-access-rights-v2-section-head'>\n\t\t\t\t\t<RolesControl :user-groups=\"userGroups\"/>\n\t\t\t\t</div>\n\t\t\t\t<div class='ui-access-rights-v2-section-content'>\n\t\t\t\t\t<SyncHorizontalScroll class='ui-access-rights-v2-section-wrapper'>\n\t\t\t\t\t\t<ColumnLayout\n\t\t\t\t\t\t\tv-for=\"[groupId, group] in userGroups\" \n\t\t\t\t\t\t\t:key=\"groupId\"\n\t\t\t\t\t\t\t:data-accessrights-user-group-id=\"groupId\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<CellLayout class=\"ui-access-rights-v2-header-role-cell\">\n\t\t\t\t\t\t\t\t<RoleHeading :user-group=\"group\"/>\n\t\t\t\t\t\t\t\t<Members :user-group=\"group\"/>\n\t\t\t\t\t\t\t</CellLayout>\n\t\t\t\t\t\t</ColumnLayout>\n\t\t\t\t\t\t<ColumnLayout>\n\t\t\t\t\t\t\t<div class=\"ui-access-rights-v2-header-role-add\">\n\t\t\t\t\t\t\t\t<button class=\"ui-btn ui-btn-light-border ui-btn-round ui-btn-disabled\"\n\t\t\t\t\t\t\t\t\t\tv-if=\"isMaxVisibleUserGroupsReached\"\n\t\t\t\t\t\t\t\t\t\tv-hint=\"$Bitrix.Loc.getMessage(\n\t\t\t\t\t\t\t\t\t 'JS_UI_ACCESSRIGHTS_V2_ROLE_ADDING_DISABLED', \n\t\t\t\t\t\t\t\t\t {'#COUNT#': maxVisibleUserGroups,})\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class=\"ui-icon-set --plus-20\"/>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t<button class=\"ui-btn ui-btn-light-border ui-btn-round\"\n\t\t\t\t\t\t\t\t\t\tv-else\n\t\t\t\t\t\t\t\t\t\t@click=\"onCreateNewRoleClick\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class=\"ui-icon-set --plus-20\"/>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</ColumnLayout>\n\t\t\t\t\t</SyncHorizontalScroll>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Runtime } from 'main.core';\n\nexport const SearchBox = {\n\tname: 'SearchBox',\n\tdebouncedSetSearchQuery: null,\n\tcreated()\n\t{\n\t\tconst setSearchQuery = (query) => {\n\t\t\tthis.$store.dispatch('accessRights/search', { query });\n\t\t};\n\n\t\tthis.debouncedSetSearchQuery = Runtime.debounce(setSearchQuery, 200);\n\t},\n\tcomputed: {\n\t\tsearchQuery: {\n\t\t\tget(): string {\n\t\t\t\treturn this.$store.state.accessRights.searchQuery;\n\t\t\t},\n\t\t\tset(query: string): void {\n\t\t\t\tthis.debouncedSetSearchQuery(query);\n\t\t\t},\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"ui-ctl ui-ctl-after-icon ui-access-rights-v2-search\">\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tclass=\"ui-ctl-element ui-ctl-textbox ui-access-rights-v2-search-input\"\n\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SEARCH_PLACEHOLDER')\"\n\t\t\t\tv-model=\"searchQuery\"\n\t\t\t\tref=\"searchInput\"\n\t\t\t>\n\t\t\t<a \n\t\t\t\tclass=\"ui-icon-set --o-search ui-access-rights-v2-search-icon\"\n\t\t\t\t@click=\"this.$refs.searchInput.focus()\"\n\t\t\t></a>\n\t\t</div>\n\t`,\n};\n","import { ajax as Ajax } from 'main.core';\nimport type { EntityOptions, Item, ItemId } from 'ui.entity-selector';\nimport { mapState } from 'ui.vue3.vuex';\nimport { type SelectorService } from '../service/selector-service';\nimport { ServiceLocator } from '../service/service-locator';\nimport type { SelectedMember } from '../store/model/user-groups-model';\nimport { Chip } from 'ui.system.chip.vue';\nimport { SELECTED_ALL_USER_ID } from '../store/model/user-groups-model';\n\nexport const MemberSelector = {\n\tname: 'MemberSelector',\n\tcomponents: { Chip },\n\tdata(): Object {\n\t\treturn {\n\t\t\taccessCodesCache: {},\n\t\t};\n\t},\n\tcomputed: {\n\t\tselectedMember: {\n\t\t\tget(): SelectedMember {\n\t\t\t\treturn this.$store.state.userGroups.selectedMember;\n\t\t\t},\n\t\t\tset(member) {\n\t\t\t\tthis.$store.dispatch('userGroups/selectMember', { member });\n\t\t\t},\n\t\t},\n\t\tselectedMemberName(): string {\n\t\t\tif (\n\t\t\t\t!this.selectedMember.id\n\t\t\t\t|| this.selectedMember.id === SELECTED_ALL_USER_ID\n\t\t\t\t|| !this.selectedMember?.member?.name\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_USER_SELECTOR_ALL_USERS');\n\t\t\t}\n\n\t\t\treturn this.selectedMember.member.name;\n\t\t},\n\t\tselectedMemberAvatar(): ?string {\n\t\t\tif (!this.selectedMember.id || this.selectedMember.id === SELECTED_ALL_USER_ID)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.selectedMember?.member?.avatar ?? '/bitrix/js/ui/accessrights/v2/images/user-avatar.svg';\n\t\t},\n\t\tavatarBackgroundImage(): string {\n\t\t\treturn `url(${encodeURI(this.selectedMemberAvatar)})`;\n\t\t},\n\t\tselectedItems(): ItemId[] {\n\t\t\tif (this.selectedMember && this.selectedMember.id && this.selectedMember.id !== SELECTED_ALL_USER_ID)\n\t\t\t{\n\t\t\t\treturn [[this.selectedMember.entityType, this.selectedMember.entityId]];\n\t\t\t}\n\n\t\t\treturn [['meta-user', SELECTED_ALL_USER_ID]];\n\t\t},\n\t\t...mapState({\n\t\t\tmemberOptions: (state) => state.application.options.additionalMembersParams,\n\t\t}),\n\t},\n\tmethods: {\n\t\topenUserSelector() {\n\t\t\tthis.getSelectorService()\n\t\t\t\t.createDialog({\n\t\t\t\t\ttargetNode: this.$refs.userSelector,\n\t\t\t\t\tpreselectedItems: this.selectedItems,\n\t\t\t\t\tmultiple: false,\n\t\t\t\t\thideOnSelect: true,\n\t\t\t\t\thideOnDeselect: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'Item:onSelect': this.onMemberSelect,\n\t\t\t\t\t\t'Item:onDeselect': this.onMemberDeselect,\n\t\t\t\t\t},\n\t\t\t\t\tentities: this.getEntities(),\n\t\t\t\t})\n\t\t\t\t.show();\n\t\t},\n\t\tgetEntities(): EntityOptions[] {\n\t\t\tconst entities = this.getSelectorService().entities();\n\t\t\tentities.push({\n\t\t\t\tid: 'meta-user',\n\t\t\t\toptions: {\n\t\t\t\t\t'all-users': true,\n\t\t\t\t},\n\t\t\t});\n\n\t\t\treturn entities;\n\t\t},\n\t\tonMemberSelect(event: BaseEvent): void {\n\t\t\tconst { item } = event.getData();\n\t\t\tconst cacheKey = item.id === SELECTED_ALL_USER_ID ? SELECTED_ALL_USER_ID : item.entityId + item.id;\n\t\t\tconst newSelectedMember = {\n\t\t\t\tid: cacheKey,\n\t\t\t\tentityId: item.id,\n\t\t\t\tentityType: item.entityId,\n\t\t\t\tmember: this.getSelectorService().getMemberByItem(item),\n\t\t\t};\n\n\t\t\tconst cachedAccessCodes = this.getAccessCodesFromCache(cacheKey);\n\t\t\tif (cachedAccessCodes.length > 0 || item.id === SELECTED_ALL_USER_ID)\n\t\t\t{\n\t\t\t\tthis.selectedMember = {\n\t\t\t\t\t...newSelectedMember,\n\t\t\t\t\taccessCodes: cachedAccessCodes,\n\t\t\t\t};\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.shouldUseAjax(item))\n\t\t\t{\n\t\t\t\tthis.selectedMember = {\n\t\t\t\t\t...newSelectedMember,\n\t\t\t\t\taccessCodes: this.getDefaultAccessCodesByItem(item),\n\t\t\t\t};\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$store.commit('application/setProgress', true);\n\t\t\tAjax.runAction('ui.accessrights.getAccessCodes', {\n\t\t\t\tdata: {\n\t\t\t\t\tid: newSelectedMember.member.id,\n\t\t\t\t\tparams: this.$store.state.application.options.additionalSaveParams,\n\t\t\t\t\tmoduleId: this.$store.state.application.options.moduleId,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tlet accessCodes = response.data ?? [];\n\t\t\t\t\tif (accessCodes.length === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\taccessCodes = this.getDefaultAccessCodesByItem(item);\n\t\t\t\t\t}\n\t\t\t\t\tthis.selectedMember = {\n\t\t\t\t\t\t...newSelectedMember,\n\t\t\t\t\t\taccessCodes,\n\t\t\t\t\t};\n\t\t\t\t\tthis.accessCodesCache[cacheKey] = new Set(accessCodes);\n\t\t\t\t\tthis.$store.commit('application/setProgress', false);\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tconst accessCodes = this.getDefaultAccessCodesByItem(item);\n\t\t\t\t\tthis.selectedMember = {\n\t\t\t\t\t\t...newSelectedMember,\n\t\t\t\t\t\taccessCodes,\n\t\t\t\t\t};\n\t\t\t\t\tthis.accessCodesCache[cacheKey] = accessCodes;\n\t\t\t\t\tthis.$store.commit('application/setProgress', false);\n\t\t\t\t});\n\t\t},\n\t\tshouldUseAjax(item): boolean {\n\t\t\tconst entityTypes = [\n\t\t\t\t'user',\n\t\t\t\t'department',\n\t\t\t\t'structure-node',\n\t\t\t];\n\n\t\t\treturn entityTypes.includes(item.entityId);\n\t\t},\n\t\tonMemberDeselect(event: BaseEvent): void {\n\t\t\tthis.selectedMember = {\n\t\t\t\tid: SELECTED_ALL_USER_ID,\n\t\t\t\tentityId: SELECTED_ALL_USER_ID,\n\t\t\t\tentityType: 'meta-user',\n\t\t\t\taccessCodes: [],\n\t\t\t};\n\t\t},\n\t\tgetDefaultAccessCodesByItem(item: Item): string[] {\n\t\t\tif (item.entityId === 'structure-role')\n\t\t\t{\n\t\t\t\tconst itemId = item.id.match(/^(?:ATD|ATE|ATT|AD|AE|AT)([1-9]\\d*)$/)?.[1];\n\t\t\t\tconst accessCodes = [this.getSelectorService().getAccessCodeByItem(item), `AE${itemId}`];\n\n\t\t\t\treturn [...new Set(accessCodes)];\n\t\t\t}\n\n\t\t\tif (item.entityId === 'project-access-codes')\n\t\t\t{\n\t\t\t\tconst itemId = item.id.match(/^SG(\\d+)_([AEK])$/)?.[1];\n\t\t\t\tconst accessCodes = [this.getSelectorService().getAccessCodeByItem(item), `SG${itemId}_K`];\n\n\t\t\t\treturn [...new Set(accessCodes)];\n\t\t\t}\n\n\t\t\treturn [this.getSelectorService().getAccessCodeByItem(item)];\n\t\t},\n\t\tgetAccessCodesFromCache(id): [] {\n\t\t\treturn this.accessCodesCache[id] || [];\n\t\t},\n\t\tgetSelectorService(): SelectorService\n\t\t{\n\t\t\treturn ServiceLocator.getSelectorService(this.memberOptions);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div ref=\"userSelector\" class=\"ui-access-rights-v2-user-selector\">\n\t\t\t<Chip\n\t\t\t\t:image=\"selectedMemberAvatar ? { src: selectedMemberAvatar, alt: selectedMemberName } : ''\"\n\t\t\t\t:dropdown=\"true\"\n\t\t\t\t:text=selectedMemberName\n\t\t\t\t@click=\"openUserSelector\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Text, Type } from 'main.core';\nimport { DEFAULT_ALIAS_SEPARATOR, normalizeAliasKey } from '../../../../utils';\nimport type {\n\tAccessRightItem,\n\tAccessRightsCollection,\n\tAccessRightSection,\n\tAccessRightSectionAction,\n\tAccessRightSectionIcon,\n\tVariable,\n} from '../../access-rights-model';\nimport type { Transformer } from '../transformer';\n\nexport type ExternalAccessRightSection = {\n\tsectionTitle: ?any,\n\tsectionSubTitle: ?any,\n\tsectionCode: ?any,\n\tsectionHint: ?any,\n\tsectionIcon: ?any,\n\trights: ExternalAccessRightItem[],\n\taction: ?ExternalAccessRightSectionAction,\n};\n\nexport type ExternalAccessRightSectionAction = {\n\tbuttonText: string,\n};\n\nexport type ExternalAccessRightItem = {\n\tid: any,\n\ttype: any,\n\ttitle: any,\n\tsubtitle: ?any,\n\thint: ?any,\n\tgroup: ?any,\n\tgroupHead: ?any,\n\tminValue?: any | any[],\n\tmaxValue?: any | any[],\n\tdefaultValue?: any | any[],\n\tnothingSelectedValue?: any | any[],\n\tsetEmptyOnSetMinMaxValueInColumn: ?any,\n\n\tvariables?: ExternalVariable[],\n\n\tallSelectedCode: ?any,\n\tselectedVariablesAliases: {[key: string]: string} & {separator?: string},\n\tenableSearch?: any,\n\tshowAvatars?: any,\n\tcompactView?: any,\n\thintTitle: ?any,\n\tdependentVariablesPopupHint: ?any,\n\n\ticonClass: ?any,\n\tisClickable: ?any,\n\tisDeletable: ?any,\n\tisNew: ?any,\n\tisModified: ?any,\n};\n\nexport type ExternalVariable = {\n\tid: any,\n\ttitle: any,\n\tentityId: ?any,\n\tsupertitle: ?any,\n\tavatar: ?any,\n\tavatarOptions: ?any,\n\tconflictsWith?: any[],\n\trequires?: any[],\n\tsecondary: ?any,\n\thint: ?any,\n}\n\nexport class AccessRightsInternalizer implements Transformer<ExternalAccessRightSection[], AccessRightsCollection>\n{\n\ttransform(externalSource: ExternalAccessRightSection[]): AccessRightsCollection\n\t{\n\t\tconst result: AccessRightsCollection = new Map();\n\n\t\tfor (const external of externalSource)\n\t\t{\n\t\t\tconst internalized = this.#internalizeExternalSection(external);\n\t\t\tresult.set(internalized.sectionCode, internalized);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#internalizeExternalSection(externalSection: ExternalAccessRightSection): AccessRightSection\n\t{\n\t\tconst internalizedSection: AccessRightSection = {\n\t\t\tsectionCode: Type.isStringFilled(externalSection.sectionCode)\n\t\t\t\t? externalSection.sectionCode\n\t\t\t\t: Text.getRandom(),\n\t\t\tsectionTitle: String(externalSection.sectionTitle),\n\t\t\tsectionSubTitle: Type.isStringFilled(externalSection.sectionSubTitle)\n\t\t\t\t? externalSection.sectionSubTitle\n\t\t\t\t: null,\n\t\t\tsectionHint: Type.isStringFilled(externalSection.sectionHint)\n\t\t\t\t? externalSection.sectionHint\n\t\t\t\t: null,\n\t\t\tsectionIcon: this.#internalizeExternalIcon(externalSection.sectionIcon),\n\t\t\trights: new Map(),\n\t\t\tisExpanded: true,\n\t\t\tisShown: true,\n\t\t\taction: this.#internalizeExternalSectionAction(externalSection.action),\n\t\t};\n\n\t\tfor (const externalItem of externalSection.rights)\n\t\t{\n\t\t\tconst internalizedItem = this.internalizeExternalItem(externalItem);\n\n\t\t\tinternalizedSection.rights.set(internalizedItem.id, internalizedItem);\n\t\t}\n\n\t\treturn internalizedSection;\n\t}\n\n\t#internalizeExternalIcon(externalIcon: ?any): ?AccessRightSectionIcon\n\t{\n\t\tif (Type.isStringFilled(externalIcon?.type) && Type.isStringFilled(externalIcon?.bgColor))\n\t\t{\n\t\t\treturn {\n\t\t\t\ttype: externalIcon.type,\n\t\t\t\tbgColor: externalIcon.bgColor,\n\t\t\t};\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#internalizeExternalSectionAction(externalSectionAction: ExternalAccessRightSectionAction): ?AccessRightSectionAction\n\t{\n\t\tif (Type.isStringFilled(externalSectionAction?.buttonText))\n\t\t{\n\t\t\treturn {\n\t\t\t\tbuttonText: externalSectionAction.buttonText,\n\t\t\t};\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tinternalizeExternalItem(externalItem: ExternalAccessRightItem): AccessRightItem\n\t{\n\t\tconst [aliases, separator] = this.#internalizeSelectedVariablesAliases(externalItem.selectedVariablesAliases);\n\n\t\tconst normalizedItem: AccessRightItem = {\n\t\t\tid: String(externalItem.id),\n\t\t\ttype: String(externalItem.type),\n\t\t\ttitle: String(externalItem.title),\n\t\t\tsubtitle: Type.isStringFilled(externalItem.subtitle) ? externalItem.subtitle : null,\n\t\t\thint: Type.isStringFilled(externalItem.hint) ? externalItem.hint : null,\n\t\t\tgroup: Type.isNil(externalItem.group) ? null : String(externalItem.group),\n\t\t\tgroupHead: Type.isBoolean(externalItem.groupHead) ? externalItem.groupHead : false,\n\t\t\tisShown: true,\n\t\t\tminValue: this.#internalizeValueSet(externalItem.minValue),\n\t\t\tmaxValue: this.#internalizeValueSet(externalItem.maxValue),\n\t\t\tdefaultValue: this.#internalizeValueSet(externalItem.defaultValue),\n\t\t\temptyValue: this.#internalizeValueSet(externalItem.emptyValue),\n\t\t\tnothingSelectedValue: this.#internalizeValueSet(externalItem.nothingSelectedValue),\n\t\t\tsetEmptyOnSetMinMaxValueInColumn: this.#internalizeSetEmptyOnSetMinMaxValueInColumn(externalItem),\n\t\t\tvariables: Type.isArray(externalItem.variables) || Type.isMap(externalItem.variables) ? new Map() : null,\n\n\t\t\tallSelectedCode: Type.isStringFilled(externalItem.allSelectedCode) ? externalItem.allSelectedCode : null,\n\t\t\tselectedVariablesAliases: aliases,\n\t\t\tselectedVariablesAliasesSeparator: separator,\n\t\t\tenableSearch: Type.isBoolean(externalItem.enableSearch) ? externalItem.enableSearch : null,\n\t\t\tshowAvatars: Type.isBoolean(externalItem.showAvatars) ? externalItem.showAvatars : null,\n\t\t\tcompactView: Type.isBoolean(externalItem.compactView) ? externalItem.compactView : null,\n\t\t\thintTitle: Type.isStringFilled(externalItem.hintTitle) ? externalItem.hintTitle : null,\n\t\t\tdependentVariablesPopupHint: Type.isStringFilled(externalItem.dependentVariablesPopupHint)\n\t\t\t\t? externalItem.dependentVariablesPopupHint\n\t\t\t\t: null,\n\n\t\t\ticonClass: Type.isStringFilled(externalItem.iconClass) ? externalItem.iconClass : null,\n\t\t\tisClickable: Type.isBoolean(externalItem.isClickable) ? externalItem.isClickable : false,\n\t\t\tisDeletable: Type.isBoolean(externalItem.isDeletable) ? externalItem.isDeletable : false,\n\t\t\tisNew: Type.isBoolean(externalItem.isNew) ? externalItem.isNew : false,\n\t\t\tisModified: Type.isBoolean(externalItem.isModified) ? externalItem.isModified : false,\n\t\t};\n\t\tif (normalizedItem.groupHead || normalizedItem.group)\n\t\t{\n\t\t\tnormalizedItem.isGroupExpanded = false;\n\t\t}\n\n\t\tif (Type.isArray(externalItem.variables))\n\t\t{\n\t\t\tfor (const variable of externalItem.variables)\n\t\t\t{\n\t\t\t\tconst normalizedVariable = this.#internalizeExternalVariable(variable);\n\n\t\t\t\tnormalizedItem.variables.set(normalizedVariable.id, normalizedVariable);\n\t\t\t}\n\t\t}\n\t\telse if (Type.isMap(externalItem.variables))\n\t\t{\n\t\t\tfor (const variable of externalItem.variables.values())\n\t\t\t{\n\t\t\t\tconst normalizedVariable = this.#internalizeExternalVariable(variable);\n\n\t\t\t\tnormalizedItem.variables.set(normalizedVariable.id, normalizedVariable);\n\t\t\t}\n\t\t}\n\n\t\treturn normalizedItem;\n\t}\n\n\t#internalizeSelectedVariablesAliases(externalAliases: {[key: string]: string} & {separator?: string}): [Map, string]\n\t{\n\t\tif (!Type.isPlainObject(externalAliases))\n\t\t{\n\t\t\treturn [new Map(), DEFAULT_ALIAS_SEPARATOR];\n\t\t}\n\n\t\tconst separator = Type.isString(externalAliases.separator) ? externalAliases.separator : DEFAULT_ALIAS_SEPARATOR;\n\n\t\tconst result = new Map();\n\t\tfor (const [key, value] of Object.entries(externalAliases))\n\t\t{\n\t\t\tif (key === 'separator')\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tresult.set(normalizeAliasKey(key, separator), String(value));\n\t\t}\n\n\t\treturn [result, separator];\n\t}\n\n\t#internalizeValueSet(value: any | any[] | undefined): ?Set<string>\n\t{\n\t\tif (Type.isNil(value))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (Type.isArray(value))\n\t\t{\n\t\t\treturn new Set(value.map((item) => String(item)));\n\t\t}\n\n\t\tif (Type.isSet(value))\n\t\t{\n\t\t\treturn new Set(Array.from(value, (item) => String(item)));\n\t\t}\n\n\t\treturn new Set([String(value)]);\n\t}\n\n\t#internalizeSetEmptyOnSetMinMaxValueInColumn(externalItem: ExternalAccessRightItem): ?boolean\n\t{\n\t\tconst boolOrNull = (x: any) => (Type.isBoolean(x) ? x : null);\n\n\t\tif (!Type.isUndefined(externalItem.setEmptyOnSetMinMaxValueInColumn))\n\t\t{\n\t\t\treturn boolOrNull(externalItem.setEmptyOnSetMinMaxValueInColumn);\n\t\t}\n\n\t\t// todo compatibility, can be removed when crm update is out\n\t\treturn boolOrNull(externalItem.setEmptyOnGroupActions);\n\t}\n\n\t#internalizeExternalVariable(externalVariable: ExternalVariable): Variable\n\t{\n\t\treturn {\n\t\t\tid: String(externalVariable.id),\n\t\t\ttitle: String(externalVariable.title),\n\t\t\tentityId: Type.isStringFilled(externalVariable.entityId) ? externalVariable.entityId : null,\n\t\t\tsupertitle: Type.isStringFilled(externalVariable.supertitle) ? externalVariable.supertitle : null,\n\t\t\tavatar: Type.isStringFilled(externalVariable.avatar) ? externalVariable.avatar : null,\n\t\t\tavatarOptions: Type.isPlainObject(externalVariable.avatarOptions) ? externalVariable.avatarOptions : null,\n\t\t\tconflictsWith: Type.isArray(externalVariable.conflictsWith)\n\t\t\t\t? new Set(externalVariable.conflictsWith.map((x) => String(x)))\n\t\t\t\t: null,\n\t\t\trequires: Type.isArray(externalVariable.requires)\n\t\t\t\t? new Set(externalVariable.requires.map((x) => String(x)))\n\t\t\t\t: null,\n\t\t\tsecondary: Type.isBoolean(externalVariable.secondary) ? externalVariable.secondary : null,\n\t\t\thint: Type.isStringFilled(externalVariable.hint) ? externalVariable.hint : null,\n\t\t};\n\t}\n}\n","import { Runtime, Type } from 'main.core';\nimport { type ActionTree, BuilderModel, GetterTree, type MutationTree } from 'ui.vue3.vuex';\nimport { ServiceLocator } from '../../service/service-locator';\nimport { compileAliasKey } from '../../utils';\nimport { AccessRightsInternalizer } from './transformation/internalizer/access-rights-internalizer';\n\nexport type AccessRightsState = {\n\tcollection: AccessRightsCollection,\n\tsearchQuery: string,\n\tdeleted: Set<string>,\n}\n\nexport type AccessRightsCollection = Map<string, AccessRightSection>;\n\nexport type AccessRightSection = {\n\tsectionTitle: string,\n\tsectionSubTitle: ?string,\n\tsectionCode: string, // not sent to backend, frontend uses it only for indexing\n\tsectionHint: ?string,\n\tsectionIcon?: AccessRightSectionIcon,\n\trights: Map<string, AccessRightItem>,\n\tisExpanded: boolean,\n\tisShown: boolean,\n\taction: ?AccessRightSectionAction,\n};\n\nexport type AccessRightSectionIcon = {\n\ttype: string, // icon name from 'ui.icon-set'\n\tbgColor: string, // hex or --ui-color-palette-* variable name\n};\n\nexport type AccessRightSectionAction = {\n\tbuttonText: string,\n};\n\nexport type AccessRightItem = {\n\tid: string,\n\ttype: string,\n\ttitle: string,\n\tsubtitle: ?string,\n\thint: ?string, // hint for row title in the title column\n\tgroup: ?string, // id of parent item id\n\tgroupHead: boolean,\n\tisGroupExpanded: ?boolean, // only for group head and grouped items\n\tisShown: boolean,\n\tminValue?: Set<string>,\n\tmaxValue?: Set<string>,\n\tdefaultValue?: Set<string>,\n\temptyValue?: Set<string>,\n\tnothingSelectedValue?: Set<string>,\n\tsetEmptyOnSetMinMaxValueInColumn?: boolean,\n\n\tvariables: VariableCollection, // options to choose from in variable-like controls\n\n\t// only for multivariable\n\tallSelectedCode: ?string,\n\tselectedVariablesAliases: Map<string, string>,\n\tselectedVariablesAliasesSeparator: ?string,\n\tenableSearch?: boolean,\n\tshowAvatars?: boolean,\n\tcompactView?: boolean,\n\thintTitle: ?string, // title for 'already selected values' hint in multivariable and dependent-variables selector\n\tdependentVariablesPopupHint: ?string, // hint in dependent-variables popup under all switchers\n\n\t// clickable right with icon\n\ticonClass: ?string,\n\tisClickable: boolean,\n\tisDeletable: boolean,\n\tisNew: boolean,\n\tisModified: boolean,\n};\n\nexport type VariableCollection = Map<string, Variable>;\n\nexport type Variable = {\n\tid: string,\n\ttitle: string,\n\t// used only in multivariable selector\n\tentityId: ?string,\n\tsupertitle: ?string,\n\tavatar: ?string,\n\tavatarOptions: ?Object,\n\t// used only in dependent-variables\n\tconflictsWith?: Set<string>,\n\trequires?: Set<string>,\n\tsecondary: ?boolean, // switcher color and size for dependent-variables\n\thint: ?string,\n}\n\nexport class AccessRightsModel extends BuilderModel\n{\n\t#initialRights: AccessRightsCollection = new Map();\n\n\tgetName(): string\n\t{\n\t\treturn 'accessRights';\n\t}\n\n\tsetInitialAccessRights(rights: AccessRightsCollection): AccessRightsModel\n\t{\n\t\tthis.#initialRights = rights;\n\n\t\treturn this;\n\t}\n\n\tgetState(): AccessRightsState\n\t{\n\t\treturn {\n\t\t\tcollection: Runtime.clone(this.#initialRights),\n\t\t\tsearchQuery: '',\n\t\t\tdeleted: new Set(),\n\t\t};\n\t}\n\n\tgetElementState(params = {}): AccessRightSection\n\t{\n\t\tthrow new Error('Cant create AccessRightSection. You are doing something wrong');\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree<AccessRightsState>\n\t{\n\t\treturn {\n\t\t\tshown: (state): AccessRightsCollection => {\n\t\t\t\tconst result = new Map();\n\n\t\t\t\tfor (const [sectionCode, section] of state.collection)\n\t\t\t\t{\n\t\t\t\t\tif (section.isShown)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.set(sectionCode, section);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\tisMinValueSetForAny: (state, getters): boolean => {\n\t\t\t\tfor (const section of state.collection.values())\n\t\t\t\t{\n\t\t\t\t\tfor (const item of section.rights.values())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst isSet = getters.isMinValueSet(section.sectionCode, item.id);\n\t\t\t\t\t\tif (isSet)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tisMinValueSet: (state) => (sectionCode: string, rightId: string): boolean => {\n\t\t\t\tconst item = state.collection.get(sectionCode)?.rights.get(rightId);\n\t\t\t\tif (!item)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t'ui.accessrights.v2: attempt to check if min value set for unknown right',\n\t\t\t\t\t\t{ sectionCode, rightId },\n\t\t\t\t\t);\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn !Type.isNil(item.minValue);\n\t\t\t},\n\t\t\tisMaxValueSetForAny: (state, getters): boolean => {\n\t\t\t\tfor (const section of state.collection.values())\n\t\t\t\t{\n\t\t\t\t\tfor (const item of section.rights.values())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst isSet = getters.isMaxValueSet(section.sectionCode, item.id);\n\t\t\t\t\t\tif (isSet)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tisMaxValueSet: (state) => (sectionCode: string, rightId: string): boolean => {\n\t\t\t\tconst item = state.collection.get(sectionCode)?.rights.get(rightId);\n\t\t\t\tif (!item)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t'ui.accessrights.v2: attempt to check if max value set for unknown right',\n\t\t\t\t\t\t{ sectionCode, rightId },\n\t\t\t\t\t);\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn !Type.isNil(item.maxValue);\n\t\t\t},\n\t\t\tgetEmptyValue: (state) => (sectionCode: string, valueId: string): Set<string> => {\n\t\t\t\tconst item = state.collection.get(sectionCode)?.rights.get(valueId);\n\t\t\t\tif (!item)\n\t\t\t\t{\n\t\t\t\t\treturn new Set();\n\t\t\t\t}\n\n\t\t\t\treturn ServiceLocator.getValueTypeByRight(item)?.getEmptyValue(item) ?? new Set();\n\t\t\t},\n\t\t\tgetNothingSelectedValue: (state, getters) => (sectionCode: string, valueId: string): Set<string> => {\n\t\t\t\tconst item = state.collection.get(sectionCode)?.rights.get(valueId);\n\n\t\t\t\treturn item?.nothingSelectedValue ?? getters.getEmptyValue(sectionCode, valueId);\n\t\t\t},\n\t\t\tgetSelectedVariablesAlias: (state) => (sectionCode: string, valueId: string, values: Set<string>): ?string => {\n\t\t\t\tconst item = state.collection.get(sectionCode)?.rights.get(valueId);\n\t\t\t\tif (!item)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst key = compileAliasKey(values, item.selectedVariablesAliasesSeparator);\n\n\t\t\t\treturn item.selectedVariablesAliases.get(key);\n\t\t\t},\n\t\t\tisModified: (state): boolean => {\n\t\t\t\tif (state.deleted.size > 0)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tfor (const section: AccessRightSection of state.collection.values())\n\t\t\t\t{\n\t\t\t\t\tfor (const rightItem: AccessRightItem of section.rights.values())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (rightItem.isNew || rightItem.isModified)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree<AccessRightsState>\n\t{\n\t\treturn {\n\t\t\ttoggleSection: (store, { sectionCode }): void => {\n\t\t\t\tif (!store.state.collection.has(sectionCode))\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('ui.accessrights.v2: Attempt to toggle section that dont exists', { sectionCode });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('toggleSection', { sectionCode });\n\t\t\t},\n\t\t\texpandAllSections: (store): void => {\n\t\t\t\tfor (const sectionCode of store.state.collection.keys())\n\t\t\t\t{\n\t\t\t\t\tstore.commit('expandSection', { sectionCode });\n\t\t\t\t}\n\t\t\t},\n\t\t\tcollapseAllSections: (store): void => {\n\t\t\t\tfor (const sectionCode of store.state.collection.keys())\n\t\t\t\t{\n\t\t\t\t\tstore.commit('collapseSection', { sectionCode });\n\t\t\t\t}\n\t\t\t},\n\t\t\ttoggleGroup: (store, { sectionCode, groupId }): void => {\n\t\t\t\tconst item = store.state.collection.get(sectionCode)?.rights.get(groupId);\n\t\t\t\tif (!item)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('ui.accessrights.v2: Attempt to toggle group that dont exists', { groupId });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!item.groupHead)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('ui.accessrights.v2: Attempt to toggle group that is not group head', { groupId });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('toggleGroup', { sectionCode, groupId });\n\t\t\t},\n\t\t\tsearch: (store, payload): void => {\n\t\t\t\tthis.#searchAction(store, payload);\n\t\t\t},\n\t\t\taddRight: (store, { sectionCode, right }): void => {\n\t\t\t\tif (!store.state.collection.has(sectionCode))\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('ui.accessrights.v2: Adding right to section that doesn`t exists', { sectionCode });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst section: AccessRightSection = store.state.collection.get(sectionCode);\n\t\t\t\tif (section)\n\t\t\t\t{\n\t\t\t\t\tconst internalRight: AccessRightItem = (new AccessRightsInternalizer()).internalizeExternalItem(right);\n\t\t\t\t\tstore.commit('expandSection', { sectionCode });\n\t\t\t\t\tstore.commit('addRight', { sectionCode, right: internalRight });\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdateRightTitle: (store, { sectionCode, rightId, rightTitle }): void => {\n\t\t\t\tif (!store.state.collection.has(sectionCode))\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('ui.accessrights.v2: Updating right in section that doesn`t exists', { sectionCode });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst section: AccessRightSection = store.state.collection.get(sectionCode);\n\t\t\t\tif (!section.rights.has(rightId))\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('ui.accessrights.v2: Updating right that doesn`t exists', { rightId });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('expandSection', { sectionCode });\n\t\t\t\tstore.commit('setRightTitle', { sectionCode, rightId, title: rightTitle });\n\t\t\t},\n\t\t\tupdateRightSubtitle: (store, { sectionCode, rightId, rightSubtitle }): void => {\n\t\t\t\tif (!store.state.collection.has(sectionCode))\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('ui.accessrights.v2: Updating right in section that doesn`t exists', { sectionCode });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst section: AccessRightSection = store.state.collection.get(sectionCode);\n\t\t\t\tif (!section.rights.has(rightId))\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('ui.accessrights.v2: Updating right that doesn`t exists', { rightId });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('expandSection', { sectionCode });\n\t\t\t\tstore.commit('setRightSubtitle', { sectionCode, rightId, subtitle: rightSubtitle });\n\t\t\t},\n\t\t\tdeleteRight: (store, { sectionCode, rightId }): void => {\n\t\t\t\tif (!store.state.collection.has(sectionCode))\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('ui.accessrights.v2: Deleting right in section that doesn`t exists', { sectionCode });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst section: AccessRightSection = store.state.collection.get(sectionCode);\n\t\t\t\tif (!section.rights.has(rightId))\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('ui.accessrights.v2: Deleting right that doesn`t exists', { rightId });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('expandSection', { sectionCode });\n\t\t\t\tstore.commit('deleteRight', { sectionCode, rightId });\n\t\t\t},\n\t\t\tmarkRightAsModified: (store, { sectionCode, rightId, isModified }): void => {\n\t\t\t\tif (!store.state.collection.has(sectionCode))\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('ui.accessrights.v2: Updating right in section that doesn`t exists', { sectionCode });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst section: AccessRightSection = store.state.collection.get(sectionCode);\n\t\t\t\tif (!section.rights.has(rightId))\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('ui.accessrights.v2: Updating right that doesn`t exists', { rightId });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('expandSection', { sectionCode });\n\t\t\t\tstore.commit('markRightAsModified', { sectionCode, rightId, isModified });\n\t\t\t},\n\t\t};\n\t}\n\n\t#searchAction(store, { query }): void\n\t{\n\t\tif (!Type.isString(query))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: attempt to search with non-string search query');\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('setSearchQuery', { query });\n\t\tif (query === '')\n\t\t{\n\t\t\tstore.commit('showAll');\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('hideAll');\n\n\t\tconst lowerQuery = query.toLowerCase();\n\n\t\tfor (const section: AccessRightSection of store.state.collection.values())\n\t\t{\n\t\t\tif (\n\t\t\t\tsection.sectionTitle.toLowerCase().includes(lowerQuery)\n\t\t\t\t|| section.sectionSubTitle?.toLowerCase().includes(lowerQuery)\n\t\t\t)\n\t\t\t{\n\t\t\t\tstore.commit('showSection', { sectionCode: section.sectionCode });\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor (const item: AccessRightItem of section.rights.values())\n\t\t\t{\n\t\t\t\tif (!item.title.toLowerCase().includes(lowerQuery))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (item.groupHead)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('showGroup', { sectionCode: section.sectionCode, groupId: item.id });\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstore.commit('showItem', { sectionCode: section.sectionCode, itemId: item.id });\n\t\t\t\t\tif (item.group)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('expandGroup', { sectionCode: section.sectionCode, groupId: item.group });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetMutations(): MutationTree<AccessRightsState>\n\t{\n\t\treturn {\n\t\t\taddRight: (state, { sectionCode, right }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\t\t\t\tsection.rights.set(right.id, right);\n\t\t\t},\n\t\t\tsetRightTitle: (state, { sectionCode, rightId, title }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\t\t\t\tsection.rights.get(rightId).title = title;\n\t\t\t},\n\t\t\tsetRightSubtitle: (state, { sectionCode, rightId, subtitle }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\t\t\t\tsection.rights.get(rightId).subtitle = subtitle;\n\t\t\t},\n\t\t\tdeleteRight: (state, { sectionCode, rightId }): void => {\n\t\t\t\tconst section: AccessRightSection = state.collection.get(sectionCode);\n\t\t\t\tsection.rights.delete(rightId);\n\t\t\t\tstate.deleted.add(rightId);\n\t\t\t},\n\t\t\tmarkRightAsModified: (state, { sectionCode, rightId, isModified }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\t\t\t\tsection.rights.get(rightId).isModified = isModified;\n\t\t\t},\n\t\t\ttoggleSection: (state, { sectionCode }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\n\t\t\t\tsection.isExpanded = !section.isExpanded;\n\t\t\t},\n\t\t\texpandSection: (state, { sectionCode }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\n\t\t\t\tsection.isExpanded = true;\n\t\t\t},\n\t\t\tcollapseSection: (state, { sectionCode }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\n\t\t\t\tsection.isExpanded = false;\n\t\t\t},\n\t\t\ttoggleGroup: (state, { sectionCode, groupId }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\n\t\t\t\tfor (const item of section.rights.values())\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\t(item.id === groupId && item.groupHead)\n\t\t\t\t\t\t|| item.group === groupId\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.isGroupExpanded = !item.isGroupExpanded;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\texpandGroup: (state, { sectionCode, groupId }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\n\t\t\t\tsection.isExpanded = true;\n\n\t\t\t\tfor (const item of section.rights.values())\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\t(item.id === groupId && item.groupHead)\n\t\t\t\t\t\t|| item.group === groupId\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.isGroupExpanded = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tshowItem: (state, { sectionCode, itemId }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\t\t\t\tsection.isShown = true;\n\n\t\t\t\tconst item = section.rights.get(itemId);\n\t\t\t\titem.isShown = true;\n\t\t\t\tif (item.group)\n\t\t\t\t{\n\t\t\t\t\tsection.rights.get(item.group).isShown = true;\n\t\t\t\t}\n\t\t\t},\n\t\t\tshowGroup: (state, { sectionCode, groupId }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\n\t\t\t\tsection.isShown = true;\n\n\t\t\t\tfor (const item of section.rights.values())\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\t(item.id === groupId && item.groupHead)\n\t\t\t\t\t\t|| item.group === groupId\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.isShown = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tshowSection: (state, { sectionCode }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\t\t\t\tsection.isShown = true;\n\t\t\t\tfor (const item of section.rights.values())\n\t\t\t\t{\n\t\t\t\t\titem.isShown = true;\n\t\t\t\t}\n\t\t\t},\n\t\t\tshowAll: (state): void => {\n\t\t\t\tfor (const section of state.collection.values())\n\t\t\t\t{\n\t\t\t\t\tsection.isShown = true;\n\t\t\t\t\tfor (const item of section.rights.values())\n\t\t\t\t\t{\n\t\t\t\t\t\titem.isShown = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\thideAll: (state): void => {\n\t\t\t\tfor (const section of state.collection.values())\n\t\t\t\t{\n\t\t\t\t\tsection.isShown = false;\n\t\t\t\t\tfor (const item of section.rights.values())\n\t\t\t\t\t{\n\t\t\t\t\t\titem.isShown = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetSearchQuery: (state, { query }): void => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.searchQuery = String(query);\n\t\t\t},\n\t\t};\n\t}\n}\n","import { Runtime } from 'main.core';\nimport { type PopupOptions } from 'main.popup';\nimport { Dialog, type ItemOptions } from 'ui.entity-selector';\nimport { RichMenuItem, RichMenuItemIcon, RichMenuPopup } from 'ui.vue3.components.rich-menu';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { EntitySelectorContext } from '../../../integration/entity-selector/dictionary';\nimport { ItemsMapper } from '../../../integration/entity-selector/items-mapper';\nimport type { UserGroupsCollection } from '../../../store/model/user-groups-model';\nimport { CellLayout } from '../../layout/cell-layout';\nimport '../../../css/section/menu-cell.css';\n\nexport const MenuCell = {\n\tname: 'MenuCell',\n\tcomponents: {\n\t\tCellLayout,\n\t\tRichMenuPopup,\n\t\tRichMenuItem,\n\t},\n\tinject: ['section', 'userGroup'],\n\tdata(): Object {\n\t\treturn {\n\t\t\tisMenuShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tRichMenuItemIcon: () => RichMenuItemIcon,\n\t\t...mapGetters({\n\t\t\tisMaxValueSetForAny: 'accessRights/isMaxValueSetForAny',\n\t\t\tisMinValueSetForAny: 'accessRights/isMinValueSetForAny',\n\t\t}),\n\t\tmenuPopupOptions(): PopupOptions {\n\t\t\tconst width = 290;\n\n\t\t\treturn {\n\t\t\t\tbindElement: this.$refs.icon,\n\t\t\t\twidth,\n\t\t\t\t// by default popup is positioned so that the left top angle is below the bind element.\n\t\t\t\t// we need to position it in the center of the column\n\t\t\t\toffsetLeft: -Math.floor(width / 2) + 9,\n\t\t\t};\n\t\t},\n\t\tshownUserGroupsWithoutCurrent(): UserGroupsCollection {\n\t\t\tconst shown: UserGroupsCollection = this.$store.getters['userGroups/shown'];\n\n\t\t\tconst shownWithoutCurrent: UserGroupsCollection = Runtime.clone(shown);\n\t\t\tshownWithoutCurrent.delete(this.userGroup.id);\n\n\t\t\treturn shownWithoutCurrent;\n\t\t},\n\t\tapplyDialogItems(): ItemOptions[] {\n\t\t\treturn ItemsMapper.mapUserGroups(this.shownUserGroupsWithoutCurrent);\n\t\t},\n\t},\n\tmethods: {\n\t\ttoggleMenu(): void\n\t\t{\n\t\t\tthis.isMenuShown = !this.isMenuShown;\n\t\t},\n\t\tshowApplyDialog(): void\n\t\t{\n\t\t\tthis.isMenuShown = false;\n\n\t\t\tconst applyDialog = new Dialog({\n\t\t\t\tcontext: EntitySelectorContext.ROLE,\n\t\t\t\ttargetNode: this.$refs.icon,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tenableSearch: true,\n\t\t\t\tcacheable: false,\n\t\t\t\titems: this.applyDialogItems,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (dialogEvent: BaseEvent) => {\n\t\t\t\t\t\tconst { item } = dialogEvent.getData();\n\n\t\t\t\t\t\tthis.$store.dispatch('userGroups/copySectionValues', {\n\t\t\t\t\t\t\tsrcUserGroupId: this.userGroup.id,\n\t\t\t\t\t\t\tdstUserGroupId: item.getId(),\n\t\t\t\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tapplyDialog.show();\n\t\t},\n\t\tsetMaxValuesInSection(): void\n\t\t{\n\t\t\tthis.isMenuShown = false;\n\n\t\t\tthis.$store.dispatch('userGroups/setMaxAccessRightValuesInSection', {\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t});\n\t\t},\n\t\tsetMinValuesInSection(): void\n\t\t{\n\t\t\tthis.isMenuShown = false;\n\n\t\t\tthis.$store.dispatch('userGroups/setMinAccessRightValuesInSection', {\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<CellLayout class=\"ui-access-rights-v2-menu-cell\" style=\"cursor: pointer\" @click=\"toggleMenu\">\n\t\t\t<div\n\t\t\t\tref=\"icon\"\n\t\t\t\tclass=\"ui-icon-set --more-l ui-access-rights-v2-icon-more\"\n\t\t\t>\n\t\t\t\t<RichMenuPopup\n\t\t\t\t\tv-if=\"isMenuShown\"\n\t\t\t\t\t@close=\"isMenuShown = false\"\n\t\t\t\t\t:popup-options=\"menuPopupOptions\"\n\t\t\t\t>\n\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\tv-if=\"isMaxValueSetForAny\"\n\t\t\t\t\t\t:icon=\"RichMenuItemIcon.check\"\n\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MAX_ACCESS_RIGHTS')\"\n\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage(\n\t\t\t\t\t\t\t'JS_UI_ACCESSRIGHTS_V2_SET_MAX_ACCESS_RIGHTS_SUBTITLE_SECTION',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'#SECTION#': section.sectionTitle + (section.sectionSubTitle ? (' ' + section.sectionSubTitle) : ''),\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\"\n\t\t\t\t\t\t@click=\"setMaxValuesInSection\"\n\t\t\t\t\t/>\n\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\tv-if=\"isMinValueSetForAny\"\n\t\t\t\t\t\t:icon=\"RichMenuItemIcon['red-lock']\"\n\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MIN_ACCESS_RIGHTS')\"\n\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage(\n\t\t\t\t\t\t\t'JS_UI_ACCESSRIGHTS_V2_SET_MIN_ACCESS_RIGHTS_SUBTITLE_SECTION',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'#SECTION#': section.sectionTitle + (section.sectionSubTitle ? (' ' + section.sectionSubTitle) : ''),\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\"\n\t\t\t\t\t\t@click=\"setMinValuesInSection\"\n\t\t\t\t\t/>\n\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\t:icon=\"RichMenuItemIcon.copy\"\n\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_APPLY_TO_ROLE')\"\n\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_APPLY_TO_ROLE_SUBTITLE')\"\n\t\t\t\t\t\t@click=\"showApplyDialog\"\n\t\t\t\t\t/>\n\t\t\t\t</RichMenuPopup>\n\t\t\t</div>\n\t\t</CellLayout>\n\t`,\n};\n","export const Icon = {\n\tname: 'Icon',\n\tinject: ['section'],\n\tcomputed: {\n\t\ticonBgColor(): string {\n\t\t\tif (this.section.sectionIcon.bgColor.startsWith('--'))\n\t\t\t{\n\t\t\t\t// css variable\n\t\t\t\treturn `var(${this.section.sectionIcon.bgColor})`;\n\t\t\t}\n\n\t\t\t// we assume its hex\n\t\t\treturn this.section.sectionIcon.bgColor;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"section.sectionIcon\" class=\"ui-access-rights-v2-section-header-icon\" :style=\"{\n\t\t\tbackgroundColor: iconBgColor,\n\t\t}\">\n\t\t\t<div class=\"ui-icon-set\" :class=\"'--' + section.sectionIcon.type\"></div>\n\t\t</div>\n\t`,\n};\n","import { Icon as SectionIcon } from '../../icon';\nimport '../../../../css/value/popup-header/locator.css';\n\nexport const Locator = {\n\tname: 'Locator',\n\tcomponents: { SectionIcon },\n\tprops: {\n\t\tmaxWidth: {\n\t\t\ttype: Number,\n\t\t\t// same as value popup width\n\t\t\tdefault: 430,\n\t\t},\n\t},\n\tinject: ['section', 'right'],\n\tcomputed: {\n\t\trightOrGroupTitle(): string {\n\t\t\tif (!this.right.group)\n\t\t\t{\n\t\t\t\treturn this.right.title;\n\t\t\t}\n\n\t\t\tconst groupHead = this.section.rights.get(this.right.group);\n\n\t\t\treturn groupHead?.title;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-access-rights-v2-cell-popup-header-locator\" :style=\"{\n\t\t\tmaxWidth: maxWidth + 'px',\n\t\t}\">\n\t\t\t<SectionIcon/>\n\t\t\t<span\n\t\t\t\tclass=\"ui-access-rights-v2-text-ellipsis\"\n\t\t\t\t:title=\"section.sectionTitle\"\n\t\t\t>{{ section.sectionTitle }}</span>\n\t\t\t<span\n\t\t\t\tv-if=\"section.sectionSubTitle\" \n\t\t\t\tclass=\"ui-access-rights-v2-text-ellipsis\"\n\t\t\t\t:title=\"section.sectionSubTitle\"\n\t\t\t\tstyle=\"margin-left: 5px; color: var(--ui-color-palette-gray-70);\"\n\t\t\t>{{ section.sectionSubTitle }}</span>\n\t\t\t<div class=\"ui-icon-set --chevron-right ui-access-rights-v2-cell-popup-header-chevron\"></div>\n\t\t\t<template v-if=\"rightOrGroupTitle !== right.title\">\n\t\t\t\t<span class=\"ui-access-rights-v2-text-ellipsis\" :title=\"right.title\">{{ right.title }}</span>\n\t\t\t\t<div class=\"ui-icon-set --chevron-right ui-access-rights-v2-cell-popup-header-chevron\"></div>\n\t\t\t</template>\n\t\t\t<span class=\"ui-access-rights-v2-text-ellipsis\" :title=\"rightOrGroupTitle\">{{ rightOrGroupTitle }}</span>\n\t\t</div>\n\t`,\n};\n","import { Switcher } from 'ui.vue3.components.switcher';\nimport '../../../../css/value/popup-header/master-switcher.css';\n\nexport const MasterSwitcher = {\n\tname: 'MasterSwitcher',\n\tcomponents: { Switcher },\n\temits: ['check', 'uncheck'],\n\tprops: {\n\t\tisChecked: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tinject: ['section', 'right'],\n\tcomputed: {\n\t\tswitcherOptions(): Object {\n\t\t\treturn {\n\t\t\t\tsize: 'small',\n\t\t\t\tcolor: 'green',\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-access-rights-v2-cell-popup-header-master-switcher\" :class=\"{\n\t\t\t'--checked': isChecked,\n\t\t}\">\n\t\t\t<slot/>\n\t\t\t<div class=\"ui-access-rights-v2-cell-popup-header-toggle-container\">\n\t\t\t\t<Switcher\n\t\t\t\t\t:is-checked=\"isChecked\"\n\t\t\t\t\t@check=\"$emit('check')\"\n\t\t\t\t\t@uncheck=\"$emit('uncheck')\"\n\t\t\t\t\t:options=\"switcherOptions\"\n\t\t\t\t\tdata-accessrights-min-max\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import '../../../../../css/value/popup-header/master-switcher/single-role-title.css';\n\nexport const SingleRoleTitle = {\n\tname: 'SingleRoleTitle',\n\tprops: {\n\t\tuserGroupTitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-access-rights-v2-cell-popup-header-role-container\">\n\t\t\t<div>\n\t\t\t\t<div class=\"ui-access-rights-v2-cell-popup-header-role-caption\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE') }}\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-access-rights-v2-cell-popup-header-role-title ui-access-rights-v2-text-ellipsis\"\n\t\t\t\t\t:title=\"userGroupTitle\"\n\t\t\t\t>\n\t\t\t\t\t{{ userGroupTitle }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\nimport { Locator } from '../popup-header/locator';\nimport { MasterSwitcher } from '../popup-header/master-switcher';\nimport { SingleRoleTitle } from '../popup-header/master-switcher/single-role-title';\n\nexport const PopupHeader = {\n\tname: 'DependentVariablesPopupHeader',\n\tcomponents: { Locator, MasterSwitcher, SingleRoleTitle },\n\temits: ['setMax', 'setMin'],\n\tprops: {\n\t\tvalues: {\n\t\t\t/** @type Set<string> */\n\t\t\ttype: Set,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tinject: ['right'],\n\tcomputed: {\n\t\tisChecked(): boolean {\n\t\t\tif (!this.isMinMaxValuesSet)\n\t\t\t{\n\t\t\t\treturn this.values.size > 0;\n\t\t\t}\n\n\t\t\treturn this.isSelectedAnythingBesidesMin;\n\t\t},\n\t\tisMinMaxValuesSet(): boolean {\n\t\t\treturn !Type.isNil(this.right.minValue) && !Type.isNil(this.right.maxValue);\n\t\t},\n\t\tisSelectedAnythingBesidesMin(): boolean {\n\t\t\tif (this.values.size <= 0)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tfor (const variableId of this.values)\n\t\t\t{\n\t\t\t\tif (!this.right.minValue.has(variableId))\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t},\n\tmethods: {\n\t\tsetMin(): void\n\t\t{\n\t\t\tif (this.isMinMaxValuesSet)\n\t\t\t{\n\t\t\t\tthis.$emit('setMin');\n\t\t\t}\n\t\t},\n\t\tsetMax(): void\n\t\t{\n\t\t\tif (this.isMinMaxValuesSet)\n\t\t\t{\n\t\t\t\tthis.$emit('setMax');\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<Locator/>\n\t\t\t<MasterSwitcher\n\t\t\t\t:is-checked=\"isChecked\"\n\t\t\t\t@check=\"setMax\"\n\t\t\t\t@uncheck=\"setMin\"\n\t\t\t>\n\t\t\t\t<slot/>\n\t\t\t</MasterSwitcher>\n\t\t</div>\n\t`,\n};\n","import { Runtime, Type } from 'main.core';\nimport '../../../../css/value/dependent-variables/popup-content.css';\nimport 'ui.icon';\nimport 'ui.icon-set.actions';\nimport { Switcher } from 'ui.vue3.components.switcher';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport { hint } from 'ui.vue3.directives.hint';\nimport type { Variable, VariableCollection } from '../../../../store/model/access-rights-model';\nimport { PopupHeader } from './popup-header';\n\nexport const PopupContent = {\n\tname: 'DependentVariablesPopupContent',\n\temits: ['apply'],\n\tcomponents: { Switcher, PopupHeader, Icon },\n\tdirectives: { hint },\n\tprops: {\n\t\t// value for selector is id of a selected variable\n\t\tinitialValues: {\n\t\t\ttype: Set,\n\t\t\tdefault: new Set(),\n\t\t},\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\t// values modified during popup lifetime and not yet dispatched to store\n\t\t\tnotSavedValues: this.getNotSavedValues(),\n\t\t};\n\t},\n\tinject: ['section', 'right', 'redefineApply'],\n\tcomputed: {\n\t\tisMinMaxValuesSet(): boolean {\n\t\t\treturn !Type.isNil(this.right.minValue) && !Type.isNil(this.right.maxValue);\n\t\t},\n\t\tvariablesShownInList(): VariableCollection {\n\t\t\tif (!this.isMinMaxValuesSet)\n\t\t\t{\n\t\t\t\treturn this.right.variables;\n\t\t\t}\n\n\t\t\tconst variablesWithoutMinAndSecondary: VariableCollection = Runtime.clone(this.right.variables);\n\t\t\tfor (const variableId of this.right.minValue)\n\t\t\t{\n\t\t\t\tvariablesWithoutMinAndSecondary.delete(variableId);\n\t\t\t}\n\n\t\t\tfor (const [variableId: string, variable: Variable] of variablesWithoutMinAndSecondary)\n\t\t\t{\n\t\t\t\tif (variable.secondary)\n\t\t\t\t{\n\t\t\t\t\tvariablesWithoutMinAndSecondary.delete(variableId);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn variablesWithoutMinAndSecondary;\n\t\t},\n\t\tsecondaryVariables(): VariableCollection {\n\t\t\tconst result: VariableCollection = new Map();\n\n\t\t\tfor (const [variableId, variable] of this.right.variables)\n\t\t\t{\n\t\t\t\tif (variable.secondary)\n\t\t\t\t{\n\t\t\t\t\tresult.set(variableId, variable);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tnothingSelectedValues(): ?Set<string> {\n\t\t\treturn this.$store.getters['accessRights/getNothingSelectedValue'](this.section.sectionCode, this.right.id);\n\t\t},\n\t\tswitcherOptions(): Object {\n\t\t\treturn {\n\t\t\t\tsize: 'small',\n\t\t\t\tcolor: 'primary',\n\t\t\t};\n\t\t},\n\t\tsecondarySwitcherOptions(): Object {\n\t\t\treturn {\n\t\t\t\tsize: 'extra-small',\n\t\t\t\tcolor: 'green',\n\t\t\t};\n\t\t},\n\t\ticonSet(): IconSet {\n\t\t\treturn IconSet;\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.redefineApply(() => {\n\t\t\tthis.apply();\n\t\t});\n\t},\n\tmethods: {\n\t\taddValue(variableId: string): void {\n\t\t\tconst variable: ?Variable = this.right.variables.get(variableId);\n\t\t\tif (!variable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.notSavedValues.add(variableId);\n\n\t\t\tif (!Type.isNil(variable.requires))\n\t\t\t{\n\t\t\t\tfor (const requiredId of variable.requires)\n\t\t\t\t{\n\t\t\t\t\tthis.notSavedValues.add(requiredId);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!Type.isNil(variable.conflictsWith))\n\t\t\t{\n\t\t\t\t// remove old variables that conflict with variable we want to add\n\t\t\t\tfor (const conflictId of variable.conflictsWith)\n\t\t\t\t{\n\t\t\t\t\tthis.notSavedValues.delete(conflictId);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const otherVariable of this.right.variables.values())\n\t\t\t{\n\t\t\t\tif (otherVariable.id === variableId)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// if one of the current variables conflicts with newly added variables, we remove old variable\n\t\t\t\tif (this.notSavedValues.has(otherVariable.id) && !Type.isNil(otherVariable.conflictsWith))\n\t\t\t\t{\n\t\t\t\t\tfor (const conflictId of otherVariable.conflictsWith)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.notSavedValues.has(conflictId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.notSavedValues.delete(otherVariable.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tremoveValue(variableId: string): void {\n\t\t\tthis.notSavedValues.delete(variableId);\n\n\t\t\tfor (const otherVariableId of this.notSavedValues)\n\t\t\t{\n\t\t\t\tif (otherVariableId === variableId)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst otherVariable: ?Variable = this.right.variables.get(otherVariableId);\n\t\t\t\tif (!otherVariable)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isNil(otherVariable.requires) && otherVariable.requires.has(variableId))\n\t\t\t\t{\n\t\t\t\t\tthis.notSavedValues.delete(otherVariableId);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tsetMaxValue(): void {\n\t\t\tfor (const variableId of this.right.maxValue)\n\t\t\t{\n\t\t\t\tthis.addValue(variableId);\n\t\t\t}\n\t\t},\n\t\tsetMinValue(): void {\n\t\t\tfor (const variableId of this.right.minValue)\n\t\t\t{\n\t\t\t\tthis.addValue(variableId);\n\t\t\t}\n\t\t},\n\t\tapply(): void {\n\t\t\tlet values = this.notSavedValues;\n\t\t\tif (values.size <= 0)\n\t\t\t{\n\t\t\t\tvalues = this.nothingSelectedValues;\n\t\t\t}\n\n\t\t\tthis.$emit('apply', {\n\t\t\t\tvalues,\n\t\t\t});\n\t\t},\n\t\tgetNotSavedValues(): Set {\n\t\t\tconst result = new Set();\n\t\t\tthis.initialValues.forEach((value) => {\n\t\t\t\tif (this.right.variables.has(value))\n\t\t\t\t{\n\t\t\t\t\tresult.add(value);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn result;\n\t\t},\n\t\tgetVariableHintOptions(variable: Variable): Object {\n\t\t\treturn {\n\t\t\t\ttext: variable.hint,\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'bottom',\n\t\t\t\t\t},\n\t\t\t\t\twidth: 262,\n\t\t\t\t\tangle: {\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t\toffset: 33,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\t// data attributes are needed for e2e automated tests\n\ttemplate: `\n\t\t<div>\n\t\t\t<PopupHeader\n\t\t\t\t:values=\"notSavedValues\"\n\t\t\t\t@set-max=\"setMaxValue\"\n\t\t\t\t@set-min=\"setMinValue\"\n\t\t\t>\n\t\t\t\t<slot name=\"role-title\"/>\n\t\t\t</PopupHeader>\n\t\t\t<div class=\"ui-access-rights-v2-dv-popup--line-container\">\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"[variableId, variable] in variablesShownInList\"\n\t\t\t\t\t:key=\"variableId\"\n\t\t\t\t\tclass=\"ui-access-rights-v2-dv-popup--line\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"ui-access-rights-v2-dv-popup--line-title\">\n\t\t\t\t\t\t<span class=\"ui-access-rights-v2-text-ellipsis\" :title=\"variable.title\">{{ variable.title }}</span>\n\t\t\t\t\t\t<Icon v-if=\"variable.hint\" :name=\"iconSet.INFO_1\" :color=\"'var(--ui-color-palette-gray-40)'\" :size=\"20\" v-hint=\"getVariableHintOptions(variable)\"></Icon>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Switcher\n\t\t\t\t\t\t:is-checked=\"notSavedValues.has(variable.id)\"\n\t\t\t\t\t\t@check=\"addValue(variable.id)\"\n\t\t\t\t\t\t@uncheck=\"removeValue(variable.id)\"\n\t\t\t\t\t\t:options=\"switcherOptions\"\n\t\t\t\t\t\t:data-accessrights-variable-id=\"variable.id\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"[variableId, variable] in secondaryVariables\"\n\t\t\t\t\t:key=\"variableId\"\n\t\t\t\t\tclass=\"ui-access-rights-v2-dv-popup--line --secondary\"\n\t\t\t\t>\n\t\t\t\t\t<Switcher\n\t\t\t\t\t\t:is-checked=\"notSavedValues.has(variable.id)\"\n\t\t\t\t\t\t@check=\"addValue(variable.id)\"\n\t\t\t\t\t\t@uncheck=\"removeValue(variable.id)\"\n\t\t\t\t\t\t:options=\"secondarySwitcherOptions\"\n\t\t\t\t\t\tstyle=\"padding-right: 5px;\"\n\t\t\t\t\t\t:data-accessrights-variable-id=\"variable.id\"\n\t\t\t\t\t/>\n\t\t\t\t\t<span class=\"ui-access-rights-v2-text-ellipsis\">{{ variable.title }}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"right.dependentVariablesPopupHint\"\n\t\t\t\tclass=\"ui-access-rights-v2-dv-popup--hint\"\n\t\t\t>\n\t\t\t\t<Icon :name=\"iconSet.INFO_1\" :color=\"'var(--ui-color-palette-gray-40)'\" :size=\"20\"></Icon>\n\t\t\t\t<span>{{ right.dependentVariablesPopupHint }}</span>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import '../../../../../css/value/popup-header/master-switcher/all-roles-title.css';\n\nexport const AllRolesTitle = {\n\tname: 'AllRolesTitle',\n\ttemplate: `\n\t\t<div class=\"ui-access-rights-v2-cell-popup-header-all-role-container\">\n\t\t\t<div class=\"ui-icon-set --persons-3\" style=\"margin-right: 4px;\"></div>\n\t\t\t<div class=\"ui-access-rights-v2-cell-popup-header-all-roles-caption\">{{ \n\t\t\t\t$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ALL_ROLES')\n\t\t\t}}</div>\n\t\t</div>\n\t`,\n};\n","import { ApplyButton, ButtonColor, CancelButton } from 'ui.buttons';\nimport { Popup } from 'ui.vue3.components.popup';\nimport '../../../css/value/value-popup.css';\n\nexport const ValuePopup = {\n\tname: 'ValuePopup',\n\tcomponents: { Popup },\n\temits: ['close', 'apply'],\n\tprovide(): Object {\n\t\treturn {\n\t\t\tredefineApply: (func: Function) => {\n\t\t\t\tthis.onApply = func;\n\t\t\t},\n\t\t};\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tonApply: () => {\n\t\t\t\tthis.$emit('apply');\n\t\t\t},\n\t\t};\n\t},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions {\n\t\t\treturn {\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseEsc: true,\n\t\t\t\tcacheable: false,\n\t\t\t\tminWidth: 466,\n\t\t\t\tpadding: 18,\n\t\t\t};\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tvoid this.$nextTick(() => {\n\t\t\tconst applyButton = new ApplyButton({\n\t\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.apply();\n\t\t\t\t\tthis.$emit('close');\n\t\t\t\t},\n\t\t\t});\n\t\t\tapplyButton.renderTo(this.$refs['button-container']);\n\n\t\t\tconst cancelButton = new CancelButton({\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.$emit('close');\n\t\t\t\t},\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_CANCEL'),\n\t\t\t});\n\t\t\tcancelButton.renderTo(this.$refs['button-container']);\n\t\t});\n\t},\n\tmethods: {\n\t\tapply(): void\n\t\t{\n\t\t\tthis.onApply();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Popup @close=\"$emit('close')\" :options=\"popupOptions\">\n\t\t\t<slot/>\n\t\t\t<div ref=\"button-container\" class=\"ui-access-rights-v2-value-popup-buttons\"></div>\n\t\t</Popup>\n\t`,\n};\n","import { PopupContent } from '../../value/dependent-variables/popup-content';\nimport { AllRolesTitle } from '../../value/popup-header/master-switcher/all-roles-title';\nimport { ValuePopup } from '../../value/value-popup';\n\nexport const DependentVariables = {\n\tname: 'DependentVariables',\n\tcomponents: { PopupContent, AllRolesTitle, ValuePopup },\n\temits: ['close'],\n\tinject: ['section', 'right'],\n\tmethods: {\n\t\tapply({ values }): void\n\t\t{\n\t\t\tthis.$store.dispatch('userGroups/setAccessRightValuesForShown', {\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\tvalueId: this.right.id,\n\t\t\t\tvalues,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ValuePopup @close=\"$emit('close')\">\n\t\t\t<PopupContent @apply=\"apply\">\n\t\t\t\t<template #role-title>\n\t\t\t\t\t<AllRolesTitle/>\n\t\t\t\t</template>\n\t\t\t</PopupContent>\n\t\t</ValuePopup>\n\t`,\n};\n","import { Dom, Event, Loc, Tag } from 'main.core';\nimport { DefaultFooter, Dialog, Item } from 'ui.entity-selector';\n\nexport class Footer extends DefaultFooter\n{\n\tconstructor(dialog: Dialog, options: { [option: string]: any })\n\t{\n\t\tsuper(dialog, options);\n\n\t\tthis.selectAllButton = Tag.render`<div class=\"ui-selector-footer-link\">${\n\t\t\tLoc.getMessage('JS_UI_ACCESSRIGHTS_V2_ALL_SELECT_LABEL')\n\t\t}</div>`;\n\t\tDom.hide(this.selectAllButton);\n\t\tEvent.bind(this.selectAllButton, 'click', this.#selectAll.bind(this));\n\n\t\tthis.deselectAllButton = Tag.render`<div class=\"ui-selector-footer-link\">${\n\t\t\tLoc.getMessage('JS_UI_ACCESSRIGHTS_V2_ALL_DESELECT_LABEL')\n\t\t}</div>`;\n\t\tDom.hide(this.deselectAllButton);\n\t\tEvent.bind(this.deselectAllButton, 'click', this.#deselectAll.bind(this));\n\n\t\tthis.getDialog().subscribe('Item:onSelect', this.#onItemStatusChange.bind(this));\n\t\tthis.getDialog().subscribe('Item:onDeselect', this.#onItemStatusChange.bind(this));\n\t}\n\n\tgetContent(): HTMLElement | HTMLElement[] | string | null\n\t{\n\t\tthis.#toggleSelectButtons();\n\n\t\treturn [this.selectAllButton, this.deselectAllButton];\n\t}\n\n\t#toggleSelectButtons(): void\n\t{\n\t\tif (this.getDialog().getSelectedItems().length === this.getDialog().getItems().length)\n\t\t{\n\t\t\tDom.hide(this.selectAllButton);\n\t\t\tDom.show(this.deselectAllButton);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.show(this.selectAllButton);\n\t\t\tDom.hide(this.deselectAllButton);\n\t\t}\n\t}\n\n\t#selectAll(): void\n\t{\n\t\tthis\n\t\t\t.getDialog()\n\t\t\t.getItems()\n\t\t\t.forEach((item: Item) => {\n\t\t\t\titem.select();\n\t\t\t})\n\t\t;\n\t}\n\n\t#deselectAll(): void\n\t{\n\t\tthis\n\t\t\t.getDialog()\n\t\t\t.getSelectedItems()\n\t\t\t.forEach((item: Item) => {\n\t\t\t\titem.deselect();\n\t\t\t})\n\t\t;\n\t}\n\n\t#onItemStatusChange(): void\n\t{\n\t\tthis.#toggleSelectButtons();\n\t}\n}\n","import { Tag } from 'main.core';\nimport { BaseHeader } from 'ui.entity-selector';\nimport { BitrixVue } from 'ui.vue3';\nimport { Locator } from '../../components/section/value/popup-header/locator';\n\nexport class Header extends BaseHeader\n{\n\trender(): HTMLElement\n\t{\n\t\treturn this.#renderVueApp();\n\t}\n\n\t#renderVueApp(): HTMLElement\n\t{\n\t\tconst container = Tag.render`<div style=\"padding: 20px 20px 0;\"></div>`;\n\n\t\tconst app = BitrixVue.createApp(Locator, {\n\t\t\tmaxWidth: this.getDialog().getWidth(),\n\t\t});\n\t\tapp.provide('section', this.getOption('section'));\n\t\tapp.provide('right', this.getOption('right'));\n\n\t\tapp.mount(container);\n\n\t\treturn container;\n\t}\n}\n","import { Runtime } from 'main.core';\nimport type { BaseEvent } from 'main.core.events';\nimport { Dialog, type Item, type ItemOptions } from 'ui.entity-selector';\nimport { EntitySelectorContext, EntitySelectorEntities } from '../../../../integration/entity-selector/dictionary';\nimport { Footer } from '../../../../integration/entity-selector/footer';\nimport { Header } from '../../../../integration/entity-selector/header';\nimport { ItemsMapper } from '../../../../integration/entity-selector/items-mapper';\nimport type { Variable, VariableCollection } from '../../../../store/model/access-rights-model';\nimport { getSelectedVariables } from '../../../../utils';\n\nexport const Selector = {\n\tname: 'Selector',\n\temits: ['apply', 'close'],\n\tprops: {\n\t\t// value for selector is id of a selected variable\n\t\tinitialValues: {\n\t\t\ttype: Set,\n\t\t\tdefault: new Set(),\n\t\t},\n\t},\n\tinject: ['section', 'right'],\n\tdata(): Object {\n\t\treturn {\n\t\t\t// values modified during popup lifetime and not yet dispatched to store\n\t\t\tvalues: this.initialValues,\n\t\t};\n\t},\n\tdialog: null,\n\tcomputed: {\n\t\tisAllSelected(): boolean {\n\t\t\treturn this.values.has(this.right.allSelectedCode);\n\t\t},\n\t\tselectedVariables(): VariableCollection {\n\t\t\treturn getSelectedVariables(this.right.variables, this.values, this.isAllSelected);\n\t\t},\n\t\tdialogItems(): ItemOptions[] {\n\t\t\treturn ItemsMapper.mapVariables(this.right.variables);\n\t\t},\n\t\tselectedDialogItems(): ItemOptions[] {\n\t\t\treturn this.dialogItems.filter((item) => this.selectedVariables.has(item.id));\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.showSelector();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.dialog?.hide();\n\t},\n\tmethods: {\n\t\tshowSelector(): void {\n\t\t\tthis.dialog = new Dialog({\n\t\t\t\theight: 400,\n\t\t\t\tcontext: EntitySelectorContext.VARIABLE,\n\t\t\t\tenableSearch: this.right.enableSearch,\n\t\t\t\tmultiple: true,\n\t\t\t\tautoHide: true,\n\t\t\t\thideByEsc: true,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tcompactView: this.right.compactView,\n\t\t\t\tshowAvatars: this.right.showAvatars,\n\t\t\t\tselectedItems: this.selectedDialogItems,\n\t\t\t\tsearchOptions: {\n\t\t\t\t\tallowCreateItem: false,\n\t\t\t\t},\n\t\t\t\tcacheable: false,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.onItemSelect,\n\t\t\t\t\t'Item:onDeselect': this.onItemDeselect,\n\t\t\t\t\tonHide: this.apply,\n\t\t\t\t\tonDestroy: () => {\n\t\t\t\t\t\tthis.dialog = null;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: EntitySelectorEntities.VARIABLE,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\titems: this.dialogItems,\n\t\t\t\theader: Header,\n\t\t\t\theaderOptions: {\n\t\t\t\t\tsection: this.section,\n\t\t\t\t\tright: this.right,\n\t\t\t\t},\n\t\t\t\tfooter: Footer,\n\t\t\t});\n\n\t\t\tthis.dialog.show();\n\t\t},\n\t\tonItemSelect(event: BaseEvent): void {\n\t\t\tconst addedItem: Item = event.getData().item;\n\n\t\t\tthis.addValue(String(addedItem.getId()));\n\t\t},\n\t\tonItemDeselect(event: BaseEvent): void {\n\t\t\tconst removedItem: Item = event.getData().item;\n\n\t\t\tthis.removeValue(String(removedItem.getId()));\n\t\t},\n\t\taddValue(value: string): void {\n\t\t\tconst newValues = Runtime.clone(this.values);\n\n\t\t\tnewValues.add(value);\n\n\t\t\tif (newValues.size >= this.right.variables.size)\n\t\t\t{\n\t\t\t\tthis.setValues(new Set([this.right.allSelectedCode]));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.setValues(newValues);\n\t\t\t}\n\t\t},\n\t\tremoveValue(value: string): void {\n\t\t\tif (this.values.has(this.right.allSelectedCode))\n\t\t\t{\n\t\t\t\tconst allVariablesIds = [...this.right.variables.values()].map((variable: Variable) => variable.id);\n\n\t\t\t\tconst allVariablesIdsWithoutRemoved = new Set(allVariablesIds);\n\t\t\t\tallVariablesIdsWithoutRemoved.delete(value);\n\n\t\t\t\tthis.setValues(allVariablesIdsWithoutRemoved);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst newValues = [...this.values].filter((candidate) => candidate !== value);\n\n\t\t\t\tthis.setValues(new Set(newValues));\n\t\t\t}\n\t\t},\n\t\tsetValues(newValues: Set<string>): void {\n\t\t\tthis.values = newValues;\n\t\t},\n\t\tapply(): void {\n\t\t\tthis.setNothingSelectedValueIfNeeded();\n\n\t\t\tthis.$emit('apply', {\n\t\t\t\tvalues: this.values,\n\t\t\t});\n\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tsetNothingSelectedValueIfNeeded(): void {\n\t\t\tif (this.values.size <= 0)\n\t\t\t{\n\t\t\t\tconst nothingSelected = this.$store.getters['accessRights/getNothingSelectedValue'](\n\t\t\t\t\tthis.section.sectionCode,\n\t\t\t\t\tthis.right.id,\n\t\t\t\t);\n\n\t\t\t\tfor (const nothing of nothingSelected)\n\t\t\t\t{\n\t\t\t\t\tthis.addValue(nothing);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div></div>\n\t`,\n};\n","import { Selector } from '../../value/multivariables/selector';\n\nexport const Multivariables = {\n\tname: 'Multivariables',\n\temits: ['close'],\n\tcomponents: {\n\t\tSelector,\n\t},\n\tinject: ['section', 'right'],\n\tmethods: {\n\t\tapply({ values }): void\n\t\t{\n\t\t\tthis.$store.dispatch('userGroups/setAccessRightValuesForShown', {\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\tvalueId: this.right.id,\n\t\t\t\tvalues,\n\t\t\t});\n\t\t},\n\t\tclose(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Selector @apply=\"apply\" @close=\"close\"/>\n\t`,\n};\n","import { MenuManager } from 'main.popup';\n\nconst POPUP_ID = 'ui-access-rights-v2-row-value-variables';\n\nexport const Variables = {\n\tname: 'Variables',\n\temits: ['close'],\n\tinject: ['section', 'right'],\n\tmounted()\n\t{\n\t\tthis.showSelector();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.closeSelector();\n\t},\n\tmethods: {\n\t\tshowSelector(): void {\n\t\t\tconst menuItems = [];\n\t\t\tfor (const variable of this.right.variables.values())\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\tid: variable.id,\n\t\t\t\t\ttext: variable.title,\n\t\t\t\t\tonclick: (innerEvent, item) => {\n\t\t\t\t\t\titem\n\t\t\t\t\t\t\t.getMenuWindow()\n\t\t\t\t\t\t\t?.close()\n\t\t\t\t\t\t;\n\n\t\t\t\t\t\tthis.setValue(variable.id);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tMenuManager.show({\n\t\t\t\tid: POPUP_ID,\n\t\t\t\tbindElement: this.$el,\n\t\t\t\titems: menuItems,\n\t\t\t\tautoHide: true,\n\t\t\t\tcacheable: false,\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tthis.$emit('close');\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tsetValue(value): void {\n\t\t\tthis.$store.dispatch('userGroups/setAccessRightValuesForShown', {\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\tvalueId: this.right.id,\n\t\t\t\tvalues: new Set([value]),\n\t\t\t});\n\t\t},\n\t\tcloseSelector(): void {\n\t\t\tMenuManager.getMenuById(POPUP_ID)?.close();\n\t\t},\n\t},\n\t// invisible div for binding selector to it\n\ttemplate: `\n\t\t<div></div>\n\t`,\n};\n","import { hint } from 'ui.vue3.directives.hint';\n\n/**\n * A special case of Hint. We don't need interactivity here, but we do need to wrap slot with a hint.\n * Combine these properties in a single vue hint wrapper is impossible.\n */\nexport const SelectedHint = {\n\tname: 'SelectedHint',\n\tprops: {\n\t\thtml: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tisRendered: true,\n\t\t};\n\t},\n\twatch: {\n\t\thtml(): void {\n\t\t\t// force hint directive to re-render\n\t\t\tthis.isRendered = false;\n\t\t\tvoid this.$nextTick(() => {\n\t\t\t\tthis.isRendered = true;\n\t\t\t});\n\t\t},\n\t},\n\tdirectives: {\n\t\thint,\n\t},\n\t// offsetTop is needed to fix infinite mouseenter/mouseleave loop in chromium. issue 204272\n\ttemplate: `\n\t\t<div v-if=\"isRendered\" v-hint=\"{\n\t\t\thtml,\n\t\t\tpopupOptions: {\n\t\t\t\toffsetTop: 3,\n\t\t\t},\n\t\t}\" data-hint-init=\"vue\">\n\t\t\t<slot/>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\nimport type { VariableCollection } from '../../../../store/model/access-rights-model';\nimport {\n\tgetMultipleSelectedVariablesHintHtml,\n\tgetMultipleSelectedVariablesTitle,\n\tgetSelectedVariables,\n} from '../../../../utils';\nimport { PopupContent } from '../../value/dependent-variables/popup-content';\nimport { SingleRoleTitle } from '../../value/popup-header/master-switcher/single-role-title';\nimport { ValuePopup } from '../../value/value-popup';\nimport { SelectedHint } from './../../../util/selected-hint';\n\nexport const DependentVariables = {\n\tname: 'DependentVariables',\n\tcomponents: { ValuePopup, PopupContent, SelectedHint, SingleRoleTitle },\n\tprops: {\n\t\t// value for selector is id of a selected variable\n\t\tvalue: {\n\t\t\t/** @type AccessRightValue */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tisPopupShown: false,\n\t\t};\n\t},\n\tinject: ['section', 'userGroup', 'right'],\n\tcomputed: {\n\t\tselectedVariables(): VariableCollection {\n\t\t\treturn getSelectedVariables(this.right.variables, this.value.values, false);\n\t\t},\n\t\tcurrentAlias(): ?string {\n\t\t\treturn this.$store.getters['accessRights/getSelectedVariablesAlias'](this.section.sectionCode, this.value.id, this.value.values);\n\t\t},\n\t\ttitle(): string {\n\t\t\tif (Type.isString(this.currentAlias))\n\t\t\t{\n\t\t\t\treturn this.currentAlias;\n\t\t\t}\n\n\t\t\tif (this.selectedVariables.size <= 0)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ADD');\n\t\t\t}\n\n\t\t\treturn getMultipleSelectedVariablesTitle(this.selectedVariables);\n\t\t},\n\t\thintHtml(): string {\n\t\t\treturn getMultipleSelectedVariablesHintHtml(this.selectedVariables, this.hintTitle, this.right.variables);\n\t\t},\n\t\thintTitle(): string {\n\t\t\tif (Type.isString(this.right.hintTitle))\n\t\t\t{\n\t\t\t\treturn this.right.hintTitle;\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SELECTED_ITEMS_TITLE');\n\t\t},\n\t},\n\tmethods: {\n\t\tapply({ values }): void\n\t\t{\n\t\t\tthis.$store.dispatch('userGroups/setAccessRightValues', {\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\tvalueId: this.value.id,\n\t\t\t\tvalues,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class='ui-access-rights-v2-column-item-text-link' :class=\"{\n\t\t\t'ui-access-rights-v2-text-ellipsis': !hintHtml\n\t\t}\" @click=\"isPopupShown = true\">\n\t\t\t<SelectedHint v-if=\"hintHtml\" :html=\"hintHtml\">{{title}}</SelectedHint>\n\t\t\t<div v-else :title=\"title\">{{title}}</div>\n\t\t\t<ValuePopup v-if=\"isPopupShown\" @close=\"isPopupShown = false\">\n\t\t\t\t<PopupContent\n\t\t\t\t\t@apply=\"apply\"\n\t\t\t\t\t:initial-values=\"value.values\"\n\t\t\t\t>\n\t\t\t\t\t<template #role-title>\n\t\t\t\t\t\t<SingleRoleTitle :user-group-title=\"userGroup.title\"/>\n\t\t\t\t\t</template>\n\t\t\t\t</PopupContent>\n\t\t\t</ValuePopup>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\nimport type { VariableCollection } from '../../../../store/model/access-rights-model';\nimport {\n\tgetMultipleSelectedVariablesHintHtml,\n\tgetMultipleSelectedVariablesTitle,\n\tgetSelectedVariables,\n} from '../../../../utils';\nimport { Selector } from '../../value/multivariables/selector';\nimport { SelectedHint } from './../../../util/selected-hint';\n\nexport const Multivariables = {\n\tname: 'Multivariables',\n\tcomponents: {\n\t\tSelectedHint,\n\t\tSelector,\n\t},\n\tprops: {\n\t\t// value for selector is id of a selected variable\n\t\tvalue: {\n\t\t\t/** @type AccessRightValue */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tinject: ['section', 'userGroup', 'right'],\n\tdata(): Object {\n\t\treturn {\n\t\t\tisSelectorShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tisAllSelected(): boolean {\n\t\t\treturn this.value.values.has(this.right.allSelectedCode);\n\t\t},\n\t\tselectedVariables(): VariableCollection {\n\t\t\treturn getSelectedVariables(this.right.variables, this.value.values, this.isAllSelected);\n\t\t},\n\t\tcurrentAlias(): ?string {\n\t\t\treturn this.$store.getters['accessRights/getSelectedVariablesAlias'](this.section.sectionCode, this.value.id, this.value.values);\n\t\t},\n\t\ttitle(): string {\n\t\t\tif (Type.isString(this.currentAlias))\n\t\t\t{\n\t\t\t\treturn this.currentAlias;\n\t\t\t}\n\n\t\t\tif (this.isAllSelected)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ALL_ACCEPTED');\n\t\t\t}\n\n\t\t\tif (this.selectedVariables.size <= 0)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ADD');\n\t\t\t}\n\n\t\t\treturn getMultipleSelectedVariablesTitle(this.selectedVariables);\n\t\t},\n\t\thintHtml(): string {\n\t\t\treturn getMultipleSelectedVariablesHintHtml(this.selectedVariables, this.hintTitle, this.right.variables);\n\t\t},\n\t\thintTitle(): string {\n\t\t\tif (Type.isString(this.right.hintTitle))\n\t\t\t{\n\t\t\t\treturn this.right.hintTitle;\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SELECTED_ITEMS_TITLE');\n\t\t},\n\t},\n\tmethods: {\n\t\tshowSelector(): void {\n\t\t\tthis.isSelectorShown = true;\n\t\t},\n\t\tsetValues({ values }): void {\n\t\t\tthis.$store.dispatch('userGroups/setAccessRightValues', {\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\tvalueId: this.value.id,\n\t\t\t\tvalues,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SelectedHint \n\t\t\tv-if=\"hintHtml\"\n\t\t\t:html=\"hintHtml\" \n\t\t\tclass='ui-access-rights-v2-column-item-text-link'\n\t\t\t@click=\"showSelector\"\n\t\t\tv-bind=\"$attrs\"\n\t\t>\n\t\t\t{{ title }}\n\t\t</SelectedHint>\n\t\t<div \n\t\t\tv-else\n\t\t\tclass='ui-access-rights-v2-column-item-text-link ui-access-rights-v2-text-ellipsis'\n\t\t\t@click=\"showSelector\"\n\t\t\t:title=\"title\"\n\t\t\tv-bind=\"$attrs\"\n\t\t>\n\t\t\t{{ title }}\n\t\t</div>\n\t\t<Selector\n\t\t\tv-if=\"isSelectorShown\" \n\t\t\t:initial-values=\"value.values\"\n\t\t\t@close=\"isSelectorShown = false\"\n\t\t\t@apply=\"setValues\"\n\t\t/>\n\t`,\n};\n","import { Switcher } from 'ui.vue3.components.switcher';\n\nexport const Toggler = {\n\tname: 'Toggler',\n\tcomponents: { Switcher },\n\tprops: {\n\t\tvalue: {\n\t\t\t/** @type AccessRightValue */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tinject: ['section', 'userGroup'],\n\tcomputed: {\n\t\tisChecked(): boolean {\n\t\t\treturn this.value.values.has('1');\n\t\t},\n\t},\n\tmethods: {\n\t\tsetValue(value): void {\n\t\t\tthis.$store.dispatch('userGroups/setAccessRightValues', {\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\tvalueId: this.value.id,\n\t\t\t\tvalues: new Set([value]),\n\t\t\t});\n\t\t},\n\t},\n\t// eslint-disable-next-line quotes\n\ttemplate: `\n\t\t<Switcher\n\t\t\t:is-checked=\"isChecked\"\n\t\t\t@check=\"setValue('1')\"\n\t\t\t@uncheck=\"setValue('0')\"\n\t\t\t:options=\"{\n\t\t\t\tsize: 'extra-small',\n\t\t\t\tcolor: 'green',\n\t\t\t}\"\n\t\t/>\n\t`,\n};\n","import { Type } from 'main.core';\nimport { MenuManager } from 'main.popup';\n\nconst POPUP_ID = 'ui-access-rights-v2-column-item-popup-variables';\n\nexport const Variables = {\n\tname: 'Variables',\n\tprops: {\n\t\t// value for selector is id of a selected variable\n\t\tvalue: {\n\t\t\t/** @type AccessRightValue */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tinject: ['section', 'userGroup', 'right'],\n\tcomputed: {\n\t\temptyVariableId(): ?string {\n\t\t\tconst emptyValue: Set<string> = this.$store.getters['accessRights/getEmptyValue'](\n\t\t\t\tthis.section.sectionCode,\n\t\t\t\tthis.value.id,\n\t\t\t);\n\n\t\t\treturn emptyValue[0];\n\t\t},\n\t\tcurrentVariableId(): ?string {\n\t\t\tif (this.value.values.size <= 0)\n\t\t\t{\n\t\t\t\treturn this.emptyVariableId;\n\t\t\t}\n\n\t\t\tconst [firstItem] = this.value.values;\n\n\t\t\treturn firstItem;\n\t\t},\n\t\tcurrentAlias(): ?string {\n\t\t\treturn this.$store.getters['accessRights/getSelectedVariablesAlias'](this.section.sectionCode, this.value.id, this.value.values);\n\t\t},\n\t\tcurrentVariableTitle(): string {\n\t\t\tif (Type.isString(this.currentAlias))\n\t\t\t{\n\t\t\t\treturn this.currentAlias;\n\t\t\t}\n\n\t\t\tconst variable = this.right.variables.get(this.currentVariableId);\n\t\t\tif (!variable)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ADD');\n\t\t\t}\n\n\t\t\treturn variable.title;\n\t\t},\n\t},\n\tmethods: {\n\t\tshowSelector(event: PointerEvent): void {\n\t\t\tconst menuItems = [];\n\t\t\tfor (const variable of this.right.variables.values())\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\tid: variable.id,\n\t\t\t\t\ttext: variable.title,\n\t\t\t\t\tonclick: (innerEvent, item) => {\n\t\t\t\t\t\titem\n\t\t\t\t\t\t\t.getMenuWindow()\n\t\t\t\t\t\t\t?.close()\n\t\t\t\t\t\t;\n\n\t\t\t\t\t\tthis.setValue(variable.id);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tMenuManager.show({\n\t\t\t\tid: POPUP_ID,\n\t\t\t\tbindElement: event.target,\n\t\t\t\titems: menuItems,\n\t\t\t\tautoHide: true,\n\t\t\t\tcacheable: false,\n\t\t\t});\n\t\t},\n\t\tsetValue(value): void {\n\t\t\tthis.$store.dispatch('userGroups/setAccessRightValues', {\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\tvalueId: this.value.id,\n\t\t\t\tvalues: new Set([value]),\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass='ui-access-rights-v2-column-item-text-link ui-access-rights-v2-text-ellipsis'\n\t\t\t:title=\"currentVariableTitle\"\n\t\t\t@click=\"showSelector\"\n\t\t>\n\t\t\t{{ currentVariableTitle }}\n\t\t</div>\n\t`,\n};\n","import { ServiceLocator } from '../../../service/service-locator';\nimport type { AccessRightItem } from '../../../store/model/access-rights-model';\n\nimport { DependentVariables as DependentVariablesRow } from '../title-column/value/dependent-variables';\nimport { Multivariables as MultivariablesRow } from '../title-column/value/multivariables';\nimport { Variables as VariablesRow } from '../title-column/value/variables';\n\nimport { DependentVariables as DependentVariablesCell } from './../column/value/dependent-variables';\nimport { Multivariables as MultivariablesCell } from './../column/value/multivariables';\nimport { Toggler as TogglerCell } from './../column/value/toggler';\nimport { Variables as VariablesCell } from './../column/value/variables';\n\nexport const Cells = Object.freeze({\n\tDependentVariables: DependentVariablesCell,\n\tMultivariables: MultivariablesCell,\n\tToggler: TogglerCell,\n\tVariables: VariablesCell,\n});\n\nexport const Rows = Object.freeze({\n\tDependentVariables: DependentVariablesRow,\n\tMultivariables: MultivariablesRow,\n\t// no row value for toggler\n\tVariables: VariablesRow,\n});\n\nexport function getValueComponent(accessRightItem: AccessRightItem): string\n{\n\tconst type = ServiceLocator.getValueTypeByRight(accessRightItem);\n\tif (!type)\n\t{\n\t\t// vue will render empty cell\n\t\treturn '';\n\t}\n\n\treturn type.getComponentName();\n}\n","import type { AccessRightItem } from '../../../store/model/access-rights-model';\nimport type { AccessRightValue } from '../../../store/model/user-groups-model';\nimport { CellLayout } from '../../layout/cell-layout';\nimport { Cells, getValueComponent } from '../value/registry';\n\nexport const ValueCell = {\n\tname: 'ValueCell',\n\tcomponents: {\n\t\tCellLayout,\n\t\t...Cells,\n\t},\n\tprops: {\n\t\tright: {\n\t\t\t/** @type AccessRightItem */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tinject: ['section', 'userGroup'],\n\tprovide(): Object {\n\t\treturn {\n\t\t\tright: this.right,\n\t\t};\n\t},\n\tcomputed: {\n\t\tvalue(): AccessRightValue\n\t\t{\n\t\t\tconst value = this.userGroup.accessRights.get(this.right.id);\n\n\t\t\treturn value || this.$store.getters['userGroups/getEmptyAccessRightValue'](this.userGroup.id, this.section.sectionCode, this.right.id);\n\t\t},\n\t\tcellComponent(): string\n\t\t{\n\t\t\treturn getValueComponent(this.right);\n\t\t},\n\t},\n\t// data attributes are needed for e2e automated tests\n\ttemplate: `\n\t\t<CellLayout\n\t\t\t:class=\"{\n\t\t\t\t'ui-access-rights-v2-group-children': right.group,\n\t\t\t\t'--modified': value.isModified\n\t\t\t}\"\n\t\t\tv-memo=\"[userGroup.id, value.values, value.isModified]\"\n\t\t>\n\t\t\t<Component\n\t\t\t\t:is=\"cellComponent\"\n\t\t\t\t:value=\"value\"\n\t\t\t\t:data-accessrights-right-id=\"right.id\"\n\t\t\t/>\n\t\t</CellLayout>\n\t`,\n};\n","import { computed } from 'ui.vue3';\nimport { AccessRightItem } from '../../store/model/access-rights-model';\nimport type { UserGroup } from '../../store/model/user-groups-model';\nimport { shouldRowBeRendered } from '../../utils';\nimport { ColumnLayout } from '../layout/column-layout';\nimport { MenuCell } from './column/menu-cell';\nimport { ValueCell } from './column/value-cell';\n\nexport const Column = {\n\tname: 'Column',\n\tcomponents: {\n\t\tColumnLayout,\n\t\tValueCell,\n\t\tMenuCell,\n\t},\n\tprops: {\n\t\tuserGroup: {\n\t\t\t/** @type UserGroup */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\trights: {\n\t\t\ttype: Map,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tprovide(): Object {\n\t\treturn {\n\t\t\tuserGroup: computed(() => this.userGroup),\n\t\t};\n\t},\n\tcomputed: {\n\t\trenderedRights(): Map<string, AccessRightItem> {\n\t\t\tconst result = new Map();\n\t\t\tfor (const [rightId: string, right: AccessRightItem] of this.rights)\n\t\t\t{\n\t\t\t\tif (shouldRowBeRendered(right))\n\t\t\t\t{\n\t\t\t\t\tresult.set(rightId, right);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ColumnLayout ref=\"column\">\n\t\t\t<MenuCell/>\n\t\t\t<ValueCell\n\t\t\t\tv-for=\"[rightId, accessRightItem] in renderedRights\"\n\t\t\t\t:key=\"rightId\"\n\t\t\t\t:right=\"accessRightItem\"\n\t\t\t/>\n\t\t</ColumnLayout>\n\t`,\n};\n","import { Dom, Event, Runtime } from 'main.core';\nimport { Ears } from 'ui.ears';\nimport { SyncHorizontalScroll } from '../util/sync-horizontal-scroll';\nimport { Column } from './column';\nimport { ColumnLayout } from '../layout/column-layout';\n\nexport const ColumnList = {\n\tname: 'ColumnList',\n\tcomponents: { Column, SyncHorizontalScroll, ColumnLayout },\n\tprops: {\n\t\tuserGroups: {\n\t\t\ttype: Map,\n\t\t\trequired: true,\n\t\t},\n\t\trights: {\n\t\t\ttype: Map,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tthrottledScrollHandler: null,\n\tthrottledResizeHandler: null,\n\tears: null,\n\tisEarsInited: false,\n\tdata(): Object {\n\t\treturn {\n\t\t\tisLeftShadowShown: false,\n\t\t\tisRightShadowShown: false,\n\t\t};\n\t},\n\tcreated()\n\t{\n\t\tthis.throttledScrollHandler = Runtime.throttle(() => {\n\t\t\tthis.adjustShadowsVisibility();\n\t\t}, 200);\n\t\tthis.throttledResizeHandler = Runtime.throttle(() => {\n\t\t\tthis.adjustShadowsVisibility();\n\t\t\tthis.adjustEars();\n\t\t}, 200);\n\t},\n\tmounted()\n\t{\n\t\tEvent.bind(window, 'resize', this.throttledResizeHandler);\n\t\tthis.adjustShadowsVisibility();\n\n\t\tthis.initEars();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.destroyEars();\n\n\t\tEvent.unbind(window, 'resize', this.throttledResizeHandler);\n\t},\n\twatch: {\n\t\tuserGroups(newValue: Map, oldValue: Map): void {\n\t\t\tif (newValue.size !== oldValue.size)\n\t\t\t{\n\t\t\t\tthis.adjustShadowsVisibility();\n\t\t\t\tthis.adjustEars();\n\t\t\t}\n\t\t},\n\t},\n\tmethods: {\n\t\tcalculateShadowsVisibility(): { isLeftShadowShown: boolean, isRightShadowShown: boolean } {\n\t\t\tif (!this.$refs['column-container'])\n\t\t\t{\n\t\t\t\t// in case it's accidentally called before mount or after unmount\n\t\t\t\treturn { isLeftShadowShown: false, isRightShadowShown: false };\n\t\t\t}\n\n\t\t\tconst scrollLeft = this.$refs['column-container'].$el.scrollLeft;\n\n\t\t\tconst isLeftShadowShown = scrollLeft > 0;\n\n\t\t\tconst offsetWidth = this.$refs['column-container'].$el.offsetWidth;\n\n\t\t\treturn {\n\t\t\t\tisLeftShadowShown,\n\t\t\t\tisRightShadowShown: this.$refs['column-container'].$el.scrollWidth > (Math.round(scrollLeft + offsetWidth)),\n\t\t\t};\n\t\t},\n\t\tadjustShadowsVisibility(): void {\n\t\t\t// avoid \"forced synchronous layout\"\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tconst { isLeftShadowShown, isRightShadowShown } = this.calculateShadowsVisibility();\n\t\t\t\tthis.isLeftShadowShown = isLeftShadowShown;\n\t\t\t\tthis.isRightShadowShown = isRightShadowShown;\n\t\t\t});\n\t\t},\n\t\tadjustEars(): void {\n\t\t\tif (!this.isEarsInited)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// avoid \"forced synchronous layout\"\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\t// force ears to recalculate its visibility\n\t\t\t\tthis.ears.toggleEars();\n\t\t\t});\n\t\t},\n\t\tinitEars(): void {\n\t\t\tif (!this.$refs['column-container'])\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.ears)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.ears = new Ears({\n\t\t\t\tcontainer: this.$refs['column-container'].$el,\n\t\t\t\timmediateInit: true,\n\t\t\t\tsmallSize: true,\n\t\t\t});\n\n\t\t\t// chrome is not happy when we query DOM values (scrollLeft, offsetWidth, ...) just after we've changed them\n\t\t\t// avoid \"forced synchronous layout\"\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tif (!this.ears || !this.$refs['column-container'])\n\t\t\t\t{\n\t\t\t\t\tthis.ears = null;\n\n\t\t\t\t\t// sometimes the callback is fired after the component is unmounted\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst scrollLeft = this.$refs['column-container'].$el.scrollLeft;\n\t\t\t\tthis.ears.init();\n\n\t\t\t\t// Ears add wrapper around the container, and it breaks our markup a little. Fix it\n\t\t\t\tDom.style(this.ears.getWrapper(), 'flex', 1);\n\t\t\t\tif (scrollLeft > 0)\n\t\t\t\t{\n\t\t\t\t\t// ears.init resets scrollLeft to 0\n\t\t\t\t\tthis.$refs['column-container'].$el.scrollLeft = scrollLeft;\n\t\t\t\t}\n\n\t\t\t\tthis.isEarsInited = true;\n\t\t\t});\n\t\t},\n\t\tdestroyEars(): void {\n\t\t\tthis.ears?.destroy();\n\t\t\tthis.isEarsInited = false;\n\t\t\tthis.ears = null;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass='ui-access-rights-v2-section-content'\n\t\t\t:class=\"{\n\t\t\t\t'ui-access-rights-v2-section-shadow-left-shown': isLeftShadowShown,\n\t\t\t\t'ui-access-rights-v2-section-shadow-right-shown': isRightShadowShown,\n\t\t\t}\"\n\t\t>\n\t\t\t<SyncHorizontalScroll\n\t\t\t\tref=\"column-container\"\n\t\t\t\tclass='ui-access-rights-v2-section-wrapper'\n\t\t\t\t@scroll=\"throttledScrollHandler\"\n\t\t\t>\n\t\t\t\t<Column\n\t\t\t\t\tv-for=\"[groupId, group] in userGroups\"\n\t\t\t\t\t:key=\"groupId\"\n\t\t\t\t\t:user-group=\"group\"\n\t\t\t\t\t:rights=\"rights\"\n\t\t\t\t\t:data-accessrights-user-group-id=\"groupId\"\n\t\t\t\t/>\n\t\t\t\t<ColumnLayout/>\n\t\t\t</SyncHorizontalScroll>\n\t\t</div>\n\t`,\n};\n","import { Dom, Tag } from 'main.core';\nimport 'ui.hint';\nimport { mapState } from 'ui.vue3.vuex';\nimport { ServiceLocator } from '../../service/service-locator';\n\n/**\n * A special case of Hint that provides interactivity and reactivity.\n */\nexport const Hint = {\n\tname: 'Hint',\n\tprops: {\n\t\thtml: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapState({\n\t\t\tguid: (state) => state.application.guid,\n\t\t}),\n\t},\n\tmounted()\n\t{\n\t\tthis.renderHint();\n\t},\n\twatch: {\n\t\thtml(): void {\n\t\t\t// make ui.hint reactive :(\n\t\t\tDom.clean(this.$refs.container);\n\t\t\tthis.renderHint();\n\t\t},\n\t},\n\tmethods: {\n\t\trenderHint(): void {\n\t\t\tconst hintIconWrapper = Tag.render`<span data-hint-html=\"true\" data-hint-interactivity=\"true\"></span>`;\n\t\t\t// Tag.render cant set prop value with HTML properly :(\n\t\t\thintIconWrapper.setAttribute('data-hint', this.html);\n\n\t\t\tDom.append(\n\t\t\t\thintIconWrapper,\n\t\t\t\tthis.$refs.container,\n\t\t\t);\n\n\t\t\tthis.getHintManager().initNode(hintIconWrapper);\n\t\t},\n\t\tgetHintManager(): BX.UI.Hint {\n\t\t\treturn ServiceLocator.getHint(this.guid);\n\t\t},\n\t},\n\ttemplate: '<span class=\"ui-access-rights-v2-hint-container\" ref=\"container\"></span>',\n};\n","import { Hint } from '../util/hint';\nimport { Icon } from './icon';\nimport { EventEmitter } from 'main.core.events';\nimport '../../css/section/header.css';\n\nexport const Header = {\n\tname: 'Header',\n\tcomponents: { Hint, Icon },\n\tinject: ['section'],\n\tmethods: {\n\t\ttoggleSection(): void {\n\t\t\tthis.$store.dispatch('accessRights/toggleSection', { sectionCode: this.section.sectionCode });\n\t\t},\n\t\tonSectionEventButtonClick(): void {\n\t\t\tconst eventData = {\n\t\t\t\tguid: this.$store.getters['application/guid'],\n\t\t\t\tsection: this.section,\n\t\t\t};\n\t\t\tEventEmitter.emit('BX.UI.AccessRights.V2:onSectionHeaderClick', eventData);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\t@click=\"toggleSection\"\n\t\t\tclass='ui-access-rights-v2-section-header'\n\t\t\t:class=\"{\n\t\t\t\t'--expanded': section.isExpanded,\n\t\t\t}\" \n\t\t\tv-memo=\"[section.isExpanded]\"\n\t\t>\n\t\t\t<div class=\"ui-access-rights-v2-section-header-expander\">\n\t\t\t\t<div class='ui-icon-set' :class=\"{\n\t\t\t\t\t'--chevron-up': section.isExpanded,\n\t\t\t\t\t'--chevron-down': !section.isExpanded,\n\t\t\t\t}\"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t\t<Icon/>\n\t\t\t<span \n\t\t\t\tclass=\"ui-access-rights-v2-text-ellipsis ui-access-rights-v2-section-title\"\n\t\t\t\t:title=\"section.sectionTitle\"\n\t\t\t>{{ section.sectionTitle }}</span>\n\t\t\t<span\n\t\t\t\tv-if=\"section.sectionSubTitle\"\n\t\t\t\tclass=\"ui-access-rights-v2-text-ellipsis ui-access-rights-v2-section-subtitle\"\n\t\t\t\t:title=\"section.sectionSubTitle\"\n\t\t\t>\n\t\t\t\t{{ section.sectionSubTitle }}\n\t\t\t</span>\n\t\t\t<Hint v-if=\"section.sectionHint\" :html=\"section.sectionHint\"/>\n\t\t\t<span \n\t\t\t\tv-if=\"section.action\"\n\t\t\t\tclass=\"ui-btn ui-btn-light-border ui-btn-xs ui-access-rights-v2-section-action\"\n\t\t\t\t@click.stop=\"onSectionEventButtonClick\"\n\t\t\t>{{ section.action.buttonText }}</span>\n\t\t</div>\n\t`,\n};\n","import { CellLayout } from '../../layout/cell-layout';\nimport '../../../css/section/menu-cell.css';\n\nexport const MenuCell = {\n\tname: 'MenuCell',\n\tcomponents: { CellLayout },\n\ttemplate: `\n\t\t<CellLayout class=\"ui-access-rights-v2-menu-cell\"/>\n\t`,\n};\n","import { getValueComponent, Rows } from '../value/registry';\n\nexport const RowValue = {\n\tname: 'RowValue',\n\tcomponents: { ...Rows },\n\temits: ['close'],\n\tinject: ['right'],\n\tcomputed: {\n\t\tcomponent(): string\n\t\t{\n\t\t\treturn getValueComponent(this.right);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Component :is=\"component\" @close=\"$emit('close')\" />\n\t`,\n};\n","import '../../../css/section/title-column/title-cell.css';\nimport { RichMenuItem, RichMenuItemIcon, RichMenuPopup } from 'ui.vue3.components.rich-menu';\nimport { ServiceLocator } from '../../../service/service-locator';\nimport { Hint } from '../../util/hint';\nimport { RowValue } from './row-value';\nimport { EventEmitter } from 'main.core.events';\n\nexport const TitleCell = {\n\tname: 'TitleCell',\n\tcomponents: { Hint, RowValue, RichMenuItem, RichMenuPopup },\n\tprops: {\n\t\tright: {\n\t\t\t/** @type AccessRightItem */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tinject: ['section'],\n\tprovide(): Object {\n\t\treturn {\n\t\t\tright: this.right,\n\t\t};\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tisMenuShown: false,\n\t\t\tisRowValueShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tRichMenuItemIcon: () => RichMenuItemIcon,\n\t\tisMinValueSet(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['accessRights/isMinValueSet'](this.section.sectionCode, this.right.id);\n\t\t},\n\t\tisMaxValueSet(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['accessRights/isMaxValueSet'](this.section.sectionCode, this.right.id);\n\t\t},\n\t\tisRowValueConfigurable(): boolean\n\t\t{\n\t\t\treturn ServiceLocator.getValueTypeByRight(this.right)?.isRowValueConfigurable() ?? false;\n\t\t},\n\t\tisRightDeletable(): boolean\n\t\t{\n\t\t\treturn this.right.isDeletable;\n\t\t},\n\t\trightCellStyle(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'margin-left': !this.right.groupHead && !this.right.group && !this.right.iconClass ? '23px' : null,\n\t\t\t\t'max-width': this.right.iconClass ? 'calc(100% - 52px)' : 'auto',\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\ttoggleGroup(): void\n\t\t{\n\t\t\tif (!this.right.groupHead)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$store.dispatch('accessRights/toggleGroup', { sectionCode: this.section.sectionCode, groupId: this.right.id });\n\t\t},\n\t\ttoggleMenu(): void\n\t\t{\n\t\t\tthis.isMenuShown = !this.isMenuShown;\n\t\t},\n\t\tsetMaxValuesForRight(): void\n\t\t{\n\t\t\tthis.isRowValueShown = false;\n\t\t\tthis.isMenuShown = false;\n\n\t\t\tthis.$store.dispatch('userGroups/setMaxAccessRightValuesForRight', {\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\trightId: this.right.id,\n\t\t\t});\n\t\t},\n\t\tsetMinValuesForRight(): void\n\t\t{\n\t\t\tthis.isRowValueShown = false;\n\t\t\tthis.isMenuShown = false;\n\n\t\t\tthis.$store.dispatch('userGroups/setMinAccessRightValuesForRight', {\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\trightId: this.right.id,\n\t\t\t});\n\t\t},\n\t\topenRowValue(): void\n\t\t{\n\t\t\tthis.isMenuShown = false;\n\n\t\t\tthis.isRowValueShown = true;\n\t\t},\n\t\tonRightClick(): void\n\t\t{\n\t\t\tconst eventData = {\n\t\t\t\tguid: this.$store.getters['application/guid'],\n\t\t\t\tright: this.right,\n\t\t\t};\n\t\t\tEventEmitter.emit('BX.UI.AccessRights.V2:onRightClick', eventData);\n\t\t},\n\t\tdeleteRight(): void\n\t\t{\n\t\t\tthis.$store.dispatch('userGroups/deleteRight', { rightId: this.right.id });\n\t\t\tthis.$store.dispatch('accessRights/deleteRight', {\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\trightId: this.right.id,\n\t\t\t});\n\t\t\tEventEmitter.emit('BX.UI.AccessRights.V2:onRightDelete', {\n\t\t\t\tguid: this.$store.getters['application/guid'],\n\t\t\t\tright: this.right,\n\t\t\t});\n\t\t},\n\t},\n\t// data attributes are needed for e2e automated tests\n\ttemplate: `\n\t\t<div\n\t\t\tclass='ui-access-rights-v2-column-item-text ui-access-rights-v2-column-item-title'\n\t\t\t@click=\"toggleGroup\"\n\t\t\t:style=\"{\n\t\t\t\tcursor: right.groupHead ? 'pointer' : null,\n\t\t\t}\"\n\t\t\tv-memo=\"[right.isGroupExpanded, right.title, right.subtitle]\"\n\t\t\t:data-accessrights-right-id=\"right.id\"\n\t\t>\n\t\t\t<span\n\t\t\t\tv-if=\"right.groupHead\"\n\t\t\t\tclass=\"ui-icon-set\"\n\t\t\t\t:class=\"{\n\t\t\t\t\t'--o-circle-minus': right.isGroupExpanded,\n\t\t\t\t\t'--o-circle-plus': !right.isGroupExpanded,\n\t\t\t\t}\"\n\t\t\t></span>\n\t\t\t<div \n\t\t\t\tv-if=\"right.iconClass\" \n\t\t\t\t:class=\"right.iconClass\"\n\t\t\t\tclass=\"ui-access-rights-v2-column-item-title-icon\"\n\t\t\t><i></i></div>\n\t\t\t<div class=\"ui-access-rights-v2-column-item-title-block\" :style=\"rightCellStyle\">\n\t\t\t\t<span\n\t\t\t\t\tv-if=\"right.isClickable\"\n\t\t\t\t\tclass=\"ui-access-rights-v2-column-item-title-link ui-access-rights-v2-text-ellipsis\"\n\t\t\t\t\t@click=\"onRightClick\"\n\t\t\t\t>\n\t\t\t\t\t{{ right.title }}<Hint v-once v-if=\"right.hint\" :html=\"right.hint\"/>\n\t\t\t\t</span>\n\t\t\t\t<span \n\t\t\t\t\tv-else \n\t\t\t\t\tclass=\"ui-access-rights-v2-text-wrap\"\n\t\t\t\t>\n\t\t\t\t\t{{ right.title }}<Hint v-once v-if=\"right.hint\" :html=\"right.hint\"/>\n\t\t\t\t</span>\n\t\t\t\t<span \n\t\t\t\t\tv-if=\"right.subtitle\" \n\t\t\t\t\tclass=\"ui-access-rights-v2-column-item-subtitle ui-access-rights-v2-text-ellipsis\"\n\t\t\t\t>{{ right.subtitle }}</span>\n\t\t\t</div>\n\t\t</div>\n\t\t<div\n\t\t\tref=\"icon\" \n\t\t\tclass=\"ui-icon-set --more-l ui-access-rights-v2-icon-more ui-access-rights-v2-title-column-menu\" \n\t\t\t@click=\"toggleMenu\"\n\t\t>\n\t\t\t<RichMenuPopup\n\t\t\t\tv-if=\"isMenuShown\"\n\t\t\t\t@close=\"isMenuShown = false\"\n\t\t\t\t:popup-options=\"{bindElement: $refs.icon, width: 300}\"\n\t\t\t>\n\t\t\t\t<RichMenuItem\n\t\t\t\t\tv-if=\"isMaxValueSet\"\n\t\t\t\t\t:icon=\"RichMenuItemIcon.check\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MAX_ACCESS_RIGHTS_ROW')\"\n\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MAX_ACCESS_RIGHTS_ROW_SUBTITLE')\"\n\t\t\t\t\t@click=\"setMaxValuesForRight\"\n\t\t\t\t/>\n\t\t\t\t<RichMenuItem\n\t\t\t\t\tv-if=\"isMinValueSet\"\n\t\t\t\t\t:icon=\"RichMenuItemIcon['red-lock']\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MIN_ACCESS_RIGHTS_ROW')\"\n\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MIN_ACCESS_RIGHTS_ROW_SUBTITLE')\"\n\t\t\t\t\t@click=\"setMinValuesForRight\"\n\t\t\t\t/>\n\t\t\t\t<RichMenuItem\n\t\t\t\t\tv-if=\"isRowValueConfigurable\"\n\t\t\t\t\t:icon=\"RichMenuItemIcon.settings\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_OPEN_ROW_VALUE')\"\n\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_OPEN_ROW_VALUE_SUBTITLE')\"\n\t\t\t\t\t@click=\"openRowValue\"\n\t\t\t\t/>\n\t\t\t\t<RichMenuItem\n\t\t\t\t\tv-if=\"isRightDeletable\"\n\t\t\t\t\t:icon=\"RichMenuItemIcon['trash-bin']\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_DELETE_ROW')\"\n\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_DELETE_ROW_SUBTITLE')\"\n\t\t\t\t\t@click=\"deleteRight\"\n\t\t\t\t/>\n\t\t\t</RichMenuPopup>\n\t\t\t<RowValue v-if=\"isRowValueShown\" @close=\"isRowValueShown = false\"/>\n\t\t</div>\n\t`,\n};\n","import { AccessRightItem } from '../../store/model/access-rights-model';\nimport { shouldRowBeRendered } from '../../utils';\nimport { CellLayout } from '../layout/cell-layout';\nimport { ColumnLayout } from '../layout/column-layout';\nimport { MenuCell } from './title-column/menu-cell';\nimport { TitleCell } from './title-column/title-cell';\n\nexport const TitleColumn = {\n\tname: 'TitleColumn',\n\tcomponents: { TitleCell, ColumnLayout, CellLayout, MenuCell },\n\tprops: {\n\t\trights: {\n\t\t\ttype: Map,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\trenderedRights(): Map<string, AccessRightItem> {\n\t\t\tconst result = new Map();\n\t\t\tfor (const [rightId: string, right: AccessRightItem] of this.rights)\n\t\t\t{\n\t\t\t\tif (shouldRowBeRendered(right))\n\t\t\t\t{\n\t\t\t\t\tresult.set(rightId, right);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ColumnLayout>\n\t\t\t<MenuCell/>\n\t\t\t<CellLayout\n\t\t\t\tv-for=\"[rightId, accessRightItem] in renderedRights\"\n\t\t\t\t:key=\"rightId\"\n\t\t\t\t:class=\"{\n\t\t\t\t\t'ui-access-rights-v2-group-children': accessRightItem.group,\n\t\t\t\t}\"\n\t\t\t>\n\t\t\t\t<TitleCell :right=\"accessRightItem\" />\n\t\t\t</CellLayout>\n\t\t</ColumnLayout>\n\t`,\n};\n","import { computed } from 'ui.vue3';\nimport { Column } from './section/column';\nimport { ColumnList } from './section/column-list';\nimport { Header } from './section/header';\nimport { TitleColumn } from './section/title-column';\nimport { SyncHorizontalScroll } from './util/sync-horizontal-scroll';\n\n// @vue/component\nexport const Section = {\n\tname: 'Section',\n\tcomponents: { Column, SyncHorizontalScroll, TitleColumn, Header, ColumnList },\n\tprops: {\n\t\tuserGroups: {\n\t\t\ttype: Map,\n\t\t\trequired: true,\n\t\t},\n\t\trights: {\n\t\t\ttype: Map,\n\t\t\trequired: true,\n\t\t},\n\t\tcode: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisExpanded: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tsubTitle: {\n\t\t\ttype: String,\n\t\t},\n\t\thint: {\n\t\t\ttype: String,\n\t\t},\n\t\ticon: {\n\t\t\t/** @type AccessRightSectionIcon */\n\t\t\ttype: Object,\n\t\t},\n\t\taction: {\n\t\t\t/** @type AccessRightSectionAction */\n\t\t\ttype: Object,\n\t\t},\n\t},\n\tprovide(): Object {\n\t\treturn {\n\t\t\tsection: computed(() => {\n\t\t\t\treturn {\n\t\t\t\t\tsectionCode: this.code,\n\t\t\t\t\tsectionTitle: this.title,\n\t\t\t\t\tsectionSubTitle: this.subTitle,\n\t\t\t\t\tsectionIcon: this.icon,\n\t\t\t\t\tsectionHint: this.hint,\n\t\t\t\t\tisExpanded: this.isExpanded,\n\t\t\t\t\trights: this.rights,\n\t\t\t\t\taction: this.action,\n\t\t\t\t};\n\t\t\t}),\n\t\t};\n\t},\n\t// data attributes are needed for e2e automated tests\n\ttemplate: `\n\t\t<div class=\"ui-access-rights-v2-section\" :data-accessrights-section-code=\"code\">\n\t\t\t<Header/>\n\t\t\t<div v-if=\"isExpanded\" class='ui-access-rights-v2-section-container'>\n\t\t\t\t<div class='ui-access-rights-v2-section-head'>\n\t\t\t\t\t<TitleColumn :rights=\"rights\" />\n\t\t\t\t</div>\n\t\t\t\t<ColumnList :rights=\"rights\" :user-groups=\"userGroups\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BitrixVueComponentProps } from 'ui.vue3';\n\nimport './grid-skeleton.css';\n\nexport const GridSkeleton: BitrixVueComponentProps = {\n\tname: 'GridSkeleton',\n\ttemplate: `\n\t\t<div class=\"ui-access-rights-v2-grid-skeleton\" />\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { mapGetters, mapState } from 'ui.vue3.vuex';\nimport { ServiceLocator } from '../service/service-locator';\nimport { Header } from './header';\nimport { SearchBox } from './searchbox';\nimport { MemberSelector } from './member-selector';\nimport { Section } from './section';\nimport { GridSkeleton } from './loader/grid/grid-skeleton';\n\nexport const Grid = {\n\tname: 'Grid',\n\tcomponents: { Section, Header, SearchBox, MemberSelector, GridSkeleton },\n\tloader: null,\n\tcomputed: {\n\t\t...mapState({\n\t\t\tisProgress: (state) => state.application.isProgress,\n\t\t\tguid: (state) => state.application.guid,\n\t\t\tsearchContainerSelector: (state) => state.application.options.searchContainerSelector,\n\t\t\tmaxVisibleUserGroups: (state) => state.application.options.maxVisibleUserGroups,\n\t\t\tsortConfig: (state) => state.userGroups.sortConfig,\n\t\t\tselectedMember: (state) => state.userGroups.selectedMember,\n\t\t}),\n\t\t...mapGetters({\n\t\t\tshownSections: 'accessRights/shown',\n\t\t\tuserGroups: 'userGroups/shown',\n\t\t}),\n\t},\n\tmounted()\n\t{\n\t\tServiceLocator.getHint(this.guid).initOwnerDocument(this.$refs.container);\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.V2:addRight', this.addRight);\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.V2:updateRightTitle', this.updateRightTitle);\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.V2:updateRightSubtitle', this.updateRightSubtitle);\n\t\tEventEmitter.subscribe('BX.UI.AccessRights.V2:markRightAsModified', this.markRightAsModified);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.unsubscribe('BX.UI.AccessRights.V2:addRight', this.addRight);\n\t\tEventEmitter.unsubscribe('BX.UI.AccessRights.V2:updateRightTitle', this.updateRightTitle);\n\t\tEventEmitter.unsubscribe('BX.UI.AccessRights.V2:updateRightSubtitle', this.updateRightSubtitle);\n\t\tEventEmitter.unsubscribe('BX.UI.AccessRights.V2:markRightAsModified', this.markRightAsModified);\n\t},\n\tmethods: {\n\t\tscrollToSection(sectionCode: string) {\n\t\t\tconst section = this.$refs.sections.find((item) => item.code === sectionCode);\n\t\t\tif (section)\n\t\t\t{\n\t\t\t\tscrollTo({\n\t\t\t\t\ttop: Dom.getPosition(section.$el).top - 155,\n\t\t\t\t\tbehavior: 'smooth',\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\taddRight(event: BaseEvent) {\n\t\t\tconst { guid, sectionCode, right } = event.data;\n\t\t\tif (!guid)\n\t\t\t{\n\t\t\t\tconsole.warn('ui.accessrights.v2: addRight: application guid should be passed in event data');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (guid === this.$store.getters['application/guid'])\n\t\t\t{\n\t\t\t\tthis.$store.dispatch('accessRights/addRight', { sectionCode, right });\n\t\t\t}\n\t\t},\n\t\tupdateRightTitle(event: BaseEvent) {\n\t\t\tconst { guid, sectionCode, rightId, rightTitle } = event.data;\n\t\t\tif (!guid)\n\t\t\t{\n\t\t\t\tconsole.warn('ui.accessrights.v2: updateRightTitle: application guid should be passed in event data');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (guid === this.$store.getters['application/guid'])\n\t\t\t{\n\t\t\t\tthis.$store.dispatch('accessRights/updateRightTitle', { sectionCode, rightId, rightTitle });\n\t\t\t}\n\t\t},\n\t\tupdateRightSubtitle(event: BaseEvent) {\n\t\t\tconst { guid, sectionCode, rightId, rightSubtitle } = event.data;\n\t\t\tif (!guid)\n\t\t\t{\n\t\t\t\tconsole.warn('ui.accessrights.v2: updateRightSubtitle: application guid should be passed in event data');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (guid === this.$store.getters['application/guid'])\n\t\t\t{\n\t\t\t\tthis.$store.dispatch('accessRights/updateRightSubtitle', { sectionCode, rightId, rightSubtitle });\n\t\t\t}\n\t\t},\n\t\tmarkRightAsModified(event: BaseEvent) {\n\t\t\tconst { guid, sectionCode, rightId, isModified } = event.data;\n\t\t\tif (!guid)\n\t\t\t{\n\t\t\t\tconsole.warn('ui.accessrights.v2: markRightAsModified: application guid should be passed in event data');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (guid === this.$store.getters['application/guid'])\n\t\t\t{\n\t\t\t\tthis.$store.dispatch('accessRights/markRightAsModified', { sectionCode, rightId, isModified });\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Teleport v-if=\"searchContainerSelector\" :to=\"searchContainerSelector\">\n\t\t\t<div class=\"ui-access-rights-v2-search-container\">\n\t\t\t\t<MemberSelector/>\n\t\t\t\t<SearchBox/>\n\t\t\t</div>\n\t\t</Teleport>\n\t\t<div ref=\"container\" class='ui-access-rights-v2'>\n\t\t\t<GridSkeleton v-if=\"isProgress\" />\n\t\t\t<template v-else>\n\t\t\t\t<Header :user-groups=\"userGroups\"/>\n\t\t\t\t<Section\n\t\t\t\t\tv-for=\"[sectionCode, accessRightSection] in shownSections\"\n\t\t\t\t\t:key=\"sectionCode\"\n\t\t\t\t\t:code=\"accessRightSection.sectionCode\"\n\t\t\t\t\t:is-expanded=\"accessRightSection.isExpanded\"\n\t\t\t\t\t:title=\"accessRightSection.sectionTitle\"\n\t\t\t\t\t:sub-title=\"accessRightSection.sectionSubTitle\"\n\t\t\t\t\t:hint=\"accessRightSection.sectionHint\"\n\t\t\t\t\t:icon=\"accessRightSection.sectionIcon\"\n\t\t\t\t\t:rights=\"accessRightSection.rights\"\n\t\t\t\t\t:action=\"accessRightSection.action\"\n\t\t\t\t\t:user-groups=\"userGroups\"\n\t\t\t\t\tref=\"sections\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { type AjaxResponse, Text, Type } from 'main.core';\nimport { type AnalyticsOptions, sendData } from 'ui.analytics';\nimport type { Store } from 'ui.vue3.vuex';\nimport type { UserGroup } from '../store/model/user-groups-model';\n\nexport class AnalyticsManager\n{\n\t#store: Store;\n\t#data: AnalyticsOptions;\n\n\t#isEnabled: boolean;\n\t#isCancelAlreadyRegistered: boolean = false;\n\n\tconstructor(store: Store, analyticsData: AnalyticsOptions)\n\t{\n\t\tthis.#store = store;\n\t\tthis.#data = analyticsData;\n\n\t\t// check 2 out of 3 required fields\n\t\t// 'event' field is provided by AnalyticsManager\n\t\tthis.#isEnabled = Object.hasOwn(this.#data, 'tool') && Object.hasOwn(this.#data, 'category');\n\t}\n\n\tonSaveSuccess(): void\n\t{\n\t\tif (!this.#isEnabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst { createdRoles, editedRoles, deletedRoles } = this.#analyzeRoles();\n\n\t\tfor (let i = 0; i < createdRoles; i++)\n\t\t{\n\t\t\tthis.#registerRoleCreateEvent('success');\n\t\t}\n\n\t\tfor (let i = 0; i < editedRoles; i++)\n\t\t{\n\t\t\tthis.#registerRoleEditEvent('success');\n\t\t}\n\n\t\tfor (let i = 0; i < deletedRoles; i++)\n\t\t{\n\t\t\tthis.#registerRoleDeleteEvent('success');\n\t\t}\n\t}\n\n\tonSaveError(response: AjaxResponse): void\n\t{\n\t\tif (!this.#isEnabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst status = this.#getSaveErrorStatus(response);\n\n\t\tconst { createdRoles, editedRoles, deletedRoles } = this.#analyzeRoles();\n\n\t\tfor (let i = 0; i < createdRoles; i++)\n\t\t{\n\t\t\tthis.#registerRoleCreateEvent(status);\n\t\t}\n\n\t\tfor (let i = 0; i < editedRoles; i++)\n\t\t{\n\t\t\tthis.#registerRoleEditEvent(status);\n\t\t}\n\n\t\tfor (let i = 0; i < deletedRoles; i++)\n\t\t{\n\t\t\tthis.#registerRoleDeleteEvent(status);\n\t\t}\n\t}\n\n\tonCancelChanges(): void\n\t{\n\t\tif (!this.#isEnabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#isCancelAlreadyRegistered)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsendData({\n\t\t\t...this.#data,\n\t\t\tevent: 'settings_cancel',\n\t\t});\n\n\t\tthis.#isCancelAlreadyRegistered = true;\n\t}\n\n\tonCloseWithoutSave(): void\n\t{\n\t\tif (!this.#isEnabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsendData({\n\t\t\t...this.#data,\n\t\t\tevent: 'settings_pop_cancel',\n\t\t});\n\t}\n\n\t#analyzeRoles(): {createdRoles: number, editedRoles: number, deletedRoles: number}\n\t{\n\t\tconst result = {\n\t\t\tcreatedRoles: 0,\n\t\t\teditedRoles: 0,\n\t\t\tdeletedRoles: this.#store.state.userGroups.deleted.size,\n\t\t};\n\n\t\tfor (const userGroup: UserGroup of this.#store.state.userGroups.collection.values())\n\t\t{\n\t\t\tif (userGroup.isNew)\n\t\t\t{\n\t\t\t\tresult.createdRoles++;\n\t\t\t}\n\t\t\telse if (this.#isUserGroupEdited(userGroup))\n\t\t\t{\n\t\t\t\tresult.editedRoles++;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#isUserGroupEdited(userGroup: UserGroup): boolean\n\t{\n\t\tif (userGroup.isModified)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tfor (const value of userGroup.accessRights.values())\n\t\t{\n\t\t\tif (value.isModified)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t#getSaveErrorStatus(response: AjaxReponse): string\n\t{\n\t\tif (!Type.isArrayFilled(response?.errors))\n\t\t{\n\t\t\treturn 'error';\n\t\t}\n\n\t\tfor (const error of response.errors)\n\t\t{\n\t\t\tif (Type.isStringFilled(error?.code))\n\t\t\t{\n\t\t\t\treturn `error_${Text.toCamelCase(error.code)}`;\n\t\t\t}\n\t\t}\n\n\t\treturn 'error';\n\t}\n\n\t#registerRoleCreateEvent(status: string): void\n\t{\n\t\tconst data = {\n\t\t\t...this.#data,\n\t\t\tevent: 'role_create',\n\t\t\tstatus,\n\t\t};\n\n\t\tthis.#appendRoleCountView(data);\n\n\t\tsendData(data);\n\t}\n\n\t#registerRoleEditEvent(status: string): void\n\t{\n\t\tconst data = {\n\t\t\t...this.#data,\n\t\t\tevent: 'role_edit',\n\t\t\tstatus,\n\t\t};\n\n\t\tthis.#appendRoleCountView(data);\n\n\t\tsendData(data);\n\t}\n\n\t#registerRoleDeleteEvent(status: string): void\n\t{\n\t\tconst data = {\n\t\t\t...this.#data,\n\t\t\tevent: 'role_delete',\n\t\t\tstatus,\n\t\t};\n\n\t\tthis.#appendRoleCountView(data);\n\n\t\tsendData(data);\n\t}\n\n\t#appendRoleCountView(data: AnalyticsOptions): void\n\t{\n\t\tthis.#appendP(\n\t\t\tdata,\n\t\t\t'roleCountView',\n\t\t\tthis.#store.getters['userGroups/shown'].size,\n\t\t);\n\t}\n\n\t#appendP(data: AnalyticsOptions, name: string, value: any): void\n\t{\n\t\tfor (const pName of ['p1', 'p2', 'p3', 'p4', 'p5'])\n\t\t{\n\t\t\tif (!Object.hasOwn(data, pName))\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tdata[pName] = `${name}_${value}`;\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n}\n","import { BuilderModel, type GetterTree, type MutationTree } from 'ui.vue3.vuex';\n\nexport type ApplicationState = {\n\toptions: Readonly<Options>,\n\tguid: string,\n\tisProgress: boolean,\n}\n\nexport type Options = {\n\tcomponent: string,\n\tactionSave: string,\n\tmode: string,\n\tbodyType?: 'json' | 'data',\n\tadditionalSaveParams: Object,\n\tisSaveOnlyChangedRights: boolean,\n\tmaxVisibleUserGroups: ?number,\n\tsearchContainerSelector: ?string,\n\tadditionalMembersParams: AdditionalMembersParams,\n\tuserSortConfigName: string,\n\tisSaveAccessRightsList: boolean,\n\tmoduleId: string,\n}\n\nexport type AdditionalMembersParams = {\n\taddUserGroupsProviderTab?: boolean,\n\taddProjectsProviderTab?: boolean,\n\taddStructureTeamsProviderTab?: boolean,\n\taddStructureRolesProviderTab?: boolean,\n\tuseStructureDepartmentsProviderTab?: boolean,\n};\n\nexport const ACTION_SAVE = 'save';\nexport const MODE = 'ajax';\nexport const BODY_TYPE = 'data';\n\nexport class ApplicationModel extends BuilderModel\n{\n\t#guid: string;\n\t#options: Readonly<Options>;\n\n\tgetName(): string\n\t{\n\t\treturn 'application';\n\t}\n\n\tsetOptions(options: Options): ApplicationModel\n\t{\n\t\tthis.#options = options;\n\n\t\treturn this;\n\t}\n\n\tsetGuid(guid: string): ApplicationModel\n\t{\n\t\tthis.#guid = guid;\n\n\t\treturn this;\n\t}\n\n\tgetState(): ApplicationState\n\t{\n\t\treturn {\n\t\t\toptions: this.#options,\n\t\t\tguid: this.#guid,\n\t\t\tisProgress: false,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree<ApplicationState>\n\t{\n\t\treturn {\n\t\t\tisMaxVisibleUserGroupsSet: (state): boolean => {\n\t\t\t\treturn state.options.maxVisibleUserGroups > 0;\n\t\t\t},\n\t\t\tisModified: (state, getters, rootState, rootGetters): boolean => {\n\t\t\t\treturn rootGetters['userGroups/isModified'] || rootGetters['accessRights/isModified'];\n\t\t\t},\n\t\t\tguid: (state): string => {\n\t\t\t\treturn state.guid;\n\t\t\t},\n\t\t\tadditionalMembersParams: (state): AdditionalMembersParams => {\n\t\t\t\treturn state.options.additionalMembersParams;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree<ApplicationState>\n\t{\n\t\treturn {\n\t\t\tsetProgress: (state, isProgress: boolean): void => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.isProgress = Boolean(isProgress);\n\t\t\t},\n\t\t};\n\t}\n}\n","import { EventEmitter } from 'main.core.events';\nimport { Builder, type Store } from 'ui.vue3.vuex';\nimport type { AccessRightsCollection } from './model/access-rights-model';\nimport { AccessRightsModel } from './model/access-rights-model';\nimport { ApplicationModel, type Options } from './model/application-model';\nimport type { UserGroupsCollection, UserGroupsOption } from './model/user-groups-model';\nimport { UserGroupsModel } from './model/user-groups-model';\n\nexport function createStore(\n\toptions: Readonly<Options>,\n\tuserGroups: UserGroupsCollection,\n\taccessRights: AccessRightsCollection,\n\tappGuid: string | number,\n\tuserGroupsOption: UserGroupsOption,\n): {\n\tstore: Store,\n\tresetState: () => Promise<void>,\n\tuserGroupsModel: UserGroupsModel,\n}\n{\n\tconst sortConfig = userGroupsOption.sortConfig ?? {};\n\tconst selectedMember = userGroupsOption.selectedMember ?? {};\n\n\tconst userGroupsModel = UserGroupsModel.create()\n\t\t.setInitialUserGroups(userGroups)\n\t\t.setSortConfig(sortConfig)\n\t\t.setSelectedMember(selectedMember)\n\t;\n\n\tconst accessRightsModel = AccessRightsModel.create()\n\t\t.setInitialAccessRights(accessRights)\n\t;\n\n\tconst { store } = Builder\n\t\t.init()\n\t\t.addModel(\n\t\t\tApplicationModel.create()\n\t\t\t\t.setOptions(options)\n\t\t\t\t.setGuid(appGuid)\n\t\t\t,\n\t\t)\n\t\t.addModel(accessRightsModel)\n\t\t.addModel(userGroupsModel)\n\t\t.syncBuild()\n\t;\n\n\treturn {\n\t\tstore,\n\t\tresetState: () => {\n\t\t\tuserGroupsModel.clearState();\n\t\t\taccessRightsModel.clearState();\n\t\t\tEventEmitter.emit('BX.UI.AccessRights.V2:onResetState', {\n\t\t\t\tguid: appGuid,\n\t\t\t});\n\t\t},\n\t\tuserGroupsModel,\n\t\taccessRightsModel,\n\t};\n}\n","import { AccessRightSection } from '../../access-rights-model';\nimport type { AccessRightItem, AccessRightsCollection } from '../../access-rights-model';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nexport type RightSaveData = {\n\tid: string,\n\tname: string,\n\trightData: Object,\n};\n\nexport class AccessRightsExporter implements Transformer<AccessRightsCollection, RightSaveData[]>\n{\n\ttransform(source: AccessRightsCollection, appGuid: string): RightSaveData[]\n\t{\n\t\tconst result: RightSaveData[] = [];\n\n\t\tfor (const accessRightSection: AccessRightSection of source.values())\n\t\t{\n\t\t\tfor (const accessRight: AccessRightItem of accessRightSection.rights.values())\n\t\t\t{\n\t\t\t\tconst data = {\n\t\t\t\t\tid: accessRight.id,\n\t\t\t\t\tname: accessRight.title,\n\t\t\t\t\tadditionalRightData: {},\n\t\t\t\t};\n\t\t\t\tconst eventResults = EventEmitter.emit('BX.UI.AccessRights.V2:additionalRightData', {\n\t\t\t\t\tguid: appGuid,\n\t\t\t\t\tright: accessRight,\n\t\t\t\t});\n\t\t\t\tfor (const eventResult: BaseEvent of eventResults)\n\t\t\t\t{\n\t\t\t\t\tdata.additionalRightData = { ...data.additionalRightData, ...eventResult.getData()?.additionalRightData };\n\t\t\t\t}\n\t\t\t\tresult.push(data);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import type { AccessRightValue, Member, UserGroup, UserGroupsCollection } from '../../../user-groups-model';\nimport { NEW_USER_GROUP_ID_PREFIX } from '../../../user-groups-model';\nimport type { ExternalAccessRightValue, ExternalUserGroup } from '../../internalizer/user-groups-internalizer';\n\nexport type UserGroupSaveData = ExternalUserGroup & {\n\tmembers: null,\n\taccessCodes: { [accessCode: string]: string },\n};\n\n/**\n * @abstract\n */\nexport class BaseUserGroupsExporter implements Transformer<UserGroupsCollection, UserGroupSaveData[]>\n{\n\ttransform(source: UserGroupsCollection): UserGroupSaveData[]\n\t{\n\t\tconst result: UserGroupSaveData[] = [];\n\n\t\tfor (const userGroup of source.values())\n\t\t{\n\t\t\tresult.push({\n\t\t\t\tid: userGroup.id.startsWith(NEW_USER_GROUP_ID_PREFIX) ? '0' : userGroup.id,\n\t\t\t\ttitle: userGroup.title,\n\t\t\t\taccessCodes: this.#transformAccessCodes(userGroup.members),\n\t\t\t\taccessRights: this.#transformAccessRightValues(userGroup),\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#transformAccessCodes(members: Map<string, Member>): { [accessCode: string]: string }\n\t{\n\t\tconst result = {};\n\n\t\tfor (const [accessCode, member] of members)\n\t\t{\n\t\t\tresult[accessCode] = member.type;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#transformAccessRightValues(userGroup: UserGroup): ExternalAccessRightValue[]\n\t{\n\t\tconst result: ExternalAccessRightValue[] = [];\n\n\t\tfor (const accessRightValue of userGroup.accessRights.values())\n\t\t{\n\t\t\tif (!this.shouldBeIncludedInExport(userGroup, accessRightValue))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor (const singleValue of accessRightValue.values)\n\t\t\t{\n\t\t\t\tresult.push({\n\t\t\t\t\tid: accessRightValue.id,\n\t\t\t\t\tvalue: singleValue,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * @abstract\n\t * @protected\n\t */\n\tshouldBeIncludedInExport(userGroup: UserGroup, accessRightValue: AccessRightValue): boolean\n\t{\n\t\tthrow new Error('Not implemented');\n\t}\n}\n","import type { AccessRightValue, UserGroup } from '../../../user-groups-model';\nimport { BaseUserGroupsExporter } from './base-user-groups-exporter';\n\nexport class AllUserGroupsExporter extends BaseUserGroupsExporter\n{\n\tshouldBeIncludedInExport(userGroup: UserGroup, accessRightValue: AccessRightValue): boolean\n\t{\n\t\treturn true;\n\t}\n}\n","import type { AccessRightValue, UserGroup } from '../../../user-groups-model';\nimport { BaseUserGroupsExporter } from './base-user-groups-exporter';\n\nexport class OnlyChangedUserGroupsExporter extends BaseUserGroupsExporter\n{\n\tshouldBeIncludedInExport(userGroup: UserGroup, accessRightValue: AccessRightValue): boolean\n\t{\n\t\treturn userGroup.isNew || accessRightValue.isModified;\n\t}\n}\n","import { Type } from 'main.core';\nimport { ACTION_SAVE, BODY_TYPE, MODE, type Options } from '../../application-model';\nimport type { Transformer } from '../transformer';\n\nexport class ApplicationInternalizer implements Transformer<Options, Readonly<Options>>\n{\n\t// noinspection OverlyComplexFunctionJS\n\ttransform(externalSource: Options): Readonly<Options>\n\t{\n\t\t// freeze tells vue that we don't need reactivity on this state\n\t\t// and prevents accidental modification as well\n\t\treturn this.#deepFreeze({\n\t\t\tcomponent: String(externalSource.component),\n\t\t\tactionSave: Type.isStringFilled(externalSource.actionSave) ? externalSource.actionSave : ACTION_SAVE,\n\t\t\tmode: Type.isStringFilled(externalSource.mode) ? externalSource.mode : MODE,\n\t\t\tbodyType: Type.isStringFilled(externalSource.bodyType) ? externalSource.bodyType : BODY_TYPE,\n\t\t\tadditionalSaveParams: Type.isPlainObject(externalSource.additionalSaveParams)\n\t\t\t\t? externalSource.additionalSaveParams\n\t\t\t\t: [],\n\t\t\tisSaveOnlyChangedRights: Type.isBoolean(externalSource.isSaveOnlyChangedRights)\n\t\t\t\t? externalSource.isSaveOnlyChangedRights\n\t\t\t\t: false,\n\t\t\tmaxVisibleUserGroups: Type.isInteger(externalSource.maxVisibleUserGroups)\n\t\t\t\t? externalSource.maxVisibleUserGroups\n\t\t\t\t: null,\n\t\t\tsearchContainerSelector: Type.isStringFilled(externalSource.searchContainerSelector)\n\t\t\t\t? externalSource.searchContainerSelector\n\t\t\t\t: null,\n\t\t\tadditionalMembersParams: Type.isPlainObject(externalSource.additionalMembersParams)\n\t\t\t\t? {\n\t\t\t\t\taddUserGroupsProviderTab: Boolean(externalSource.additionalMembersParams?.addUserGroupsProviderTab ?? false),\n\t\t\t\t\taddProjectsProviderTab: Boolean(externalSource.additionalMembersParams?.addProjectsProviderTab ?? true),\n\t\t\t\t\taddStructureTeamsProviderTab: Boolean(\n\t\t\t\t\t\texternalSource.additionalMembersParams?.addStructureTeamsProviderTab ?? false,\n\t\t\t\t\t),\n\t\t\t\t\tuseStructureDepartmentsProviderTab: Boolean(\n\t\t\t\t\t\texternalSource.additionalMembersParams?.useStructureDepartmentsProviderTab ?? false,\n\t\t\t\t\t),\n\t\t\t\t\taddStructureRolesProviderTab: Boolean(\n\t\t\t\t\t\texternalSource.additionalMembersParams?.addStructureRolesProviderTab ?? false,\n\t\t\t\t\t),\n\t\t\t\t}\n\t\t\t\t: {\n\t\t\t\t\taddUserGroupsProviderTab: false,\n\t\t\t\t\taddProjectsProviderTab: true,\n\t\t\t\t\taddStructureTeamsProviderTab: false,\n\t\t\t\t\tuseStructureDepartmentsProviderTab: false,\n\t\t\t\t\taddStructureRolesProviderTab: false,\n\t\t\t\t},\n\t\t\tuserSortConfigName: String(externalSource.userSortConfigName ?? externalSource.component),\n\t\t\tisSaveAccessRightsList: Type.isBoolean(externalSource.isSaveAccessRightsList)\n\t\t\t\t? externalSource.isSaveAccessRightsList\n\t\t\t\t: false,\n\t\t\tmoduleId: Type.isString(externalSource.moduleId) ? externalSource.moduleId : '',\n\t\t});\n\t}\n\n\t#deepFreeze(target: Object): Readonly<Object>\n\t{\n\t\tif (Type.isObject(target))\n\t\t{\n\t\t\tObject.values(target).forEach((value) => {\n\t\t\t\tthis.#deepFreeze(value);\n\t\t\t});\n\n\t\t\treturn Object.freeze(target);\n\t\t}\n\n\t\treturn target;\n\t}\n}\n","import { Type } from 'main.core';\nimport { SelectorService } from '../../../../service/selector-service';\nimport type { AccessRightValue, UserGroupsCollection } from '../../user-groups-model';\nimport { Member, UserGroup } from '../../user-groups-model';\nimport type { Transformer } from '../transformer';\n\nexport type ExternalUserGroup = {\n\tid: any,\n\ttitle: any,\n\taccessRights: ExternalAccessRightValue[],\n\tmembers: {[accessCode: string]: ExternalMember},\n}\n\nexport type ExternalAccessRightValue = {\n\tid: any,\n\tvalue: any | any[],\n};\n\nexport type ExternalMember = {\n\ttype: any,\n\tid: any,\n\tname: any,\n\tavatar: any,\n};\n\nexport class UserGroupsInternalizer implements Transformer<ExternalUserGroup[], UserGroupsCollection>\n{\n\t#maxVisibleUserGroups: ?number = null;\n\n\tconstructor(maxVisibleUserGroups: ?number)\n\t{\n\t\tif (Type.isInteger(maxVisibleUserGroups))\n\t\t{\n\t\t\tthis.#maxVisibleUserGroups = maxVisibleUserGroups;\n\t\t}\n\t}\n\n\ttransform(externalSource: ExternalUserGroup[]): UserGroupsCollection\n\t{\n\t\tconst result = new Map();\n\n\t\tfor (const externalGroup of externalSource)\n\t\t{\n\t\t\tconst internalGroup = this.#internalizeExternalGroup(externalGroup);\n\n\t\t\tresult.set(internalGroup.id, internalGroup);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#internalizeExternalGroup(externalGroup: ExternalUserGroup): UserGroup\n\t{\n\t\tconst internalizedGroup: UserGroup = {\n\t\t\tid: String(externalGroup.id),\n\t\t\tisNew: false,\n\t\t\tisModified: false,\n\t\t\ttitle: String(externalGroup.title),\n\t\t\taccessRights: new Map(),\n\t\t\tmembers: new Map(),\n\t\t};\n\n\t\tfor (const externalValue: ExternalAccessRightValue of externalGroup.accessRights)\n\t\t{\n\t\t\tconst internalizedValue = this.#internalizeExternalAccessRightsValue(externalValue);\n\n\t\t\tif (internalizedGroup.accessRights.has(internalizedValue.id))\n\t\t\t{\n\t\t\t\tfor (const previousValue of internalizedGroup.accessRights.get(internalizedValue.id).values)\n\t\t\t\t{\n\t\t\t\t\tinternalizedValue.values.add(previousValue);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tinternalizedGroup.accessRights.set(internalizedValue.id, internalizedValue);\n\t\t}\n\n\t\tfor (const [accessCode: string, externalMember: ExternalMember] of Object.entries(externalGroup.members))\n\t\t{\n\t\t\tconst internalizedAccessCode = this.#internalizeExternalAccessCode(accessCode);\n\n\t\t\tinternalizedGroup.members.set(internalizedAccessCode, this.#internalizeExternalMember(externalMember));\n\t\t}\n\n\t\treturn internalizedGroup;\n\t}\n\n\t#internalizeExternalAccessRightsValue(externalAccessRightsValue: ExternalAccessRightValue): AccessRightValue\n\t{\n\t\tconst valueId = String(externalAccessRightsValue.id);\n\n\t\tconst internalized: AccessRightValue = {\n\t\t\tid: valueId,\n\t\t\tisModified: false,\n\t\t};\n\n\t\tconst values: Array<any> = Type.isArray(externalAccessRightsValue.value)\n\t\t\t? externalAccessRightsValue.value\n\t\t\t: [externalAccessRightsValue.value];\n\n\t\tinternalized.values = new Set(values.map((x) => String(x)));\n\n\t\treturn internalized;\n\t}\n\n\t#internalizeExternalAccessCode(accessCode: any): string\n\t{\n\t\tlet stringAccessCode = String(accessCode);\n\n\t\tif (/^IU(\\d+)$/.test(stringAccessCode))\n\t\t{\n\t\t\t// `IU` and `U` are basically the same in this extension. differentiation between them is not supported\n\t\t\t// for data consistency, force `U`\n\t\t\tstringAccessCode = stringAccessCode.replace('IU', 'U');\n\t\t}\n\n\t\treturn stringAccessCode;\n\t}\n\n\t#internalizeExternalMember(externalMember: ExternalMember): Member\n\t{\n\t\treturn {\n\t\t\tid: String(externalMember.id),\n\t\t\ttype: Type.isStringFilled(externalMember.type) ? externalMember.type : null,\n\t\t\tname: Type.isStringFilled(externalMember.name) ? externalMember.name : null,\n\t\t\tavatar: Type.isStringFilled(externalMember.avatar) ? externalMember.avatar : null,\n\t\t};\n\t}\n}\n","import { Type } from 'main.core';\nimport { SELECTED_ALL_USER_ID } from '../user-groups-model';\nimport type { UserGroupsCollection } from '../user-groups-model';\nimport type { Transformer } from './transformer';\n\nexport class ShownUserGroupsCopier implements Transformer<UserGroupsCollection, UserGroupsCollection>\n{\n\t#srcUserGroups: UserGroupsCollection;\n\t#maxVisibleUserGroups: ?number = null;\n\t#sortConfig: Record<string, Record<string, number>>;\n\n\tconstructor(srcUserGroups: UserGroupsCollection, maxVisibleUserGroups: ?number, sortConfig: Record<string, Record<string, number>>)\n\t{\n\t\tthis.#srcUserGroups = srcUserGroups;\n\t\tif (Type.isInteger(maxVisibleUserGroups))\n\t\t{\n\t\t\tthis.#maxVisibleUserGroups = maxVisibleUserGroups;\n\t\t}\n\t\tthis.#sortConfig = sortConfig;\n\t}\n\n\t/**\n\t * WARNING! Mutates `externalSource`. Src is not copied for perf reasons, since we don't need it functionally\n\t */\n\ttransform(externalSource: UserGroupsCollection): UserGroupsCollection\n\t{\n\t\tfor (const [userGroupId, userGroup] of externalSource)\n\t\t{\n\t\t\tconst srcUserGroup = this.#srcUserGroups.get(userGroupId);\n\t\t\tif (!srcUserGroup)\n\t\t\t{\n\t\t\t\t// likely it's a just created user group\n\t\t\t\tthis.#addUserGroupInSortConfig(userGroup);\n\t\t\t}\n\t\t}\n\n\t\treturn externalSource;\n\t}\n\n\t#addUserGroupInSortConfig(userGroup)\n\t{\n\t\tconst updateUserSortConfig = (userId) => {\n\t\t\tif (!this.#sortConfig[userId])\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst values = Object.values(this.#sortConfig[userId]);\n\t\t\tconst maxSortValue = values.length > 0 ? Math.max(...values) : 0;\n\t\t\tthis.#sortConfig[userId][userGroup.id] = maxSortValue + 1;\n\t\t};\n\n\t\tfor (const [memberId] of userGroup.members)\n\t\t{\n\t\t\tupdateUserSortConfig(memberId);\n\t\t}\n\t\tupdateUserSortConfig(SELECTED_ALL_USER_ID);\n\t}\n\n\tgetSortConfig(): Record<string, Record<string, number>>\n\t{\n\t\treturn this.#sortConfig;\n\t}\n}\n","import { ajax as Ajax, type AjaxResponse, Dom, type JsonObject, Loc, Runtime, Text, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Button, ButtonColor, ButtonSize, CancelButton } from 'ui.buttons';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport { BitrixVue, type VueCreateAppResult } from 'ui.vue3';\nimport type { Store } from 'ui.vue3.vuex';\nimport { Grid } from './components/grid';\nimport 'ui.notification';\nimport { AnalyticsManager } from './integration/analytics-manager';\nimport { createStore } from './store/index';\nimport type { Options } from './store/model/application-model';\nimport { AccessRightsExporter } from './store/model/transformation/backend-exporter/access-rights-exporter';\nimport { AllUserGroupsExporter } from './store/model/transformation/backend-exporter/user-groups/all-user-groups-exporter';\nimport { OnlyChangedUserGroupsExporter } from './store/model/transformation/backend-exporter/user-groups/only-changed-user-groups-exporter';\nimport type { ExternalAccessRightSection } from './store/model/transformation/internalizer/access-rights-internalizer';\nimport { AccessRightsInternalizer } from './store/model/transformation/internalizer/access-rights-internalizer';\nimport { ApplicationInternalizer } from './store/model/transformation/internalizer/application-internalizer';\nimport type { ExternalUserGroup } from './store/model/transformation/internalizer/user-groups-internalizer';\nimport { UserGroupsInternalizer } from './store/model/transformation/internalizer/user-groups-internalizer';\nimport { ShownUserGroupsCopier } from './store/model/transformation/shown-user-groups-copier';\nimport { SELECTED_ALL_USER_ID, SelectedMember } from './store/model/user-groups-model';\nimport type { AccessRightsModel } from './store/model/access-rights-model';\nimport { Loader } from 'main.loader';\nimport { saveSortConfigForAllUserGroups } from './utils';\nimport type { UserGroupsCollection, UserGroupsModel } from './store/model/user-groups-model';\n\nexport type AppConstructOptions = Options & {\n\trenderTo?: HTMLElement;\n\trenderToContainerId?: string;\n\tuserGroups: ExternalUserGroup[];\n\taccessRights: ExternalAccessRightSection[];\n\tsortConfigForAllUserGroups: Object;\n\tuserSortConfigName: string;\n\tselectedMember: Object;\n};\n\ntype SaveAjaxResponse = AjaxResponse<{ USER_GROUPS: JsonObject, ACCESS_RIGHTS: ?JsonObject }>;\n\n/**\n * @memberOf BX.UI.AccessRights.V2\n */\nexport class App\n{\n\t#options: AppConstructOptions = {};\n\t#renderTo: HTMLElement;\n\t#buttonPanel: BX.UI.ButtonPanel;\n\n\t#guid: string;\n\t#isUserConfirmedClose: boolean = false;\n\n\t#handleSliderClose: (BaseEvent<BX.SidePanel.Event[]>) => void;\n\n\t#app: VueCreateAppResult;\n\t#rootComponent: Element;\n\t#store: Store;\n\t#resetState: () => void;\n\t#unwatch: () => void;\n\t#userGroupsModel: UserGroupsModel;\n\t#accessRightsModel: AccessRightsModel;\n\t#analyticsManager: AnalyticsManager;\n\t#selectedMember: Object;\n\t#sortConfigForAllUserGroups: ?Record<string, number>;\n\t#confirmationPopup: MessageBox | null = null;\n\n\tconstructor(options: AppConstructOptions)\n\t{\n\t\tthis.#options = options || {};\n\t\tthis.#renderTo = this.#getRenderTo();\n\t\tthis.#buttonPanel = BX.UI.ButtonPanel || null;\n\t\tthis.#sortConfigForAllUserGroups = options.sortConfigForAllUserGroups;\n\t\tthis.#selectedMember = options.selectedMember;\n\t\tthis.#options.userSortConfigName = options.userSortConfigName ?? options.component;\n\n\t\tthis.#guid = Text.getRandom(16);\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#getRenderTo(): ?HTMLElement\n\t{\n\t\tif (Type.isElementNode(this.#options.renderTo))\n\t\t{\n\t\t\treturn this.#options.renderTo;\n\t\t}\n\n\t\treturn document.getElementById(this.#options.renderToContainerId);\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tthis.#handleSliderClose = (event: BaseEvent<BX.SidePanel.Event[]>): void => {\n\t\t\tconst [sliderEvent] = event.getData();\n\n\t\t\tconst isSliderBelongsToThisApp = BX.SidePanel?.Instance?.getSliderByWindow(window) === sliderEvent?.getSlider();\n\n\t\t\tif (!isSliderBelongsToThisApp)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.#confirmBeforeClosingModifiedSlider(sliderEvent);\n\t\t};\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onClose', this.#handleSliderClose);\n\t}\n\n\t#unbindEvents(): void\n\t{\n\t\tEventEmitter.unsubscribe('SidePanel.Slider:onClose', this.#handleSliderClose);\n\n\t\tthis.#handleSliderClose = null;\n\t}\n\n\tfireEventReset(): void\n\t{\n\t\tconst box = MessageBox.create({\n\t\t\tmessage: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_MODIFIED_CANCEL_WARNING'),\n\t\t\tmodal: true,\n\t\t\tbuttons: [\n\t\t\t\tnew Button({\n\t\t\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\t\ttext: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_MODIFIED_CANCEL_YES_CANCEL'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.#analyticsManager.onCancelChanges();\n\t\t\t\t\t\tthis.#resetState();\n\t\t\t\t\t\tbox.close();\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tnew Button({\n\t\t\t\t\tcolor: ButtonColor.LINK,\n\t\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\t\ttext: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_MODIFIED_CANCEL_NO_CANCEL'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tbox.close();\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\n\t\tbox.show();\n\t}\n\n\t#tryShowFeaturePromoter(response: SaveAjaxResponse): boolean\n\t{\n\t\tif (!Type.isArrayFilled(response?.errors))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (const error of response.errors)\n\t\t{\n\t\t\tif (Type.isStringFilled(error?.customData?.sliderCode))\n\t\t\t{\n\t\t\t\tRuntime.loadExtension('ui.info-helper').then(({ FeaturePromotersRegistry }) => {\n\t\t\t\t\t/** @see BX.UI.FeaturePromotersRegistry */\n\t\t\t\t\tFeaturePromotersRegistry.getPromoter({ code: error.customData.sliderCode }).show();\n\t\t\t\t}).catch((loadError) => {\n\t\t\t\t\tconsole.error('ui.accessrights.v2: could not load ui.info-helper', loadError);\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t#showNotification(title): void\n\t{\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: title,\n\t\t\tposition: 'top-right',\n\t\t\tautoHideDelay: 3000,\n\t\t});\n\t}\n\n\tsendActionRequest(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (this.#store.state.application.isProgress || !this.#store.getters['application/isModified'])\n\t\t\t{\n\t\t\t\tresolve();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.#store.commit('application/setProgress', true);\n\n\t\t\tthis.#runSaveAjaxRequest()\n\t\t\t\t.then(({ userGroups, accessRights, sortConfig }) => {\n\t\t\t\t\tthis.#analyticsManager.onSaveSuccess();\n\t\t\t\t\tthis.#userGroupsModel.setInitialUserGroups(userGroups)\n\t\t\t\t\t\t.setSortConfig(sortConfig)\n\t\t\t\t\t\t.setSelectedMember(this.getSelectedMember());\n\t\t\t\t\tif (accessRights)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#accessRightsModel.setInitialAccessRights(accessRights);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst guid: string = this.#guid;\n\t\t\t\t\tEventEmitter.emit('BX.UI.AccessRights.V2:afterSave', { userGroups, accessRights, guid });\n\n\t\t\t\t\t// reset modification flags and stuff\n\t\t\t\t\tthis.#resetState();\n\t\t\t\t\tthis.#saveUserSortConfig(sortConfig[SELECTED_ALL_USER_ID]);\n\n\t\t\t\t\tthis.#showNotification(Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SETTINGS_HAVE_BEEN_SAVED'));\n\t\t\t\t})\n\t\t\t\t.catch((response: SaveAjaxResponse) => {\n\t\t\t\t\tthis.#analyticsManager.onSaveError(response);\n\n\t\t\t\t\tconsole.warn('ui.accessrights.v2: error during save', response);\n\n\t\t\t\t\tif (this.#tryShowFeaturePromoter(response))\n\t\t\t\t\t{\n\t\t\t\t\t\treject(response);\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.#showNotification(response?.errors?.[0]?.message || 'Something went wrong');\n\t\t\t\t\tEventEmitter.emit('ui:accessRights:v2:onSaveError', { response });\n\n\t\t\t\t\treject(response);\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tconst waitContainer = this.#buttonPanel?.getContainer().querySelector('.ui-btn-wait');\n\t\t\t\t\tDom.removeClass(waitContainer, 'ui-btn-wait');\n\t\t\t\t\tthis.#store.commit('application/setProgress', false);\n\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t});\n\t}\n\n\t#saveUserSortConfig(userSortConfig): Promise\n\t{\n\t\tif (!Type.isObject(userSortConfig))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst userGroups = this.#store.state.userGroups.collection;\n\t\tconst validUserSortConfig = {};\n\n\t\tfor (const [groupId, sortValue] of Object.entries(userSortConfig))\n\t\t{\n\t\t\tif (userGroups.has(groupId))\n\t\t\t{\n\t\t\t\tvalidUserSortConfig[groupId] = sortValue;\n\t\t\t}\n\t\t}\n\n\t\tthis.#sortConfigForAllUserGroups = validUserSortConfig;\n\n\t\treturn saveSortConfigForAllUserGroups(this.#options.userSortConfigName, this.#sortConfigForAllUserGroups);\n\t}\n\n\t#runSaveAjaxRequest(): Promise<{ userGroups: UserGroupsCollection }>\n\t{\n\t\tconst internalUserGroups = this.#store.state.userGroups.collection;\n\n\t\tlet userGroups = null;\n\t\tif (this.#store.state.application.options.isSaveOnlyChangedRights)\n\t\t{\n\t\t\tuserGroups = (new OnlyChangedUserGroupsExporter()).transform(internalUserGroups);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tuserGroups = (new AllUserGroupsExporter()).transform(internalUserGroups);\n\t\t}\n\n\t\tconst bodyType = this.#store.state.application.options.bodyType;\n\n\t\tlet accessRights = null;\n\t\tlet deletedAccessRights = null;\n\t\tif (this.#store.state.application.options.isSaveAccessRightsList)\n\t\t{\n\t\t\taccessRights = (new AccessRightsExporter()).transform(\n\t\t\t\tthis.#store.state.accessRights.collection,\n\t\t\t\tthis.#guid,\n\t\t\t);\n\t\t\tdeletedAccessRights = [...this.#store.state.accessRights.deleted.values()];\n\t\t}\n\n\t\t// wrap ajax in native promise\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tAjax.runComponentAction(\n\t\t\t\tthis.#store.state.application.options.component,\n\t\t\t\tthis.#store.state.application.options.actionSave,\n\t\t\t\t{\n\t\t\t\t\tmode: this.#store.state.application.options.mode,\n\t\t\t\t\t[bodyType]: {\n\t\t\t\t\t\tuserGroups,\n\t\t\t\t\t\tdeletedUserGroups: [...this.#store.state.userGroups.deleted.values()],\n\t\t\t\t\t\tparameters: this.#store.state.application.options.additionalSaveParams,\n\t\t\t\t\t\taccessRights,\n\t\t\t\t\t\tdeletedAccessRights,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t)\n\t\t\t\t.then((response: SaveAjaxResponse) => {\n\t\t\t\t\tconst maxVisibleUserGroups = this.#store.state.application.options.maxVisibleUserGroups;\n\t\t\t\t\tconst sortConfig = this.#store.state.userGroups.sortConfig;\n\n\t\t\t\t\tconst newUserGroups = (new UserGroupsInternalizer(maxVisibleUserGroups))\n\t\t\t\t\t\t.transform(response.data.USER_GROUPS)\n\t\t\t\t\t;\n\n\t\t\t\t\tconst transformer = new ShownUserGroupsCopier(internalUserGroups, maxVisibleUserGroups, sortConfig);\n\t\t\t\t\ttransformer.transform(newUserGroups);\n\t\t\t\t\tconst newSortConfig = transformer.getSortConfig();\n\n\t\t\t\t\tlet newAccessRights = null;\n\t\t\t\t\tif (response.data.ACCESS_RIGHTS)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewAccessRights = (new AccessRightsInternalizer()).transform(response.data.ACCESS_RIGHTS);\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve({\n\t\t\t\t\t\tuserGroups: newUserGroups,\n\t\t\t\t\t\tsortConfig: newSortConfig,\n\t\t\t\t\t\taccessRights: newAccessRights,\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch(reject)\n\t\t\t;\n\t\t});\n\t}\n\n\t#confirmBeforeClosingModifiedSlider(sliderEvent: BX.SidePanel.Event): void\n\t{\n\t\tif (!this.#store.getters['application/isModified'] || this.#isUserConfirmedClose)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsliderEvent.denyAction();\n\n\t\tif (this.#confirmationPopup && this.#confirmationPopup.getPopupWindow().isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#confirmationPopup = MessageBox.create({\n\t\t\tmediumButtonSize: false,\n\t\t\ttitle: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_MODIFIED_CLOSE_WARNING_TITLE'),\n\t\t\tmessage: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_MODIFIED_CLOSE_WARNING'),\n\t\t\tmodal: true,\n\t\t\tbuttons: [\n\t\t\t\tnew Button({\n\t\t\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\t\ttext: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_MODIFIED_CLOSE_YES_CLOSE'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.#analyticsManager.onCloseWithoutSave();\n\t\t\t\t\t\tthis.#isUserConfirmedClose = true;\n\t\t\t\t\t\tthis.#confirmationPopup.close();\n\t\t\t\t\t\tthis.#confirmationPopup = null;\n\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tsliderEvent.getSlider().close();\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tnew CancelButton({\n\t\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\t\ttext: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_CANCEL'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.#confirmationPopup.close();\n\t\t\t\t\t\tthis.#confirmationPopup = null;\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t],\n\t\t\tpopupOptions: {\n\t\t\t\tfixed: true,\n\t\t\t},\n\t\t});\n\n\t\tthis.#confirmationPopup.show();\n\t}\n\n\t#getSortConfigForAllUserGroups(): Promise\n\t{\n\t\tif (this.#sortConfigForAllUserGroups)\n\t\t{\n\t\t\treturn Promise.resolve(this.#sortConfigForAllUserGroups);\n\t\t}\n\n\t\treturn new Promise((resolve) => {\n\t\t\tAjax.runAction('ui.accessrights.getUserSortConfig', {\n\t\t\t\tdata: {\n\t\t\t\t\tname: this.#options.userSortConfigName,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((response) => resolve(response.data ? { ...response.data } : null))\n\t\t\t\t.catch(() => resolve(null));\n\t\t});\n\t}\n\n\tdraw(): void\n\t{\n\t\tconst loader = new Loader({\n\t\t\ttarget: this.#renderTo,\n\t\t});\n\t\tloader.show();\n\t\tthis.#getSortConfigForAllUserGroups()\n\t\t\t.then((result) => {\n\t\t\t\tthis.#sortConfigForAllUserGroups = result;\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tthis.#sortConfigForAllUserGroups = null;\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tconst applicationOptions = (new ApplicationInternalizer()).transform(this.#options);\n\t\t\t\tconst userGroupsOptions = {\n\t\t\t\t\tsortConfig: {},\n\t\t\t\t\tselectedMember: this.#selectedMember,\n\t\t\t\t};\n\t\t\t\tif (Type.isObject(this.#sortConfigForAllUserGroups))\n\t\t\t\t{\n\t\t\t\t\tuserGroupsOptions.sortConfig[SELECTED_ALL_USER_ID] = this.#sortConfigForAllUserGroups;\n\t\t\t\t}\n\n\t\t\t\tconst { store, resetState, userGroupsModel, accessRightsModel } = createStore(\n\t\t\t\t\tapplicationOptions,\n\t\t\t\t\t(new UserGroupsInternalizer(applicationOptions.maxVisibleUserGroups)).transform(this.#options.userGroups),\n\t\t\t\t\t(new AccessRightsInternalizer()).transform(this.#options.accessRights),\n\t\t\t\t\tthis.#guid,\n\t\t\t\t\tuserGroupsOptions,\n\t\t\t\t);\n\n\t\t\t\tthis.#store = store;\n\t\t\t\tthis.#resetState = resetState;\n\t\t\t\tthis.#userGroupsModel = userGroupsModel;\n\t\t\t\tthis.#accessRightsModel = accessRightsModel;\n\n\t\t\t\tthis.#unwatch = this.#store.watch(\n\t\t\t\t\t(state, getters) => getters['application/isModified'],\n\t\t\t\t\t(newValue) => {\n\t\t\t\t\t\tif (newValue)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.#buttonPanel?.show();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.#buttonPanel?.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\tthis.#app = BitrixVue.createApp(Grid);\n\t\t\t\tthis.#app.use(this.#store);\n\n\t\t\t\tloader.hide();\n\t\t\t\tDom.clean(this.#renderTo);\n\t\t\t\tthis.#rootComponent = this.#app.mount(this.#renderTo);\n\t\t\t\tthis.#analyticsManager = new AnalyticsManager(this.#store, this.#options.analytics);\n\t\t\t});\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.#analyticsManager = null;\n\n\t\tthis.#app.unmount();\n\t\tthis.#app = null;\n\n\t\tthis.#unbindEvents();\n\n\t\tthis.#unwatch();\n\t\tthis.#unwatch = null;\n\n\t\tthis.#store = null;\n\t\tthis.#resetState = null;\n\t\tthis.#userGroupsModel = null;\n\t\tthis.#options = null;\n\t\tthis.#buttonPanel = null;\n\n\t\tDom.clean(this.#renderTo);\n\t\tthis.#renderTo = null;\n\n\t\tif (this.#confirmationPopup)\n\t\t{\n\t\t\tthis.#confirmationPopup.close();\n\t\t\tthis.#confirmationPopup.getPopupWindow().destroy();\n\t\t\tthis.#confirmationPopup = null;\n\t\t}\n\t}\n\n\thasUnsavedChanges(): boolean\n\t{\n\t\treturn !(!this.#store.getters['application/isModified'] || this.#isUserConfirmedClose);\n\t}\n\n\tscrollToSection(sectionCode)\n\t{\n\t\tthis.#rootComponent.scrollToSection(sectionCode);\n\t}\n\n\tgetSelectedMember(): SelectedMember\n\t{\n\t\treturn this.#store.state.userGroups.selectedMember;\n\t}\n\n\tgetGuid(): string\n\t{\n\t\treturn this.#guid;\n\t}\n}\n"],"names":["Base","getComponentName","Error","getEmptyValue","item","emptyValue","Set","getMinValue","Type","isNil","minValue","getMaxValue","maxValue","isRowValueConfigurable","DependentVariables","Multivariables","Toggler","isFalsy","explicit","isNull","Variables","EntitySelectorContext","Object","freeze","ROLE","MEMBER","VARIABLE","USER","EntitySelectorEntities","STRUCTURE_NODE_ENTITY_TYPE","TEAM","DEPARTMENT","STRUCTURE_NODE_ENTITY_TYPE_INFO","commonPrefix","recursivePrefix","memberType","SelectorService","constructor","options","createDialog","dialogOptions","Dialog","context","enableSearch","alwaysShowLabels","cacheable","entities","id","intranetUsersOnly","emailUsers","inviteEmployeeLink","inviteGuestLink","includedNodeEntityTypes","useStructureDepartmentsProviderTab","push","addStructureTeamsProviderTab","length","selectMode","allowSelectRootDepartment","allowFlatDepartments","useMultipleTabs","visual","avatarMode","tagStyle","dynamicLoad","dynamicSearch","addStructureRolesProviderTab","addProjectsProviderTab","addUserGroupsProviderTab","getItemIdByAccessCode","accessCode","test","match","userId","departmentId","groupId","at","structureNodeId","getMemberTypeByItem","entityId","getItemStructureNodeEntityTypeInfo","defaultNodeEntityType","availableNodeEntityTypes","values","itemNodeEntityType","getCustomData","get","includes","entries","forEach","nodeEntityType","info","startsWith","getAccessCodeByItem","isString","endsWith","originalId","prefix","getItemIdsByAccessCodes","accessCodes","map","Map","set","getMemberByItem","type","name","title","text","avatar","isStringFilled","ServiceLocator","getHint","appGuid","remember","BX","UI","Hint","createInstance","classNameIcon","popupParameters","className","autoHide","darkMode","maxWidth","offsetTop","offsetLeft","angle","animation","getValueTypeByRight","right","getValueType","stringType","String","console","warn","getSelectorService","memberOptions","Cache","MemoryCache","Selector","emits","props","userGroup","required","bindNode","HTMLElement","computed","selectedItems","result","members","keys","mapState","state","application","additionalMembersParams","mounted","targetNode","preselectedItems","events","onHide","show","methods","event","dialog","getTarget","$store","dispatch","userGroupId","$emit","getMemberFromEvent","getData","template","SingleMember","member","avatarBackgroundImage","encodeURI","noAvatarClass","memberTitle","MAX_SHOWN_MEMBERS","Members","components","data","isSelectorShown","isSelectedMembersPopupShown","popup","shownMembers","size","shownKeyValuePairs","slice","notShownMembersCount","$refs","container","RoleHeading","RichMenuPopup","RichMenuItem","isEdit","isPopupShown","RichMenuItemIcon","isProgress","guid","maxVisibleUserGroups","mapGetters","isMaxVisibleUserGroupsReached","isMaxValueSetForAny","isMinValueSetForAny","watch","newValue","bindClickedOutsideHandler","$nextTick","input","scrollIntoView","behavior","block","inline","focus","select","unbindClickedOutsideHandler","isNew","beforeUnmount","Event","bind","window","turnOffEditWhenClickedOutside","capture","unbind","target","showDeleteConfirmation","Popup","bindElement","width","overlay","contentPadding","content","$Bitrix","Loc","getMessage","buttons","Button","ButtonSize","SMALL","color","ButtonColor","PRIMARY","click","destroy","CancelButton","showActionsMenu","onSetMaxValuesClick","onSetMinValuesClick","onEnableEditClick","onCopyRoleClick","onDeleteRoleClick","ItemsMapper","mapUserGroups","userGroups","supertitle","tabs","mapVariables","variables","items","variable","Runtime","clone","NEW_USER_GROUP_ID_PREFIX","SELECTED_ALL_USER_ID","UserGroupsModel","BuilderModel","getName","setInitialUserGroups","groups","setSortConfig","sortConfig","setSelectedMember","selectedMember","getState","collection","deleted","getElementState","params","Text","getRandom","isModified","accessRights","getGetters","shown","getters","rootState","selectedMemberId","sortedGroups","filter","sort","idA","idB","Infinity","userGroupsBySelectedMember","getEmptyAccessRightValue","rootGetters","sectionCode","valueId","defaultAccessRightValues","section","rightId","rights","defaultValue","value","getActions","setAccessRightValues","store","payload","setAccessRightValuesForShown","setMinAccessRightValues","setMaxAccessRightValues","setMinAccessRightValuesInSection","setMaxAccessRightValuesInSection","setMinAccessRightValuesForRight","setMaxAccessRightValuesForRight","setRoleTitle","addMember","removeMember","updateMembersForUserGroup","copyUserGroup","copySectionValues","addUserGroup","removeUserGroup","updateUserGroupSort","updateSortConfigForSelectedMember","updateSortConfig","deleteRight","selectMember","getMutations","accessRightValue","delete","memberCollection","markUserGroupForDeletion","add","sortConfigForSelectedMember","role","some","code","has","isSet","commit","root","valueToSet","setEmpty","isBoolean","setEmptyOnSetMinMaxValueInColumn","src","srcUserGroupId","dstUserGroupId","sourceGroup","emptyGroup","copy","updatedSortConfig","newGroup","currentSorting","userIdsToUpdate","newSortConfig","currentValues","Math","max","group","Boolean","config","every","isNumber","userConfig","isObject","isArray","initialGroup","initialValues","a","b","isFunction","symmetricDifference","initialAccessCodes","currentAccessCodes","shouldRowBeRendered","accessRightItem","isShown","isGroupExpanded","getSelectedVariables","selected","isAllSelected","selectedVariables","variableId","getMultipleSelectedVariablesTitle","lastVariable","pop","cutLongTitle","VARIABLE_TITLE_MAX_LENGTH","getMultipleSelectedVariablesHintHtml","hintTitle","allVariables","listItems","makeSortedVariablesArray","encode","toSort","example","orderMap","index","indexA","indexB","DEFAULT_ALIAS_SEPARATOR","parseAliasKey","key","separator","parts","split","compileAliasKey","sortedParts","join","normalizeAliasKey","parsed","saveSortConfigForAllUserGroups","categoryName","Ajax","runAction","userSortConfig","CellLayout","ColumnLayout","RolesControl","viewDialog","allUserGroups","userSortConfigName","isMaxVisibleUserGroupsSet","shownGroupsCounter","copyDialogItems","viewDialogItems","copyDialogItem","onCreateNewRoleClick","onRoleViewClick","showViewDialog","configure","showCopyDialog","copyDialog","multiple","dropdownMode","dialogEvent","getId","ItemListSelector","subtitle","getMessagePlural","maxSelected","onSave","getSelectedItems","toggleViewDialog","hide","isMaxListenersSet","lastScrollLeft","SyncHorizontalScroll","componentGuid","throttledEmitScrollEvent","created","requestAnimationFrameThrottle","emitScrollEvent","sectionsNumber","eventEmitter","incrementMaxListeners","subscribe","handleScrollEvent","syncScroll","unsubscribe","scrollLeft","emit","$el","func","callbackSet","invoke","wrapper","args","q","requestAnimationFrame","Header","directives","hint","SearchBox","debouncedSetSearchQuery","setSearchQuery","query","debounce","searchQuery","MemberSelector","Chip","accessCodesCache","selectedMemberName","selectedMemberAvatar","entityType","openUserSelector","userSelector","hideOnSelect","hideOnDeselect","onMemberSelect","onMemberDeselect","getEntities","cacheKey","newSelectedMember","cachedAccessCodes","getAccessCodesFromCache","shouldUseAjax","getDefaultAccessCodesByItem","additionalSaveParams","moduleId","then","response","catch","entityTypes","itemId","AccessRightsInternalizer","transform","externalSource","external","internalized","internalizeExternalItem","externalItem","aliases","selectedVariablesAliases","normalizedItem","groupHead","nothingSelectedValue","isMap","allSelectedCode","selectedVariablesAliasesSeparator","showAvatars","compactView","dependentVariablesPopupHint","iconClass","isClickable","isDeletable","normalizedVariable","externalSection","internalizedSection","sectionTitle","sectionSubTitle","sectionHint","sectionIcon","isExpanded","action","internalizedItem","externalIcon","bgColor","externalSectionAction","buttonText","externalAliases","isPlainObject","Array","from","boolOrNull","x","isUndefined","setEmptyOnGroupActions","externalVariable","avatarOptions","conflictsWith","requires","secondary","AccessRightsModel","setInitialAccessRights","isMinValueSet","isMaxValueSet","getNothingSelectedValue","getSelectedVariablesAlias","rightItem","toggleSection","expandAllSections","collapseAllSections","toggleGroup","search","addRight","internalRight","updateRightTitle","rightTitle","updateRightSubtitle","rightSubtitle","markRightAsModified","setRightTitle","setRightSubtitle","expandSection","collapseSection","expandGroup","showItem","showGroup","showSection","showAll","hideAll","lowerQuery","toLowerCase","MenuCell","inject","isMenuShown","menuPopupOptions","icon","floor","shownUserGroupsWithoutCurrent","shownWithoutCurrent","applyDialogItems","toggleMenu","showApplyDialog","applyDialog","setMaxValuesInSection","setMinValuesInSection","Icon","iconBgColor","Locator","SectionIcon","Number","default","rightOrGroupTitle","MasterSwitcher","Switcher","isChecked","switcherOptions","SingleRoleTitle","userGroupTitle","PopupHeader","isMinMaxValuesSet","isSelectedAnythingBesidesMin","setMin","setMax","PopupContent","notSavedValues","getNotSavedValues","variablesShownInList","variablesWithoutMinAndSecondary","secondaryVariables","nothingSelectedValues","secondarySwitcherOptions","iconSet","IconSet","redefineApply","apply","addValue","requiredId","conflictId","otherVariable","removeValue","otherVariableId","setMaxValue","setMinValue","getVariableHintOptions","popupOptions","bindOptions","position","offset","AllRolesTitle","ValuePopup","provide","onApply","closeEsc","minWidth","padding","applyButton","ApplyButton","onclick","renderTo","cancelButton","Footer","DefaultFooter","selectAllButton","Tag","render","Dom","deselectAllButton","getDialog","getContent","getItems","deselect","BaseHeader","app","BitrixVue","createApp","getWidth","getOption","mount","dialogItems","selectedDialogItems","showSelector","height","hideByEsc","searchOptions","allowCreateItem","onItemSelect","onItemDeselect","onDestroy","header","headerOptions","footer","addedItem","removedItem","newValues","setValues","allVariablesIds","allVariablesIdsWithoutRemoved","candidate","setNothingSelectedValueIfNeeded","nothingSelected","nothing","close","POPUP_ID","closeSelector","menuItems","innerEvent","getMenuWindow","setValue","MenuManager","onClose","getMenuById","SelectedHint","html","isRendered","currentAlias","hintHtml","emptyVariableId","currentVariableId","firstItem","currentVariableTitle","Cells","DependentVariablesCell","MultivariablesCell","TogglerCell","VariablesCell","Rows","DependentVariablesRow","MultivariablesRow","VariablesRow","getValueComponent","ValueCell","cellComponent","Column","renderedRights","ColumnList","throttledScrollHandler","throttledResizeHandler","ears","isEarsInited","isLeftShadowShown","isRightShadowShown","throttle","adjustShadowsVisibility","adjustEars","initEars","destroyEars","oldValue","calculateShadowsVisibility","offsetWidth","scrollWidth","round","toggleEars","Ears","immediateInit","smallSize","init","style","getWrapper","renderHint","clean","hintIconWrapper","setAttribute","append","getHintManager","initNode","onSectionEventButtonClick","eventData","EventEmitter","RowValue","component","TitleCell","isRowValueShown","isRightDeletable","rightCellStyle","setMaxValuesForRight","setMinValuesForRight","openRowValue","onRightClick","TitleColumn","Section","subTitle","GridSkeleton","Grid","loader","searchContainerSelector","shownSections","initOwnerDocument","scrollToSection","sections","find","scrollTo","top","getPosition","AnalyticsManager","analyticsData","hasOwn","onSaveSuccess","createdRoles","editedRoles","deletedRoles","i","onSaveError","status","onCancelChanges","sendData","onCloseWithoutSave","isArrayFilled","errors","error","toCamelCase","pName","ACTION_SAVE","MODE","BODY_TYPE","ApplicationModel","setOptions","setGuid","setProgress","createStore","userGroupsOption","userGroupsModel","create","accessRightsModel","Builder","addModel","syncBuild","resetState","clearState","AccessRightsExporter","source","accessRightSection","accessRight","additionalRightData","eventResults","eventResult","BaseUserGroupsExporter","shouldBeIncludedInExport","singleValue","AllUserGroupsExporter","OnlyChangedUserGroupsExporter","ApplicationInternalizer","actionSave","mode","bodyType","isSaveOnlyChangedRights","isInteger","isSaveAccessRightsList","UserGroupsInternalizer","externalGroup","internalGroup","internalizedGroup","externalValue","internalizedValue","previousValue","externalMember","internalizedAccessCode","externalAccessRightsValue","stringAccessCode","replace","ShownUserGroupsCopier","srcUserGroups","srcUserGroup","getSortConfig","updateUserSortConfig","maxSortValue","memberId","App","ButtonPanel","sortConfigForAllUserGroups","fireEventReset","box","MessageBox","message","modal","LINK","sendActionRequest","Promise","resolve","reject","getSelectedMember","finally","waitContainer","getContainer","querySelector","removeClass","draw","Loader","applicationOptions","userGroupsOptions","use","analytics","unmount","getPopupWindow","hasUnsavedChanges","getGuid","isElementNode","document","getElementById","renderToContainerId","sliderEvent","isSliderBelongsToThisApp","SidePanel","Instance","getSliderByWindow","getSlider","customData","sliderCode","loadExtension","FeaturePromotersRegistry","getPromoter","loadError","Notification","Center","notify","autoHideDelay","validUserSortConfig","sortValue","internalUserGroups","deletedAccessRights","runComponentAction","deletedUserGroups","parameters","newUserGroups","USER_GROUPS","transformer","newAccessRights","ACCESS_RIGHTS","denyAction","mediumButtonSize","setTimeout","fixed"],"mappings":"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"}