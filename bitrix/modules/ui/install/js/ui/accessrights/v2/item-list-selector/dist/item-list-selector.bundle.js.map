{"version":3,"file":"item-list-selector.bundle.js","sources":["../src/components/checkbox.js","../src/components/item.js","../src/components/selector.js","../src/item-list-selector.js"],"sourcesContent":["import { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.actions';\nimport 'ui.icon-set.outline';\nimport 'ui.forms';\n\nexport const Checkbox = {\n\tname: 'Checkbox',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\tstatus: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t\tvalidator: (value) => ['checked', 'indeterminate', 'unchecked'].includes(value),\n\t\t},\n\t},\n\tcomputed: {\n\t\tset(): Outline {\n\t\t\treturn Outline;\n\t\t},\n\t\ticonName(): string {\n\t\t\treturn this.status === 'checked' ? this.set.CHECK_S : this.set.MINUS_S;\n\t\t},\n\t\ticonColor(): string {\n\t\t\treturn this.status === 'checked' ? 'var(--ui-color-bg-content-light)' : 'var(--ui-color-accent-main-primary)';\n\t\t},\n\t},\n\tmethods: {\n\t\thandleClick() {\n\t\t\tthis.$emit('change');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<label\n\t\t  class=\"ui-item-selector__checkbox\"\n\t\t  :class=\"{ \n\t\t    'ui-item-selector__checkbox--active': status === 'checked',\n\t\t    'ui-item-selector__checkbox--indeterminate': status === 'indeterminate'\n\t\t  }\"\n\t\t  @click=\"handleClick\"\n\t\t>\n\t\t  <BIcon\n\t\t    v-if=\"status !== 'unchecked'\"\n\t\t    class=\"ui-item-selector-item__checked-icon\"\n\t\t    :name=\"iconName\"\n\t\t    :color=\"iconColor\"\n\t\t    :size=\"22\"\n\t\t  ></BIcon>\n\t\t</label>\n\t`,\n};\n","import { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport { Checkbox } from './checkbox';\nimport 'ui.icon-set.actions';\nimport 'ui.icon-set.outline';\nimport 'ui.forms';\nimport { hint } from 'ui.vue3.directives.hint';\n\nexport const Item = {\n\tname: 'Item',\n\tcomponents: {\n\t\tBIcon,\n\t\tCheckbox,\n\t},\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisSelected: {\n\t\t\ttype: Boolean,\n\t\t},\n\t\tisDraggable: {\n\t\t\ttype: Boolean,\n\t\t},\n\t\thint: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tdirectives: {\n\t\thint,\n\t},\n\tmethods: {\n\t\thandleClick(event) {\n\t\t\tif (!event.target.closest('.ui-item-selector-item__drag-icon'))\n\t\t\t{\n\t\t\t\tthis.$emit('update:selected', !this.isSelected);\n\t\t\t}\n\t\t},\n\t},\n\tcomputed: {\n\t\tOutline(): Outline {\n\t\t\treturn Outline;\n\t\t},\n\t\tcheckboxStatus(): string {\n\t\t\treturn this.isSelected ? 'checked' : 'unchecked';\n\t\t},\n\t\titemClasses(): Object {\n\t\t\treturn {\n\t\t\t\t'ui-item-selector-item--active': this.isSelected,\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"ui-item-selector-item\"\n\t\t\t:class=\"itemClasses\"\n\t\t\t@click=\"handleClick\"\n\t\t\t:data-id=\"id\"\n\t\t\t:data-selected=\"isSelected\"\n\t\t\tv-hint=\"hint\"\n\t\t>\n\t\t\t<BIcon\n\t\t\t\tclass=\"ui-item-selector-item__drag-icon\"\n\t\t\t\t:class=\"isDraggable ? 'ui-item-selector-item__drag_element' : ''\"\n\t\t\t\t:name=\"Outline.DRAG_M\"\n\t\t\t\t:color=\"isSelected ? 'var(--ui-color-accent-main-primary-alt)' : 'var(--ui-color-g-content-grey-2)'\"\n\t\t\t\t:style=\"{ opacity: isDraggable ? '1' : '0' }\"\n\t\t\t></BIcon>\n\n\t\t\t<span class=\"ui-item-selector-item__title\" :title=\"title\">\n\t\t\t\t{{ title }}\n\t\t\t</span>\n\n\t\t\t<Checkbox\n\t\t\t\t:status=\"checkboxStatus\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Checkbox } from './checkbox';\nimport { Item } from './item';\nimport { Draggable } from 'ui.draganddrop.draggable';\nimport 'ui.icon-set.actions';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\nimport 'ui.forms';\nimport { Type, Text } from 'main.core';\nimport { Chip, ChipDesign } from 'ui.system.chip.vue';\n\nexport const Selector = {\n\tname: 'Selector',\n\tcomponents: {\n\t\tItem,\n\t\tBIcon,\n\t\tCheckbox,\n\t\tChip,\n\t},\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tmaxSelected: {\n\t\t\ttype: Number,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tlocalItems: this.items.map(item => ({ ...item })),\n\t\t\tsearchQuery: '',\n\t\t\tsortDirection: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tselectedCount(): number {\n\t\t\treturn this.localItems.filter((item) => item.selected).length;\n\t\t},\n\t\tfilteredItems(): Array {\n\t\t\tlet items = [...this.itemsBySearchQuery];\n\n\t\t\tif (this.sortDirection)\n\t\t\t{\n\t\t\t\titems.sort((item1, item2) => {\n\t\t\t\t\tif (item1.selected !== item2.selected)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn item1.selected ? -1 : 1;\n\t\t\t\t\t}\n\t\t\t\t\tconst compare = item1.title.localeCompare(item2.title);\n\n\t\t\t\t\treturn this.sortDirection === 'asc' ? compare : -compare;\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\titems.sort((item1, item2) => {\n\t\t\t\t\tif (item1.selected !== item2.selected)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn item1.selected ? -1 : 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isUndefined(item1.sort) && !Type.isUndefined(item2.sort))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst sortCompare = Text.toInteger(item1.sort) - Text.toInteger(item2.sort);\n\t\t\t\t\t\tif (sortCompare !== 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn sortCompare;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.sortDirection)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst titleCompare = item1.title.localeCompare(item2.title);\n\n\t\t\t\t\t\treturn this.sortDirection === 'asc' ? titleCompare : -titleCompare;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn 0;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn items;\n\t\t},\n\t\titemsBySearchQuery(): Array {\n\t\t\tlet items = [...this.localItems];\n\n\t\t\tif (this.searchQuery)\n\t\t\t{\n\t\t\t\tconst query = this.searchQuery.toLowerCase();\n\t\t\t\titems = items.filter((item) => item.title.toLowerCase().includes(query));\n\t\t\t}\n\n\t\t\treturn items;\n\t\t},\n\t\thasActiveItems(): boolean {\n\t\t\treturn this.itemsBySearchQuery.some((item) => item.selected);\n\t\t},\n\t\tallItemsActive(): boolean {\n\t\t\tconst items = this.itemsBySearchQuery;\n\n\t\t\treturn items.length > 0 && items.every((item) => item.selected);\n\t\t},\n\t\ttoggleAllStatus(): string {\n\t\t\treturn this.allItemsActive ? 'checked'\n\t\t\t\t: (this.hasActiveItems ? 'indeterminate' : 'unchecked');\n\t\t},\n\t\tselectionLimitReached(): boolean {\n\t\t\treturn this.selectedCount >= this.maxSelected;\n\t\t},\n\t\tOutline() {\n\t\t\treturn Outline;\n\t\t},\n\t\tChipDesign() {\n\t\t\treturn ChipDesign;\n\t\t},\n\t},\n\tmounted() {\n\t\tthis.initDragAndDrop();\n\t},\n\tmethods: {\n\t\thandleItemSelect(itemId) {\n\t\t\tconst currentItem = this.localItems.find((item) => item.id === itemId);\n\n\t\t\tif (currentItem.selected)\n\t\t\t{\n\t\t\t\tcurrentItem.selected = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!currentItem.selected && this.maxSelected !== null && this.selectionLimitReached)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcurrentItem.selected = true;\n\t\t},\n\t\tinitDragAndDrop() {\n\t\t\t(new Draggable({\n\t\t\t\tcontainer: this.$refs['items-container'].$el,\n\t\t\t\tdraggable: '.ui-item-selector-item',\n\t\t\t\tdragElement: '.ui-item-selector-item__drag_element',\n\t\t\t})).subscribe('end', this.onDragEnd.bind(this));\n\t\t},\n\t\tonDragEnd() {\n\t\t\tconst itemsMap = this.getCurrentOrder();\n\n\t\t\tthis.localItems = this.localItems.map((localItem) => {\n\t\t\t\tconst draggedItem = itemsMap.get(localItem.id);\n\n\t\t\t\treturn draggedItem\n\t\t\t\t\t? { ...localItem, sort: draggedItem.sort }\n\t\t\t\t\t: localItem;\n\t\t\t});\n\t\t},\n\t\ttoggleAllItems() {\n\t\t\tconst shouldActivate = !this.hasActiveItems;\n\n\t\t\tthis.itemsBySearchQuery.forEach((item) => {\n\t\t\t\titem.selected = shouldActivate;\n\t\t\t});\n\t\t},\n\t\ttoggleSort() {\n\t\t\tif (this.sortDirection === 'asc')\n\t\t\t{\n\t\t\t\tthis.sortDirection = 'desc';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.sortDirection = 'asc';\n\t\t\t}\n\t\t},\n\t\tgetCurrentOrder() {\n\t\t\treturn new Map(\n\t\t\t\t[...this.$el.querySelectorAll('.ui-item-selector-item')]\n\t\t\t\t\t.map((itemElement, index) => [\n\t\t\t\t\t\titemElement.dataset.id,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: itemElement.dataset.id,\n\t\t\t\t\t\t\tsort: index + 1,\n\t\t\t\t\t\t\tselected: itemElement.dataset.selected === 'true',\n\t\t\t\t\t\t},\n\t\t\t\t\t]),\n\t\t\t);\n\t\t},\n\t\tgetOrder() {\n\t\t\tthis.searchQuery = '';\n\t\t\tthis.filteredItems.forEach((item, index) => {\n\t\t\t\titem.sort = index;\n\t\t\t});\n\n\t\t\treturn this.filteredItems;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-item-selector\">\n\t\t\t<div class=\"ui-item-selector-controls\">\n\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-w100\">\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tclass=\"ui-ctl-element ui-ctl-textbox ui-item-selector-search__input\"\n\t\t\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('JS_UI_ITEM_SELECTOR_SEARCH_PLACEHOLDER')\"\n\t\t\t\t\t\tv-model=\"searchQuery\"\n\t\t\t\t\t>\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\tclass=\"ui-item-selector-search-icon\"\n\t\t\t\t\t\t:name=\"Outline.SEARCH\"\n\t\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t\tcolor=\"var(--ui-color-base-4)\"\n\t\t\t\t\t></BIcon>\n\t\t\t\t</div>\n\n\t\t\t\t<Chip\n\t\t\t\t\t:icon=\"sortDirection === 'asc' ? Outline.LETTER_SORT_DOWN : Outline.LETTER_SORT_UP\"\n\t\t\t\t\t:design=\"sortDirection ? ChipDesign.OutlineAccent : ChipDesign.Outline\"\n\t\t\t\t\t@click=\"toggleSort\"\n\t\t\t\t/>\n\n\t\t\t\t<Checkbox\n\t\t\t\t\t:status=\"toggleAllStatus\"\n\t\t\t\t\t@change=\"toggleAllItems\"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<TransitionGroup tag=\"div\" name=\"ui-item-selector-items\" class=\"ui-item-selector-items\" ref=\"items-container\">\n\t\t\t\t<Item\n\t\t\t\t\tv-for=\"(item) in filteredItems\"\n\t\t\t\t\t:key=\"item.id\"\n\t\t\t\t\t:id=\"item.id\"\n\t\t\t\t\t:title=\"item.title\"\n\t\t\t\t\t:isSelected=\"item.selected\"\n\t\t\t\t\t:isDraggable=\"!this.searchQuery\"\n\t\t\t\t\t@update:selected=\"handleItemSelect(item.id)\"\n\t\t\t\t/>\n\t\t\t</TransitionGroup>\n\t\t</div>\n\t`,\n};\n","import { Dom, Tag, Type, Text } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { SaveButton, CancelButton, ButtonSize, AirButtonStyle } from 'ui.buttons';\nimport type { VueCreateAppResult } from 'ui.vue3';\nimport { BitrixVue } from 'ui.vue3';\nimport { Selector } from './components/selector';\nimport 'ui.icon-set';\nimport './item-list-selector.css';\nimport { ItemListSelectorOptions, Item } from './item-list-selector-options';\n\nexport class ItemListSelector\n{\n\t#targetNode: HTMLElement;\n\t#content: HTMLElement;\n\t#items: Array<Item>;\n\t#app: VueCreateAppResult;\n\t#title: string;\n\t#subtitle: string;\n\t#events: Object;\n\t#maxSelected: number;\n\t#popup: Popup;\n\t#rootComponent: any;\n\n\tconstructor(params: ItemListSelectorOptions)\n\t{\n\t\tif (!Type.isDomNode(params.targetNode))\n\t\t{\n\t\t\tthrow new Error('Target DOM node not found');\n\t\t}\n\n\t\tthis.#targetNode = params.targetNode;\n\t\tthis.#items = params.items;\n\t\tthis.#title = params.title;\n\t\tthis.#subtitle = params.subtitle;\n\t\tthis.#events = params.events;\n\t\tthis.#maxSelected = Type.isInteger(params.maxSelected) ? params.maxSelected : null;\n\t}\n\n\t#getPopup(): Popup\n\t{\n\t\tif (this.#popup)\n\t\t{\n\t\t\treturn this.#popup;\n\t\t}\n\n\t\tthis.#popup = new Popup({\n\t\t\twidth: 409,\n\t\t\tfixed: true,\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tcontentPadding: 0,\n\t\t\tpadding: 24,\n\t\t\tclassName: 'ui-item-selector-popup',\n\t\t\tbindElement: this.#targetNode,\n\t\t\ttitleBar: { content: this.#getHeader() },\n\t\t\tcontent: this.#getContent(),\n\t\t\tbuttons: [\n\t\t\t\tnew SaveButton({\n\t\t\t\t\tonclick: this.#save.bind(this),\n\t\t\t\t\tsize: ButtonSize.LARGE,\n\t\t\t\t\tstyle: AirButtonStyle.FILLED,\n\t\t\t\t\tuseAirDesign: true,\n\t\t\t\t}),\n\t\t\t\tnew CancelButton({\n\t\t\t\t\tonclick: this.hide.bind(this),\n\t\t\t\t\tsize: ButtonSize.LARGE,\n\t\t\t\t\tstyle: AirButtonStyle.OUTLINE,\n\t\t\t\t\tuseAirDesign: true,\n\t\t\t\t}),\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonClose: this.hide.bind(this),\n\t\t\t},\n\t\t});\n\n\t\treturn this.#popup;\n\t}\n\n\t#createSelector(): void\n\t{\n\t\tconst rootProps = {\n\t\t\titems: this.#items,\n\t\t\tmaxSelected: this.#maxSelected,\n\t\t};\n\t\tthis.#app = BitrixVue.createApp(Selector, rootProps);\n\t\tthis.#rootComponent = this.#app.mount(this.#getContent());\n\t}\n\n\t#getContent(): HTMLElement\n\t{\n\t\tif (!this.#content)\n\t\t{\n\t\t\tthis.#content = Tag.render`\n\t\t\t\t<div class=\"ui-item-selector-content\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#content;\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.#getPopup().show();\n\t\tthis.#createSelector();\n\t}\n\n\thide(): void\n\t{\n\t\tif (this.#app)\n\t\t{\n\t\t\tthis.#app.unmount();\n\t\t\tthis.#app = null;\n\t\t}\n\n\t\tif (this.#events.onHide)\n\t\t{\n\t\t\tthis.#events.onHide();\n\t\t}\n\n\t\tthis.#popup.destroy();\n\t}\n\n\t#save(): void\n\t{\n\t\tif (this.#events.onSave)\n\t\t{\n\t\t\tthis.#events.onSave();\n\t\t}\n\n\t\tthis.hide();\n\t}\n\n\tgetSelectedItems(): Array<Item>\n\t{\n\t\treturn this.getCurrentOrder().filter((item) => item.selected) ?? [];\n\t}\n\n\tgetCurrentOrder(): Array<Item>\n\t{\n\t\tif (!this.#rootComponent)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\t\tconst items = [...this.#rootComponent.getOrder().values()];\n\t\titems.sort((item1, item2) => {\n\t\t\tconst sortA = item1.sort ?? Infinity;\n\t\t\tconst sortB = item2.sort ?? Infinity;\n\n\t\t\treturn sortA - sortB;\n\t\t});\n\n\t\treturn items;\n\t}\n\n\t#getHeader(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-item-selector-header\">\n\t\t\t\t<div class=\"ui-item-selector-header-title\">${Text.encode(this.#title)}</div>\n\t\t\t\t<div class=\"ui-item-selector-header-subtitle\">${Text.encode(this.#subtitle)}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n}\n"],"names":["Checkbox","name","components","BIcon","props","status","type","String","required","validator","value","includes","computed","set","Outline","iconName","CHECK_S","MINUS_S","iconColor","methods","handleClick","$emit","template","Item","id","title","isSelected","Boolean","isDraggable","hint","default","directives","event","target","closest","checkboxStatus","itemClasses","Selector","Chip","items","Array","maxSelected","Number","data","localItems","map","item","searchQuery","sortDirection","selectedCount","filter","selected","length","filteredItems","itemsBySearchQuery","sort","item1","item2","compare","localeCompare","Type","isUndefined","sortCompare","Text","toInteger","titleCompare","query","toLowerCase","hasActiveItems","some","allItemsActive","every","toggleAllStatus","selectionLimitReached","ChipDesign","mounted","initDragAndDrop","handleItemSelect","itemId","currentItem","find","Draggable","container","$refs","$el","draggable","dragElement","subscribe","onDragEnd","bind","itemsMap","getCurrentOrder","localItem","draggedItem","get","toggleAllItems","shouldActivate","forEach","toggleSort","Map","querySelectorAll","itemElement","index","dataset","getOrder","ItemListSelector","constructor","params","isDomNode","targetNode","Error","subtitle","events","isInteger","show","hide","unmount","onHide","destroy","getSelectedItems","values","sortA","Infinity","sortB","Popup","width","fixed","autoHide","closeByEsc","contentPadding","padding","className","bindElement","titleBar","content","buttons","SaveButton","onclick","size","ButtonSize","LARGE","style","AirButtonStyle","FILLED","useAirDesign","CancelButton","OUTLINE","onClose","rootProps","BitrixVue","createApp","mount","Tag","render","onSave","encode"],"mappings":"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"}