{"version":3,"file":"entityrelation.bundle.js","sources":["../src/interface/bar.js","../src/interface/booking-bar.js","../src/interface/deal-bar.js","../src/api/client.js","../src/collection/relation-collection.js","../src/interface/header.js","../src/interface/relation-interface.js"],"sourcesContent":["import type { RelationData } from '../type/data';\nimport type { BarOptions, BarEntityLinkOptions } from '../type/constructor-options';\nimport { Tag, Dom, Loc, Event } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Loader } from 'main.loader';\nimport { Messenger } from 'im.public';\nimport { Icon, Outline } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.main';\n\nexport default class Bar\n{\n\tconstructor(options: BarOptions)\n\t{\n\t\tthis.parentNode = options.parentNode;\n\t\tthis.init();\n\t}\n\n\tinit(): void\n\t{\n\t\tthis.bar = Tag.render`\n\t\t\t<div class=\"calendar-relation-bar\">\n\t\t\t</div>\n\t\t`;\n\t\tEvent.bind(this.bar, 'mouseenter', () => {\n\t\t\tEventEmitter.emit('BX.Calendar.EntityRelation.onMouseEnter');\n\t\t});\n\t}\n\n\trenderLoader(): HTMLElement\n\t{\n\t\tDom.clean(this.bar);\n\t\tif (!this.loaderWrap)\n\t\t{\n\t\t\tthis.loaderWrap = Tag.render`<div class=\"calendar-relation-bar-loader\"></div>`;\n\t\t}\n\t\tDom.append(this.loaderWrap, this.bar);\n\t\tthis.showLoader();\n\n\t\treturn this.bar;\n\t}\n\n\tshowLoader(): void\n\t{\n\t\tif (this.loader)\n\t\t{\n\t\t\tthis.loader.destroy();\n\t\t}\n\n\t\tthis.loader = new Loader({\n\t\t\ttarget: this.loaderWrap,\n\t\t\tsize: 22,\n\t\t\tcolor: '#2066B0',\n\t\t\toffset: {\n\t\t\t\tleft: '0px',\n\t\t\t\ttop: '0px',\n\t\t\t},\n\t\t\tmode: 'inline',\n\t\t});\n\t\tthis.loader.show();\n\t}\n\n\trender(relationData: RelationData, entityLink: ?HTMLElement): HTMLElement\n\t{\n\t\tDom.clean(this.bar);\n\t\tDom.append(entityLink, this.bar);\n\t\tDom.append(this.getOwnerData(relationData), this.bar);\n\n\t\treturn this.bar;\n\t}\n\n\tgetEntityLink({ link = '#', text, title }: BarEntityLinkOptions): ?HTMLElement\n\t{\n\t\tconst arrowIcon = new Icon({\n\t\t\ticon: Outline.CHEVRON_RIGHT_M,\n\t\t\tsize: 20,\n\t\t\tcolor: 'rgb(130, 139, 149)',\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<a\n\t\t\t\tclass=\"calendar-relation-entity-link\"\n\t\t\t\thref=\"${link}\"\n\t\t\t\ttitle=\"${title}\"\n\t\t\t>\n\t\t\t\t<div class=\"calendar-relation-entity-link-text\">\n\t\t\t\t\t${text}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"calendar-relation-entity-link-arrow\">\n\t\t\t\t\t${arrowIcon.render()}\n\t\t\t\t</div>\n\t\t\t</a>\n\t\t`;\n\t}\n\n\tgetOwnerData(relationData: RelationData): HTMLElement\n\t{\n\t\tconst chatIcon = new Icon({\n\t\t\ticon: Outline.MESSAGES,\n\t\t\tsize: 22,\n\t\t\tcolor: 'rgb(0, 117, 255)',\n\t\t});\n\n\t\tconst { root, chatButton } = Tag.render`\n\t\t\t<div class=\"calendar-relation-owner\">\n\t\t\t\t<div class=\"calendar-relation-owner-role\">${Loc.getMessage('CALENDAR_RELATION_OWNER_ROLE_DEAL')}</div>\n\t\t\t\t<div class=\"calendar-relation-owner-info\">\n\t\t\t\t\t${this.getOwnerAvatarNode(relationData)}\n\t\t\t\t\t${this.getOwnerNameNode(relationData)}\n\t\t\t\t\t<div\n\t\t\t\t\t\tref=\"chatButton\"\n\t\t\t\t\t\tclass=\"calendar-relation-owner-chat\"\n\t\t\t\t\t\ttitle=\"${Loc.getMessage('CALENDAR_RELATION_CHAT_BUTTON_HINT')}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t${chatIcon.render()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(chatButton, 'click', () => this.openChat(relationData.owner.id));\n\n\t\treturn root;\n\t}\n\n\tgetOwnerAvatarNode(relationData: RelationData): HTMLElement\n\t{\n\t\tconst avatarWrap = Tag.render`\n\t\t\t<a\n\t\t\t\thref=\"${relationData.owner.link}\"\n\t\t\t\tclass=\"calendar-relation-owner-avatar ui-icon ui-icon-common-user\"\n\t\t\t\ttitle=\"${Loc.getMessage('CALENDAR_RELATION_OWNER_PROFILE_HINT')}\"\n\t\t\t>\n\t\t\t</a>\n\t\t`;\n\n\t\tlet avatar = null;\n\n\t\tif (relationData.owner.avatar)\n\t\t{\n\t\t\tavatar = Tag.render`\n\t\t\t\t<img\n\t\t\t\t\tsrc=\"${encodeURI(relationData.owner.avatar)}\"\n\t\t\t\t\talt=\"\"\n\t\t\t\t/>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tavatar = Tag.render`\n\t\t\t\t<i></i>\n\t\t\t`;\n\t\t}\n\n\t\tDom.append(avatar, avatarWrap);\n\n\t\treturn avatarWrap;\n\t}\n\n\tgetOwnerNameNode(relationData: RelationData): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<a\n\t\t\t\tclass=\"calendar-relation-owner-name\"\n\t\t\t\thref=\"${relationData.owner.link}\"\n\t\t\t\ttitle=\"${Loc.getMessage('CALENDAR_RELATION_OWNER_PROFILE_HINT')}\"\n\t\t\t>\n\t\t\t\t${relationData.owner.name}\n\t\t\t</a>\n\t\t`;\n\t}\n\n\topenChat(chatId: number)\n\t{\n\t\tMessenger.openChat(chatId);\n\t}\n}\n","import { Loc, Event, Runtime } from 'main.core';\nimport type Bar from './bar';\nimport type { RelationData } from '../type/data';\n\nexport class BookingBar\n{\n\t#bar: Bar;\n\t#BookingEventPopup = null;\n\n\tconstructor(bar: Bar)\n\t{\n\t\tthis.#bar = bar;\n\t}\n\n\trender(relationData: RelationData): ?HTMLElement\n\t{\n\t\tRuntime.loadExtension('booking.application.booking-event-popup').then((exports): void => {\n\t\t\tthis.#BookingEventPopup = exports.BookingEventPopup;\n\t\t}).catch((error): void => {\n\t\t\tconsole.error('Calendar. EntityRelation. Load BookingEventPopup extension error', error);\n\t\t});\n\n\t\treturn this.#bar.render(\n\t\t\trelationData,\n\t\t\tthis.#getEntityLink(relationData),\n\t\t);\n\t}\n\n\t#getEntityLink(relationData: RelationData): ?HTMLElement\n\t{\n\t\tconst entityLink = this.#bar.getEntityLink({\n\t\t\tlink: relationData.entity.link,\n\t\t\ttext: Loc.getMessage('CALENDAR_RELATION_ENTITY_LINK_BOOKING'),\n\t\t\ttitle: Loc.getMessage('CALENDAR_RELATION_ENTITY_LINK_BOOKING'),\n\t\t});\n\n\t\tEvent.bind(entityLink, 'click', async (event): Promise<void> => {\n\t\t\tevent.preventDefault();\n\t\t\tawait this.#openBooking(relationData.entity.id);\n\t\t});\n\n\t\treturn entityLink;\n\t}\n\n\tasync #openBooking(bookingId: number): void\n\t{\n\t\tif (!this.#BookingEventPopup)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tawait new this.#BookingEventPopup({ bookingId }).show();\n\t}\n}\n","import { Loc } from 'main.core';\nimport type Bar from './bar';\nimport type { RelationData } from '../type/data';\n\nexport class DealBar\n{\n\t#bar: Bar;\n\n\tconstructor(bar: Bar)\n\t{\n\t\tthis.#bar = bar;\n\t}\n\n\trender(relationData: RelationData): ?HTMLElement\n\t{\n\t\treturn this.#bar.render(\n\t\t\trelationData,\n\t\t\tthis.#getEntityLink(relationData),\n\t\t);\n\t}\n\n\t#getEntityLink(relationData: RelationData): ?HTMLElement\n\t{\n\t\treturn this.#bar.getEntityLink({\n\t\t\tlink: relationData.entity.link,\n\t\t\ttext: Loc.getMessage('CALENDAR_RELATION_ENTITY_LINK_DEAL'),\n\t\t\ttitle: Loc.getMessage('CALENDAR_RELATION_OPEN_ENTITY_HINT_DEAL'),\n\t\t});\n\t}\n}\n","import { ajax, Type } from 'main.core';\n\nexport default class Client\n{\n\tstatic async getRelationData(eventId: number | null): Promise\n\t{\n\t\tif (Type.isNil(eventId))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst action = 'calendar.api.calendarentryajax.getEventEntityRelation';\n\t\tconst data = { eventId };\n\t\tconst response = await ajax.runAction(action, { data }).then(\n\t\t\t(ajaxResponse) => {\n\t\t\t\treturn ajaxResponse;\n\t\t\t},\n\t\t\t() => {\n\t\t\t\treturn null;\n\t\t\t},\n\t\t);\n\n\t\treturn response?.data || false;\n\t}\n}\n","import type { RelationData } from '../type/data';\n\nexport default class RelationCollection\n{\n\tstatic map = new Map();\n\n\tstatic getRelation(eventId: number): RelationData | false\n\t{\n\t\treturn RelationCollection.map.get(eventId) ?? false;\n\t}\n\n\tstatic setRelation(relationData: RelationData): void\n\t{\n\t\tRelationCollection.map.set(relationData.eventId, relationData);\n\t}\n}\n","import { Tag, Loc, Event } from 'main.core';\nimport { Icon, Outline } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.main';\n\nconst HELP_DESK_CODE = 26_423_530;\n\nexport class EntityRelationsHeader\n{\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar--relation-entities-header\">\n\t\t\t\t<h6 class=\"calendar--relation-entities-title\">\n\t\t\t\t\t${Loc.getMessage('CALENDAR_RELATIONS_TITLE')}\n\t\t\t\t</h6>\n\t\t\t\t<span class=\"calendar--relation-entities-help-desk-icon\">\n\t\t\t\t\t${this.#getHelpDeskIcon()}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getHelpDeskIcon(): HTMLElement\n\t{\n\t\tconst helpDeskIcon = new Icon({\n\t\t\ticon: Outline.QUESTION,\n\t\t\tsize: 16,\n\t\t\tcolor: 'rgba(167, 167, 167, 1)',\n\t\t}).render();\n\n\t\tEvent.bind(helpDeskIcon, 'click', () => this.#showHelpDesk());\n\n\t\treturn helpDeskIcon;\n\t}\n\n\t#showHelpDesk(): void\n\t{\n\t\tif (!top.BX.Helper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst params = {\n\t\t\tredirect: 'detail',\n\t\t\tcode: HELP_DESK_CODE,\n\t\t};\n\n\t\tconst queryString = Object.entries(params)\n\t\t\t.map(([key, value]) => `${key}=${value}`)\n\t\t\t.join('&');\n\n\t\ttop.BX.Helper.show(queryString);\n\t}\n}\n","import Bar from './bar';\nimport { BookingBar } from './booking-bar';\nimport { DealBar } from './deal-bar';\nimport { Dom, Tag, Type } from 'main.core';\nimport Client from '../api/client';\nimport RelationCollection from '../collection/relation-collection';\nimport { EntityRelationsHeader } from './header';\nimport type { InterfaceOptions } from '../type/constructor-options';\nimport type { RelationData } from '../type/data';\n\nexport default class RelationInterface\n{\n\tconstructor(options: InterfaceOptions)\n\t{\n\t\tthis.bar = new Bar({ parentNode: options.parentNode });\n\n\t\tthis.eventId = options.eventId ?? null;\n\t\tthis.relationData = RelationCollection.getRelation(this.eventId) || null;\n\t\tthis.layout = null;\n\t}\n\n\trender(): HTMLElement | null\n\t{\n\t\tif (Type.isNil(this.relationData))\n\t\t{\n\t\t\tthis.layout = this.bar.renderLoader();\n\t\t\tvoid this.showLazy();\n\t\t}\n\t\telse if (this.relationData)\n\t\t{\n\t\t\tthis.layout = this.#renderBar(this.relationData);\n\t\t}\n\n\t\treturn this.#wrapLayout(this.layout);\n\t}\n\n\tasync showLazy()\n\t{\n\t\tthis.relationData = await Client.getRelationData(this.eventId);\n\n\t\tif (this.relationData)\n\t\t{\n\t\t\tRelationCollection.setRelation(this.relationData);\n\n\t\t\tconst barLayout = this.#renderBar(this.relationData);\n\n\t\t\tDom.replace(this.layout, barLayout);\n\t\t\tthis.layout = barLayout;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.destroy();\n\t\t}\n\t}\n\n\tdestroy(): void\n\t{\n\t\tDom.remove(this.layout);\n\t\tthis.layout = null;\n\t}\n\n\t#renderBar(relationData: RelationData): ?HTMLElement\n\t{\n\t\tif (relationData.entity.type === 'deal')\n\t\t{\n\t\t\treturn new DealBar(this.bar).render(relationData);\n\t\t}\n\n\t\tif (relationData.entity.type === 'booking')\n\t\t{\n\t\t\treturn new BookingBar(this.bar).render(relationData);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#wrapLayout(layout: HTMLElement | null): HTMLElement | null\n\t{\n\t\tif (layout === null)\n\t\t{\n\t\t\treturn layout;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar--relation-entities-wrapper\">\n\t\t\t\t${new EntityRelationsHeader().render()}\n\t\t\t\t${this.layout}\n\t\t\t</div>\n\t\t`;\n\t}\n}\n"],"names":["Bar","constructor","options","parentNode","init","bar","Tag","render","Event","bind","EventEmitter","emit","renderLoader","Dom","clean","loaderWrap","append","showLoader","loader","destroy","Loader","target","size","color","offset","left","top","mode","show","relationData","entityLink","getOwnerData","getEntityLink","link","text","title","arrowIcon","Icon","icon","Outline","CHEVRON_RIGHT_M","chatIcon","MESSAGES","root","chatButton","Loc","getMessage","getOwnerAvatarNode","getOwnerNameNode","openChat","owner","id","avatarWrap","avatar","encodeURI","name","chatId","Messenger","BookingBar","Runtime","loadExtension","then","exports","BookingEventPopup","catch","error","console","entity","event","preventDefault","bookingId","DealBar","Client","getRelationData","eventId","Type","isNil","action","data","response","ajax","runAction","ajaxResponse","RelationCollection","getRelation","map","get","setRelation","set","Map","HELP_DESK_CODE","EntityRelationsHeader","helpDeskIcon","QUESTION","BX","Helper","params","redirect","code","queryString","Object","entries","key","value","join","RelationInterface","layout","showLazy","barLayout","replace","remove","type"],"mappings":"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"}