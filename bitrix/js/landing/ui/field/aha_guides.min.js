(function(){"use strict";BX.namespace("BX.Landing.UI.Guide");BX.Landing.UI.Guide.TourManager=class e{registeredGuides=new Map;observer=null;register(e){this.registeredGuides.set(e.id,e);if(!this.observer){this.startObserving()}}startObserving(){if(this.observer){return}this.observer=new MutationObserver(this.#e.bind(this));this.observer.observe(document.body,{childList:true,subtree:true})}#e(e){for(const t of e){if(t.type==="childList"){t.addedNodes.forEach(this.#t.bind(this))}}}#t(e){if(e.nodeType===Node.ELEMENT_NODE){this.checkNodeForTargets(e)}}stopObserving(){if(this.observer){this.observer.disconnect();this.observer=null}}checkNodeForTargets(e){for(const[t,n]of this.registeredGuides){try{const i=e.matches(n.selector)?e:e.querySelector(n.selector);if(!i){continue}if(n.requiredChildSelector){const e=i.querySelector(n.requiredChildSelector);if(!e){continue}}this.processGuide(t,n,i)}catch(e){}}}async processGuide(e,t,n){this.registeredGuides.delete(e);try{const e=await t.checkCondition();if(!e){return}await t.showGuide(n);if(t.markAsShown){t.markAsShown()}}catch(e){}finally{if(this.registeredGuides.size===0){this.stopObserving()}}}};const e=new BX.Landing.UI.Guide.TourManager;BX.ready((()=>{if(!BX.UI?.Tour?.Guide||!BX.Event){return}const t=BX.UI.Tour.Guide;const n=BX.Event;function i(){return new Promise((e=>{BX.ajax.runAction("landing.landing.isPhoneRegionCodeTourAlreadySeen").then((t=>{e(t.data)}),(()=>{e(false)})).catch((()=>{e(false)}))}))}function o(){BX.userOptions.save("ui-tour","landing_phone_aha_shown","null","Y")}function s(e){return new Promise((i=>{try{const o=e.querySelector(".landing-ui-button-icon-edit");const s=new t({id:"landing-phone-field-aha-moment",overlay:true,simpleMode:true,onEvents:false,steps:[{target:e,title:"",text:BX.Landing.Loc.getMessage("LANDING_PHONE_FIELD_AHA_MOMENT_REGION_CODE"),position:"bottom"}]});s.getPopup().setWidth(350);const r=()=>{const t=s.getPopup();if(!t||!t.getPopupContainer()){return}const n=t.getPopupContainer();const i=e.getBoundingClientRect();const r=i.right-n.offsetWidth;BX.Dom.style(n,{left:`${r}px`});const d=t.angle?.element;if(d&&o){const e=o.getBoundingClientRect();const t=e.left+e.width/2;const n=t-r;const i=d.offsetWidth;BX.Dom.style(d,{left:`${n-i/2}px`})}};const d=()=>{n.unbind(window,"resize",r);n.unbind(document,"scroll",r,true);i()};s.getPopup().subscribe("onClose",d);s.getPopup().subscribe("onDestroy",d);s.start();requestAnimationFrame((()=>{const e=s.getPopup().getPopupContainer();if(e){BX.Dom.style(e,{zIndex:"1050"})}}));requestAnimationFrame((()=>{r()}));n.bind(window,"resize",r);n.bind(document,"scroll",r,true);i()}catch(e){i()}}))}e.register({id:"landing-phone-field-aha",selector:'.landing-ui-component-list-item[data-type="phone"]',requiredChildSelector:".landing-ui-button-icon-edit",checkCondition:async()=>{const e=await i();return!e},showGuide:s,markAsShown:o})}))})();
//# sourceMappingURL=aha_guides.map.js