{"version":3,"file":"sectioninterface.bundle.js","sources":["../src/editform.js","../src/trackingusersform.js","../src/trackinggroupsform.js","../src/trackingcollabform.js","../src/trackingtypesform.js","../src/sectioninterface.js"],"sourcesContent":["import { Runtime, Dom, Event, Loc, Text, Type, Tag } from 'main.core';\nimport { Util } from 'calendar.util';\nimport {EventEmitter} from 'main.core.events';\nimport {Dialog as EntitySelectorDialog} from 'ui.entity-selector';\n\n\nexport class EditForm extends EventEmitter\n{\n\tDOM = {};\n\tisCreated = false;\n\n\tconstructor(options = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.SectionInterface.EditForm');\n\n\t\tthis.DOM.outerWrap = options.wrap;\n\t\tthis.sectionAccessTasks = options.sectionAccessTasks;\n\t\tthis.sectionManager = options.sectionManager;\n\t\tthis.closeCallback = options.closeCallback;\n\t\tthis.BX = Util.getBX();\n\t\tthis.calendarContext = options.calendarContext;\n\t\tthis.keyHandlerBinded = this.keyHandler.bind(this);\n\t}\n\n\tshow(params = {})\n\t{\n\t\tthis.section = params.section;\n\t\tthis.create();\n\t\tthis.showAccess = params.showAccess !== false;\n\t\tthis.allowChangeName = params.allowChangeName !== false;\n\t\tif (this.showAccess)\n\t\t{\n\t\t\tthis.DOM.accessLink.style.display = '';\n\t\t\tthis.DOM.accessWrap.style.display = '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.DOM.accessLink.style.display = 'none';\n\t\t\tthis.DOM.accessWrap.style.display = 'none';\n\t\t}\n\n\t\tEvent.bind(document, 'keydown', this.keyHandlerBinded);\n\t\tDom.addClass(this.DOM.outerWrap, 'show');\n\n\t\tif (params.section)\n\t\t{\n\t\t\tif (params.section.color)\n\t\t\t{\n\t\t\t\tthis.setColor(params.section.color);\n\t\t\t}\n\n\t\t\tthis.setAccess(params.section.access || params.section.data.ACCESS || {});\n\n\t\t\tif (params.section.name)\n\t\t\t{\n\t\t\t\tthis.DOM.sectionTitleInput.value = params.section.name;\n\t\t\t}\n\t\t}\n\n\t\tif (this.allowChangeName)\n\t\t{\n\t\t\tBX.focus(this.DOM.sectionTitleInput);\n\t\t\tif (this.DOM.sectionTitleInput.value !== '')\n\t\t\t{\n\t\t\t\tthis.DOM.sectionTitleInput.select();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.DOM.sectionTitleInput, '--disabled');\n\t\t\tthis.DOM.sectionTitleInput.disabled = true;\n\t\t}\n\n\t\tthis.isOpenedState = true;\n\t}\n\n\tclose()\n\t{\n\t\tthis.isOpenedState = false;\n\t\tEvent.unbind(document, 'keydown', this.keyHandlerBinded);\n\t\tDom.removeClass(this.DOM.outerWrap, 'show');\n\n\t\tif (Type.isFunction(this.closeCallback))\n\t\t{\n\t\t\tthis.closeCallback();\n\t\t}\n\t}\n\n\tisOpened()\n\t{\n\t\treturn this.isOpenedState;\n\t}\n\n\tcreate()\n\t{\n\t\tthis.wrap = this.DOM.outerWrap.querySelector('.calendar-form-content');\n\n\t\tif (this.wrap)\n\t\t{\n\t\t\tDom.clean(this.wrap);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.wrap = this.DOM.outerWrap.appendChild(Dom.create('DIV', {props: {className: 'calendar-form-content'}}));\n\t\t}\n\n\t\tthis.DOM.formFieldsWrap = this.wrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-list-slider-widget-content'}\n\t\t\t\t}\n\t\t\t)\n\t\t)\n\t\t\t.appendChild(\n\t\t\t\tDom.create(\n\t\t\t\t\t'DIV',\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: {className: 'calendar-list-slider-widget-content-block'}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t// Title\n\t\tthis.DOM.sectionTitleInput = this.DOM.formFieldsWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-field-container calendar-field-container-string'}\n\t\t\t\t}\n\t\t\t)\n\t\t)\n\t\t\t.appendChild(Dom.create('DIV', {props: {className: 'calendar-field-block'}}))\n\t\t\t.appendChild(Dom.create('INPUT', {\n\t\t\t\tattrs: {type: 'text', placeholder: Loc.getMessage('EC_SEC_SLIDER_SECTION_TITLE')},\n\t\t\t\tprops: {className: 'calendar-field calendar-field-string'}\n\t\t\t}));\n\n\t\tthis.DOM.optionsWrap = this.DOM.formFieldsWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-list-slider-new-calendar-options-container'}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.initSectionColorSelector();\n\n\t\tthis.initAccessController();\n\n\t\t// Buttons\n\t\tthis.buttonsWrap = this.DOM.formFieldsWrap.appendChild(Dom.create('DIV', {props: {className: 'calendar-list-slider-btn-container'}}));\n\n\t\tthis.saveBtn = new BX.UI.Button({\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_SAVE'),\n\t\t\tclassName: 'ui-btn ui-btn-success',\n\t\t\tevents: {click: this.save.bind(this)}\n\t\t});\n\t\tthis.saveBtn.renderTo(this.buttonsWrap);\n\n\t\tnew BX.UI.Button({\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_CANCEL'),\n\t\t\tclassName: 'ui-btn ui-btn-link',\n\t\t\tevents: {click: this.checkClose.bind(this)}\n\t\t}).renderTo(this.buttonsWrap);\n\n\t\tthis.isCreated = true;\n\t}\n\n\tkeyHandler(e)\n\t{\n\t\tif(e.keyCode === Util.getKeyCode('escape'))\n\t\t{\n\t\t\tthis.checkClose();\n\t\t}\n\t\telse if(e.keyCode === Util.getKeyCode('enter'))\n\t\t{\n\t\t\tthis.save();\n\t\t}\n\t}\n\n\tcheckClose()\n\t{\n\t\tthis.close();\n\t}\n\n\tsave()\n\t{\n\t\tthis.saveBtn.setWaiting(true);\n\t\tthis.sectionManager.saveSection(\n\t\t\tthis.DOM.sectionTitleInput.value,\n\t\t\tthis.color,\n\t\t\tthis.access,\n\t\t\t{section: this.section}\n\t\t)\n\t\t\t.then(() => {\n\t\t\t\tthis.saveBtn.setWaiting(false);\n\t\t\t\tthis.close();\n\t\t\t});\n\t}\n\n\tinitSectionColorSelector()\n\t{\n\t\tthis.DOM.colorContWrap = this.DOM.optionsWrap.appendChild(Dom.create('DIV', {\n\t\t\tprops: { className: 'calendar-list-slider-new-calendar-option-color' },\n\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_COLOR')\n\t\t}));\n\t\tthis.colorIcon = this.DOM.colorContWrap.appendChild(Dom.create('SPAN', {\n\t\t\tprops: { className: 'calendar-list-slider-new-calendar-option-color-selected' }\n\t\t}));\n\t\tthis.colorChangeLink = this.DOM.colorContWrap.appendChild(Dom.create('SPAN', {\n\t\t\tprops: { className: 'calendar-list-slider-new-calendar-option-color-change' },\n\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_CHANGE')\n\t\t}));\n\n\t\tEvent.bind(this.colorIcon, 'click', this.showSimplePicker.bind(this));\n\t\tEvent.bind(this.colorChangeLink, 'click', this.showSimplePicker.bind(this));\n\t}\n\n\tshowSimplePicker(value)\n\t{\n\t\tconst colors = Runtime.clone(Util.getDefaultColorList(), true);\n\t\tconst innerCont = Dom.create(\n\t\t\t'DIV',\n\t\t\t{\n\t\t\t\tprops: {className: 'calendar-simple-color-wrap calendar-field-container-colorpicker-square'}\n\t\t\t}\n\t\t);\n\t\tconst colorWrap = innerCont.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\t\tevents: {click: BX.delegate(this.simplePickerClick, this)}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tconst moreLinkWrap = innerCont.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-simple-color-more-link-wrap'}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tconst moreLink = moreLinkWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'SPAN',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-simple-color-more-link'},\n\t\t\t\t\thtml: Loc.getMessage('EC_COLOR'),\n\t\t\t\t\tevents: {click: BX.delegate(this.showFullPicker, this)}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.simplePickerColorWrap = colorWrap;\n\t\tthis.colors = [];\n\n\t\tif (!colors.includes(this.color))\n\t\t{\n\t\t\tcolors.push(this.color);\n\t\t}\n\n\t\tfor (let i = 0; i < colors.length; i++)\n\t\t{\n\t\t\tthis.colors.push({\n\t\t\t\tcolor: colors[i],\n\t\t\t\tnode: colorWrap.appendChild(Dom.create('SPAN', {\n\t\t\t\t\tprops: {className: 'calendar-field-colorpicker-color-item'},\n\t\t\t\t\tstyle: {backgroundColor: colors[i]},\n\t\t\t\t\tattrs: {'data-bx-calendar-color': colors[i]},\n\t\t\t\t\thtml: '<span class=\"calendar-field-colorpicker-color\"></span>'\n\t\t\t\t}))\n\t\t\t});\n\t\t}\n\n\t\tthis.lastActiveNode = this.colors[BX.util.array_search(this.color, colors) || 0].node;\n\t\tDom.addClass(this.lastActiveNode, 'active');\n\n\t\tthis.simpleColorPopup = BX.PopupWindowManager.create(\n\t\t\t\"simple-color-popup-\" + Util.getRandomInt(),\n\t\t\tthis.colorIcon,\n\t\t\t{\n\t\t\t\t//zIndex: this.zIndex,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 9,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcontent: innerCont,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\n\t\tthis.simpleColorPopup.setAngle({offset: 10});\n\t\tthis.simpleColorPopup.show(true);\n\t}\n\n\tsimplePickerClick(e)\n\t{\n\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\tif (Type.isElementNode(target))\n\t\t{\n\t\t\tconst value = target.getAttribute('data-bx-calendar-color');\n\t\t\tif(value !== null)\n\t\t\t{\n\t\t\t\tif (this.lastActiveNode)\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(this.lastActiveNode, 'active');\n\t\t\t\t}\n\n\t\t\t\tDom.addClass(target, 'active');\n\t\t\t\tthis.lastActiveNode = target;\n\t\t\t\tthis.setColor(value);\n\t\t\t}\n\t\t}\n\t}\n\n\tshowFullPicker()\n\t{\n\t\tif (this.simpleColorPopup)\n\t\t{\n\t\t\tthis.simpleColorPopup.close();\n\t\t}\n\n\t\tif (!this.fullColorPicker || this.fullColorPicker.getPopupWindow()?.isDestroyed())\n\t\t{\n\t\t\tthis.fullColorPicker = new BX.ColorPicker({\n\t\t\t\tbindElement: this.DOM.colorContWrap,\n\t\t\t\tonColorSelected: BX.delegate(function(color){\n\t\t\t\t\tthis.setColor(color);\n\t\t\t\t}, this),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tzIndex: this.zIndex,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPopupClose:BX.delegate(function(){\n\t\t\t\t\t\t}, this)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tthis.fullColorPicker.open();\n\t}\n\n\tsetColor(value)\n\t{\n\t\tthis.colorIcon.style.backgroundColor = value;\n\t\tthis.color = value;\n\t}\n\n\tsetAccess(value)\n\t{\n\t\tlet rowsCount = 0;\n\t\tfor (let code in value)\n\t\t{\n\t\t\tif (value.hasOwnProperty(code))\n\t\t\t{\n\t\t\t\trowsCount++;\n\t\t\t}\n\t\t}\n\t\tthis.accessRowsCount = rowsCount;\n\t\tthis.access = value;\n\n\t\tfor (let code in value)\n\t\t{\n\t\t\tif (value.hasOwnProperty(code))\n\t\t\t{\n\t\t\t\tthis.insertAccessRow(Util.getAccessName(code), code, value[code]);\n\t\t\t}\n\t\t}\n\t\tthis.checkAccessTableHeight();\n\t}\n\n\tinitAccessController()\n\t{\n\t\tthis.buildAccessController();\n\t\tif (this.sectionManager && this.sectionManager.calendarType === 'group')\n\t\t{\n\t\t\tthis.initDialogGroup();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.initDialogStandard();\n\t\t}\n\t\tthis.initAccessSelectorPopup();\n\t}\n\n\tinitAccessSelectorPopup()\n\t{\n\t\tEvent.bind(this.DOM.accessWrap, 'click', (e) => {\n\t\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\t\tif (Type.isElementNode(target))\n\t\t\t{\n\t\t\t\tif (target.getAttribute('data-bx-calendar-access-selector') !== null)\n\t\t\t\t{\n\t\t\t\t\t// show selector\n\t\t\t\t\tconst code = target.getAttribute('data-bx-calendar-access-selector');\n\t\t\t\t\tif (this.accessControls[code])\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showAccessSelectorPopup({\n\t\t\t\t\t\t\t\tnode: this.accessControls[code].removeIcon,\n\t\t\t\t\t\t\t\tsetValueCallback: (value) => {\n\t\t\t\t\t\t\t\t\tif (this.accessTasks[value] && this.accessControls[code])\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tthis.accessControls[code].valueNode.innerHTML =\n\t\t\t\t\t\t\t\t\t\t\tText.encode(this.accessTasks[value].title);\n\t\t\t\t\t\t\t\t\t\tthis.access[code] = value;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (target.getAttribute('data-bx-calendar-access-remove') !== null)\n\t\t\t\t{\n\t\t\t\t\tconst code = target.getAttribute('data-bx-calendar-access-remove');\n\t\t\t\t\tif (this.accessControls[code])\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.remove(this.accessControls[code].rowNode);\n\t\t\t\t\t\tthis.accessControls[code] = null;\n\t\t\t\t\t\tdelete this.access[code];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tbuildAccessController()\n\t{\n\t\tthis.DOM.accessLink = this.DOM.optionsWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-new-calendar-option-more\">${Loc.getMessage('EC_SEC_SLIDER_ACCESS')}</div>`,\n\t\t);\n\n\t\tthis.DOM.accessWrap = this.DOM.formFieldsWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"calendar-list-slider-access-container\">\n\t\t\t\t\t<div class=\"calendar-list-slider-access-inner-wrap\">\n\t\t\t\t\t\t${this.DOM.accessTable = Tag.render`\n\t\t\t\t\t\t\t<table class=\"calendar-section-slider-access-table\"></table>\n\t\t\t\t\t\t`}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-list-slider-new-calendar-options-container\">\n\t\t\t\t\t\t${this.DOM.accessButton = Tag.render`\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-new-calendar-option-add\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_ACCESS_ADD')}\n\t\t\t\t\t\t\t</span>`\n\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t</div>`,\n\t\t);\n\n\t\tthis.accessControls = {};\n\t\tthis.accessTasks = this.sectionAccessTasks;\n\n\t\tEvent.bind(this.DOM.accessLink, 'click', () => {\n\t\t\tif (Dom.hasClass(this.DOM.accessWrap, 'shown'))\n\t\t\t{\n\t\t\t\tDom.removeClass(this.DOM.accessWrap, 'shown');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.addClass(this.DOM.accessWrap, 'shown');\n\t\t\t}\n\t\t\tthis.checkAccessTableHeight();\n\t\t});\n\t}\n\n\tinitDialogStandard()\n\t{\n\t\tEvent.bind(this.DOM.accessButton, 'click', () => {\n\t\t\tconst entities = [\n\t\t\t\t{\n\t\t\t\t\tid: 'user',\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tanalyticsSource: 'calendar',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'department',\n\t\t\t\t\toptions: { selectMode: 'usersAndDepartments' },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'meta-user',\n\t\t\t\t\toptions: { 'all-users': true },\n\t\t\t\t},\n\t\t\t];\n\n\t\t\tconst calendarContext = this.calendarContext || Util.getCalendarContext();\n\n\t\t\tif (calendarContext.util.config.projectFeatureEnabled)\n\t\t\t{\n\t\t\t\tentities.push({\n\t\t\t\t\tid: 'project',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.entitySelectorDialog = new EntitySelectorDialog({\n\t\t\t\ttargetNode: this.DOM.accessButton,\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: [],\n\t\t\t\tenableSearch: true,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tpopupOptions: {\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t},\n\t\t\t\tentities,\n\t\t\t});\n\t\t\tthis.entitySelectorDialog.show();\n\t\t});\n\t}\n\n\tinitDialogGroup()\n\t{\n\t\tEvent.bind(this.DOM.accessButton, 'click', () => {\n\t\t\tthis.entitySelectorDialog = new EntitySelectorDialog({\n\t\t\t\ttargetNode: this.DOM.accessButton,\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: [],\n\t\t\t\tenableSearch: true,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tpopupOptions: {\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tanalyticsSource: 'calendar',\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: { selectMode: 'usersAndDepartments' },\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'meta-user',\n\t\t\t\t\t\toptions: { 'all-users': true },\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ttabs: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'groupAccess',\n\t\t\t\t\t\ttitle: this.sectionManager.ownerName,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'SG' + this.sectionManager.ownerId + '_' + 'A',\n\t\t\t\t\t\tentityId: 'group',\n\t\t\t\t\t\ttabs: 'groupAccess',\n\t\t\t\t\t\ttitle: Loc.getMessage('EC_ACCESS_GROUP_ADMIN'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'SG' + this.sectionManager.ownerId + '_' + 'E',\n\t\t\t\t\t\tentityId: 'group',\n\t\t\t\t\t\ttabs: 'groupAccess',\n\t\t\t\t\t\ttitle: Loc.getMessage('EC_ACCESS_GROUP_MODERATORS'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'SG' + this.sectionManager.ownerId + '_' + 'K',\n\t\t\t\t\t\tentityId: 'group',\n\t\t\t\t\t\ttabs: 'groupAccess',\n\t\t\t\t\t\ttitle: Loc.getMessage('EC_ACCESS_GROUP_MEMBERS'),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\t\t\tthis.entitySelectorDialog.show();\n\t\t});\n\t}\n\n\thandleEntitySelectorChanges()\n\t{\n\t\tconst entityList = this.entitySelectorDialog.getSelectedItems();\n\t\tthis.entitySelectorDialog.hide();\n\t\tif (Type.isArray(entityList))\n\t\t{\n\t\t\tentityList.forEach((entity) => {\n\t\t\t\tlet title;\n\t\t\t\tif (entity.entityId === 'group')\n\t\t\t\t{\n\t\t\t\t\ttitle = this.sectionManager.ownerName + ': ' + entity.title.text;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = entity.title.text;\n\t\t\t\t}\n\t\t\t\tconst code = Util.convertEntityToAccessCode(entity);\n\t\t\t\tUtil.setAccessName(code, title);\n\t\t\t\tthis.insertAccessRow(title, code);\n\t\t\t});\n\t\t}\n\n\t\tRuntime.debounce(() => {\n\t\t\tthis.entitySelectorDialog.destroy();\n\t\t}, 400)();\n\t}\n\n\t// todo: refactor it\n\tinsertAccessRow(title, code, value)\n\t{\n\t\tif (!this.accessControls[code])\n\t\t{\n\t\t\tif (value === undefined)\n\t\t\t{\n\t\t\t\tfor(let taskId in this.sectionAccessTasks)\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.sectionAccessTasks.hasOwnProperty(taskId)\n\t\t\t\t\t\t&& this.sectionAccessTasks[taskId].name === 'calendar_view'\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue = taskId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst\n\t\t\t\trowNode = Dom.adjust(this.DOM.accessTable.insertRow(-1), {props : {className: 'calendar-section-slider-access-table-row'}}),\n\t\t\t\ttitleNode = Dom.adjust(rowNode.insertCell(-1), {\n\t\t\t\t\tprops : {className: 'calendar-section-slider-access-table-cell'},\n\t\t\t\t\thtml: '<span class=\"calendar-section-slider-access-title\">' + Text.encode(title) + ':</span>'}),\n\t\t\t\tvalueCell = Dom.adjust(rowNode.insertCell(-1), {\n\t\t\t\t\tprops : {className: 'calendar-section-slider-access-table-cell'},\n\t\t\t\t\tattrs: {'data-bx-calendar-access-selector': code}\n\t\t\t\t}),\n\t\t\t\tselectNode = valueCell.appendChild(Dom.create('SPAN', {\n\t\t\t\t\tprops: {className: 'calendar-section-slider-access-container'}\n\t\t\t\t})),\n\t\t\t\tvalueNode = selectNode.appendChild(Dom.create('SPAN', {\n\t\t\t\t\ttext: this.accessTasks[value] ? this.accessTasks[value].title : '',\n\t\t\t\t\tprops: {className: 'calendar-section-slider-access-value'}\n\t\t\t\t})),\n\t\t\t\tremoveIcon = selectNode.appendChild(Dom.create('SPAN', {\n\t\t\t\t\tprops: {className: 'calendar-section-slider-access-remove'},\n\t\t\t\t\tattrs: {'data-bx-calendar-access-remove': code}\n\t\t\t\t}));\n\n\t\t\tthis.access[code] = value;\n\n\t\t\tthis.accessControls[code] = {\n\t\t\t\trowNode: rowNode,\n\t\t\t\ttitleNode: titleNode,\n\t\t\t\tvalueNode: valueNode,\n\t\t\t\tremoveIcon: removeIcon\n\t\t\t};\n\t\t}\n\t}\n\n\tcheckAccessTableHeight()\n\t{\n\t\tif (this.checkTableTimeout)\n\t\t{\n\t\t\tthis.checkTableTimeout = clearTimeout(this.checkTableTimeout);\n\t\t}\n\n\t\tthis.checkTableTimeout = setTimeout(() => {\n\t\t\tif (Dom.hasClass(this.DOM.accessWrap, 'shown'))\n\t\t\t{\n\t\t\t\tif (this.DOM.accessWrap.offsetHeight - this.DOM.accessTable.offsetHeight < 36)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.accessWrap.style.maxHeight = parseInt(this.DOM.accessTable.offsetHeight) + 100 + 'px';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.accessWrap.style.maxHeight = '';\n\t\t\t}\n\t\t}, 300);\n\t}\n\n\tshowAccessSelectorPopup(params)\n\t{\n\t\tif (\n\t\t\tthis.accessPopupMenu\n\t\t\t&& this.accessPopupMenu.popupWindow\n\t\t\t&& this.accessPopupMenu.popupWindow.isShown()\n\t\t)\n\t\t{\n\t\t\treturn this.accessPopupMenu.close();\n\t\t}\n\n\t\tconst _this = this;\n\t\tconst menuItems = [];\n\n\t\tfor(let taskId in this.accessTasks)\n\t\t{\n\t\t\tif (this.accessTasks.hasOwnProperty(taskId))\n\t\t\t{\n\t\t\t\tmenuItems.push(\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: this.accessTasks[taskId].title,\n\t\t\t\t\t\tonclick: (function (value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn function ()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tparams.setValueCallback(value);\n\t\t\t\t\t\t\t\t_this.accessPopupMenu.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})(taskId)\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.accessPopupMenu = this.BX.PopupMenu.create(\n\t\t\t'section-access-popup' + Util.randomInt(),\n\t\t\tparams.node,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : true,\n\t\t\t\toffsetTop: -5,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tangle: true,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\n\t\tthis.accessPopupMenu.show();\n\n\t}\n}\n","import { Runtime, Dom, Event, Loc, Type, Tag, Text } from 'main.core';\nimport { Util } from 'calendar.util';\nimport { TagSelector } from 'ui.entity-selector';\n\n/* eslint-disable @bitrix24/bitrix24-rules/no-native-dom-methods */\nexport class TrackingUsersForm\n{\n\tDOM = {};\n\tisCreated = false;\n\n\tconstructor(options = {})\n\t{\n\t\tthis.interfaceType = 'users';\n\t\tthis.DOM.outerWrap = options.wrap;\n\t\tthis.trackingUsers = options.trackingUsers || [];\n\t\tthis.trackingUserIdList = this.trackingUsers.map((item) => parseInt(item.ID, 10));\n\t\tthis.trackingIdList = [];\n\n\t\tthis.CHECKED_CLASS = 'calendar-list-slider-item-checkbox-checked';\n\t\tthis.selectorId = `add-tracking${Util.getRandomInt()}`;\n\t\tthis.closeCallback = options.closeCallback;\n\n\t\tthis.superposedSections = Type.isArray(options.superposedSections) ? options.superposedSections : [];\n\t\tthis.selected = {};\n\t\tthis.superposedSections.forEach((section) => {\n\t\t\tthis.selected[section.id] = true;\n\t\t});\n\n\t\tthis.isCreated = false;\n\t\tthis.keyHandlerBinded = this.keyHandler.bind(this);\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.isCreated)\n\t\t{\n\t\t\tthis.create();\n\t\t}\n\n\t\tDom.addClass(this.DOM.outerWrap, 'show');\n\t\tthis.checkInnerWrapHeight();\n\n\t\tEvent.bind(document, 'keydown', this.keyHandlerBinded);\n\n\t\tthis.updateSectionList();\n\n\t\tthis.firstTrackingUserIdList = Runtime.clone(this.trackingUserIdList);\n\t\tthis.isOpenedState = true;\n\t}\n\n\tclose(): void\n\t{\n\t\tEvent.unbind(document, 'keydown', this.keyHandlerBinded);\n\n\t\tthis.isOpenedState = false;\n\t\tDom.removeClass(this.DOM.outerWrap, 'show');\n\t\tthis.DOM.outerWrap.style.cssText = '';\n\n\t\tif (Type.isFunction(this.closeCallback))\n\t\t{\n\t\t\tthis.closeCallback();\n\t\t}\n\t}\n\n\tisOpened(): boolean\n\t{\n\t\treturn this.isOpenedState;\n\t}\n\n\tcreate(): void\n\t{\n\t\tif (!this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Tag.render`<div></div>`);\n\t\t}\n\n\t\tthis.selectorWrap = this.DOM.innerWrap.appendChild(\n\t\t\tDom.create('DIV', { props: { className: 'calendar-list-slider-selector-wrap' } }),\n\t\t);\n\n\t\tthis.userTagSelector = new TagSelector({\n\t\t\tdialogOptions: {\n\t\t\t\twidth: 320,\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: this.trackingUsers.map(\n\t\t\t\t\t(item) => ['user', parseInt(item.ID, 10)],\n\t\t\t\t),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleUserSelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleUserSelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t});\n\n\t\tthis.userTagSelector.renderTo(this.selectorWrap);\n\n\t\t// List of sections\n\t\tthis.sectionsWrap = this.DOM.innerWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-sections-wrap\"></div>`,\n\t\t);\n\t\tthis.createButtons();\n\n\t\tthis.isCreated = true;\n\t}\n\n\tcreateButtons(): void\n\t{\n\t\tthis.DOM.innerWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"calendar-list-slider-btn-container\">\n\t\t\t\t\t<button \n\t\t\t\t\t\tclass=\"ui-btn ui-btn-sm ui-btn-primary\"\n\t\t\t\t\t\tonclick=\"${this.save.bind(this)}\"\n\t\t\t\t\t>${Loc.getMessage('EC_SEC_SLIDER_SAVE')}</button>\n\t\t\t\t\t<button \n\t\t\t\t\t\tclass=\"ui-btn ui-btn-link\"\n\t\t\t\t\t\tonclick=\"${this.close.bind(this)}\"\n\t\t\t\t\t>${Loc.getMessage('EC_SEC_SLIDER_CANCEL')}</button>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t);\n\t}\n\n\thandleUserSelectorChanges(): void\n\t{\n\t\tconst selectedItems = this.userTagSelector.getDialog().getSelectedItems();\n\t\tthis.trackingUserIdList = [];\n\t\tselectedItems.forEach((item) => {\n\t\t\tif (item.entityId === 'user')\n\t\t\t{\n\t\t\t\tthis.trackingUserIdList.push(item.id);\n\t\t\t}\n\t\t});\n\t\tthis.updateSectionList();\n\t}\n\n\tsave(): void\n\t{\n\t\tBX.ajax.runAction('calendar.api.calendarajax.setTrackingSections', {\n\t\t\tdata: {\n\t\t\t\tuserIdList: this.trackingUserIdList,\n\t\t\t\tgroupIdList: this.trackingIdList,\n\t\t\t\tcollabIdList: this.trackingIdList,\n\t\t\t\tsections: this.prepareTrackingSections(),\n\t\t\t\ttype: this.interfaceType,\n\t\t\t},\n\t\t}).then(\n\t\t\t() => {\n\t\t\t\tlocation.reload();\n\t\t\t},\n\t\t\t(response) => {\n\t\t\t\tUtil.displayError(response.errors);\n\t\t\t},\n\t\t);\n\n\t\tthis.close();\n\t}\n\n\tprepareTrackingSections()\n\t{\n\t\tlet sections = this.getSelectedSections();\n\n\t\tfor (const id in this.sectionIndex)\n\t\t{\n\t\t\tif (this.sectionIndex.hasOwnProperty(id) && this.sectionIndex[id].checkbox)\n\t\t\t{\n\t\t\t\tif (Dom.hasClass(this.sectionIndex[id].checkbox, this.CHECKED_CLASS))\n\t\t\t\t{\n\t\t\t\t\tif (!sections.includes(parseInt(id, 10)))\n\t\t\t\t\t{\n\t\t\t\t\t\tsections.push(parseInt(id, 10));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (sections.includes(parseInt(id, 10)))\n\t\t\t\t{\n\t\t\t\t\tsections = sections.filter(\n\t\t\t\t\t\t(section) => parseInt(section, 10) !== parseInt(id, 10),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn sections;\n\t}\n\n\tgetSelectedSections()\n\t{\n\t\tconst sections = [];\n\t\tthis.superposedSections.forEach((section) => {\n\t\t\tif (\n\t\t\t\tthis.interfaceType === 'users'\n\t\t\t\t&& section.type === 'user'\n\t\t\t\t&& this.trackingUserIdList\n\t\t\t\t&& !this.trackingUserIdList.includes(section.ownerId)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsections.push(parseInt(section.id, 10));\n\t\t});\n\n\t\treturn sections;\n\t}\n\n\tupdateSectionList(delayExecution)\n\t{\n\t\tif (this.updateSectionLoader)\n\t\t{\n\t\t\tDom.remove(this.updateSectionLoader);\n\t\t}\n\t\tthis.updateSectionLoader = this.sectionsWrap.appendChild(\n\t\t\tDom.adjust(Util.getLoader(), { style: { height: '140px' } }),\n\t\t);\n\n\t\tif (this.updateSectionTimeout)\n\t\t{\n\t\t\tclearTimeout(this.updateSectionTimeout);\n\t\t\tthis.updateSectionTimeout = null;\n\t\t}\n\n\t\tif (delayExecution !== false)\n\t\t{\n\t\t\tthis.updateSectionTimeout = setTimeout(() => {\n\t\t\t\tthis.updateSectionList(false);\n\t\t\t}, 300);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.checkInnerWrapHeight();\n\n\t\tBX.ajax.runAction('calendar.api.calendarajax.getTrackingSections', {\n\t\t\tdata: {\n\t\t\t\tuserIdList: this.trackingUserIdList,\n\t\t\t\ttype: 'users',\n\t\t\t},\n\t\t}).then(\n\t\t\t// Success\n\t\t\t(response) => {\n\t\t\t\tDom.clean(this.sectionsWrap);\n\t\t\t\tthis.sectionIndex = {};\n\t\t\t\tthis.checkInnerWrapHeight();\n\n\t\t\t\t// Users calendars\n\t\t\t\tresponse.data.users.forEach((user) => {\n\t\t\t\t\tconst sections = response.data.sections.filter((section) => {\n\t\t\t\t\t\treturn parseInt(section.OWNER_ID, 10) === parseInt(user.ID, 10);\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.sectionsWrap.appendChild(Tag.render`\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t\t\t${Text.encode(user.FORMATTED_NAME)}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`);\n\n\t\t\t\t\tif (sections.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.createSectionBlock({\n\t\t\t\t\t\t\tsectionList: sections,\n\t\t\t\t\t\t\twrap: this.sectionsWrap,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.sectionsWrap.appendChild(Tag.render`\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_NO_SECTIONS')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t(response) => {\n\t\t\t\tUtil.displayError(response.errors);\n\t\t\t},\n\t\t);\n\t}\n\n\tcreateSectionBlock(params = {})\n\t{\n\t\tlet result = false;\n\t\tif (\n\t\t\tType.isArray(params.sectionList)\n\t\t\t&& params.sectionList.length\n\t\t\t&& Type.isElementNode(params.wrap))\n\t\t{\n\t\t\tlet listWrap;\n\t\t\tparams.wrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-list-slider-widget-content\">\n\t\t\t\t\t<div class=\"calendar-list-slider-widget-content-block\">\n\t\t\t\t\t\t${listWrap = Tag.render`<ul class=\"calendar-list-slider-container\"></ul>`}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`);\n\n\t\t\tEvent.bind(listWrap, 'click', this.sectionClick.bind(this));\n\n\t\t\tparams.sectionList.forEach((section) => {\n\t\t\t\tconst id = section.ID.toString();\n\t\t\t\tlet checkbox;\n\n\t\t\t\tconst li = listWrap.appendChild(Tag.render`\n\t\t\t\t\t<li class=\"calendar-list-slider-item\" data-bx-calendar-section=\"${id}\">\n\t\t\t\t\t\t${checkbox = Tag.render`\n\t\t\t\t\t\t\t<div class=\"calendar-list-slider-item-checkbox\" style=\"background: ${section.COLOR}\"></div>\n\t\t\t\t\t\t`}\n\t\t\t\t\t\t<div class=\"calendar-list-slider-item-name\">${Text.encode(section.NAME)}</div>\n\t\t\t\t\t</li>\n\t\t\t\t`);\n\n\t\t\t\tthis.sectionIndex[id] = {\n\t\t\t\t\titem: li,\n\t\t\t\t\tcheckbox,\n\t\t\t\t};\n\n\t\t\t\tif (\n\t\t\t\t\tthis.selected[id]\n\t\t\t\t\t|| !Type.isArray(this.firstTrackingUserIdList)\n\t\t\t\t\t|| !this.firstTrackingUserIdList.includes(parseInt(section.OWNER_ID, 10))\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(checkbox, this.CHECKED_CLASS);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsectionClick(e): void\n\t{\n\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\tif (!Type.isElementNode(target))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = target.getAttribute('data-bx-calendar-section');\n\t\tif (id === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.sectionIndex[id]?.checkbox)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Dom.hasClass(this.sectionIndex[id].checkbox, this.CHECKED_CLASS))\n\t\t{\n\t\t\tDom.removeClass(this.sectionIndex[id].checkbox, this.CHECKED_CLASS);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.sectionIndex[id].checkbox, this.CHECKED_CLASS);\n\t\t}\n\t}\n\n\tkeyHandler(e)\n\t{\n\t\tif (e.keyCode === Util.getKeyCode('escape'))\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t\telse if (e.keyCode === Util.getKeyCode('enter'))\n\t\t{\n\t\t\tthis.save();\n\t\t}\n\t}\n\n\tcheckInnerWrapHeight()\n\t{\n\t\tif (this.checkHeightTimeout)\n\t\t{\n\t\t\tclearTimeout(this.checkHeightTimeout);\n\t\t\tthis.checkHeightTimeout = null;\n\t\t}\n\n\t\tthis.checkHeightTimeout = setTimeout(() => {\n\t\t\tif (Dom.hasClass(this.DOM.outerWrap, 'show'))\n\t\t\t{\n\t\t\t\tif (this.DOM.outerWrap.offsetHeight - this.DOM.innerWrap.offsetHeight < 36)\n\t\t\t\t{\n\t\t\t\t\tconst fullHeight = parseInt(this.DOM.innerWrap.offsetHeight, 10) + 200;\n\t\t\t\t\tthis.DOM.outerWrap.style.maxHeight = `${fullHeight}px`;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.outerWrap.style.maxHeight = '';\n\t\t\t}\n\t\t}, 300);\n\t}\n}\n","import { Dom, Tag } from 'main.core';\nimport { Util } from 'calendar.util';\nimport { TagSelector } from 'ui.entity-selector';\nimport { TrackingUsersForm } from './trackingusersform';\n\n/* eslint-disable @bitrix24/bitrix24-rules/no-native-dom-methods */\nexport class TrackingGroupsForm extends TrackingUsersForm\n{\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.interfaceType = 'groups';\n\t\tthis.trackingIdList = options.trackingGroups || [];\n\t\tthis.collabs = options.collabs || [];\n\t}\n\n\tcreate()\n\t{\n\t\tif (!this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Tag.render`<div></div>`);\n\t\t}\n\n\t\tthis.selectorWrap = this.DOM.innerWrap.appendChild(\n\t\t\tDom.create('DIV', { props: { className: 'calendar-list-slider-selector-wrap' } }),\n\t\t);\n\n\t\tthis.groupTagSelector = new TagSelector({\n\t\t\tdialogOptions: {\n\t\t\t\twidth: 320,\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: this.trackingIdList.map((id) => ['project', id]),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleGroupSelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleGroupSelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tentities: this.getSelectorEntities(),\n\t\t\t},\n\t\t});\n\n\t\tthis.groupTagSelector.renderTo(this.selectorWrap);\n\n\t\t// List of sections\n\t\tthis.sectionsWrap = this.DOM.innerWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-sections-wrap\"></div>`,\n\t\t);\n\t\tthis.createButtons();\n\n\t\tthis.isCreated = true;\n\t}\n\n\thandleGroupSelectorChanges()\n\t{\n\t\tconst selectedItems = this.groupTagSelector.getDialog().getSelectedItems();\n\t\tthis.trackingIdList = [];\n\t\tselectedItems.forEach((item) => {\n\t\t\tif (item.entityId === 'project')\n\t\t\t{\n\t\t\t\tthis.trackingIdList.push(item.id);\n\t\t\t}\n\t\t});\n\t\tthis.updateSectionList();\n\t}\n\n\tupdateSectionList()\n\t{\n\t\tif (this.updateSectionLoader)\n\t\t{\n\t\t\tDom.remove(this.updateSectionLoader);\n\t\t}\n\t\tthis.updateSectionLoader = this.sectionsWrap.appendChild(\n\t\t\tDom.adjust(Util.getLoader(), { style: { height: '140px' } }),\n\t\t);\n\n\t\tif (this.updateSectionTimeout)\n\t\t{\n\t\t\tclearTimeout(this.updateSectionTimeout);\n\t\t\tthis.updateSectionTimeout = null;\n\t\t}\n\n\t\tthis.checkInnerWrapHeight();\n\t\tBX.ajax.runAction('calendar.api.calendarajax.getTrackingSections', {\n\t\t\tdata: {\n\t\t\t\tgroupIdList: this.trackingIdList,\n\t\t\t\ttype: this.interfaceType,\n\t\t\t},\n\t\t}).then(\n\t\t\t(response) => {\n\t\t\t\tDom.clean(this.sectionsWrap);\n\t\t\t\tthis.sectionIndex = {};\n\t\t\t\tthis.checkInnerWrapHeight();\n\n\t\t\t\t// Groups calendars\n\t\t\t\tthis.createSectionBlock({\n\t\t\t\t\tsectionList: response.data.sections,\n\t\t\t\t\twrap: this.sectionsWrap,\n\t\t\t\t});\n\t\t\t},\n\t\t\t(response) => {\n\t\t\t\tUtil.displayError(response.errors);\n\t\t\t},\n\t\t);\n\t}\n\n\tgetSelectedSections(): Array<number>\n\t{\n\t\tconst sections = [];\n\t\tthis.superposedSections.forEach((section) => {\n\t\t\tif (\n\t\t\t\tthis.interfaceType === 'groups'\n\t\t\t\t&& section.type === 'group'\n\t\t\t\t&& !this.trackingIdList?.includes(section.ownerId)\n\t\t\t\t&& !this.collabs?.includes(section.ownerId)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsections.push(parseInt(section.id, 10));\n\t\t});\n\n\t\treturn sections;\n\t}\n\n\tgetSelectorEntities(): Array\n\t{\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: 'project',\n\t\t\t\toptions: {\n\t\t\t\t\tlockProjectLink: !Util.isProjectFeatureEnabled(),\n\t\t\t\t\tlockProjectLinkFeatureId: 'socialnetwork_projects_groups',\n\t\t\t\t\t'!type': ['collab'],\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t}\n}\n","import { TrackingGroupsForm } from './trackinggroupsform';\n\nexport class TrackingCollabsForm extends TrackingGroupsForm\n{\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.interfaceType = 'collabs';\n\t\tthis.trackingIdList = options.trackingCollabs || [];\n\t\tthis.groups = options.groups || [];\n\t}\n\n\tgetSelectedSections(): Array<number>\n\t{\n\t\tconst sections = [];\n\t\tthis.superposedSections.forEach((section): void => {\n\t\t\tif (\n\t\t\t\tthis.interfaceType === 'collabs'\n\t\t\t\t&& section.type === 'group'\n\t\t\t\t&& !this.trackingIdList?.includes(section.ownerId)\n\t\t\t\t&& !this.groups?.includes(section.ownerId)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsections.push(parseInt(section.id, 10));\n\t\t});\n\n\t\treturn sections;\n\t}\n\n\thandleGroupSelectorChanges(): void\n\t{\n\t\tconst selectedItems = this.groupTagSelector.getDialog().getSelectedItems();\n\t\tthis.trackingIdList = [];\n\t\tselectedItems.forEach((item): void => {\n\t\t\tif (item.entityType !== 'collab')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.trackingIdList.push(item.id);\n\t\t});\n\t\tthis.updateSectionList();\n\t}\n\n\tgetSelectorEntities(): Array\n\t{\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: 'project',\n\t\t\t\toptions: {\n\t\t\t\t\ttype: ['collab'],\n\t\t\t\t\tcreateProjectLink: false,\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t}\n}\n","import { Dom, Loc, Tag, Type } from 'main.core';\nimport { Util } from 'calendar.util';\nimport { TrackingUsersForm } from './trackingusersform';\n\n/* eslint-disable @bitrix24/bitrix24-rules/no-native-dom-methods */\nexport class TrackingTypesForm extends TrackingUsersForm\n{\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.trackingGroups = options.trackingGroups || [];\n\t\tthis.interfaceType = 'company';\n\t\tthis.selectGroups = true;\n\t\tthis.selectUsers = false;\n\t\tthis.addLinkMessage = Loc.getMessage('EC_SEC_SLIDER_SELECT_GROUPS');\n\t}\n\n\tshow()\n\t{\n\t\tif (!this.isCreated)\n\t\t{\n\t\t\tthis.create();\n\t\t}\n\n\t\tthis.updateSectionList();\n\t\tthis.isOpenedState = true;\n\t\tDom.addClass(this.DOM.outerWrap, 'show');\n\t}\n\n\tcreate()\n\t{\n\t\tif (!this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Tag.render`<div></div>`);\n\t\t}\n\n\t\t// List of sections\n\t\tthis.sectionsWrap = this.DOM.innerWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-sections-wrap\"></div>`,\n\t\t);\n\n\t\tthis.createButtons();\n\n\t\tthis.isCreated = true;\n\t}\n\n\tupdateSectionList()\n\t{\n\t\tif (this.updateSectionLoader)\n\t\t{\n\t\t\tDom.remove(this.updateSectionLoader);\n\t\t}\n\t\tthis.updateSectionLoader = this.sectionsWrap.appendChild(\n\t\t\tDom.adjust(Util.getLoader(), { style: { height: '140px' } }),\n\t\t);\n\n\t\tif (this.updateSectionTimeout)\n\t\t{\n\t\t\tclearTimeout(this.updateSectionTimeout);\n\t\t\tthis.updateSectionTimeout = null;\n\t\t}\n\n\t\tBX.ajax.runAction('calendar.api.calendarajax.getTrackingSections', {\n\t\t\tdata: {\n\t\t\t\ttype: 'company',\n\t\t\t},\n\t\t}).then(\n\t\t\t(response) => {\n\t\t\t\tDom.clean(this.sectionsWrap);\n\t\t\t\tthis.sectionIndex = {};\n\t\t\t\tthis.checkInnerWrapHeight();\n\n\t\t\t\tif (\n\t\t\t\t\tType.isArray(response.data.sections)\n\t\t\t\t\t&& response.data.sections.length)\n\t\t\t\t{\n\t\t\t\t\tthis.createSectionBlock({\n\t\t\t\t\t\tsectionList: response.data.sections,\n\t\t\t\t\t\twrap: this.sectionsWrap,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.sectionsWrap.appendChild(Tag.render`\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_NO_SECTIONS')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`);\n\t\t\t\t}\n\t\t\t},\n\t\t\t(response) => {\n\t\t\t\tUtil.displayError(response.errors);\n\t\t\t},\n\t\t);\n\n\t\tthis.checkInnerWrapHeight();\n\t}\n\n\tsave()\n\t{\n\t\tBX.ajax.runAction('calendar.api.calendarajax.setTrackingSections', {\n\t\t\tdata: {\n\t\t\t\tsections: this.prepareTrackingSections(),\n\t\t\t},\n\t\t}).then(\n\t\t\t() => location.reload(),\n\t\t\t(response) => Util.displayError(response.errors),\n\t\t);\n\n\t\tthis.close();\n\t}\n\n\tgetSelectedSections(): Array<number>\n\t{\n\t\tconst sections = [];\n\t\tthis.superposedSections.forEach((section) => sections.push(parseInt(section.id, 10)));\n\n\t\treturn sections;\n\t}\n}\n","import { Util } from 'calendar.util';\nimport { IcalSyncPopup } from 'calendar.sync.interface';\nimport { Dom, Event, Loc, Tag, Text, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { MenuItem, MenuManager } from 'main.popup';\nimport { FeaturePromotersRegistry } from 'ui.info-helper';\nimport { EditForm } from './editform';\nimport { TrackingUsersForm } from './trackingusersform';\nimport { TrackingGroupsForm } from './trackinggroupsform';\nimport { TrackingCollabsForm } from './trackingcollabform';\nimport { TrackingTypesForm } from './trackingtypesform';\nimport { SectionManager } from 'calendar.sectionmanager';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport { ButtonColor, ButtonSize, SplitButton } from 'ui.buttons';\n\n/* eslint-disable @bitrix24/bitrix24-rules/no-native-dom-methods */\nexport class SectionInterface extends EventEmitter\n{\n\tname = 'sectioninterface';\n\tuid = null;\n\tDOM = {};\n\tSLIDER_WIDTH = 400;\n\tSLIDER_DURATION = 80;\n\tsliderId = 'calendar:section-slider';\n\tdenyClose = false;\n\tdeletedSectionsIds = [];\n\tisCollabFeatureEnabled = false;\n\n\tconstructor({ calendarContext, readonly, sectionManager, isCollabFeatureEnabled = false })\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.SectionInterface');\n\t\tthis.sectionManager = sectionManager;\n\t\tthis.calendarContext = calendarContext;\n\t\tthis.readonly = readonly;\n\t\tthis.BX = Util.getBX();\n\t\tthis.deleteSectionHandlerBinded = this.deleteSectionHandler.bind(this);\n\t\tthis.refreshSectionListBinded = this.refreshSectionList.bind(this);\n\t\tthis.keyHandlerBinded = this.keyHandler.bind(this);\n\t\tthis.currentUserId = this.calendarContext?.currentUser?.id;\n\t\tthis.isCollabFeatureEnabled = isCollabFeatureEnabled;\n\n\t\tif (this.calendarContext !== null && this.calendarContext.util.config.accessNames)\n\t\t{\n\t\t\tUtil.setAccessNames(this.calendarContext?.util?.config?.accessNames);\n\t\t}\n\t}\n\n\tshow()\n\t{\n\t\tthis.BX.SidePanel.Instance.open(this.sliderId, {\n\t\t\tcontentCallback: this.createContent.bind(this),\n\t\t\twidth: this.SLIDER_WIDTH,\n\t\t\tanimationDuration: this.SLIDER_DURATION,\n\t\t\tevents: {\n\t\t\t\tonCloseByEsc: this.escHide.bind(this),\n\t\t\t\tonClose: this.hide.bind(this),\n\t\t\t\tonCloseComplete: this.destroy.bind(this),\n\t\t\t\tonLoad: this.onLoadSlider.bind(this),\n\t\t\t},\n\t\t});\n\n\t\tthis.addEventEmitterSubscriptions();\n\n\t\tEvent.bind(document, 'keydown', this.keyHandlerBinded);\n\t}\n\n\taddEventEmitterSubscriptions()\n\t{\n\t\tthis.BX.Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Section:delete',\n\t\t\tthis.deleteSectionHandlerBinded,\n\t\t);\n\t\tthis.BX.Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Section:pull-delete',\n\t\t\tthis.deleteSectionHandlerBinded,\n\t\t);\n\t\tthis.BX.Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Section:edit',\n\t\t\tthis.refreshSectionListBinded,\n\t\t);\n\n\t\tthis.BX.Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Section:pull-reload-data',\n\t\t\tthis.refreshSectionListBinded,\n\t\t);\n\t}\n\n\tdestroyEventEmitterSubscriptions()\n\t{\n\t\tthis.BX.Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Section:delete',\n\t\t\tthis.deleteSectionHandlerBinded,\n\t\t);\n\t\tthis.BX.Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Section:pull-delete',\n\t\t\tthis.deleteSectionHandlerBinded,\n\t\t);\n\t\tthis.BX.Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Section:edit',\n\t\t\tthis.refreshSectionListBinded,\n\t\t);\n\t\tthis.BX.Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Section:pull-reload-data',\n\t\t\tthis.refreshSectionListBinded,\n\t\t);\n\t}\n\n\tescHide(event)\n\t{\n\t\tif (event && event.getSlider && event.getSlider().getUrl() === this.sliderId && this.denyClose)\n\t\t{\n\t\t\tevent.denyAction();\n\t\t}\n\t}\n\n\thide(event)\n\t{\n\t\tif (event && event.getSlider && event.getSlider().getUrl() === this.sliderId)\n\t\t{\n\t\t\tthis.closeForms();\n\t\t\tthis.destroyEventEmitterSubscriptions();\n\t\t\tEvent.unbind(document, 'keydown', this.keyHandlerBinded);\n\t\t}\n\t}\n\n\tclose()\n\t{\n\t\tBX.SidePanel.Instance.close();\n\t}\n\n\tdestroy(event)\n\t{\n\t\tif (event && event.getSlider && event.getSlider().getUrl() === this.sliderId)\n\t\t{\n\t\t\tthis.destroyEventEmitterSubscriptions();\n\t\t\tEvent.unbind(document, 'keydown', this.keyHandlerBinded);\n\n\t\t\tUtil.getBX().Event.EventEmitter.unsubscribe('BX.Calendar.Section:delete', this.deleteSectionHandlerBinded);\n\t\t\tUtil.getBX().Event.EventEmitter.unsubscribe('BX.Calendar.Section:pull-delete', this.deleteSectionHandlerBinded);\n\n\t\t\tBX.removeCustomEvent('SidePanel.Slider:onCloseComplete', BX.proxy(this.destroy, this));\n\t\t\tBX.SidePanel.Instance.destroy(this.sliderId);\n\t\t\tdelete this.DOM.localSectionListWrap;\n\n\t\t\tthis.deletedSectionsIds = [];\n\n\t\t\tif (this.sectionActionMenu)\n\t\t\t{\n\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t}\n\n\t\t\tif (this.trackingTypesForm)\n\t\t\t{\n\t\t\t\tdelete this.trackingTypesForm;\n\t\t\t}\n\n\t\t\tif (this.trackingUsersForm)\n\t\t\t{\n\t\t\t\tdelete this.trackingUsersForm;\n\t\t\t}\n\n\t\t\tif (this.trackingGroupsForm)\n\t\t\t{\n\t\t\t\tdelete this.trackingGroupsForm;\n\t\t\t}\n\n\t\t\tif (this.trackingCollabsForm)\n\t\t\t{\n\t\t\t\tdelete this.trackingCollabsForm;\n\t\t\t}\n\n\t\t\tif (this.addBtnMenu)\n\t\t\t{\n\t\t\t\tthis.addBtnMenu.destroy();\n\t\t\t\tdelete this.addBtnMenu;\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateContent()\n\t{\n\t\tthis.DOM.outerWrap = Tag.render`\n\t\t\t<div class=\"calendar-list-slider-wrap\"></div>\n\t\t`;\n\t\tthis.DOM.titleWrap = this.DOM.outerWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"calendar-list-slider-title-container\">\n\t\t\t\t\t<div class=\"calendar-list-slider-title\"> \n\t\t\t\t\t\t${Loc.getMessage('EC_SECTION_BUTTON')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t);\n\t\tconst calendarContext = this.calendarContext || Util.getCalendarContext();\n\n\t\tif (calendarContext && !this.readonly)\n\t\t{\n\t\t\tthis.DOM.sectionFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_NEW_SECTION')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\tcalendarContext\n\t\t\t&& !this.readonly\n\t\t\t&& (\n\t\t\t\t!calendarContext.util.isUserCalendar()\n\t\t\t\t|| calendarContext.util.userIsOwner()\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\t// #1. Controls\n\t\t\tthis.createAddButton();\n\n\t\t\t// #2. Forms\n\t\t\tthis.DOM.trackingGroupsFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_GROUP')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t);\n\t\t\tthis.DOM.trackingCollabsFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_COLLAB')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t);\n\t\t\tthis.DOM.trackingUsersFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_USER')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t);\n\t\t\tthis.DOM.trackingTypesFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_COMP')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t);\n\t\t}\n\n\t\t// #3. List of sections\n\t\tthis.createSectionList();\n\n\t\treturn this.DOM.outerWrap;\n\t}\n\n\tonLoadSlider(event)\n\t{\n\t\tthis.slider = event.getSlider();\n\t\tthis.sliderId = this.slider.getUrl();\n\t\tthis.DOM.content = this.slider.layout.content;\n\t}\n\n\tcreateSectionList()\n\t{\n\t\tthis.sliderSections = this.sectionManager.getSections().filter((section) => {\n\t\t\treturn !this.deletedSectionsIds.find((id) => id === section.id);\n\t\t});\n\t\tif (Type.isElementNode(this.DOM.sectonListOuterWrap))\n\t\t{\n\t\t\tDom.remove(this.DOM.sectonListOuterWrap);\n\t\t}\n\t\tthis.DOM.sectonListOuterWrap = this.DOM.outerWrap.appendChild(Tag.render`<div></div>`);\n\t\tEvent.bind(this.DOM.sectonListOuterWrap, 'click', this.sectionClickHandler.bind(this));\n\n\t\tthis.createLocalSectionsList();\n\t\tthis.createExternalSectionsList();\n\t}\n\n\tcreateLocalSectionsList()\n\t{\n\t\tthis.DOM.localSectionListWrap = this.DOM.sectonListOuterWrap.appendChild(\n\t\t\tthis.getSectionListWrap(this.getLocalSectionListTitle()),\n\t\t);\n\n\t\tthis.createSectionsBlock({\n\t\t\twrap: this.DOM.localSectionListWrap,\n\t\t\tsectionList: this.sliderSections.filter((section) => {\n\t\t\t\treturn (section.externalTypeIsLocal() && section.belongsToView()) || section.isPseudo();\n\t\t\t}),\n\t\t});\n\n\t\tthis.createCompanySectionList();\n\t\tthis.createUsersSectionList();\n\t\tthis.createGroupsSectionList();\n\t\tthis.createCollabSectionList();\n\t}\n\n\tcreateExternalSectionsList()\n\t{\n\t\tconst externalSections = this.sliderSections.filter((section) => {\n\t\t\treturn !section.externalTypeIsLocal() && section.belongsToView();\n\t\t});\n\n\t\tthis.DOM.extSectionListWrap = [];\n\n\t\texternalSections.forEach((section) => {\n\t\t\tconst listWrap = this.getSectionListWrapForSection(section);\n\n\t\t\tthis.createSectionUnit({\n\t\t\t\tsection,\n\t\t\t\twrap: listWrap,\n\t\t\t});\n\t\t});\n\t}\n\n\tgetSectionListWrapForSection(section)\n\t{\n\t\tlet sectionExternalType = section.getExternalType();\n\t\tif (section.isGoogle())\n\t\t{\n\t\t\tsectionExternalType = 'google';\n\t\t}\n\n\t\tif (section.data.IS_EXCHANGE)\n\t\t{\n\t\t\tsectionExternalType = 'exchange';\n\t\t}\n\n\t\tconst calendarContext = this.calendarContext || Util.getCalendarContext();\n\t\tconst sectionExternalConnection = SectionManager.getSectionExternalConnection(\n\t\t\tsection,\n\t\t\tsectionExternalType,\n\t\t\tcalendarContext,\n\t\t);\n\n\t\tsection.data.CAL_DAV_CON = sectionExternalConnection?.addParams?.id || null;\n\t\tconst key = sectionExternalType + (\n\t\t\tsectionExternalConnection\n\t\t\t\t? sectionExternalConnection.getId()\n\t\t\t\t: '-disconnected'\n\t\t);\n\n\t\tif (!Type.isElementNode(this.DOM.extSectionListWrap[key]))\n\t\t{\n\t\t\tconst sectionListWrap = this.DOM.sectonListOuterWrap.appendChild(\n\t\t\t\tthis.getSectionListWrap(this.getExternalConnectionBlockTitle(\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: sectionExternalType,\n\t\t\t\t\t\tconnection: sectionExternalConnection,\n\t\t\t\t\t},\n\t\t\t\t)),\n\t\t\t);\n\n\t\t\tsectionListWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-list-slider-widget-content\">\n\t\t\t\t\t<div class=\"calendar-list-slider-widget-content-block\">\n\t\t\t\t\t\t${this.DOM.extSectionListWrap[key] = Tag.render`<ul class=\"calendar-list-slider-container\"/>`}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`);\n\n\t\t\tif (\n\t\t\t\t!sectionExternalConnection\n\t\t\t\t&& calendarContext\n\t\t\t\t&& calendarContext.util.userIsOwner()\n\t\t\t\t&& !section.isArchive()\n\t\t\t\t&& (\n\t\t\t\t\t!section.isExchange()\n\t\t\t\t\t|| (!calendarContext.util.config.bExchange && section.isExchange())\n\t\t\t\t)\n\t\t\t)\n\t\t\t{\n\t\t\t\tsectionListWrap.querySelector('.calendar-list-slider-widget-content-block')\n\t\t\t\t\t.appendChild(\n\t\t\t\t\t\tTag.render`\n\t\t\t\t\t\t\t<div data-bx-calendar-open-sync=\"Y\" class=\"calendar-list-slider-card-widget-bottom-button\">\n\t\t\t\t\t\t\t\t<span class=\"calendar-list-slider-link\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_ADJUST_SYNC')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`,\n\t\t\t\t\t);\n\n\t\t\t\tsectionListWrap.querySelector('.calendar-list-slider-card-widget-title')\n\t\t\t\t\t.appendChild(\n\t\t\t\t\t\tTag.render`\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text calendar-list-title-disabled\" >\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_SYNC_DISABLED')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t`,\n\t\t\t\t\t);\n\t\t\t}\n\t\t\telse if (section.isArchive())\n\t\t\t{\n\t\t\t\tconst hintNode = sectionListWrap.querySelector('.calendar-list-slider-card-widget-title')\n\t\t\t\t\t.appendChild(Tag.render`\n\t\t\t\t\t\t<div class=\"ui-icon ui-icon-common-question calendar-list-slider-archive-hint\"\n\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('EC_SEC_SLIDER_TYPE_ARCHIVE_HELPER')}\">\n\t\t\t\t\t\t\t<i></i>\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`);\n\t\t\t\tif (Type.isDomNode(hintNode))\n\t\t\t\t{\n\t\t\t\t\tUtil.initHintNode(hintNode);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.DOM.extSectionListWrap[key];\n\t}\n\n\tgetExternalConnectionBlockTitle({ type, connection }): string\n\t{\n\t\tlet title = '';\n\t\tconst connectionName = connection\n\t\t\t? connection.getConnectionAccountName() || connection.getConnectionName()\n\t\t\t: null\n\t\t;\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase 'google':\n\t\t\t\tif (connectionName)\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage(\n\t\t\t\t\t\t'EC_SEC_SLIDER_TYPE_GOOGLE',\n\t\t\t\t\t\t{ '#CONNECTION_NAME#': connectionName },\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_GOOGLE_DIS');\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 'office365':\n\t\t\t\tif (connectionName)\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage(\n\t\t\t\t\t\t'EC_SEC_SLIDER_TYPE_OFFICE365',\n\t\t\t\t\t\t{ '#CONNECTION_NAME#': connectionName },\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_OFFICE365_DIS');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'icloud':\n\t\t\t\tif (connectionName)\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage(\n\t\t\t\t\t\t'EC_SEC_SLIDER_TYPE_ICLOUD',\n\t\t\t\t\t\t{ '#CONNECTION_NAME#': connectionName },\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_ICLOUD_DIS');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'caldav':\n\t\t\t\tif (connectionName)\n\t\t\t\t{\n\t\t\t\t\tif (connection.getType() === 'yandex')\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = Loc.getMessage(\n\t\t\t\t\t\t\t'EC_SEC_SLIDER_TYPE_YANDEX',\n\t\t\t\t\t\t\t{ '#CONNECTION_NAME#': connectionName },\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = Loc.getMessage(\n\t\t\t\t\t\t\t'EC_SEC_SLIDER_TYPE_CALDAV',\n\t\t\t\t\t\t\t{ '#CONNECTION_NAME#': connectionName },\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_DEFAULT');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'exchange':\n\t\t\t\ttitle = Loc.getMessage('EC_CAL_SYNC_EXCHANGE');\n\t\t\t\tbreak;\n\t\t\tcase 'archive':\n\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_ARCHIVE');\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_DEFAULT');\n\t\t}\n\n\t\treturn title;\n\t}\n\n\tcreateCompanySectionList()\n\t{\n\t\tconst sections = this.sliderSections.filter((section) => {\n\t\t\treturn section.isCompanyCalendar() && !section.belongsToView();\n\t\t});\n\n\t\tif (sections.length > 0)\n\t\t{\n\t\t\tthis.DOM.localSectionListWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-list-slider-card-section-title\">\n\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_TITLE_COMP_CALENDAR')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`);\n\n\t\t\tthis.createSectionsBlock({\n\t\t\t\twrap: this.DOM.localSectionListWrap,\n\t\t\t\tsectionList: this.sliderSections.filter((section) => {\n\t\t\t\t\treturn section.isCompanyCalendar();\n\t\t\t\t}),\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateUsersSectionList()\n\t{\n\t\tthis.calendarContext.util.getSuperposedTrackedUsers().forEach((user) => {\n\t\t\tconst sections = this.sliderSections.filter((section) => {\n\t\t\t\treturn !section.belongsToView()\n\t\t\t\t\t&& section.type === 'user'\n\t\t\t\t\t&& section.data.OWNER_ID === user.ID;\n\t\t\t});\n\n\t\t\tif (sections.length > 0)\n\t\t\t{\n\t\t\t\tconst calendarName = this.currentUserId === parseInt(user.ID, 10)\n\t\t\t\t\t? Loc.getMessage('EC_SEC_SLIDER_MY_CALENDARS_LIST')\n\t\t\t\t\t: Text.encode(user.FORMATTED_NAME)\n\t\t\t\t;\n\t\t\t\tthis.DOM.localSectionListWrap.appendChild(Tag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-section-title\">\n\t\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t\t${calendarName}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t`);\n\n\t\t\t\tthis.createSectionsBlock({\n\t\t\t\t\twrap: this.DOM.localSectionListWrap,\n\t\t\t\t\tsectionList: sections,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tcreateGroupsSectionList()\n\t{\n\t\tconst sections = this.sliderSections.filter((section) => (\n\t\t\t!section.belongsToView() && section.type === 'group' && !section.isCollab()\n\t\t));\n\n\t\tif (sections.length > 0)\n\t\t{\n\t\t\tthis.DOM.localSectionListWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-list-slider-card-section-title\">\n\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_TITLE_GROUP_CALENDAR')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`);\n\n\t\t\tthis.createSectionsBlock({\n\t\t\t\twrap: this.DOM.localSectionListWrap,\n\t\t\t\tsectionList: sections,\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateCollabSectionList()\n\t{\n\t\tconst sections = this.sliderSections.filter((section) => (\n\t\t\t!section.belongsToView() && section.type === 'group' && section.isCollab()\n\t\t));\n\n\t\tif (sections.length > 0)\n\t\t{\n\t\t\tthis.DOM.localSectionListWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-list-slider-card-section-title\">\n\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_TITLE_COLLAB_CALENDAR')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`);\n\n\t\t\tthis.createSectionsBlock({\n\t\t\t\twrap: this.DOM.localSectionListWrap,\n\t\t\t\tsectionList: sections,\n\t\t\t});\n\t\t}\n\t}\n\n\tgetSectionListWrap(title): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-list-slider-card-widget\">\n\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t${Text.encode(title)}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetLocalSectionListTitle(): string\n\t{\n\t\tif (this.sectionManager.calendarType === 'user')\n\t\t{\n\t\t\treturn Loc.getMessage('EC_SEC_SLIDER_MY_CALENDARS_LIST');\n\t\t}\n\n\t\tconst calendarContext = this.calendarContext || Util.getCalendarContext();\n\t\tif (\n\t\t\tthis.sectionManager.calendarType === 'group'\n\t\t\t&& calendarContext?.isCollabCalendar\n\t\t)\n\t\t{\n\t\t\treturn Loc.getMessage('EC_SEC_SLIDER_THIS_COLLAB_CALENDARS_LIST');\n\t\t}\n\n\t\tif (\n\t\t\tthis.sectionManager.calendarType === 'group'\n\t\t\t&& !calendarContext?.isCollabCalendar\n\t\t)\n\t\t{\n\t\t\treturn Loc.getMessage('EC_SEC_SLIDER_GROUP_CALENDARS_LIST');\n\t\t}\n\n\t\treturn Loc.getMessage('EC_SEC_SLIDER_TYPE_CALENDARS_LIST');\n\t}\n\n\tcreateAddButton()\n\t{\n\t\tconst calendarContext = this.calendarContext || Util.getCalendarContext();\n\n\t\tif (\n\t\t\tcalendarContext.util.config.perm?.edit_section\n\t\t\t&& !calendarContext.isCollabUser\n\t\t)\n\t\t{\n\t\t\tconst button = new SplitButton({\n\t\t\t\ttext: Loc.getMessage('EC_ADD'),\n\t\t\t\tsize: ButtonSize.MEDIUM,\n\t\t\t\tcolor: ButtonColor.LIGHT_BORDER,\n\t\t\t\tmainButton: {\n\t\t\t\t\tonclick: this.showEditSectionForm.bind(this),\n\t\t\t\t},\n\t\t\t\tmenuButton: {\n\t\t\t\t\tonclick: this.showAddButtonPopup.bind(this),\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tbutton.renderTo(this.DOM.titleWrap);\n\n\t\t\tthis.DOM.addButton = button.getMainButton().getContainer();\n\t\t\tthis.DOM.addButtonMore = button.getMenuButton().getContainer();\n\t\t}\n\t}\n\n\tshowAddButtonPopup(): void\n\t{\n\t\tif (this.addBtnMenu && this.addBtnMenu.popupWindow && this.addBtnMenu.popupWindow.isShown())\n\t\t{\n\t\t\tthis.addBtnMenu.close();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = [\n\t\t\tnew MenuItem({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_NEW_TITLE'),\n\t\t\t\tdelimiter: true,\n\t\t\t}),\n\t\t\t{\n\t\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_POPUP_NEW_MENU'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\t\tthis.showEditSectionForm();\n\t\t\t\t},\n\t\t\t},\n\t\t\tnew MenuItem({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_EXIST_TITLE'),\n\t\t\t\tdelimiter: true,\n\t\t\t}),\n\t\t\tthis.getAddCompanyMenuItem(),\n\t\t\tthis.getAddUserMenuItem(),\n\t\t];\n\n\t\tconst calendarContext = this.calendarContext || Util.getCalendarContext();\n\t\tconst { isBitrix24Template } = calendarContext.util.config;\n\n\t\tif (isBitrix24Template)\n\t\t{\n\t\t\tmenuItems.push(this.getAddGroupMenuItem());\n\t\t}\n\n\t\tif (isBitrix24Template && this.isCollabFeatureEnabled)\n\t\t{\n\t\t\tmenuItems.push(this.getAddCollabMenuItem());\n\t\t}\n\n\t\tthis.addBtnMenu = MenuManager.create(\n\t\t\t`add-btn-${Util.getRandomInt()}`,\n\t\t\tthis.DOM.addButtonMore,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tzIndex: this.zIndex,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 15,\n\t\t\t\tangle: true,\n\t\t\t\tcacheable: false,\n\t\t\t},\n\t\t);\n\n\t\tthis.addBtnMenu.show();\n\t}\n\n\tgetAddCompanyMenuItem(): Object\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_COMP'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\tthis.showTrackingTypesForm();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetAddUserMenuItem(): Object\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_USER'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\tthis.showTrackingUsersForm();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetAddGroupMenuItem(): Object\n\t{\n\t\tconst calendarContext = this.calendarContext || Util.getCalendarContext();\n\n\t\tif (calendarContext.util.config.projectFeatureEnabled)\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_GROUP'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\t\tthis.showTrackingGroupsForm();\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tclassName: 'menu-popup-item-lock',\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_GROUP'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\tFeaturePromotersRegistry.getPromoter({ featureId: 'socialnetwork_projects_groups' }).show();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetAddCollabMenuItem(): Object\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_COLLAB'),\n\t\t\tonclick: (): void => {\n\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\tthis.showTrackingCollabsForm();\n\t\t\t},\n\t\t};\n\t}\n\n\tcreateSectionsBlock({ sectionList, wrap })\n\t{\n\t\tif (Type.isArray(sectionList))\n\t\t{\n\t\t\tconst listWrap = wrap.appendChild(Tag.render`<div class=\"calendar-list-slider-widget-content\"></div>`)\n\t\t\t\t.appendChild(Tag.render`<div class=\"calendar-list-slider-widget-content-block\"></div>`)\n\t\t\t\t.appendChild(Tag.render`<ul class=\"calendar-list-slider-container\"></ul>`)\n\t\t\t;\n\n\t\t\tsectionList.forEach((section) => {\n\t\t\t\tthis.createSectionUnit({ section, wrap: listWrap });\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateSectionUnit({ section, wrap })\n\t{\n\t\tif (!section.DOM)\n\t\t{\n\t\t\tsection.DOM = {};\n\t\t}\n\t\tconst sectionId = section.id.toString();\n\t\tconst li = wrap.appendChild(Tag.render`\n\t\t\t<li class=\"calendar-list-slider-item\" data-bx-calendar-section=\"${sectionId}\"></li>\n\t\t`);\n\t\tconst checkbox = li.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-list-slider-item-checkbox ${section.isShown() ? 'calendar-list-slider-item-checkbox-checked' : ''}\" style=\"background-color: ${section.color}\"></div>\n\t\t`);\n\t\tconst title = li.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-list-slider-item-name\" title=\"${Text.encode(section.name)}\">${Text.encode(section.name)}</div>\n\t\t`);\n\n\t\tsection.DOM.item = li;\n\t\tsection.DOM.checkbox = checkbox;\n\t\tsection.DOM.title = title;\n\n\t\tsection.DOM.actionCont = li.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-list-slider-item-actions-container\" data-bx-calendar-section-menu=\"${sectionId}\">\n\t\t\t\t<span class=\"calendar-list-slider-item-context-menu\"></span>\n\t\t\t</div>\n\t\t`);\n\t}\n\n\tsectionClickHandler(e)\n\t{\n\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\tif (target && target.getAttribute)\n\t\t{\n\t\t\tif (target.getAttribute('data-bx-calendar-section-menu') !== null)\n\t\t\t{\n\t\t\t\tlet sectionId = target.getAttribute('data-bx-calendar-section-menu');\n\t\t\t\tsectionId = sectionId === 'tasks' ? sectionId : parseInt(sectionId, 10);\n\t\t\t\tthis.showSectionMenu(this.sectionManager.getSection(sectionId), target);\n\t\t\t}\n\t\t\telse if (target.getAttribute('data-bx-calendar-section') !== null)\n\t\t\t{\n\t\t\t\tthis.switchSection(this.sectionManager.getSection(target.getAttribute('data-bx-calendar-section')));\n\t\t\t}\n\t\t\telse if (target.getAttribute('data-bx-calendar-open-sync') !== null)\n\t\t\t{\n\t\t\t\tthis.calendarContext.syncInterface.openSyncPanel();\n\t\t\t}\n\t\t}\n\t}\n\n\tfindCheckBoxNodes(id): Array<HTMLElement>\n\t{\n\t\treturn this.DOM.sectonListOuterWrap.querySelectorAll(\n\t\t\t`.calendar-list-slider-item[data-bx-calendar-section='${id}'] .calendar-list-slider-item-checkbox`,\n\t\t);\n\t}\n\n\tswitchSection(section)\n\t{\n\t\tconst checkboxNodes = this.findCheckBoxNodes(section.id);\n\n\t\tfor (const checkboxNode of checkboxNodes)\n\t\t{\n\t\t\tif (section.isShown())\n\t\t\t{\n\t\t\t\tDom.removeClass(checkboxNode, 'calendar-list-slider-item-checkbox-checked');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.addClass(checkboxNode, 'calendar-list-slider-item-checkbox-checked');\n\t\t\t}\n\t\t}\n\n\t\tif (section.isShown())\n\t\t{\n\t\t\tsection.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsection.show();\n\t\t}\n\n\t\t// TODO: should use eventEmtter\n\t\tthis.calendarContext.reload();\n\t}\n\n\tswitchOnSection(section)\n\t{\n\t\tconst checkboxNodes = this.findCheckBoxNodes(section.id);\n\n\t\tfor (const checkboxNode of checkboxNodes)\n\t\t{\n\t\t\tif (!section.isShown())\n\t\t\t{\n\t\t\t\tDom.addClass(checkboxNode, 'calendar-list-slider-item-checkbox-checked');\n\t\t\t}\n\t\t}\n\n\t\tif (!section.isShown())\n\t\t{\n\t\t\tsection.show();\n\t\t}\n\t}\n\n\tswitchOffSection(section)\n\t{\n\t\tconst checkboxNodes = this.findCheckBoxNodes(section.id);\n\n\t\tfor (const checkboxNode of checkboxNodes)\n\t\t{\n\t\t\tif (section.isShown())\n\t\t\t{\n\t\t\t\tDom.removeClass(checkboxNode, 'calendar-list-slider-item-checkbox-checked');\n\t\t\t}\n\t\t}\n\n\t\tif (section.isShown())\n\t\t{\n\t\t\tsection.hide();\n\t\t}\n\t}\n\n\tshowSectionMenu(section, menuItemNode)\n\t{\n\t\tconst menuItems = [];\n\t\tconst itemNode = menuItemNode.closest('[data-bx-calendar-section]');\n\t\tif (Type.isElementNode(itemNode))\n\t\t{\n\t\t\tDom.addClass(itemNode, 'active');\n\t\t}\n\n\t\tif (section.canDo('view_time'))\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_LEAVE_ONE'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tthis.showOnlyOneSection(section, this.sectionManager.sections);\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tif (!section.isPseudo() && section.getLink() && !section.belongsToView())\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_OPEN_LINK'),\n\t\t\t\thref: section.getLink(),\n\t\t\t});\n\t\t}\n\n\t\tif (\n\t\t\t!this.readonly\n\t\t\t&& section.canDo('edit_section')\n\t\t\t&& !section.isPseudo()\n\t\t)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_EDIT'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tthis.showEditSectionForm({ section });\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tif (section.isSuperposed() && !section.belongsToView())\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_HIDE'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.hideSuperposedHandler(section);\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tif (section.canBeConnectedToOutlook() && section.data.EXTERNAL_TYPE === 'local')\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_CONNECT_TO_OUTLOOK'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tsection.connectToOutlook();\n\t\t\t\t\tthis.close();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tif (\n\t\t\t!section.isPseudo()\n\t\t\t&& section.data.EXPORT?.LINK\n\t\t\t&& section.data.EXPORT?.PATH\n\t\t\t&& section.data.EXTERNAL_TYPE === 'local'\n\t\t\t&& !this.calendarContext?.util?.isExtranetUser()\n\t\t)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_ACTION_EXPORT'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\n\t\t\t\t\tconst options = {\n\t\t\t\t\t\tsectionLink: section.data.EXPORT.LINK,\n\t\t\t\t\t\tcalendarPath: section.data.EXPORT.PATH,\n\t\t\t\t\t};\n\t\t\t\t\tif (IcalSyncPopup.checkPathes(options))\n\t\t\t\t\t{\n\t\t\t\t\t\tIcalSyncPopup.createInstance(options).show();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tIcalSyncPopup.showPopupWithPathesError();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tlet provider;\n\t\tlet connection;\n\n\t\tif (section.data.CAL_DAV_CON\n\t\t\t&& section.belongsToView()\n\t\t\t&& this.calendarContext.syncInterface\n\t\t)\n\t\t{\n\t\t\t[provider, connection] = this.calendarContext.syncInterface.getProviderById(section.data.CAL_DAV_CON);\n\t\t}\n\n\t\tif (\n\t\t\tsection.canDo('edit_section')\n\t\t\t&& section.belongsToView()\n\t\t\t&& !section.isPseudo()\n\t\t\t&& (\n\t\t\t\t(!section.isGoogle() && !connection)\n\t\t\t\t|| section.data.EXTERNAL_TYPE === 'local'\n\t\t\t\t|| !connection\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_DELETE'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tthis.showSectionConfirm('delete', section);\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tif (section.canDo('edit_section') && connection)\n\t\t{\n\t\t\tif (section.isGoogle() || section.isIcloud() || section.isOffice365() || section.isCalDav())\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: Loc.getMessage('EC_ACTION_EXTERNAL_ADJUST'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\t\tif (provider)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tprovider.openActiveConnectionSlider(connection);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (section.isGoogle() || section.isIcloud() || section.isOffice365())\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: Loc.getMessage('EC_ACTION_HIDE'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\t\tthis.showSectionConfirm('hideSync', section);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\telse if (section.isCalDav())\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: Loc.getMessage('EC_ACTION_HIDE'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\t\tthis.showSectionConfirm('hideExternal', section);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (section.isPseudo() && section.taskSectionBelongToUser())\n\t\t{\n\t\t\tmenuItems.push(\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('EC_SEC_EDIT'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\t\tthis.showEditSectionForm({\n\t\t\t\t\t\t\tsection,\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('EC_SEC_TASK_HIDE'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\t\tBX.userOptions.save('calendar', 'user_settings', 'showTasks', 'N');\n\n\t\t\t\t\t\tDom.addClass(section.DOM.item, 'calendar-list-slider-item-disappearing');\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tDom.clean(section.DOM.item, true);\n\t\t\t\t\t\t\tBX.reload();\n\t\t\t\t\t\t}, 300);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\tif (menuItems && menuItems.length > 0)\n\t\t{\n\t\t\tthis.sectionActionMenu = MenuManager.create(\n\t\t\t\t`section-menu-${Util.getRandomInt()}`,\n\t\t\t\tmenuItemNode,\n\t\t\t\tmenuItems,\n\t\t\t\t{\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tzIndex: this.zIndex,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: 9,\n\t\t\t\t\tangle: true,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t},\n\t\t\t);\n\n\t\t\tthis.sectionActionMenu.show();\n\t\t\tthis.sectionActionMenu.popupWindow.subscribe('onClose', () => {\n\t\t\t\tif (Type.isElementNode(itemNode))\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(itemNode, 'active');\n\t\t\t\t}\n\t\t\t\tthis.allowSliderClose();\n\t\t\t});\n\n\t\t\tthis.denySliderClose();\n\t\t}\n\t}\n\n\tdenySliderClose()\n\t{\n\t\tthis.denyClose = true;\n\t}\n\n\tallowSliderClose()\n\t{\n\t\tthis.denyClose = false;\n\t}\n\n\tcloseForms()\n\t{\n\t\tif (this.addBtnMenu)\n\t\t{\n\t\t\tthis.addBtnMenu.close();\n\t\t}\n\n\t\tif (this.editSectionForm)\n\t\t{\n\t\t\tthis.editSectionForm.close();\n\t\t}\n\n\t\tif (this.trackingUsersForm)\n\t\t{\n\t\t\tthis.trackingUsersForm.close();\n\t\t}\n\n\t\tif (this.trackingGroupsForm)\n\t\t{\n\t\t\tthis.trackingGroupsForm.close();\n\t\t}\n\n\t\tif (this.trackingCollabsForm)\n\t\t{\n\t\t\tthis.trackingCollabsForm.close();\n\t\t}\n\n\t\tif (this.trackingTypesForm)\n\t\t{\n\t\t\tthis.trackingTypesForm.close();\n\t\t}\n\t}\n\n\tshowEditSectionForm(params = {})\n\t{\n\t\tif (!this.DOM.sectionFormWrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.closeForms();\n\t\tconst formTitleNode = this.DOM.sectionFormWrap.querySelector('.calendar-list-slider-card-widget-title-text');\n\n\t\tthis.editSectionForm = new EditForm({\n\t\t\twrap: this.DOM.sectionFormWrap,\n\t\t\tsectionAccessTasks: this.sectionManager.getSectionAccessTasks(),\n\t\t\tsectionManager: this.sectionManager,\n\t\t\tcalendarContext: this.calendarContext,\n\t\t\tcloseCallback: () => {\n\t\t\t\tthis.allowSliderClose();\n\t\t\t},\n\t\t});\n\n\t\tlet showAccessControl = true;\n\t\tif (params.section && (!params.section.belongsToView() || params.section.isPseudo()))\n\t\t{\n\t\t\tformTitleNode.innerHTML = Loc.getMessage('EC_SEC_SLIDER_EDIT_SECTION_PERSONAL');\n\t\t\tshowAccessControl = false;\n\t\t}\n\t\telse if (params.section && params.section.id)\n\t\t{\n\t\t\tformTitleNode.innerHTML = Loc.getMessage('EC_SEC_SLIDER_EDIT_SECTION');\n\t\t\tshowAccessControl = params.section.hasPermission('access');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tformTitleNode.innerHTML = Loc.getMessage('EC_SEC_SLIDER_NEW_SECTION');\n\t\t}\n\n\t\tthis.editSectionForm.show({\n\t\t\tshowAccess: showAccessControl,\n\t\t\tallowChangeName: params.section ? !params.section.isPrimaryForConnection() : true,\n\t\t\tsection: params.section || {\n\t\t\t\tcolor: Util.getRandomColor(),\n\t\t\t\taccess: this.sectionManager.getDefaultSectionAccess(),\n\t\t\t},\n\t\t});\n\n\t\tthis.denySliderClose();\n\t}\n\n\tshowTrackingTypesForm()\n\t{\n\t\tthis.closeForms();\n\n\t\tif (!this.trackingTypesForm)\n\t\t{\n\t\t\tthis.trackingTypesForm = new TrackingTypesForm({\n\t\t\t\twrap: this.DOM.trackingTypesFormWrap,\n\t\t\t\tsuperposedSections: this.sectionManager.getSuperposedSectionList(),\n\t\t\t\tcloseCallback: () => {\n\t\t\t\t\tthis.allowSliderClose();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tthis.trackingTypesForm.show();\n\t\tthis.denySliderClose();\n\t}\n\n\tshowTrackingUsersForm()\n\t{\n\t\tthis.closeForms();\n\n\t\tif (!this.trackingUsersForm)\n\t\t{\n\t\t\tthis.trackingUsersForm = new TrackingUsersForm({\n\t\t\t\twrap: this.DOM.trackingUsersFormWrap,\n\t\t\t\ttrackingUsers: this.calendarContext.util.getSuperposedTrackedUsers(),\n\t\t\t\tsuperposedSections: this.sectionManager.getSuperposedSectionList(),\n\t\t\t\tcloseCallback: () => {\n\t\t\t\t\tthis.allowSliderClose();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tthis.trackingUsersForm.show();\n\t\tthis.denySliderClose();\n\t}\n\n\tshowTrackingGroupsForm()\n\t{\n\t\tthis.closeForms();\n\n\t\tif (!this.trackingGroupsForm)\n\t\t{\n\t\t\tconst superposedSections = this.sectionManager.getSuperposedSectionList();\n\t\t\tconst trackingGroups = [];\n\t\t\tconst collabs = [];\n\n\t\t\tsuperposedSections.forEach((section) => {\n\t\t\t\tif (section.getType() !== 'group')\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst ownerId = section.getOwnerId();\n\t\t\t\tif (\n\t\t\t\t\t!section.isCollab()\n\t\t\t\t\t&& !trackingGroups.includes(ownerId)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\ttrackingGroups.push(ownerId);\n\t\t\t\t}\n\t\t\t\telse if (\n\t\t\t\t\tsection.isCollab()\n\t\t\t\t\t&& !collabs.includes(ownerId)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tcollabs.push(ownerId);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.trackingGroupsForm = new TrackingGroupsForm({\n\t\t\t\twrap: this.DOM.trackingGroupsFormWrap,\n\t\t\t\ttrackingGroups,\n\t\t\t\tcollabs,\n\t\t\t\tsuperposedSections,\n\t\t\t\tcloseCallback: (): void => this.allowSliderClose(),\n\t\t\t});\n\t\t}\n\n\t\tthis.trackingGroupsForm.show();\n\t\tthis.denySliderClose();\n\t}\n\n\tshowTrackingCollabsForm(): void\n\t{\n\t\tthis.closeForms();\n\n\t\tif (!this.trackingCollabsForm)\n\t\t{\n\t\t\tthis.trackingCollabsForm = this.createTrackingCollabsForm();\n\t\t}\n\n\t\tthis.trackingCollabsForm.show();\n\t\tthis.denySliderClose();\n\t}\n\n\tcreateTrackingCollabsForm(): TrackingCollabsForm\n\t{\n\t\tconst superposedSections = this.sectionManager.getSuperposedSectionList();\n\t\tconst trackingCollabs = [];\n\t\tconst groups = [];\n\n\t\tsuperposedSections.forEach((section): void => {\n\t\t\tif (section.getType() !== 'group')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst ownerId = section.getOwnerId();\n\t\t\tif (\n\t\t\t\tsection.isCollab()\n\t\t\t\t&& !trackingCollabs.includes(ownerId)\n\t\t\t)\n\t\t\t{\n\t\t\t\ttrackingCollabs.push(ownerId);\n\t\t\t}\n\t\t\telse if (\n\t\t\t\t!section.isCollab()\n\t\t\t\t&& !groups.includes(ownerId)\n\t\t\t)\n\t\t\t{\n\t\t\t\tgroups.push(ownerId);\n\t\t\t}\n\t\t});\n\n\t\treturn new TrackingCollabsForm({\n\t\t\twrap: this.DOM.trackingCollabsFormWrap,\n\t\t\ttrackingCollabs,\n\t\t\tgroups,\n\t\t\tsuperposedSections,\n\t\t\tcloseCallback: (): void => this.allowSliderClose(),\n\t\t});\n\t}\n\n\tdeleteSectionHandler(event)\n\t{\n\t\tif (event && event instanceof this.BX.Event.BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\t\t\tconst sectionId = parseInt(data.sectionId, 10);\n\n\t\t\tthis.sliderSections.forEach((section, index) => {\n\t\t\t\tif (parseInt(section.id, 10) === sectionId)\n\t\t\t\t{\n\t\t\t\t\tthis.sectionManager.deleteSectionHandler(sectionId);\n\t\t\t\t\tthis.deletedSectionsIds.push(sectionId);\n\t\t\t\t\tconst deleteSectionNodes = this.DOM.sectonListOuterWrap.querySelectorAll(\n\t\t\t\t\t\t`.calendar-list-slider-item[data-bx-calendar-section='${sectionId}']`,\n\t\t\t\t\t);\n\n\t\t\t\t\tdeleteSectionNodes.forEach((node) => {\n\t\t\t\t\t\tDom.addClass(node, 'calendar-list-slider-item-disappearing');\n\t\t\t\t\t});\n\n\t\t\t\t\tif (!section.externalTypeIsLocal())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst listWrap = this.getSectionListWrapForSection(section);\n\t\t\t\t\t\tthis.sliderSections = BX.util.deleteFromArray(this.sliderSections, index);\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tdeleteSectionNodes.forEach((node) => {\n\t\t\t\t\t\t\t\tDom.remove(node);\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tif (!listWrap.querySelector('li.calendar-list-slider-item'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tDom.remove(listWrap.closest('.calendar-list-slider-card-widget'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 300);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.closeForms();\n\t\t}\n\t}\n\n\thideSuperposedHandler(section)\n\t{\n\t\tconst superposedSections = this.sectionManager.getSuperposedSectionList();\n\t\tconst sections = [];\n\t\tlet i;\n\n\t\tfor (i = 0; i < superposedSections.length; i++)\n\t\t{\n\t\t\tif (parseInt(section.id, 10) !== parseInt(superposedSections[i].id, 10))\n\t\t\t{\n\t\t\t\tsections.push(parseInt(superposedSections[i].id, 10));\n\t\t\t}\n\t\t}\n\n\t\tBX.ajax.runAction('calendar.api.calendarajax.setTrackingSections', {\n\t\t\tdata: {\n\t\t\t\tsections,\n\t\t\t},\n\t\t}).then(\n\t\t\t() => BX.reload(),\n\t\t\t(response) => Util.displayError(response.errors),\n\t\t);\n\t}\n\n\trefreshSectionList()\n\t{\n\t\tthis.createSectionList();\n\t}\n\n\tshowOnlyOneSection(section, sections)\n\t{\n\t\tfor (const curSection of sections)\n\t\t{\n\t\t\tif (curSection.id === section.id)\n\t\t\t{\n\t\t\t\tthis.switchOnSection(curSection);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.switchOffSection(curSection);\n\t\t\t}\n\t\t}\n\n\t\tthis.calendarContext.reload();\n\t}\n\n\tkeyHandler(e)\n\t{\n\t\tif (\n\t\t\te.keyCode === Util.getKeyCode('enter')\n\t\t\t&& this.DOM.confirmSectionPopup\n\t\t\t&& this.currentConfirmMode\n\t\t\t&& this.currentSection\n\t\t)\n\t\t{\n\t\t\tswitch (this.currentConfirmMode)\n\t\t\t{\n\t\t\t\tcase 'delete': {\n\t\t\t\t\tthis.removeSection(this.currentSection);\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase 'hideSync': {\n\t\t\t\t\tthis.hideSyncSection(this.currentSection);\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase 'hideExternal': {\n\t\t\t\t\tthis.hideExternalSection(this.currentSection);\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t// no default\n\t\t\t}\n\t\t}\n\t}\n\n\tshowSectionConfirm(mode, section)\n\t{\n\t\tthis.currentSection = section;\n\t\tthis.currentConfirmMode = mode;\n\n\t\tconst confirmCallback = this.getConfirmCallback();\n\t\tconst okCaption = this.getOkCaption();\n\n\t\tthis.DOM.confirmSectionPopup = new MessageBox({\n\t\t\tmessage: this.getSectionConfirmContent(),\n\t\t\tminHeight: 120,\n\t\t\tminWidth: 280,\n\t\t\tmaxWidth: 300,\n\t\t\tbuttons: BX.UI.Dialogs.MessageBoxButtons.OK_CANCEL,\n\t\t\tonOk: confirmCallback,\n\t\t\tonCancel: () => {\n\t\t\t\tthis.DOM.confirmSectionPopup.close();\n\t\t\t},\n\t\t\tokCaption,\n\t\t\tpopupOptions: {\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\tdelete this.DOM.confirmSectionPopup;\n\t\t\t\t\t\tdelete this.currentSection;\n\t\t\t\t\t\tdelete this.currentConfirmMode;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tpadding: 0,\n\t\t\t\tcontentPadding: 0,\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t},\n\t\t});\n\n\t\tthis.DOM.confirmSectionPopup.show();\n\t}\n\n\tgetConfirmCallback(): Function | null\n\t{\n\t\tif (this.currentConfirmMode === 'delete')\n\t\t{\n\t\t\treturn () => {\n\t\t\t\tthis.removeSection(this.currentSection);\n\t\t\t};\n\t\t}\n\n\t\tif (this.currentConfirmMode === 'hideSync')\n\t\t{\n\t\t\treturn () => {\n\t\t\t\tthis.hideSyncSection(this.currentSection);\n\t\t\t};\n\t\t}\n\n\t\tif (this.currentConfirmMode === 'hideExternal')\n\t\t{\n\t\t\treturn () => {\n\t\t\t\tthis.hideExternalSection(this.currentSection);\n\t\t\t};\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetOkCaption(): string | null\n\t{\n\t\tif (this.currentConfirmMode === 'delete')\n\t\t{\n\t\t\treturn Loc.getMessage('EC_SEC_DELETE');\n\t\t}\n\n\t\tif (this.currentConfirmMode === 'hideSync' || this.currentConfirmMode === 'hideExternal')\n\t\t{\n\t\t\treturn Loc.getMessage('EC_CAL_SYNC_DISCONNECT');\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetSectionConfirmContent(): HTMLElement\n\t{\n\t\tlet phrase = '';\n\n\t\tif (this.currentConfirmMode === 'delete')\n\t\t{\n\t\t\tphrase = Loc.getMessage('EC_SEC_DELETE_CONFIRM');\n\t\t}\n\t\telse if (this.currentConfirmMode === 'hideSync' || this.currentConfirmMode === 'hideExternal')\n\t\t{\n\t\t\tphrase = Loc.getMessage('EC_CAL_GOOGLE_HIDE_CONFIRM');\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-list-slider-messagebox-text\">${phrase}</div>\n\t\t`;\n\t}\n\n\tremoveSection(section)\n\t{\n\t\tsection.remove();\n\t\tthis.DOM.confirmSectionPopup.close();\n\t}\n\n\thideSyncSection(section)\n\t{\n\t\tsection.hideSyncSection();\n\t\tthis.DOM.confirmSectionPopup.close();\n\t}\n\n\thideExternalSection(section)\n\t{\n\t\tsection.hideExternalCalendarSection();\n\t\tthis.DOM.confirmSectionPopup.close();\n\t}\n}\n"],"names":["EditForm","EventEmitter","constructor","options","DOM","isCreated","setEventNamespace","outerWrap","wrap","sectionAccessTasks","sectionManager","closeCallback","BX","Util","getBX","calendarContext","keyHandlerBinded","keyHandler","bind","show","params","section","create","showAccess","allowChangeName","accessLink","style","display","accessWrap","Event","document","Dom","addClass","color","setColor","setAccess","access","data","ACCESS","name","sectionTitleInput","value","focus","select","disabled","isOpenedState","close","unbind","removeClass","Type","isFunction","isOpened","querySelector","clean","appendChild","props","className","formFieldsWrap","attrs","type","placeholder","Loc","getMessage","optionsWrap","initSectionColorSelector","initAccessController","buttonsWrap","saveBtn","UI","Button","text","events","click","save","renderTo","checkClose","e","keyCode","getKeyCode","setWaiting","saveSection","then","colorContWrap","html","colorIcon","colorChangeLink","showSimplePicker","colors","Runtime","clone","getDefaultColorList","innerCont","colorWrap","delegate","simplePickerClick","moreLinkWrap","moreLink","showFullPicker","simplePickerColorWrap","includes","push","i","length","node","backgroundColor","lastActiveNode","util","array_search","simpleColorPopup","PopupWindowManager","getRandomInt","autoHide","closeByEsc","offsetTop","offsetLeft","lightShadow","content","cacheable","setAngle","offset","target","findTargetNode","srcElement","isElementNode","getAttribute","fullColorPicker","getPopupWindow","isDestroyed","ColorPicker","bindElement","onColorSelected","popupOptions","zIndex","onPopupClose","open","rowsCount","code","hasOwnProperty","accessRowsCount","insertAccessRow","getAccessName","checkAccessTableHeight","buildAccessController","calendarType","initDialogGroup","initDialogStandard","initAccessSelectorPopup","accessControls","showAccessSelectorPopup","removeIcon","setValueCallback","accessTasks","valueNode","innerHTML","Text","encode","title","remove","rowNode","Tag","render","accessTable","accessButton","hasClass","entities","id","analyticsSource","selectMode","getCalendarContext","config","projectFeatureEnabled","entitySelectorDialog","EntitySelectorDialog","targetNode","context","preselectedItems","enableSearch","handleEntitySelectorChanges","targetContainer","body","tabs","ownerName","items","ownerId","entityId","entityList","getSelectedItems","hide","isArray","forEach","entity","convertEntityToAccessCode","setAccessName","debounce","destroy","undefined","taskId","adjust","insertRow","titleNode","insertCell","valueCell","selectNode","checkTableTimeout","clearTimeout","setTimeout","offsetHeight","maxHeight","parseInt","accessPopupMenu","popupWindow","isShown","_this","menuItems","onclick","PopupMenu","randomInt","angle","TrackingUsersForm","interfaceType","trackingUsers","trackingUserIdList","map","item","ID","trackingIdList","CHECKED_CLASS","selectorId","superposedSections","selected","checkInnerWrapHeight","updateSectionList","firstTrackingUserIdList","cssText","innerWrap","selectorWrap","userTagSelector","TagSelector","dialogOptions","width","handleUserSelectorChanges","sectionsWrap","createButtons","selectedItems","getDialog","ajax","runAction","userIdList","groupIdList","collabIdList","sections","prepareTrackingSections","location","reload","response","displayError","errors","getSelectedSections","sectionIndex","checkbox","filter","delayExecution","updateSectionLoader","getLoader","height","updateSectionTimeout","users","user","OWNER_ID","FORMATTED_NAME","createSectionBlock","sectionList","result","listWrap","sectionClick","toString","li","COLOR","NAME","checkHeightTimeout","fullHeight","TrackingGroupsForm","trackingGroups","collabs","groupTagSelector","handleGroupSelectorChanges","getSelectorEntities","lockProjectLink","isProjectFeatureEnabled","lockProjectLinkFeatureId","TrackingCollabsForm","trackingCollabs","groups","entityType","createProjectLink","TrackingTypesForm","selectGroups","selectUsers","addLinkMessage","SectionInterface","readonly","isCollabFeatureEnabled","uid","SLIDER_WIDTH","SLIDER_DURATION","sliderId","denyClose","deletedSectionsIds","deleteSectionHandlerBinded","deleteSectionHandler","refreshSectionListBinded","refreshSectionList","currentUserId","currentUser","accessNames","setAccessNames","SidePanel","Instance","contentCallback","createContent","animationDuration","onCloseByEsc","escHide","onClose","onCloseComplete","onLoad","onLoadSlider","addEventEmitterSubscriptions","subscribe","destroyEventEmitterSubscriptions","unsubscribe","event","getSlider","getUrl","denyAction","closeForms","removeCustomEvent","proxy","localSectionListWrap","sectionActionMenu","trackingTypesForm","trackingUsersForm","trackingGroupsForm","trackingCollabsForm","addBtnMenu","titleWrap","sectionFormWrap","isUserCalendar","userIsOwner","createAddButton","trackingGroupsFormWrap","trackingCollabsFormWrap","trackingUsersFormWrap","trackingTypesFormWrap","createSectionList","slider","layout","sliderSections","getSections","find","sectonListOuterWrap","sectionClickHandler","createLocalSectionsList","createExternalSectionsList","getSectionListWrap","getLocalSectionListTitle","createSectionsBlock","externalTypeIsLocal","belongsToView","isPseudo","createCompanySectionList","createUsersSectionList","createGroupsSectionList","createCollabSectionList","externalSections","extSectionListWrap","getSectionListWrapForSection","createSectionUnit","sectionExternalType","getExternalType","isGoogle","IS_EXCHANGE","sectionExternalConnection","SectionManager","getSectionExternalConnection","CAL_DAV_CON","addParams","key","getId","sectionListWrap","getExternalConnectionBlockTitle","connection","isArchive","isExchange","bExchange","hintNode","isDomNode","initHintNode","connectionName","getConnectionAccountName","getConnectionName","getType","isCompanyCalendar","getSuperposedTrackedUsers","calendarName","isCollab","isCollabCalendar","perm","edit_section","isCollabUser","button","SplitButton","size","ButtonSize","MEDIUM","ButtonColor","LIGHT_BORDER","mainButton","showEditSectionForm","menuButton","showAddButtonPopup","addButton","getMainButton","getContainer","addButtonMore","getMenuButton","MenuItem","delimiter","getAddCompanyMenuItem","getAddUserMenuItem","isBitrix24Template","getAddGroupMenuItem","getAddCollabMenuItem","MenuManager","showTrackingTypesForm","showTrackingUsersForm","showTrackingGroupsForm","FeaturePromotersRegistry","getPromoter","featureId","showTrackingCollabsForm","sectionId","actionCont","showSectionMenu","getSection","switchSection","syncInterface","openSyncPanel","findCheckBoxNodes","querySelectorAll","checkboxNodes","checkboxNode","switchOnSection","switchOffSection","menuItemNode","itemNode","closest","canDo","showOnlyOneSection","getLink","href","isSuperposed","hideSuperposedHandler","canBeConnectedToOutlook","EXTERNAL_TYPE","connectToOutlook","EXPORT","LINK","PATH","isExtranetUser","sectionLink","calendarPath","IcalSyncPopup","checkPathes","createInstance","showPopupWithPathesError","provider","getProviderById","showSectionConfirm","isIcloud","isOffice365","isCalDav","openActiveConnectionSlider","taskSectionBelongToUser","userOptions","allowSliderClose","denySliderClose","editSectionForm","formTitleNode","getSectionAccessTasks","showAccessControl","hasPermission","isPrimaryForConnection","getRandomColor","getDefaultSectionAccess","getSuperposedSectionList","getOwnerId","createTrackingCollabsForm","BaseEvent","getData","index","deleteSectionNodes","deleteFromArray","curSection","confirmSectionPopup","currentConfirmMode","currentSection","removeSection","hideSyncSection","hideExternalSection","mode","confirmCallback","getConfirmCallback","okCaption","getOkCaption","MessageBox","message","getSectionConfirmContent","minHeight","minWidth","maxWidth","buttons","Dialogs","MessageBoxButtons","OK_CANCEL","onOk","onCancel","padding","contentPadding","animation","phrase","hideExternalCalendarSection"],"mappings":"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"}