{"version":3,"file":"entity-catalog.bundle.js","sources":["../src/directives/feedback.js","../src/components/group.js","../src/components/group-list.js","../src/components/main-groups.js","../src/components/item-list-advice.js","../src/components/button.js","../src/components/item.js","../src/components/item-list.js","../src/components/stubs/empty-content.js","../src/stores/global-state.js","../src/components/main-content.js","../src/components/titlebar-filter.js","../src/components/search.js","../src/components/application.js","../src/entity-catalog.js"],"sourcesContent":["import {Event} from \"main.core\";\nimport \"ui.feedback.form\";\n\nexport const feedback = {\n\tbeforeMount(element: HTMLElement, bindings): void\n\t{\n\t\tEvent.bind(element, 'click', (event) => {\n\t\t\tevent.preventDefault();\n\n\t\t\tBX.UI.Feedback.Form.open(bindings.value);\n\t\t});\n\t}\n};\n","import { Type } from 'main.core';\nimport { GroupData } from '@/types/group';\nimport { CounterStyle } from 'ui.cnt';\nimport { Counter } from 'ui.vue3.components.counter';\n\nimport '../css/group.css';\n\nexport const Group = {\n\temits: ['selected', 'unselected'],\n\n\tname: 'ui-entity-catalog-group',\n\tcomponents: {\n\t\tCounter,\n\t},\n\tprops: {\n\t\t/** @type GroupData */\n\t\tgroupData: {\n\t\t\ttype: GroupData,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\thasIcon(): boolean\n\t\t{\n\t\t\treturn Type.isStringFilled(this.groupData.icon);\n\t\t},\n\t\tgetCounterStyle(): string\n\t\t{\n\t\t\treturn CounterStyle.FILLED_SUCCESS;\n\t\t},\n\t\tgetCounterValue(): ?number\n\t\t{\n\t\t\tconst custom = this.groupData?.customData ?? {};\n\t\t\tconst value = custom.counterValue;\n\t\t\tconst isValueInteger = Number.isInteger(value);\n\n\t\t\treturn isValueInteger && value > 0 ? value : null;\n\t\t}\n\t},\n\tmethods: {\n\t\thandleClick()\n\t\t{\n\t\t\tif (this.groupData.deselectable)\n\t\t\t{\n\t\t\t\tthis.$emit(!this.groupData.selected ? 'selected' : 'unselected', this.groupData);\n\t\t\t}\n\t\t\telse if (!this.groupData.selected)\n\t\t\t{\n\t\t\t\tthis.$emit('selected', this.groupData);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<slot name=\"group\" v-bind:groupData=\"groupData\" v-bind:handleClick=\"handleClick\">\n\t\t\t<li\n\t\t\t\t:class=\"{\n\t\t\t\t\t'ui-entity-catalog__menu_item': true,\n\t\t\t\t\t'--active': groupData.selected,\n\t\t\t\t\t'--disabled': groupData.disabled,\n\t\t\t\t}\"\n\t\t\t\t@click=\"handleClick\"\n\t\t\t>\n\t\t\t\t<span class=\"ui-entity-catalog__menu_item-icon\" v-if=\"hasIcon\" v-html=\"groupData.icon\"/>\n\t\t\t\t<span class=\"ui-entity-catalog__menu_item-text\">{{ groupData.name }}</span>\n\t\t\t\t<span\n\t\t\t\t\tv-if=\"getCounterValue !== null\"\n\t\t\t\t\tclass=\"ui-entity-catalog__menu_item-entity-count\"\n\t\t\t\t>\n\t\t\t\t\t<Counter\n\t\t\t\t\t\t:value=\"getCounterValue\"\n\t\t\t\t\t\t:style=\"getCounterStyle\"\n\t\t\t\t\t>\n\t\t\t\t\t</Counter>\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t</slot>\n\t`,\n};","import { Group } from './group';\nimport type { GroupData } from '@/types/group';\n\nimport '../css/group-list.css';\n\nexport const GroupList = {\n\temits: ['groupSelected', 'groupUnselected'],\n\n\tname: 'ui-entity-selector-group-list',\n\tcomponents: {\n\t\tGroup,\n\t},\n\tprops: {\n\t\t/** @type Array<Array<GroupData>> */\n\t\tgroups: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tgroupLists(): Array<Array<GroupData>>\n\t\t{\n\t\t\tif (!this.groups || this.groups.length === 0)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tif (Array.isArray(this.groups[0]))\n\t\t\t{\n\t\t\t\treturn this.groups;\n\t\t\t}\n\n\t\t\treturn [this.groups];\n\t\t},\n\n\t\theaderLists(): Array<Array<GroupData>>\n\t\t{\n\t\t\treturn this.groupLists\n\t\t\t\t.map(list => list.filter(g => !!g.isHeaderGroup))\n\t\t\t\t.filter(list => list.length > 0);\n\t\t},\n\n\t\tmainLists(): Array<Array<GroupData>>\n\t\t{\n\t\t\treturn this.groupLists\n\t\t\t\t.map(list => list.filter(g => !g.isHeaderGroup))\n\t\t\t\t.filter(list => list.length > 0);\n\t\t},\n\t},\n\tmethods: {\n\t\thandleGroupSelected(group: GroupData)\n\t\t{\n\t\t\tthis.$emit('groupSelected', group);\n\t\t},\n\t\thandleGroupUnselected(group: GroupData)\n\t\t{\n\t\t\tthis.$emit('groupUnselected', group);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<div\n\t\t\t\tclass=\"ui-entity-catalog__header-groups-content\"\n\t\t\t\tv-if=\"headerLists && headerLists.length\"\n\t\t\t>\n\t\t\t\t<ul\n\t\t\t\t\tclass=\"ui-entity-catalog__menu\"\n\t\t\t\t\tv-for=\"(groupList, listIndex) in headerLists\"\n\t\t\t\t\t:key=\"'header-'+listIndex\"\n\t\t\t\t>\n\t\t\t\t\t<Group\n\t\t\t\t\t\t:group-data=\"group\"\n\t\t\t\t\t\t:key=\"group.id\"\n\t\t\t\t\t\tv-for=\"group in groupList\"\n\t\t\t\t\t\t@selected=\"handleGroupSelected\"\n\t\t\t\t\t\t@unselected=\"handleGroupUnselected\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #group=\"groupSlotProps\">\n\t\t\t\t\t\t\t<slot\n\t\t\t\t\t\t\t\tname=\"group\"\n\t\t\t\t\t\t\t\tv-bind:groupData=\"groupSlotProps.groupData\"\n\t\t\t\t\t\t\t\tv-bind:handleClick=\"groupSlotProps.handleClick\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</Group>\n\t\t\t\t</ul>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<ul\n\t\t\t\t\tclass=\"ui-entity-catalog__menu\"\n\t\t\t\t\tv-for=\"(groupList, listIndex) in mainLists\"\n\t\t\t\t\t:key=\"'main-'+listIndex\"\n\t\t\t\t>\n\t\t\t\t\t<Group\n\t\t\t\t\t\t:group-data=\"group\"\n\t\t\t\t\t\t:key=\"group.id\"\n\t\t\t\t\t\tv-for=\"group in groupList\"\n\t\t\t\t\t\t@selected=\"handleGroupSelected\"\n\t\t\t\t\t\t@unselected=\"handleGroupUnselected\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #group=\"groupSlotProps\">\n\t\t\t\t\t\t\t<slot\n\t\t\t\t\t\t\t\tname=\"group\"\n\t\t\t\t\t\t\t\tv-bind:groupData=\"groupSlotProps.groupData\"\n\t\t\t\t\t\t\t\tv-bind:handleClick=\"groupSlotProps.handleClick\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</Group>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { GroupList } from './group-list';\n\nimport { GroupData } from '@/type/group';\n\nimport '../css/main-groups.css';\n\nexport const MainGroups = {\n\temits: ['groupSelected'],\n\n\tname: 'ui-entity-catalog-main-groups',\n\tcomponents: {\n\t\tGroupList,\n\t},\n\tprops: {\n\t\tgroups: {\n\t\t\t/** @type Array<Array<GroupData>> */\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tsearching: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tselectedGroup: {\n\t\t\t/** @type GroupData */\n\t\t\ttype: Object,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tcomputed: {\n\t\tprocessedGroups()\n\t\t{\n\t\t\tconst selectedGroupId = this.searching ? null : (this.selectedGroup ? this.selectedGroup.id : null);\n\n\t\t\tconst groupsClone = BX.Runtime.clone(this.groups);\n\n\t\t\tgroupsClone.forEach(groupList => {\n\t\t\t\tgroupList.forEach(group => {\n\t\t\t\t\tgroup.selected = (group.id === selectedGroupId);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn groupsClone;\n\t\t},\n\t\theaderLists(): Array<Array<GroupData>>\n\t\t{\n\t\t\treturn this.processedGroups\n\t\t\t\t.map(list => list.filter(g => g.isHeaderGroup))\n\t\t\t\t.filter(list => list.length > 0);\n\t\t},\n\t\tmainLists(): Array<Array<GroupData>>\n\t\t{\n\t\t\treturn this.processedGroups\n\t\t\t\t.map(list => list.filter(g => !g.isHeaderGroup))\n\t\t\t\t.filter(list => list.length > 0);\n\t\t},\n\t},\n\tmethods: {\n\t\thandleGroupSelected(group: GroupData)\n\t\t{\n\t\t\tthis.$emit('groupSelected', group);\n\t\t},\n\t\thandleGroupUnselected()\n\t\t{\n\t\t\tthis.$emit('groupSelected', null);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-entity-catalog__main-groups\">\n\t\t\t<div class=\"ui-entity-catalog__main-groups-head\">\n\t\t\t\t<slot name=\"group-list-header\"/>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclass=\"ui-entity-catalog__header-groups-content\"\n\t\t\t\tv-if=\"headerLists && headerLists.length\"\n\t\t\t>\n\t\t\t\t<GroupList\n\t\t\t\t\t:groups=\"headerLists\"\n\t\t\t\t\t@groupSelected=\"handleGroupSelected\"\n\t\t\t\t\t@groupUnselected=\"handleGroupUnselected\"\n\t\t\t\t>\n\t\t\t\t\t<template #group=\"groupSlotProps\">\n\t\t\t\t\t\t<slot\n\t\t\t\t\t\t\tname=\"group\"\n\t\t\t\t\t\t\tv-bind:groupData=\"groupSlotProps.groupData\"\n\t\t\t\t\t\t\tv-bind:handleClick=\"groupSlotProps.handleClick\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</GroupList>\n\t\t\t</div>\n\t\t\t<div class=\"ui-entity-catalog__main-groups-content\">\n\t\t\t\t<GroupList\n\t\t\t\t\t:groups=\"mainLists\"\n\t\t\t\t\t@groupSelected=\"handleGroupSelected\"\n\t\t\t\t\t@groupUnselected=\"handleGroupUnselected\"\n\t\t\t\t>\n\t\t\t\t\t<template #group=\"groupSlotProps\">\n\t\t\t\t\t\t<slot\n\t\t\t\t\t\t\tname=\"group\"\n\t\t\t\t\t\t\tv-bind:groupData=\"groupSlotProps.groupData\"\n\t\t\t\t\t\t\tv-bind:handleClick=\"groupSlotProps.handleClick\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</GroupList>\n\t\t\t</div>\n\t\t\t<div class=\"ui-entity-catalog__main-groups-footer\">\n\t\t\t\t<slot name=\"group-list-footer\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Type, Dom } from 'main.core';\nimport { GroupData } from '@/types/group';\nimport { Advice } from 'ui.advice';\n\nexport const ItemListAdvice = {\n\tname: 'ui-entity-catalog-item-list-advice',\n\tprops: {\n\t\tgroupData: {\n\t\t\ttype: GroupData,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tgetAvatar: function(): string\n\t\t{\n\t\t\treturn (\n\t\t\t\tType.isStringFilled(this.groupData.adviceAvatar)\n\t\t\t\t\t? this.groupData.adviceAvatar\n\t\t\t\t\t: '/bitrix/js/ui/entity-catalog/images/ui-entity-catalog--nata.jpg'\n\t\t\t);\n\t\t},\n\t},\n\n\tmethods: {\n\t\trenderAdvice() {\n\t\t\tDom.clean(this.$refs.container);\n\n\t\t\tconst advice = new Advice({\n\t\t\t\tcontent: this.groupData.adviceTitle,\n\t\t\t\tavatarImg: this.getAvatar,\n\t\t\t\tanglePosition: Advice.AnglePosition.BOTTOM,\n\t\t\t});\n\n\t\t\tadvice.renderTo(this.$refs.container);\n\t\t},\n\t},\n\n\tmounted() {\n\t\tthis.renderAdvice();\n\t},\n\n\tupdated() {\n\t\tthis.renderAdvice();\n\t},\n\n\ttemplate: `\n\t\t<div ref=\"container\"></div>\n\t`,\n};","import { Loc, Type } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { ButtonData } from '@/types/button';\n\nimport '../css/button.css';\n\nexport const Button = {\n\tname: 'ui-entity-catalog-button',\n\tprops: {\n\t\tbuttonData: {\n\t\t\ttype: ButtonData,\n\t\t\trequired: true,\n\t\t},\n\t\teventData: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tbuttonText(): string\n\t\t{\n\t\t\treturn (\n\t\t\t\tType.isStringFilled(this.buttonData.text)\n\t\t\t\t\t? this.buttonData.text\n\t\t\t\t\t: Loc.getMessage('UI_JS_ENTITY_CATALOG_ITEM_DEFAULT_BUTTON_TEXT')\n\t\t\t);\n\t\t},\n\t},\n\tmethods: {\n\t\thandleButtonClick(pointerEvent)\n\t\t{\n\t\t\tconst event = new BaseEvent({\n\t\t\t\tdata: {\n\t\t\t\t\teventData: this.eventData,\n\t\t\t\t\toriginalEvent: pointerEvent,\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (Type.isFunction(this.buttonData.action))\n\t\t\t{\n\t\t\t\tthis.buttonData.action.call(this, event);\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-entity-catalog__option-btn-block\">\n\t\t\t<div \n\t\t\t\tclass=\"ui-entity-catalog__btn\"\n\t\t\t\t:class=\"{'--lock': buttonData.locked}\"\n\t\t\t\t@click=\"handleButtonClick\"\n\t\t\t>{{buttonText}}</div>\n\t\t</div>\n\t`\n};","import { Type } from 'main.core';\nimport { Button } from './button';\nimport { ItemData } from '@/types/item';\nimport { ButtonData } from '@/types/button';\n\nimport '../css/item.css';\n\nexport const Item = {\n\tname: 'ui-entity-catalog-item',\n\tcomponents:{\n\t\tButton,\n\t},\n\tprops: {\n\t\titemData: {\n\t\t\ttype: ItemData,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tbuttonData(): ButtonData\n\t\t{\n\t\t\tif (!Type.isPlainObject(this.itemData.button))\n\t\t\t{\n\t\t\t\tthis.itemData.button = {};\n\t\t\t}\n\n\t\t\treturn this.itemData.button;\n\t\t},\n\t\ttopText(): ?string\n\t\t{\n\t\t\tconst custom = this.itemData?.customData ?? {};\n\t\t\tif (Type.isStringFilled(custom.topText))\n\t\t\t{\n\t\t\t\treturn custom.topText;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<slot name=\"item\" v-bind:itemData=\"itemData\">\n\t\t\t<div \n\t\t\t\tclass=\"ui-entity-catalog__option\"\n\t\t\t\t:data-item-id=\"String(itemData.id)\"\n\t\t\t>\n\t\t\t\t<div class=\"ui-entity-catalog__option-info\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"topText\"\n\t\t\t\t\t\tclass=\"ui-entity-catalog__option-info_top_text\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ topText }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-entity-catalog__option-info_name\">\n\t\t\t\t\t\t<span>{{itemData.title}}</span>\n\t\t\t\t\t\t<span class=\"ui-entity-catalog__option-info_label\" v-if=\"itemData.subtitle\">{{itemData.subtitle}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-entity-catalog__option-info_description\">\n\t\t\t\t\t\t{{itemData.description}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<Button :buttonData=\"buttonData\" :event-data=\"itemData\"/>\n\t\t\t</div>\n\t\t</slot>\n\t`,\n}\n","import { Item } from './item';\nimport type { ItemData } from '@/type/item';\n\nimport '../css/item-list.css';\n\nexport const ItemList = {\n\tname: 'ui-entity-selector-item-list',\n\tcomponents: {\n\t\tItem,\n\t},\n\tprops: {\n\t\titems: {\n\t\t\t/** @type Array<ItemData> */\n\t\t\tType: Array,\n\t\t\trequired: true,\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-entity-catalog__content\">\n\t\t\t<div class=\"ui-entity-catalog__options\">\n\t\t\t\t<Item \n\t\t\t\t\t:item-data=\"item\"\n\t\t\t\t\t:key=\"item.id\"\n\t\t\t\t\tv-for=\"item in items\"\n\t\t\t\t>\n\t\t\t\t\t<template #item=\"itemSlotProps\">\n\t\t\t\t\t\t<slot name=\"item\" v-bind:itemData=\"itemSlotProps.itemData\"/>\n\t\t\t\t\t</template>\n\t\t\t\t</Item>\n\t\t\t</div>\n\t\t</div>\n\t`,\n}","import '../../css/stubs/empty-content.css';\n\nexport const EmptyContent = {\n\ttemplate: `\n\t\t<div class=\"ui-entity-catalog__content --help-block\">\n\t\t\t<div class=\"ui-entity-catalog__empty-content\">\n\t\t\t\t<div class=\"ui-entity-catalog__empty-content_icon\">\n\t\t\t\t\t<img src=\"/bitrix/js/ui/entity-catalog/images/ui-entity-catalog--search-icon.svg\" alt=\"Choose a grouping\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-entity-catalog__empty-content_text\">\n\t\t\t\t\t<slot/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t`\n}","import { defineStore } from 'ui.vue3.pinia';\nimport { GroupData } from '@/types/group';\n\nexport const useGlobalState = defineStore('global-state', {\n\tstate: () => ({\n\t\tsearchQuery: '',\n\t\tsearchApplied: false,\n\t\tfiltersApplied: false,\n\t\tcurrentGroup: GroupData,\n\t\tshouldShowWelcomeStub: true,\n\t}),\n});\n","import { Type } from 'main.core';\nimport { mapState } from 'ui.vue3.pinia';\nimport { GroupData } from '@/types/group';\nimport { ItemListAdvice } from './item-list-advice';\nimport { ItemList} from './item-list';\nimport { EmptyContent } from './stubs/empty-content';\n\nimport { useGlobalState } from '../stores/global-state';\n\nimport '../css/main-content.css';\n\nexport const MainContent = {\n\tname: 'ui-entity-catalog-main-content',\n\tcomponents: {\n\t\tItemListAdvice,\n\t\tItemList,\n\t\tEmptyContent,\n\t},\n\tprops: {\n\t\titems: {\n\t\t\t/** @type Array<ItemData> */\n\t\t\ttype: Array,\n\t\t\trequired: true\n\t\t},\n\t\titemsToShow: {\n\t\t\t/** @type Array<ItemData> */\n\t\t\ttype: Array,\n\t\t},\n\t\tgroup: {\n\t\t\ttype: GroupData,\n\t\t\trequired: true,\n\t\t},\n\t\tsearching: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapState(useGlobalState, ['filtersApplied', 'shouldShowWelcomeStub']),\n\t\tshowAdvice(): boolean\n\t\t{\n\t\t\treturn this.group && Type.isStringFilled(this.group.adviceTitle) && !this.searching;\n\t\t},\n\t\thasItems(): boolean\n\t\t{\n\t\t\treturn this.group && this.items.length > 0;\n\t\t},\n\t\tshowWelcomeStub(): boolean\n\t\t{\n\t\t\treturn this.showNoSelectedGroupStub && this.shouldShowWelcomeStub;\n\t\t},\n\t\tshowNoSelectedGroupStub(): boolean\n\t\t{\n\t\t\treturn !this.group && !this.searching;\n\t\t},\n\t\tshowFiltersStub()\n\t\t{\n\t\t\tconst hasFilterStubTitle = !!this.$slots['main-content-filter-stub-title'];\n\n\t\t\treturn hasFilterStubTitle && this.hasItems && this.filtersApplied && (this.itemsToShow.length <= 0);\n\t\t},\n\t\tshowSearchStub(): boolean\n\t\t{\n\t\t\treturn (!this.group || this.hasItems) && this.searching && (this.itemsToShow.length <= 0);\n\t\t},\n\t\tshowEmptyGroupStub(): boolean\n\t\t{\n\t\t\treturn this.group && this.itemsToShow.length === 0;\n\t\t},\n\t\tshowSeparator(): boolean\n\t\t{\n\t\t\treturn this.showAdvice && (this.items.length <= 0);\n\t\t},\n\t},\n\tbeforeUpdate()\n\t{\n\t\tthis.$refs.content.scrollTop = 0;\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-entity-catalog__main-content\">\n\t\t\t<div class=\"ui-entity-catalog__main-content-head\">\n\t\t\t\t<slot name=\"main-content-header\"/>\n\t\t\t</div>\n\t\t\t<ItemListAdvice v-if=\"showAdvice\" :groupData=\"group\" />\n\n\t\t\t<hr class=\"ui-entity-catalog__main-separator\" v-if=\"showSeparator\">\n\n\t\t\t<div class=\"ui-entity-catalog__main-content-body\" ref=\"content\">\n\t\t\t\t<slot name=\"main-content-welcome-stub\" v-if=\"showWelcomeStub\"/>\n\t\t\t\t<slot name=\"main-content-no-selected-group-stub\" v-else-if=\"showNoSelectedGroupStub\"/>\n\t\t\t\t<slot name=\"main-content-filter-stub\" v-if=\"showFiltersStub\">\n\t\t\t\t\t<EmptyContent>\n\t\t\t\t\t\t<slot name=\"main-content-filter-stub-title\"/>\n\t\t\t\t\t</EmptyContent>\n\t\t\t\t</slot>\n\t\t\t\t<slot name=\"main-content-search-stub\" v-else-if=\"showSearchStub\">\n\t\t\t\t\t<EmptyContent>\n\t\t\t\t\t\t<slot name=\"main-content-search-not-found-stub\"/>\n\t\t\t\t\t</EmptyContent>\n\t\t\t\t</slot>\n\t\t\t\t<slot name=\"main-content-empty-group-stub\" v-else-if=\"showEmptyGroupStub\">\n\t\t\t\t\t<EmptyContent>\n\t\t\t\t\t\t<slot name=\"main-content-empty-group-stub-title\"/>\n\t\t\t\t\t</EmptyContent> \n\t\t\t\t</slot>\n\t\t\t\t<ItemList v-else :items=\"itemsToShow\">\n\t\t\t\t\t<template #item=\"itemSlotProps\">\n\t\t\t\t\t\t<slot name=\"item\" v-bind:itemData=\"itemSlotProps.itemData\"/>\n\t\t\t\t\t</template>\n\t\t\t\t</ItemList>\n\t\t\t\t<div class=\"ui-entity-catalog__main-content-footer\">\n\t\t\t\t\t<slot name=\"main-content-footer\"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};","import { Dom, Tag, Text, Loc } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { MenuItemOptions, MenuManager, Menu } from 'main.popup';\n\nimport type { FilterData } from '@/types/filter'\n\nimport '../css/titlebar-filter.css';\n\nexport const TitleBarFilter = {\n\temits: ['onApplyFilters'],\n\tname: 'ui-entity-catalog-titlebar-filter',\n\tprops: {\n\t\tfilters: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tmultiple: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tappliedFilters: this.getAppliedFilters(),\n\t\t\tallFilters: this.filters,\n\t\t};\n\t},\n\tmethods: {\n\t\tshowMenu(): Menu\n\t\t{\n\t\t\tMenuManager.create({\n\t\t\t\tid: 'ui-entity-catalog-titlebar-filter-menu',\n\t\t\t\tbindElement: this.$el,\n\t\t\t\tminWidth: 271,\n\t\t\t\tautoHide: true,\n\t\t\t\tcontentColor: 'white',\n\t\t\t\tdraggable: false,\n\t\t\t\tcacheable: false,\n\t\t\t\titems: this.getItems(),\n\t\t\t}).show();\n\t\t},\n\t\tgetItems(): MenuItemOptions[]\n\t\t{\n\t\t\tconst items = [];\n\n\t\t\tfor (const key in this.allFilters)\n\t\t\t{\n\t\t\t\tconst html = Tag.render`\n\t\t\t\t\t<div style=\"display: flex\">\n\t\t\t\t\t\t<div>${Text.encode(this.filters[key].text)}</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\n\t\t\t\tif (this.allFilters[key].applied)\n\t\t\t\t{\n\t\t\t\t\tDom.append(Tag.render`<div class=\"ui-entity-catalog__filter-block_selected\"></div>`, html);\n\t\t\t\t}\n\n\t\t\t\titems.push({\n\t\t\t\t\thtml,\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\tif (this.allFilters[key].applied)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdelete this.appliedFilters[this.allFilters[key].id];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!this.multiple)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.clearAllAction();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthis.appliedFilters[this.allFilters[key].id] = this.allFilters[key];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.allFilters[key].applied = !this.allFilters[key].applied;\n\t\t\t\t\t\tthis.$emit('onApplyFilters', new BaseEvent({data: this.appliedFilters}));\n\n\n\t\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\titems.push({\n\t\t\t\tdelimiter: true,\n\t\t\t});\n\n\t\t\titems.push(this.getClearAllFilter());\n\n\t\t\treturn items;\n\t\t},\n\t\tgetClearAllFilter(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\thtml: `\n\t\t\t\t\t<div style=\"display: flex\">\n\t\t\t\t\t\t<div>${Loc.getMessage('UI_JS_ENTITY_CATALOG_RESET_FILTER')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\tthis.clearAllAction();\n\t\t\t\t\tthis.$emit('onApplyFilters', new BaseEvent({data: this.appliedFilters}));\n\n\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tclearAllAction()\n\t\t{\n\t\t\tthis.appliedFilters = {};\n\t\t\tthis.allFilters = this.allFilters.map(filter => ({...filter, applied: false}));\n\t\t},\n\t\tgetAppliedFilters(): Object<string, FilterData>\n\t\t{\n\t\t\tconst appliedFilters = {};\n\n\t\t\tfor (const key in this.filters)\n\t\t\t{\n\t\t\t\tif (this.filters[key].applied)\n\t\t\t\t{\n\t\t\t\t\tappliedFilters[this.filters[key].id] = this.filters[key];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (Object.keys(appliedFilters).length > 0)\n\t\t\t{\n\t\t\t\tthis.$emit('onApplyFilters', new BaseEvent({data: appliedFilters}));\n\t\t\t}\n\n\t\t\treturn appliedFilters;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\t:class=\"{\n\t\t\t\t'ui-entity-catalog__titlebar_btn-filter': true,\n\t\t\t\t'--active': Object.keys(appliedFilters).length > 0\n\t\t\t}\"\n\t\t\t@click=\"showMenu\">\n\t\t</div>\n\t`,\n};","import { BaseEvent } from 'main.core.events';\nimport { Loc, debounce, Type } from 'main.core';\n\nexport const Search = {\n\temits: ['onSearch'],\n\tname: 'ui-entity-catalog-titlebar-search',\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\topened: false,\n\t\t\tdebounceSearchHandler: null,\n\t\t\tqueryString: '',\n\t\t\tshowClearSearch: false,\n\t\t};\n\t},\n\twatch:{\n\t\tqueryString(newString)\n\t\t{\n\t\t\tthis.showClearSearch = this.opened && this.$refs['search-input'] && Type.isStringFilled(newString);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.debounceSearchHandler = debounce((event) => {\n\t\t\tthis.onSearch(event.target.value);\n\t\t}, 255);\n\t},\n\tmethods: {\n\t\topenSearch()\n\t\t{\n\t\t\tthis.opened = true;\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.$refs['search-input'].focus();\n\t\t\t});\n\t\t},\n\t\tonSearch(queryString)\n\t\t{\n\t\t\tthis.queryString = queryString;\n\t\t\tthis.$emit(\n\t\t\t\t'onSearch',\n\t\t\t\tnew BaseEvent({data: {queryString: queryString ? queryString.toString() : ''}})\n\t\t\t);\n\t\t},\n\t\tclearSearch()\n\t\t{\n\t\t\tif (this.showClearSearch)\n\t\t\t{\n\t\t\t\tthis.$refs['search-input'].value = '';\n\t\t\t\tthis.onSearch('');\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-ctl-round\" @click.once=\"openSearch\">\n\t\t\t<a \n\t\t\t\t:class=\"{\n\t\t\t\t\t'ui-ctl-after': true,\n\t\t\t\t\t'ui-ctl-icon-search': !showClearSearch,\n\t\t\t\t\t'ui-ctl-icon-clear': showClearSearch\n\t\t\t\t}\"\n\t\t\t\t@click=\"clearSearch\"\n\t\t\t/>\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tclass=\"ui-ctl-element ui-ctl-textbox\"\n\t\t\t\tplaceholder=\"${Loc.getMessage('UI_JS_ENTITY_CATALOG_GROUP_LIST_SEARCH_PLACEHOLDER')}\"\n\t\t\t\tref=\"search-input\"\n\t\t\t\tv-if=\"opened\"\n\t\t\t\t@input=\"debounceSearchHandler\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};","import { Type, Runtime } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { mapWritableState } from 'ui.vue3.pinia';\nimport 'ui.icons';\n\nimport { MainGroups } from './main-groups';\nimport { MainContent } from './main-content';\nimport { TitleBarFilter } from './titlebar-filter';\nimport { Search } from './search';\n\nimport { useGlobalState } from '../stores/global-state';\n\nimport { GroupData } from '@/type/group';\nimport type { ItemData } from '@/type/item';\n\nimport '../css/application.css';\n\nexport const Application = {\n\tname: 'ui-entity-catalog-application',\n\tcomponents: {\n\t\tMainGroups,\n\t\tMainContent,\n\t\tTitleBarFilter,\n\t\tSearch,\n\t},\n\tprops: {\n\t\t/** @type Array<Array<GroupData>> */\n\t\tgroups: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\t/** @type Array<ItemData> */\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tshowEmptyGroups: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tfilterOptions: {\n\t\t\ttype: Object,\n\t\t\tdefault: {\n\t\t\t\tfilterItems: [],\n\t\t\t\tmultiple: false,\n\t\t\t},\n\t\t},\n\t},\n\tdata(): {\n\t\tselectedGroup: ?GroupData,\n\t\tselectedGroupId: ?string,\n\t\tshownItems: Array,\n\t\tshownGroups: Array<Array<GroupData>>,\n\t\tlastSearchString: string,\n\t\tfilters: Array,\n\t}\n\t{\n\t\tlet selectedGroup = null;\n\n\t\tfor (const groupList of this.groups)\n\t\t{\n\t\t\tselectedGroup = groupList.find(group => group.selected);\n\t\t\tif (selectedGroup)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tselectedGroup,\n\t\t\tselectedGroupId: selectedGroup?.id ?? null,\n\t\t\tshownItems: [],\n\t\t\tshownGroups: [],\n\t\t\tlastSearchString: '',\n\t\t\tfilters: [],\n\t\t};\n\t},\n\tcomputed: {\n\t\titemsBySelectedGroupId(): Array<ItemData>\n\t\t{\n\t\t\tconst items = this.items.filter((item) => item.groupIds.some(id => id === this.selectedGroupId));\n\n\t\t\treturn this.selectedGroup?.compare ? items.sort(this.selectedGroup.compare) : items;\n\t\t},\n\t\tcomputedShownGroups(): Array<Array<GroupData>>\n\t\t{\n\t\t\tif (this.showEmptyGroups)\n\t\t\t{\n\t\t\t\treturn Runtime.clone(this.groups);\n\t\t\t}\n\n\t\t\tconst groupIdsWithItems = new Set();\n\t\t\tthis.items.forEach((item) => {\n\t\t\t\titem.groupIds.forEach((groupId) => groupIdsWithItems.add(groupId));\n\t\t\t});\n\n\t\t\treturn (\n\t\t\t\tthis.groups\n\t\t\t\t\t.map(groupList => groupList.filter(group => group.isHeaderGroup === true || groupIdsWithItems.has(group.id)))\n\t\t\t\t\t.filter(list => list.length > 0)\n\t\t\t);\n\t\t},\n\n\t\tcomputedShownItems(): Array<ItemData>\n\t\t{\n\t\t\tif (this.searching && Type.isStringFilled(this.lastSearchString))\n\t\t\t{\n\t\t\t\tconst q = this.lastSearchString;\n\t\t\t\tlet result = this.items.filter((item) => (\n\t\t\t\t\tString(item.title).toLowerCase().includes(q)\n\t\t\t\t\t|| String(item.description).toLowerCase().includes(q)\n\t\t\t\t\t|| item.tags?.some(tag => tag === q)\n\t\t\t\t));\n\n\t\t\t\tfor (const filterId in this.filters)\n\t\t\t\t{\n\t\t\t\t\tresult = result.filter(this.filters[filterId].action);\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tlet result = this.itemsBySelectedGroupId.slice();\n\t\t\tfor (const filterId in this.filters)\n\t\t\t{\n\t\t\t\tresult = result.filter(this.filters[filterId].action);\n\t\t\t}\n\t\t\treturn result;\n\t\t},\n\t\t...mapWritableState(useGlobalState, {\n\t\t\tsearchQuery: 'searchQuery',\n\t\t\tsearching: 'searchApplied',\n\t\t\tfiltersApplied: 'filtersApplied',\n\t\t\tglobalGroup: 'currentGroup',\n\t\t\tshouldShowWelcomeStub: 'shouldShowWelcomeStub',\n\t\t}),\n\t},\n\twatch: {\n\t\tcomputedShownItems: {\n\t\t\thandler()\n\t\t\t{\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis.$emit('itemsRendered');\n\t\t\t\t});\n\t\t\t},\n\t\t\tflush: 'post',\n\t\t},\n\t\tcomputedShownGroups: {\n\t\t\timmediate: true,\n\t\t\thandler(newVal)\n\t\t\t{\n\t\t\t\t// quick replace in-place to keep same array object reference\n\t\t\t\tthis.shownGroups.splice(0, this.shownGroups.length, ...newVal);\n\n\t\t\t\tif (!this.selectedGroupId)\n\t\t\t\t{\n\t\t\t\t\tconst selected = this.shownGroups.flat().find(g => g.selected);\n\t\t\t\t\tif (selected)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selectedGroup = selected;\n\t\t\t\t\t\tthis.selectedGroupId = selected.id;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\tselectedGroup()\n\t\t{\n\t\t\tthis.shouldShowWelcomeStub = false;\n\t\t\tthis.globalGroup = this.selectedGroup;\n\t\t},\n\t},\n\tmethods: {\n\t\tgetDisplayedGroup(): Array<Array<GroupData>>\n\t\t{\n\t\t\tif (this.showEmptyGroups)\n\t\t\t{\n\t\t\t\treturn Runtime.clone(this.groups);\n\t\t\t}\n\n\t\t\tconst groupIdsWithItems = new Set();\n\t\t\tthis.items.forEach((item: ItemData) => {\n\t\t\t\titem.groupIds.forEach((groupId: String | Number) => {\n\t\t\t\t\tgroupIdsWithItems.add(groupId);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn (\n\t\t\t\tthis\n\t\t\t\t\t.groups\n\t\t\t\t\t.map((groupList: Array<GroupData>) => groupList.filter((group: GroupData) => (\n\t\t\t\t\t\t(group.isHeaderGroup === true) || groupIdsWithItems.has(group.id)\n\t\t\t\t\t)))\n\t\t\t\t\t.filter(groupList => groupList.length > 0)\n\t\t\t);\n\t\t},\n\t\thandleGroupSelected(group: ?GroupData)\n\t\t{\n\t\t\tthis.searching = false;\n\t\t\tthis.$refs.search?.clearSearch();\n\n\t\t\tthis.selectedGroupId = group ? group.id : null;\n\t\t\tthis.selectedGroup = group ?? null;\n\t\t},\n\t\tonSearch(event: BaseEvent)\n\t\t{\n\t\t\tconst queryString = event.getData().queryString.toLowerCase();\n\t\t\tthis.lastSearchString = queryString;\n\t\t\tthis.searchQuery = queryString || '';\n\n\t\t\tif (!Type.isStringFilled(queryString))\n\t\t\t{\n\t\t\t\tthis.searching = false;\n\t\t\t\tthis.shownItems = [];\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.searching = true;\n\t\t\tthis.selectedGroup = null;\n\t\t\tthis.selectedGroupId = null;\n\n\t\t\tthis.shownItems = this.items.filter((item) => (\n\t\t\t\tString(item.title).toLowerCase().includes(queryString)\n\t\t\t\t|| String(item.description).toLowerCase().includes(queryString)\n\t\t\t\t|| item.tags?.some(tag => tag === queryString)\n\t\t\t));\n\n\t\t\tthis.applyFilters();\n\t\t},\n\t\tonApplyFilterClick(event: BaseEvent)\n\t\t{\n\t\t\tthis.filters = event.getData();\n\t\t\tif (this.searching)\n\t\t\t{\n\t\t\t\tthis.onSearch(new BaseEvent({ data: { queryString: this.lastSearchString } }));\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.shownItems = this.itemsBySelectedGroupId;\n\t\t\tthis.applyFilters();\n\t\t},\n\t\tapplyFilters()\n\t\t{\n\t\t\tthis.filtersApplied = Object.values(this.filters).length > 0;\n\t\t\tfor (const filterId in this.filters)\n\t\t\t{\n\t\t\t\tthis.shownItems = this.shownItems.filter(this.filters[filterId].action);\n\t\t\t}\n\t\t},\n\t\tgetFilterNode(): ?Element\n\t\t{\n\t\t\treturn (this.$root.$app\n\t\t\t\t\t.getPopup()\n\t\t\t\t\t.getTitleContainer()\n\t\t\t\t\t.querySelector('[data-role=\"titlebar-filter\"]')\n\t\t\t);\n\t\t},\n\t\tgetSearchNode(): ?Element\n\t\t{\n\t\t\treturn (this.$root.$app\n\t\t\t\t\t.getPopup()\n\t\t\t\t\t.getTitleContainer()\n\t\t\t\t\t.querySelector('[data-role=\"titlebar-search\"]')\n\t\t\t);\n\t\t},\n\t\tstopPropagation(event)\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-entity-catalog__main\">\n\t\t\t<MainGroups\n\t\t\t\t:groups=\"this.shownGroups\"\n\t\t\t\t:searching=\"searching\"\n\t\t\t\t@group-selected=\"handleGroupSelected\"\n\t\t\t\t:selected-group=\"selectedGroup\"\n\t\t\t>\n\t\t\t\t<template #group-list-header>\n\t\t\t\t\t<slot name=\"group-list-header\"/>\n\t\t\t\t</template>\n\t\t\t\t<template #group=\"groupSlotProps\">\n\t\t\t\t\t<slot\n\t\t\t\t\t\tname=\"group\"\n\t\t\t\t\t\tv-bind:groupData=\"groupSlotProps.groupData\"\n\t\t\t\t\t\tv-bind:handleClick=\"groupSlotProps.handleClick\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t\t<template #group-list-footer>\n\t\t\t\t\t<slot name=\"group-list-footer\"/>\n\t\t\t\t</template>\n\t\t\t</MainGroups>\n\t\t\t<MainContent\n\t\t\t\t:items=\"itemsBySelectedGroupId\"\n\t\t\t\t:items-to-show=\"computedShownItems\"\n\t\t\t\t:group=\"selectedGroup\"\n\t\t\t\t:searching=\"searching\"\n\t\t\t>\n\t\t\t\t<template #main-content-header>\n\t\t\t\t\t<slot name=\"main-content-header\"/>\n\t\t\t\t</template>\n\t\t\t\t<template #main-content-no-selected-group-stub>\n\t\t\t\t\t<slot name=\"main-content-no-selected-group-stub\"/>\n\t\t\t\t</template>\n\t\t\t\t<template #main-content-welcome-stub>\n\t\t\t\t\t<slot name=\"main-content-welcome-stub\"/>\n\t\t\t\t</template>\n\t\t\t\t<template #main-content-filter-stub v-if=\"$slots['main-content-filter-stub']\">\n\t\t\t\t\t<slot name=\"main-content-filter-stub\"/>\n\t\t\t\t</template>\n\t\t\t\t<template #main-content-filter-stub-title v-if=\"$slots['main-content-filter-stub-title']\">\n\t\t\t\t\t<slot name=\"main-content-filter-stub-title\"/>\n\t\t\t\t</template>\n\t\t\t\t<template #main-content-search-stub>\n\t\t\t\t\t<slot name=\"main-content-search-stub\"></slot>\n\t\t\t\t</template>\n\t\t\t\t<template #main-content-search-not-found-stub>\n\t\t\t\t\t<slot name=\"main-content-search-not-found-stub\"/>\n\t\t\t\t</template>\n\t\t\t\t<template #main-content-empty-group-stub>\n\t\t\t\t\t<slot name=\"main-content-empty-group-stub\"/>\n\t\t\t\t</template>\n\t\t\t\t<template #main-content-empty-group-stub-title>\n\t\t\t\t\t<slot name=\"main-content-empty-group-stub-title\"/>\n\t\t\t\t</template>\n\t\t\t\t<template #item=\"itemSlotProps\">\n\t\t\t\t\t<slot name=\"item\" v-bind:itemData=\"itemSlotProps.itemData\"/>\n\t\t\t\t</template>\n\t\t\t\t<template #main-content-footer>\n\t\t\t\t\t<slot name=\"main-content-footer\"/>\n\t\t\t\t</template>\n\t\t\t</MainContent>\n\t\t\t<Teleport v-if=\"getFilterNode()\" :to=\"getFilterNode()\">\n\t\t\t\t<TitleBarFilter\n\t\t\t\t\t:filters=\"filterOptions.filterItems\"\n\t\t\t\t\t:multiple=\"filterOptions.multiple\"\n\t\t\t\t\t@onApplyFilters=\"onApplyFilterClick\"\n\t\t\t\t\t@mousedown=\"stopPropagation\"\n\t\t\t\t/>\n\t\t\t</Teleport>\n\t\t\t<Teleport v-if=\"getSearchNode()\" :to=\"getSearchNode()\">\n\t\t\t\t<Search @onSearch=\"onSearch\" ref=\"search\" @mousedown=\"stopPropagation\"/>\n\t\t\t</Teleport>\n\t\t</div>\n\t`,\n};","import { Loc, Tag, Text, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Popup, PopupOptions } from 'main.popup';\nimport { BitrixVue } from 'ui.vue3';\nimport { createPinia } from 'ui.vue3.pinia';\nimport { Hint } from 'ui.vue3.components.hint';\nimport { feedback } from './directives/feedback';\n\nimport { Application } from './components/application';\nimport { Button } from './components/button';\n\nimport 'ui.forms';\n\nimport './css/popup.css';\n\nimport type { GroupData } from './types/group';\nimport type { ItemData } from './types/item';\nimport type { FilterData } from './types/filter';\n\nexport type {\n\tGroupData,\n\tItemData,\n\tFilterData,\n};\n\nimport { EmptyContent } from './components/stubs/empty-content';\n\nimport { useGlobalState } from './stores/global-state';\n\nexport const Stubs = {\n\tEmptyContent,\n};\n\nexport const States = {\n\tuseGlobalState,\n};\n\nexport class EntityCatalog extends EventEmitter\n{\n\tstatic DEFAULT_POPUP_WIDTH = 881;\n\tstatic DEFAULT_POPUP_HEIGHT = 621;\n\tstatic DEFAULT_POPUP_COLOR = '#edeef0';\n\n\tstatic SLOT_GROUP_LIST_HEADER = 'group-list-header';\n\tstatic SLOT_GROUP = 'group';\n\tstatic SLOT_GROUP_LIST_FOOTER = 'group-list-footer';\n\tstatic SLOT_MAIN_CONTENT_HEADER = 'main-content-header';\n\tstatic SLOT_MAIN_CONTENT_FOOTER = 'main-content-footer';\n\tstatic SLOT_MAIN_CONTENT_FILTERS_STUB = 'main-content-filter-stub';\n\tstatic SLOT_MAIN_CONTENT_FILTERS_STUB_TITLE = 'main-content-filter-stub-title';\n\tstatic SLOT_MAIN_CONTENT_SEARCH_NOT_FOUND = 'search-not-found';\n\tstatic SLOT_MAIN_CONTENT_WELCOME_STUB = 'main-content-welcome-stub';\n\tstatic SLOT_MAIN_CONTENT_NO_SELECTED_GROUP_STUB = 'main-content-no-selected-group-stub';\n\tstatic SLOT_MAIN_CONTENT_EMPTY_GROUP_STUB = 'main-content-empty-group-stub';\n\tstatic SLOT_MAIN_CONTENT_EMPTY_GROUP_STUB_TITLE = 'main-content-empty-group-stub-title';\n\tstatic SLOT_MAIN_CONTENT_ITEM = 'main-content-item';\n\tstatic SLOT_MAIN_CONTENT_SEARCH_STUB = 'main-content-search-stub';\n\n\t#popup: ?Popup;\n\t#popupOptions: PopupOptions;\n\t#popupTitle: string;\n\t#customTitleBar: Element = null;\n\n\t#groups: Array<Array<GroupData>> = [];\n\t#items: Array<Item> = [];\n\t#showEmptyGroups: boolean = false;\n\t#showSearch: boolean = false;\n\t#filterOptions: {\n\t\tfilterItems: Array<FilterData>,\n\t\tmultiple: boolean,\n\t} = {\n\t\tfilterItems: [],\n\t\tmultiple: false,\n\t};\n\t#application;\n\t#slots: object;\n\t#customComponents: object;\n\n\t// backward compatability\n\t#recentGroupData: ?GroupData;\n\t#showRecentGroup: boolean = false;\n\t#vueInstance: any;\n\n\tconstructor(props: {\n\t\tgroups?: Array<Array<GroupData>>,\n\t\titems?: Array<ItemData>,\n\t\tcanDeselectGroups?: boolean,\n\t\tshowEmptyGroups?: boolean,\n\t\tshowSearch?: boolean,\n\t\tfilterOptions?: {\n\t\t\tfilterItems: Array<FilterData>,\n\t\t\tmultiple: boolean,\n\t\t},\n\t\tpopupOptions?: PopupOptions,\n\t\tcustomTitleBar?: string,\n\t\ttitle?: string,\n\t\tslots?: object,\n\t\tevents?: { [eventName: string]: (event: BaseEvent) => void },\n\t\tcustomComponents?: object,\n\n\t\t// backward compatability\n\t\trecentGroupData: ?GroupData,\n\t\tshowRecentGroup: boolean,\n\t})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.EntityCatalog');\n\n\t\tthis.setGroups(Type.isArray(props.groups) ? props.groups : []);\n\t\tthis.setItems(Type.isArray(props.items) ? props.items : []);\n\n\t\t// backward compatibility\n\t\tthis.#recentGroupData = props.recentGroupData ?? null;\n\t\tthis.#showRecentGroup = Type.isBoolean(props.showRecentGroup) ? props.showRecentGroup : false;\n\n\t\tif (Type.isBoolean(props.canDeselectGroups))\n\t\t{\n\t\t\tthis.#groups.forEach((groupList) => {\n\t\t\t\tgroupList.forEach((group) => {\n\t\t\t\t\tgroup.deselectable = props.canDeselectGroups;\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tthis.#showEmptyGroups = Type.isBoolean(props.showEmptyGroups) ? props.showEmptyGroups : false;\n\t\tthis.#showSearch = Type.isBoolean(props.showSearch) ? props.showSearch : false;\n\n\t\tif (Type.isPlainObject(props.filterOptions))\n\t\t{\n\t\t\tthis.#filterOptions = props.filterOptions;\n\t\t}\n\n\t\tthis.#popupTitle = Type.isString(props.title) ? props.title : '';\n\t\tthis.#customTitleBar = props.customTitleBar ? props.customTitleBar : null;\n\t\tthis.#popupOptions = Object.assign(\n\t\t\tthis.#getDefaultPopupOptions(),\n\t\t\tType.isObject(props.popupOptions) ? props.popupOptions : {},\n\t\t);\n\t\tthis.#slots = props.slots ?? {};\n\t\tthis.#customComponents = props.customComponents ?? {};\n\n\t\tthis.subscribeFromOptions(props.events);\n\t}\n\n\tsetGroups(groups: Array<Array<GroupData> | GroupData>): this\n\t{\n\t\tthis.#groups = groups.map((groupList) => {\n\t\t\tif (!Type.isArray(groupList))\n\t\t\t{\n\t\t\t\tgroupList = [groupList];\n\t\t\t}\n\t\t\treturn groupList.map(group => ({ selected: false, deselectable: true, ...group }));\n\t\t});\n\n\t\tif (!this.#vueInstance || !this.#vueInstance.localGroups)\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tif (this.isGroupsStructureChanged(this.#groups))\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tthis.#vueInstance.refreshGroups(this.#groups);\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\tconsole.error(e);\n\t\t\t\tthis.#vueInstance.localGroups = this.#groups;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst countersMap = {};\n\t\t\tfor (const list of this.#groups)\n\t\t\t{\n\t\t\t\tfor (const g of list)\n\t\t\t\t{\n\t\t\t\t\tcountersMap[String(g.id)] = g.customData?.counterValue ?? null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._updateCountersInGroupLists(this.#vueInstance.localGroups, countersMap);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tisGroupsStructureChanged(newGroups): boolean\n\t{\n\t\tif (!Array.isArray(this.#groups) || !Array.isArray(newGroups))\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.#groups.length !== newGroups.length)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tfor (let i = 0; i < newGroups.length; i++)\n\t\t{\n\t\t\tconst oldList = this.#groups[i] || [];\n\t\t\tconst newList = newGroups[i] || [];\n\t\t\tif (oldList.length !== newList.length)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tfor (let j = 0; j < newList.length; j++)\n\t\t\t{\n\t\t\t\tif (String(oldList[j]?.id) !== String(newList[j]?.id))\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t_updateCountersInGroupLists(groupLists, countersMap = {})\n\t{\n\t\tif (!Array.isArray(groupLists)) return;\n\t\tfor (const list of groupLists)\n\t\t{\n\t\t\tfor (const group of list)\n\t\t\t{\n\t\t\t\tconst id = String(group.id);\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(countersMap, id))\n\t\t\t\t{\n\t\t\t\t\tconst custom = group.customData ?? {};\n\t\t\t\t\tgroup.customData = Object.assign({}, custom, { counterValue: countersMap[id] });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateGroupCounter(groupId, counterValue): this\n\t{\n\t\tconst idStr = String(groupId);\n\t\tconst countersMap = { [idStr]: counterValue };\n\n\t\tthis._updateCountersInGroupLists(this.#groups, countersMap);\n\n\t\tif (!this.#vueInstance)\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tthis._updateCountersInGroupLists(this.#vueInstance.localGroups, countersMap);\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tif (typeof this.#vueInstance.refreshGroups === 'function')\n\t\t\t{\n\t\t\t\tthis.#vueInstance.refreshGroups(this.#groups);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetItems(): Array<ItemData>\n\t{\n\t\treturn this.#items;\n\t}\n\n\tsetItems(items: Array<ItemData> = []): this\n\t{\n\t\tthis.#items.length = 0;\n\t\tthis.#items.push(...items);\n\n\t\tif (!this.#vueInstance || typeof this.#vueInstance.refreshItems !== 'function')\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tthis.#vueInstance.refreshItems(this.#items);\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tconsole.error(e);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tupdateItemById(id, patch = {}): this\n\t{\n\t\tif (this.#vueInstance && typeof this.#vueInstance.updateItemById === 'function')\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tthis.#vueInstance.updateItemById(id, patch);\n\t\t\t\treturn this;\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t}\n\n\t\tconst itemForUpdate = this.#items.find(item => String(item.id) === String(id));\n\t\tif (itemForUpdate)\n\t\t{\n\t\t\tObject.assign(itemForUpdate, patch);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#items.push(Object.assign({ id }, patch));\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tshow()\n\t{\n\t\tthis.#attachTemplate();\n\t\tthis.getPopup().show();\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn this.#popup && this.#popup.isShown();\n\t}\n\n\t#resolveGroupsForTemplate(): Array<Array<GroupData>>\n\t{\n\t\tif (!this.#recentGroupData || !this.#showRecentGroup)\n\t\t{\n\t\t\treturn this.#groups;\n\t\t}\n\n\t\t// clone groups shallowly to avoid mutating original arrays\n\t\tconst groupsClone = this.#groups.map(list => list.slice());\n\n\t\tconst recent = {\n\t\t\tisHeaderGroup: true,\n\t\t\tid: (this.#recentGroupData.id ?? 'recent'),\n\t\t\tname: this.#recentGroupData.name ?? '',\n\t\t\ticon: this.#recentGroupData.icon ?? '',\n\t\t\ttags: this.#recentGroupData.tags ?? [],\n\t\t\tadviceTitle: this.#recentGroupData.adviceTitle,\n\t\t\tadviceAvatar: this.#recentGroupData.adviceAvatar,\n\t\t\tselected: !!this.#recentGroupData.selected,\n\t\t\tdisabled: !!this.#recentGroupData.disabled,\n\t\t\tdeselectable: this.#recentGroupData.deselectable ?? true,\n\t\t\tcompare: this.#recentGroupData.compare,\n\t\t\tcustomData: Object.assign(\n\t\t\t\t{},\n\t\t\t\tthis.#recentGroupData.customData ?? {},\n\t\t\t\t{\n\t\t\t\t\t// prefer canonical name `counterValue`, fallback to legacy `newEntitiesCount`\n\t\t\t\t\tcounterValue: (this.#recentGroupData.customData?.counterValue ?? this.#recentGroupData.customData?.newEntitiesCount)\n\t\t\t\t}\n\t\t\t),\n\t\t};\n\n\t\tif (groupsClone.length > 0 && Array.isArray(groupsClone[0]) && groupsClone[0].some(g => g.isHeaderGroup))\n\t\t{\n\t\t\tgroupsClone[0].unshift(recent);\n\t\t\treturn groupsClone;\n\t\t}\n\n\t\treturn [[recent], ...groupsClone];\n\t}\n\n\t#attachTemplate()\n\t{\n\t\tconst container = this.getPopup().getContentContainer();\n\n\t\tif (this.#application && typeof this.#application.unmount === 'function')\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tthis.#application.unmount();\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t\tthis.#application = null;\n\t\t\tthis.#vueInstance = null;\n\t\t}\n\n\t\tconst context = this;\n\n\t\tconst groupsToPass = this.#resolveGroupsForTemplate();\n\n\t\tconst rootProps = {\n\t\t\tgroups: groupsToPass,\n\t\t\titems: this.#items,\n\t\t\tshowEmptyGroups: this.#showEmptyGroups,\n\t\t\tfilterOptions: this.#filterOptions,\n\t\t};\n\n\t\tthis.#application = BitrixVue.createApp(\n\t\t\t{\n\t\t\t\tname: 'ui-entity-catalog',\n\t\t\t\tcomponents: Object.assign(this.#customComponents, {\n\t\t\t\t\tApplication,\n\t\t\t\t\tHint,\n\t\t\t\t\tButton,\n\t\t\t\t}),\n\t\t\t\tdirectives: {\n\t\t\t\t\tfeedback,\n\t\t\t\t},\n\t\t\t\tprops: {\n\t\t\t\t\tgroups: Array,\n\t\t\t\t\titems: Array,\n\t\t\t\t\tshowEmptyGroups: Boolean,\n\t\t\t\t\tfilterOptions: Object,\n\t\t\t\t},\n\t\t\t\tcreated()\n\t\t\t\t{\n\t\t\t\t\tthis.$app = context;\n\t\t\t\t},\n\t\t\t\tdata(): { localGroups: Array<Array<GroupData>>, localItems: Array<Item> }\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\tlocalGroups: this.groups,\n\t\t\t\t\t\tlocalItems: this.items,\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tmethods: {\n\t\t\t\t\tonItemsRendered()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$app.emit('onItemsRendered');\n\t\t\t\t\t},\n\t\t\t\t\trefreshGroups(groups: Array<GroupData>)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.localGroups = groups;\n\t\t\t\t\t},\n\t\t\t\t\trefreshItems(newItems = [])\n\t\t\t\t\t{\n\t\t\t\t\t\ttry\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst existingMap = new Map(this.localItems.map(it => [String(it.id), it]));\n\n\t\t\t\t\t\t\tnewItems.forEach(newIt => {\n\t\t\t\t\t\t\t\tconst id = String(newIt.id);\n\t\t\t\t\t\t\t\tif (existingMap.has(id))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tObject.assign(existingMap.get(id), newIt);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.localItems.push(newIt);\n\t\t\t\t\t\t\t\t\texistingMap.set(id, this.localItems[this.localItems.length - 1]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tconst newIds = new Set(newItems.map(it => String(it.id)));\n\t\t\t\t\t\t\tfor (let i = this.localItems.length - 1; i >= 0; i--)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (!newIds.has(String(this.localItems[i].id)))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.localItems.splice(i, 1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcatch (e)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t\t\tthis.localItems.splice(0, this.localItems.length, ...newItems);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\n\t\t\t\t\tupdateItemById(id, patch = {})\n\t\t\t\t\t{\n\t\t\t\t\t\ttry\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst it = this.localItems.find(x => String(x.id) === String(id));\n\t\t\t\t\t\t\tif (it)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tObject.assign(it, patch);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.localItems.push(Object.assign({ id }, patch));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcatch (e)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\ttemplate: `\n\t\t\t\t\t<Application\n\t\t\t\t\t\tref=\"application\"\n\t\t\t\t\t\t@itemsRendered=\"onItemsRendered\"\n\t\t\t\t\t\t:groups=\"localGroups\"\n\t\t\t\t\t\t:items=\"localItems\"\n\t\t\t\t\t\t:show-empty-groups=\"showEmptyGroups\"\n\t\t\t\t\t\t:filter-options=\"filterOptions\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #group-list-header>\n\t\t\t\t\t\t\t${this.#slots[EntityCatalog.SLOT_GROUP_LIST_HEADER] ?? ''}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #group=\"groupSlotProps\">\n\t\t\t\t\t\t\t${this.#slots[EntityCatalog.SLOT_GROUP] ?? ''}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #group-list-footer>\n\t\t\t\t\t\t\t${this.#slots[EntityCatalog.SLOT_GROUP_LIST_FOOTER] ?? ''}\n\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t<template #main-content-header>\n\t\t\t\t\t\t\t${this.#slots[EntityCatalog.SLOT_MAIN_CONTENT_HEADER] ?? ''}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #main-content-footer>\n\t\t\t\t\t\t\t${this.#slots[EntityCatalog.SLOT_MAIN_CONTENT_FOOTER] ?? ''}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #main-content-filter-stub v-if=\"${!!this.#slots[EntityCatalog.SLOT_MAIN_CONTENT_FILTERS_STUB]}\">\n\t\t\t\t\t\t\t${this.#slots[EntityCatalog.SLOT_MAIN_CONTENT_FILTERS_STUB]}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #main-content-filter-stub-title v-if=\"${!!this.#slots[EntityCatalog.SLOT_MAIN_CONTENT_FILTERS_STUB_TITLE]}\">\n\t\t\t\t\t\t\t${this.#slots[EntityCatalog.SLOT_MAIN_CONTENT_FILTERS_STUB_TITLE]}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #main-content-search-not-found-stub>\n\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\tthis.#slots[EntityCatalog.SLOT_MAIN_CONTENT_SEARCH_NOT_FOUND]\n\t\t\t\t\t\t\t\t?? Loc.getMessage('UI_JS_ENTITY_CATALOG_GROUP_LIST_ITEM_LIST_SEARCH_STUB_DEFAULT_TITLE')\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-if=\"${Boolean(this.#slots[EntityCatalog.SLOT_MAIN_CONTENT_SEARCH_STUB])}\" #main-content-search-stub>\n\t\t\t\t\t\t\t${this.#slots[EntityCatalog.SLOT_MAIN_CONTENT_SEARCH_STUB]}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #main-content-welcome-stub>\n\t\t\t\t\t\t\t${this.#slots[EntityCatalog.SLOT_MAIN_CONTENT_WELCOME_STUB] ?? ''}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #main-content-no-selected-group-stub>\n\t\t\t\t\t\t\t${this.#slots[EntityCatalog.SLOT_MAIN_CONTENT_NO_SELECTED_GROUP_STUB] ?? ''}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #main-content-empty-group-stub>\n\t\t\t\t\t\t\t${this.#slots[EntityCatalog.SLOT_MAIN_CONTENT_EMPTY_GROUP_STUB] ?? ''}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #main-content-empty-group-stub-title>\n\t\t\t\t\t\t\t${this.#slots[EntityCatalog.SLOT_MAIN_CONTENT_EMPTY_GROUP_STUB_TITLE] ?? ''}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #item=\"itemSlotProps\">\n\t\t\t\t\t\t\t${this.#slots[EntityCatalog.SLOT_MAIN_CONTENT_ITEM] ?? ''}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</Application>\n\t\t\t\t`,\n\t\t\t},\n\t\t\trootProps,\n\t\t);\n\n\t\tthis.#vueInstance = this.#application.use(createPinia()).mount(container);\n\t}\n\n\tgetPopup(): Popup\n\t{\n\t\tif (Type.isNil(this.#popup))\n\t\t{\n\t\t\tthis.#popup = new Popup(this.#popupOptions);\n\n\t\t\tthis.#popup.setResizeMode(true);\n\t\t}\n\n\t\treturn this.#popup;\n\t}\n\n\tselectGroup(groupId: string | number): this\n\t{\n\t\tif (this.#vueInstance && this.#vueInstance.$refs.application)\n\t\t{\n\t\t\tconst group = this.#vueInstance.localGroups.flat().find(g => String(g.id) === String(groupId));\n\n\t\t\tif (group)\n\t\t\t{\n\t\t\t\tthis.#vueInstance.$refs.application.handleGroupSelected(group);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t#getDefaultPopupOptions(): PopupOptions\n\t{\n\t\treturn {\n\t\t\tclassName: 'ui-catalog-popup ui-entity-catalog__scope',\n\t\t\ttitleBar: this.#getPopupTitleBar(),\n\t\t\tnoAllPaddings: true,\n\t\t\tcloseByEsc: true,\n\t\t\tcontentBackground: EntityCatalog.DEFAULT_POPUP_COLOR,\n\t\t\tdraggable: true,\n\t\t\twidth: EntityCatalog.DEFAULT_POPUP_WIDTH,\n\t\t\theight: EntityCatalog.DEFAULT_POPUP_HEIGHT,\n\t\t\tminWidth: EntityCatalog.DEFAULT_POPUP_WIDTH,\n\t\t\tminHeight: EntityCatalog.DEFAULT_POPUP_HEIGHT,\n\t\t\tautoHide: false,\n\t\t};\n\t}\n\n\t#getPopupTitleBar(): Object\n\t{\n\t\tconst titleBar =\n\t\t\tthis.#customTitleBar\n\t\t\t\t? this.#customTitleBar\n\t\t\t\t: Tag.render`<div>${Text.encode(this.#popupTitle)}</div>`\n\t\t;\n\n\t\treturn {\n\t\t\tcontent: Tag.render`\n\t\t\t\t<div class=\"popup-window-titlebar-text ui-entity-catalog-popup-titlebar\">\n\t\t\t\t\t${titleBar}\n\t\t\t\t\t\n\t\t\t\t\t${this.#showSearch ? `<div class=\"ui-entity-catalog__titlebar_search\" data-role=\"titlebar-search\"></div>` : ''}\n\t\t\t\t\t${this.#filterOptions.filterItems.length > 0 ? '<div data-role=\"titlebar-filter\"></div>' : ''}\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass=\"popup-window-close-icon popup-window-titlebar-close-icon\"\n\t\t\t\t\t\tonclick=\"${this.#handleClose.bind(this)}\"\n\t\t\t\t\t\t></span>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t};\n\t}\n\n\t#handleClose(): void\n\t{\n\t\tthis.close();\n\t}\n\n\tclose()\n\t{\n\t\ttry\n\t\t{\n\t\t\tif (this.#application && typeof this.#application.unmount === 'function')\n\t\t\t{\n\t\t\t\tthis.#application.unmount();\n\t\t\t}\n\n\t\t\tif (this.#popup)\n\t\t\t{\n\t\t\t\tthis.#popup.close();\n\t\t\t}\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tconsole.error(e);\n\t\t}\n\n\t\tthis.#application = null;\n\t\tthis.#vueInstance = null;\n\t\tthis.#popup = null;\n\t}\n}"],"names":["feedback","beforeMount","element","bindings","Event","bind","event","preventDefault","BX","UI","Feedback","Form","open","value","Group","emits","name","components","Counter","props","groupData","type","GroupData","required","computed","hasIcon","Type","isStringFilled","icon","getCounterStyle","CounterStyle","FILLED_SUCCESS","getCounterValue","custom","customData","counterValue","isValueInteger","Number","isInteger","methods","handleClick","deselectable","$emit","selected","template","GroupList","groups","Array","groupLists","length","isArray","headerLists","map","list","filter","g","isHeaderGroup","mainLists","handleGroupSelected","group","handleGroupUnselected","MainGroups","searching","Boolean","default","selectedGroup","Object","processedGroups","selectedGroupId","id","groupsClone","Runtime","clone","forEach","groupList","ItemListAdvice","getAvatar","adviceAvatar","renderAdvice","Dom","clean","$refs","container","advice","Advice","content","adviceTitle","avatarImg","anglePosition","AnglePosition","BOTTOM","renderTo","mounted","updated","Button","buttonData","ButtonData","eventData","buttonText","text","Loc","getMessage","handleButtonClick","pointerEvent","BaseEvent","data","originalEvent","isFunction","action","call","Item","itemData","ItemData","isPlainObject","button","topText","ItemList","items","EmptyContent","useGlobalState","defineStore","state","searchQuery","searchApplied","filtersApplied","currentGroup","shouldShowWelcomeStub","MainContent","itemsToShow","mapState","showAdvice","hasItems","showWelcomeStub","showNoSelectedGroupStub","showFiltersStub","hasFilterStubTitle","$slots","showSearchStub","showEmptyGroupStub","showSeparator","beforeUpdate","scrollTop","TitleBarFilter","filters","multiple","appliedFilters","getAppliedFilters","allFilters","showMenu","MenuManager","create","bindElement","$el","minWidth","autoHide","contentColor","draggable","cacheable","getItems","show","key","html","Tag","render","Text","encode","applied","append","push","onclick","item","clearAllAction","getMenuWindow","close","delimiter","getClearAllFilter","keys","Search","opened","debounceSearchHandler","queryString","showClearSearch","watch","newString","created","debounce","onSearch","target","openSearch","$nextTick","focus","toString","clearSearch","Application","showEmptyGroups","filterOptions","filterItems","find","shownItems","shownGroups","lastSearchString","itemsBySelectedGroupId","groupIds","some","compare","sort","computedShownGroups","groupIdsWithItems","Set","groupId","add","has","computedShownItems","q","result","String","title","toLowerCase","includes","description","tags","tag","filterId","slice","mapWritableState","globalGroup","handler","flush","immediate","newVal","splice","flat","getDisplayedGroup","search","getData","applyFilters","onApplyFilterClick","values","getFilterNode","$root","$app","getPopup","getTitleContainer","querySelector","getSearchNode","stopPropagation","Stubs","States","EntityCatalog","EventEmitter","constructor","setEventNamespace","setGroups","setItems","recentGroupData","isBoolean","showRecentGroup","canDeselectGroups","showSearch","isString","customTitleBar","assign","isObject","popupOptions","slots","customComponents","subscribeFromOptions","events","localGroups","isGroupsStructureChanged","refreshGroups","e","console","error","countersMap","_updateCountersInGroupLists","newGroups","i","oldList","newList","j","prototype","hasOwnProperty","updateGroupCounter","idStr","refreshItems","updateItemById","patch","itemForUpdate","isShown","isNil","Popup","setResizeMode","selectGroup","application","unmount","recent","disabled","newEntitiesCount","unshift","getContentContainer","context","groupsToPass","rootProps","BitrixVue","createApp","Hint","directives","localItems","onItemsRendered","emit","newItems","existingMap","Map","it","newIt","get","set","newIds","x","SLOT_GROUP_LIST_HEADER","SLOT_GROUP","SLOT_GROUP_LIST_FOOTER","SLOT_MAIN_CONTENT_HEADER","SLOT_MAIN_CONTENT_FOOTER","SLOT_MAIN_CONTENT_FILTERS_STUB","SLOT_MAIN_CONTENT_FILTERS_STUB_TITLE","SLOT_MAIN_CONTENT_SEARCH_NOT_FOUND","SLOT_MAIN_CONTENT_SEARCH_STUB","SLOT_MAIN_CONTENT_WELCOME_STUB","SLOT_MAIN_CONTENT_NO_SELECTED_GROUP_STUB","SLOT_MAIN_CONTENT_EMPTY_GROUP_STUB","SLOT_MAIN_CONTENT_EMPTY_GROUP_STUB_TITLE","SLOT_MAIN_CONTENT_ITEM","use","createPinia","mount","className","titleBar","noAllPaddings","closeByEsc","contentBackground","DEFAULT_POPUP_COLOR","width","DEFAULT_POPUP_WIDTH","height","DEFAULT_POPUP_HEIGHT","minHeight"],"mappings":"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"}