{"version":3,"file":"hint.bundle.js","sources":["../src/tooltip.js","../src/directive.js"],"sourcesContent":["import { Event, Tag, Text, Type } from 'main.core';\nimport { Popup, type PopupOptions } from 'main.popup';\n\nexport type HintParams = {\n\ttext: string,\n\thtml: string,\n\tpopupOptions: PopupOptions,\n\tposition: 'top',\n\ttimeout: number,\n\tinteractivity: boolean,\n};\n\nclass Tooltip\n{\n\tpopup: ?Popup;\n\tcursorOnPopup: boolean;\n\n\tconstructor(): void\n\t{\n\t\tthis.popup = null;\n\t\tthis.cursorOnPopup = false;\n\t}\n\n\tshow(element: HTMLElement, params: HintParams): void\n\t{\n\t\tthis.hide(false);\n\n\t\tconst popupOptions: PopupOptions = {\n\t\t\tid: `bx-vue-hint-${Date.now()}`,\n\t\t\tbindElement: element,\n\t\t\tbindOptions: {\n\t\t\t\tposition: (params.position === 'top') ? 'top' : 'bottom',\n\t\t\t},\n\t\t\tcontent: Tag.render`\n\t\t\t\t<span class='ui-hint-content'>${this.#getText(element, params)}</span>\n\t\t\t`,\n\t\t\tdarkMode: true,\n\t\t\tautoHide: true,\n\t\t\tcacheable: false,\n\t\t\tanimation: 'fading',\n\t\t\t...(params.popupOptions ?? null),\n\t\t};\n\n\t\tthis.popup = new Popup(popupOptions);\n\t\tthis.popup.show();\n\n\t\tif (params.interactivity && this.popup?.getPopupContainer())\n\t\t{\n\t\t\tEvent.bind(this.popup.getPopupContainer(), 'mouseenter', () => {\n\t\t\t\tthis.cursorOnPopup = true;\n\t\t\t});\n\t\t\tEvent.bind(this.popup.getPopupContainer(), 'mouseleave', () => {\n\t\t\t\tthis.cursorOnPopup = false;\n\t\t\t\tthis.hide(true);\n\t\t\t});\n\t\t}\n\t}\n\n\thide(isInteractive: boolean): void\n\t{\n\t\tif (isInteractive)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (this.popup && this.popup.getPopupContainer() && !(this.cursorOnPopup))\n\t\t\t\t{\n\t\t\t\t\tthis.popup.close();\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.popup?.close();\n\t\t}\n\t}\n\n\t#getText(element: HTMLElement, params: HintParams): string\n\t{\n\t\tif (Type.isStringFilled(params) && Type.isUndefined(element.dataset.hintHtml))\n\t\t{\n\t\t\treturn Text.encode(params);\n\t\t}\n\n\t\treturn params.html || Text.encode(params.text) || params;\n\t}\n}\n\nexport const tooltip = new Tooltip();\n","/**\n * Hint Vue directive\n *\n * @package bitrix\n * @subpackage ui\n * @copyright 2001-2025 Bitrix\n */\n\n/*\n\t<span v-hint=\"$Bitrix.Loc.getMessage('HINT_HTML')\" data-hint-html>Html code</span>\n\t<span v-hint=\"{text: 'Text node'}\">Plain text</span>\n\t<span v-hint=\"{html: '<b>Html</b> code'}\">Html code</span>\n\t<span v-hint=\"{text: 'Custom position top and light mode', position: 'top', popupOptions: {darkMode: false}}\">\n\t\tText top on light panel\n\t</span>\n\t<span v-hint=\"{text: 'Hint text <a>More</a>', interactivity: true}\">Hint with clickable link</span>\n*/\n\nimport { Event, Type } from 'main.core';\nimport 'ui.hint';\n\nimport { tooltip, type HintParams } from './tooltip';\nexport type { HintParams };\n\nconst handlersMap = new WeakMap();\n\nexport const hint = {\n\tmounted(element: HTMLElement, { value }: { value: HintParams | Function }): void\n\t{\n\t\tupdateEvents(element, value);\n\t},\n\tupdated(element: HTMLElement, { value }: { value: HintParams | Function }): void\n\t{\n\t\tupdateEvents(element, value);\n\t},\n\tbeforeUnmount(element: HTMLElement): void\n\t{\n\t\tunbindEvents(element);\n\t},\n};\n\nlet showTimeout = null;\n\nfunction updateEvents(element: HTMLElement, params: HintParams | Function): void\n{\n\tunbindEvents(element);\n\tif (params)\n\t{\n\t\tconst handlers = {\n\t\t\tmouseenter: () => onMouseEnter(element, getParams(params)),\n\t\t\tmouseleave: () => hideTooltip(getParams(params).interactivity ?? false),\n\t\t\tclick: () => hideTooltip(),\n\t\t};\n\t\thandlersMap.set(element, handlers);\n\n\t\tObject.entries(handlers).forEach(([event, handler]) => Event.bind(element, event, handler));\n\t}\n}\n\nfunction unbindEvents(element: HTMLElement): void\n{\n\tclearTimeouts();\n\tObject.entries(handlersMap.get(element) ?? {}).forEach(([event, handler]) => Event.unbind(element, event, handler));\n\thandlersMap.delete(element);\n}\n\nfunction onMouseEnter(element: HTMLElement, params: HintParams): void\n{\n\tclearTimeouts();\n\tshowTimeout = setTimeout(() => showTooltip(element, params), params.timeout ?? 0);\n}\n\nfunction showTooltip(element: HTMLElement, params: HintParams): void\n{\n\tclearTimeouts();\n\ttooltip.show(element, params);\n}\n\nfunction hideTooltip(isInteractive): void\n{\n\tclearTimeouts();\n\ttooltip.hide(isInteractive);\n}\n\nfunction clearTimeouts(): void\n{\n\tclearTimeout(showTimeout);\n}\n\nfunction getParams(value: HintParams | Function): HintParams\n{\n\treturn Type.isFunction(value) ? value() : value;\n}\n"],"names":["Tooltip","constructor","popup","cursorOnPopup","show","element","params","hide","popupOptions","id","Date","now","bindElement","bindOptions","position","content","Tag","render","darkMode","autoHide","cacheable","animation","Popup","interactivity","getPopupContainer","Event","bind","isInteractive","setTimeout","close","Type","isStringFilled","isUndefined","dataset","hintHtml","Text","encode","html","text","tooltip","handlersMap","WeakMap","hint","mounted","value","updateEvents","updated","beforeUnmount","unbindEvents","showTimeout","handlers","mouseenter","onMouseEnter","getParams","mouseleave","hideTooltip","click","set","Object","entries","forEach","event","handler","clearTimeouts","get","unbind","delete","showTooltip","timeout","clearTimeout","isFunction"],"mappings":"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"}