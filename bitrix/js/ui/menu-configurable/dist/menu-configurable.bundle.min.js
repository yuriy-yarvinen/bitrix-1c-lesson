this.BX=this.BX||{};this.BX.UI=this.BX.UI||{};(function(e,s,i,l,a){"use strict";var t=babelHelpers.classPrivateFieldLooseKey("id");var r=babelHelpers.classPrivateFieldLooseKey("items");var o=babelHelpers.classPrivateFieldLooseKey("menu");var b=babelHelpers.classPrivateFieldLooseKey("bindElement");var n=babelHelpers.classPrivateFieldLooseKey("draggable");var c=babelHelpers.classPrivateFieldLooseKey("promise");var d=babelHelpers.classPrivateFieldLooseKey("closeResolver");var v=babelHelpers.classPrivateFieldLooseKey("maxVisibleItems");var u=babelHelpers.classPrivateFieldLooseKey("maxWidth");var p=babelHelpers.classPrivateFieldLooseKey("resolveWithCancel");var h=babelHelpers.classPrivateFieldLooseKey("resolveWithItems");var P=babelHelpers.classPrivateFieldLooseKey("getItemById");var L=babelHelpers.classPrivateFieldLooseKey("createMenu");var F=babelHelpers.classPrivateFieldLooseKey("getSaveItem");var H=babelHelpers.classPrivateFieldLooseKey("getCancelItem");var m=babelHelpers.classPrivateFieldLooseKey("save");var f=babelHelpers.classPrivateFieldLooseKey("cancel");var B=babelHelpers.classPrivateFieldLooseKey("getMenuItem");var y=babelHelpers.classPrivateFieldLooseKey("getVisibleSectionTitleItem");var g=babelHelpers.classPrivateFieldLooseKey("getHiddenSectionTitleItem");var I=babelHelpers.classPrivateFieldLooseKey("initDraggable");var O=babelHelpers.classPrivateFieldLooseKey("saveItemsFromMenu");var E=babelHelpers.classPrivateFieldLooseKey("getItemNode");var j=babelHelpers.classPrivateFieldLooseKey("getHiddenSectionTitleNode");var K=babelHelpers.classPrivateFieldLooseKey("adjustMaxVisibleItems");class M extends i.EventEmitter{constructor(e){super();Object.defineProperty(this,K,{value:J});Object.defineProperty(this,j,{value:G});Object.defineProperty(this,E,{value:T});Object.defineProperty(this,O,{value:R});Object.defineProperty(this,I,{value:W});Object.defineProperty(this,g,{value:V});Object.defineProperty(this,y,{value:A});Object.defineProperty(this,B,{value:X});Object.defineProperty(this,f,{value:D});Object.defineProperty(this,m,{value:x});Object.defineProperty(this,H,{value:w});Object.defineProperty(this,F,{value:_});Object.defineProperty(this,L,{value:S});Object.defineProperty(this,P,{value:U});Object.defineProperty(this,h,{value:N});Object.defineProperty(this,p,{value:C});Object.defineProperty(this,t,{writable:true,value:void 0});Object.defineProperty(this,r,{writable:true,value:void 0});Object.defineProperty(this,o,{writable:true,value:void 0});Object.defineProperty(this,b,{writable:true,value:void 0});Object.defineProperty(this,n,{writable:true,value:void 0});Object.defineProperty(this,c,{writable:true,value:void 0});Object.defineProperty(this,d,{writable:true,value:void 0});Object.defineProperty(this,v,{writable:true,value:0});Object.defineProperty(this,u,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,t)[t]=s.Type.isStringFilled(e.id)?e.id:`settings-popup-${Math.random().toString().slice(2)}`;babelHelpers.classPrivateFieldLooseBase(this,r)[r]=e.items;babelHelpers.classPrivateFieldLooseBase(this,b)[b]=e.bindElement;babelHelpers.classPrivateFieldLooseBase(this,v)[v]=Number(e.maxVisibleItems);babelHelpers.classPrivateFieldLooseBase(this,u)[u]=s.Type.isNumber(e.maxWidth)?e.maxWidth:null;babelHelpers.classPrivateFieldLooseBase(this,L)[L]();this.setEventNamespace("BX.UI.MenuConfigurable.Menu")}open(e){var s;if(e){var i;(i=babelHelpers.classPrivateFieldLooseBase(this,o)[o])==null?void 0:i.getPopupWindow().setBindElement(e)}(s=babelHelpers.classPrivateFieldLooseBase(this,o)[o])==null?void 0:s.show();if(!babelHelpers.classPrivateFieldLooseBase(this,c)[c]){babelHelpers.classPrivateFieldLooseBase(this,c)[c]=new Promise((e=>{babelHelpers.classPrivateFieldLooseBase(this,d)[d]=e}))}return babelHelpers.classPrivateFieldLooseBase(this,c)[c]}close(){babelHelpers.classPrivateFieldLooseBase(this,L)[L]();babelHelpers.classPrivateFieldLooseBase(this,p)[p]()}setItems(e){babelHelpers.classPrivateFieldLooseBase(this,r)[r]=e;return this}getItemsFromMenu(){const e=[];let i=false;babelHelpers.classPrivateFieldLooseBase(this,o)[o].itemsContainer.querySelectorAll(".menu-configurable-item").forEach((l=>{if(s.Dom.hasClass(l,"menu-configurable-hidden-section-title")){i=true}const a=l.dataset.id;const t=babelHelpers.classPrivateFieldLooseBase(this,P)[P](a);if(t){const l=s.Runtime.clone(t);l.isHidden=i;e.push(l)}}));return e}}function C(){babelHelpers.classPrivateFieldLooseBase(this,c)[c]=null;if(babelHelpers.classPrivateFieldLooseBase(this,d)[d]){babelHelpers.classPrivateFieldLooseBase(this,d)[d]({isCanceled:true})}babelHelpers.classPrivateFieldLooseBase(this,d)[d]=null}function N(){babelHelpers.classPrivateFieldLooseBase(this,c)[c]=null;if(babelHelpers.classPrivateFieldLooseBase(this,d)[d]){babelHelpers.classPrivateFieldLooseBase(this,d)[d]({items:babelHelpers.classPrivateFieldLooseBase(this,r)[r]})}babelHelpers.classPrivateFieldLooseBase(this,d)[d]=null}function U(e){return babelHelpers.classPrivateFieldLooseBase(this,r)[r].find((s=>s.id===e))}function S(e){if(babelHelpers.classPrivateFieldLooseBase(this,o)[o]){babelHelpers.classPrivateFieldLooseBase(this,o)[o].destroy();babelHelpers.classPrivateFieldLooseBase(this,n)[n]=null}const s=[];s.push(babelHelpers.classPrivateFieldLooseBase(this,y)[y]());const i=babelHelpers.classPrivateFieldLooseBase(this,r)[r].filter((e=>!e.isHidden));const a=babelHelpers.classPrivateFieldLooseBase(this,r)[r].filter((e=>e.isHidden));i.forEach((e=>{s.push(babelHelpers.classPrivateFieldLooseBase(this,B)[B](e))}));s.push(babelHelpers.classPrivateFieldLooseBase(this,g)[g]());a.forEach((e=>{s.push(babelHelpers.classPrivateFieldLooseBase(this,B)[B](e))}));s.push(babelHelpers.classPrivateFieldLooseBase(this,F)[F](),babelHelpers.classPrivateFieldLooseBase(this,H)[H]());babelHelpers.classPrivateFieldLooseBase(this,o)[o]=l.MenuManager.create({id:babelHelpers.classPrivateFieldLooseBase(this,t)[t],items:s,bindElement:e!=null?e:babelHelpers.classPrivateFieldLooseBase(this,b)[b],events:{onClose:this.close.bind(this)},maxWidth:babelHelpers.classPrivateFieldLooseBase(this,u)[u]});babelHelpers.classPrivateFieldLooseBase(this,I)[I]();return babelHelpers.classPrivateFieldLooseBase(this,o)[o]}function _(){return{text:s.Loc.getMessage("UI_JS_MENU_CONFIGURABLE_SAVE"),onclick:babelHelpers.classPrivateFieldLooseBase(this,m)[m].bind(this)}}function w(){return{text:s.Loc.getMessage("UI_JS_MENU_CONFIGURABLE_CANCEL"),onclick:babelHelpers.classPrivateFieldLooseBase(this,f)[f].bind(this)}}function x(){const e=new i.BaseEvent;this.emit("Save",e);if(e.isDefaultPrevented()){return}babelHelpers.classPrivateFieldLooseBase(this,O)[O]();babelHelpers.classPrivateFieldLooseBase(this,h)[h]();babelHelpers.classPrivateFieldLooseBase(this,L)[L]()}function D(){const e=new i.BaseEvent;this.emit("Cancel",e);if(e.isDefaultPrevented()){return}this.close()}function X(e){return{id:e.id,text:e.text,html:e.html,className:"menu-configurable-item",dataset:{id:e.id}}}function A(){return{delimiter:true,html:`<span>${s.Loc.getMessage("UI_JS_MENU_CONFIGURABLE_VISIBLE")}</span>`,className:"menu-configurable-visible-section-title menu-configurable-delimiter-item"}}function V(){return{delimiter:true,html:`<span>${s.Loc.getMessage("UI_JS_MENU_CONFIGURABLE_HIDDEN")}</span>`,className:"menu-configurable-hidden-section-title menu-configurable-delimiter-item menu-configurable-item"}}function W(){babelHelpers.classPrivateFieldLooseBase(this,n)[n]=new a.Draggable({container:babelHelpers.classPrivateFieldLooseBase(this,o)[o].itemsContainer,draggable:".menu-configurable-item",dragElement:".menu-popup-item-icon",type:a.Draggable.MOVE});babelHelpers.classPrivateFieldLooseBase(this,n)[n].subscribe("end",babelHelpers.classPrivateFieldLooseBase(this,K)[K].bind(this))}function R(){this.setItems(this.getItemsFromMenu())}function T(e){return babelHelpers.classPrivateFieldLooseBase(this,o)[o].itemsContainer.querySelector(`.menu-configurable-item[data-id="${e.id}"]`)}function G(){return babelHelpers.classPrivateFieldLooseBase(this,o)[o].itemsContainer.querySelector(".menu-configurable-hidden-section-title")}function J(){if(babelHelpers.classPrivateFieldLooseBase(this,v)[v]<=0){return}const e=this.getItemsFromMenu();const i=e.filter((e=>!e.isHidden));const l=i.length;const a=babelHelpers.classPrivateFieldLooseBase(this,j)[j]();if(a&&l>babelHelpers.classPrivateFieldLooseBase(this,v)[v]){for(let e=babelHelpers.classPrivateFieldLooseBase(this,v)[v];e<l;e++){const l=i[e];const t=babelHelpers.classPrivateFieldLooseBase(this,E)[E](l);if(t){s.Dom.insertAfter(t,a)}}}}e.Menu=M})(this.BX.UI.MenuConfigurable=this.BX.UI.MenuConfigurable||{},BX,BX.Event,BX.Main,BX.UI.DragAndDrop);
//# sourceMappingURL=menu-configurable.bundle.map.js