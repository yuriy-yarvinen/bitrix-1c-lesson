{"version":3,"file":"user-consent.bundle.js","sources":["../src/user-consent.js"],"sourcesContent":["import { BitrixVue } from 'ui.vue';\nimport { ajax, Tag, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { EventType, Component, RestMethod } from 'sale.checkout.const';\n\nBitrixVue.component('sale-checkout-view-user_consent', {\n\tprops: ['item'],\n\tmounted()\n\t{\n\t\tthis.getBlockHtml();\n\t},\n\tmethods:\n\t{\n\t\tgetBlockHtml()\n\t\t{\n\t\t\tconst userConsent = {\n\t\t\t\ttitle: this.item.title,\n\t\t\t\tisLoaded: this.item.isLoaded,\n\t\t\t\tautoSave: this.item.autoSave,\n\t\t\t\tsubmitEventName: this.item.submitEventName,\n\t\t\t\tfields: this.item.params,\n\t\t\t\titems: this.item.items,\n\t\t\t};\n\n\t\t\tajax.runComponentAction(\n\t\t\t\tComponent.bitrixSaleOrderCheckout,\n\t\t\t\tRestMethod.saleEntityUserConsentRequest,\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tfields: userConsent,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tif (\n\t\t\t\t\t\tBX.type.isPlainObject(response.data)\n\t\t\t\t\t\t\t&& BX.type.isNotEmptyString(response.data.html)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst consent = response.data.html;\n\n\t\t\t\t\t\tif (BX.UserConsent !== undefined)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst wrapper = this.$refs.consentDiv;\n\n\t\t\t\t\t\t\twrapper.appendChild(Tag.render`<div>${consent}</div>`);\n\n\t\t\t\t\t\t\tBX.UserConsent.loadAll(wrapper);\n\t\t\t\t\t\t\tconst controls = BX.UserConsent && BX.UserConsent.getItems();\n\t\t\t\t\t\t\tcontrols.forEach((control) => {\n\t\t\t\t\t\t\t\tEventEmitter.subscribe(\n\t\t\t\t\t\t\t\t\tcontrol,\n\t\t\t\t\t\t\t\t\tBX.UserConsent.events.afterAccepted,\n\t\t\t\t\t\t\t\t\t(event) => EventEmitter.emit(\n\t\t\t\t\t\t\t\t\t\tEventType.consent.accepted,\n\t\t\t\t\t\t\t\t\t\tevent,\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tEventEmitter.subscribe(\n\t\t\t\t\t\t\t\t\tcontrol,\n\t\t\t\t\t\t\t\t\tBX.UserConsent.events.refused,\n\t\t\t\t\t\t\t\t\t(event) => EventEmitter.emit(\n\t\t\t\t\t\t\t\t\t\tEventType.consent.refused,\n\t\t\t\t\t\t\t\t\t\tevent,\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t <div class=\"checkout-basket-section checkout-basket-section-consent\">\n\t\t<div ref=\"consentDiv\"/>\n\t\t    </div>\n\t`,\n});\n"],"names":["BitrixVue","component","props","mounted","getBlockHtml","methods","userConsent","title","item","isLoaded","autoSave","submitEventName","fields","params","items","ajax","runComponentAction","Component","bitrixSaleOrderCheckout","RestMethod","saleEntityUserConsentRequest","data","then","response","BX","type","isPlainObject","isNotEmptyString","html","consent","UserConsent","undefined","wrapper","$refs","consentDiv","appendChild","Tag","render","loadAll","controls","getItems","forEach","control","EventEmitter","subscribe","events","afterAccepted","event","emit","EventType","accepted","refused","template"],"mappings":";;;;;;;;AAAA,AAKAA,iBAAS,CAACC,SAAS,CAAC,iCAAiC,EAAE;GACtDC,KAAK,EAAE,CAAC,MAAM,CAAC;GACfC,OAAO,qBACP;KACC,IAAI,CAACC,YAAY,EAAE;IACnB;GACDC,OAAO,EACP;KACCD,YAAY,0BACZ;OAAA;OACC,IAAME,WAAW,GAAG;SACnBC,KAAK,EAAE,IAAI,CAACC,IAAI,CAACD,KAAK;SACtBE,QAAQ,EAAE,IAAI,CAACD,IAAI,CAACC,QAAQ;SAC5BC,QAAQ,EAAE,IAAI,CAACF,IAAI,CAACE,QAAQ;SAC5BC,eAAe,EAAE,IAAI,CAACH,IAAI,CAACG,eAAe;SAC1CC,MAAM,EAAE,IAAI,CAACJ,IAAI,CAACK,MAAM;SACxBC,KAAK,EAAE,IAAI,CAACN,IAAI,CAACM;QACjB;OAEDC,cAAI,CAACC,kBAAkB,CACtBC,6BAAS,CAACC,uBAAuB,EACjCC,8BAAU,CAACC,4BAA4B,EACvC;SACCC,IAAI,EAAE;WACLT,MAAM,EAAEN;;QAET,CACD,CACCgB,IAAI,CAAC,UAACC,QAAQ,EAAK;SACnB,IACCC,EAAE,CAACC,IAAI,CAACC,aAAa,CAACH,QAAQ,CAACF,IAAI,CAAC,IAChCG,EAAE,CAACC,IAAI,CAACE,gBAAgB,CAACJ,QAAQ,CAACF,IAAI,CAACO,IAAI,CAAC,EAEjD;WACC,IAAMC,OAAO,GAAGN,QAAQ,CAACF,IAAI,CAACO,IAAI;WAElC,IAAIJ,EAAE,CAACM,WAAW,KAAKC,SAAS,EAChC;aACC,IAAMC,OAAO,GAAG,KAAI,CAACC,KAAK,CAACC,UAAU;aAErCF,OAAO,CAACG,WAAW,CAACC,aAAG,CAACC,MAAM,iGAAQR,OAAO,EAAS;aAEtDL,EAAE,CAACM,WAAW,CAACQ,OAAO,CAACN,OAAO,CAAC;aAC/B,IAAMO,QAAQ,GAAGf,EAAE,CAACM,WAAW,IAAIN,EAAE,CAACM,WAAW,CAACU,QAAQ,EAAE;aAC5DD,QAAQ,CAACE,OAAO,CAAC,UAACC,OAAO,EAAK;eAC7BC,6BAAY,CAACC,SAAS,CACrBF,OAAO,EACPlB,EAAE,CAACM,WAAW,CAACe,MAAM,CAACC,aAAa,EACnC,UAACC,KAAK;iBAAA,OAAKJ,6BAAY,CAACK,IAAI,CAC3BC,6BAAS,CAACpB,OAAO,CAACqB,QAAQ,EAC1BH,KAAK,CACL;iBACD;eACDJ,6BAAY,CAACC,SAAS,CACrBF,OAAO,EACPlB,EAAE,CAACM,WAAW,CAACe,MAAM,CAACM,OAAO,EAC7B,UAACJ,KAAK;iBAAA,OAAKJ,6BAAY,CAACK,IAAI,CAC3BC,6BAAS,CAACpB,OAAO,CAACsB,OAAO,EACzBJ,KAAK,CACL;iBACD;cACD,CAAC;;;QAGJ,CAAC;;IAEJ;;GAEDK,QAAQ;CAKT,CAAC,CAAC;;;;"}